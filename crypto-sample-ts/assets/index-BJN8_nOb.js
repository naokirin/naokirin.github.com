(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?o.credentials="include":c.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(c){if(c.ep)return;c.ep=!0;const o=r(c);fetch(c.href,o)}})();const mf="modulepreload",Ef=function(t,e){return new URL(t,e).href},ri={},Ce=function(e,r,a){let c=Promise.resolve();if(r&&r.length>0){let h=function(m){return Promise.all(m.map(B=>Promise.resolve(B).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};const i=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),u=n?.nonce||n?.getAttribute("nonce");c=h(r.map(m=>{if(m=Ef(m,a),m in ri)return;ri[m]=!0;const B=m.endsWith(".css"),v=B?'[rel="stylesheet"]':"";if(a)for(let p=i.length-1;p>=0;p--){const C=i[p];if(C.href===m&&(!B||C.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${v}`))return;const d=document.createElement("link");if(d.rel=B?"stylesheet":mf,B||(d.as="script"),d.crossOrigin="",d.href=m,u&&d.setAttribute("nonce",u),document.head.appendChild(d),B)return new Promise((p,C)=>{d.addEventListener("load",p),d.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(i){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=i,window.dispatchEvent(n),!n.defaultPrevented)throw i}return c.then(i=>{for(const n of i||[])n.status==="rejected"&&o(n.reason);return e().catch(o)})};let or=null,ni=!1;async function Or(){if(!(ni&&or))try{const t=(await Ce(async()=>{const{default:e}=await import("./abe_wasm-DZZnvu4H.js");return{default:e}},[],import.meta.url)).default;or=await t({module_or_path:new URL(""+new URL("abe_wasm_bg-BOfsLHu7.wasm",import.meta.url).href,import.meta.url).href}),or.init(),ni=!0}catch(t){throw new Error(`Failed to initialize ABE WebAssembly module: ${t}`)}}async function xf(){if(await Or(),!or)throw new Error("ABE module not initialized");const{ABE:t}=await Ce(async()=>{const{ABE:o}=await import("./abe_wasm-DZZnvu4H.js");return{ABE:o}},[],import.meta.url),r=new t().setup();if(!r||typeof r!="object")throw new Error("Failed to generate ABE key pair");const a=r.master_key,c=r.public_params;return{masterKey:a,publicParams:c}}async function Sf(t,e){if(await Or(),!or)throw new Error("ABE module not initialized");const{ABE:r}=await Ce(async()=>{const{ABE:o}=await import("./abe_wasm-DZZnvu4H.js");return{ABE:o}},[],import.meta.url),c=new r().key_gen(t,e);if(!c)throw new Error("Failed to extract ABE private key");return c}async function Cf(t,e,r){if(await Or(),!or)throw new Error("ABE module not initialized");const{ABE:a}=await Ce(async()=>{const{ABE:o}=await import("./abe_wasm-DZZnvu4H.js");return{ABE:o}},[],import.meta.url),c=new a;try{return c.encrypt(t,e,r)}catch(o){throw new Error(`ABE encrypt failed: ${o}`)}}async function bf(t,e){if(await Or(),!or)throw new Error("ABE module not initialized");const{ABE:r}=await Ce(async()=>{const{ABE:c}=await import("./abe_wasm-DZZnvu4H.js");return{ABE:c}},[],import.meta.url),a=new r;try{return a.decrypt(t,e)}catch(c){throw new Error(`ABE decrypt failed: ${c}`)}}const Yr=BigInt(2**32-1),ai=BigInt(32);function fn(t,e=!1){return e?{h:Number(t&Yr),l:Number(t>>ai&Yr)}:{h:Number(t>>ai&Yr)|0,l:Number(t&Yr)|0}}function Ls(t,e=!1){const r=t.length;let a=new Uint32Array(r),c=new Uint32Array(r);for(let o=0;o<r;o++){const{h:i,l:n}=fn(t[o],e);[a[o],c[o]]=[i,n]}return[a,c]}const ii=(t,e,r)=>t>>>r,si=(t,e,r)=>t<<32-r|e>>>r,er=(t,e,r)=>t>>>r|e<<32-r,tr=(t,e,r)=>t<<32-r|e>>>r,wr=(t,e,r)=>t<<64-r|e>>>r-32,Tr=(t,e,r)=>t>>>r-32|e<<64-r,Bf=(t,e)=>e,wf=(t,e)=>t,Tf=(t,e,r)=>t<<r|e>>>32-r,Af=(t,e,r)=>e<<r|t>>>32-r,If=(t,e,r)=>e<<r-32|t>>>64-r,_f=(t,e,r)=>t<<r-32|e>>>64-r;function St(t,e,r,a){const c=(e>>>0)+(a>>>0);return{h:t+r+(c/2**32|0)|0,l:c|0}}const Pa=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Oa=(t,e,r,a)=>e+r+a+(t/2**32|0)|0,Rf=(t,e,r,a)=>(t>>>0)+(e>>>0)+(r>>>0)+(a>>>0),Nf=(t,e,r,a,c)=>e+r+a+c+(t/2**32|0)|0,Lf=(t,e,r,a,c)=>(t>>>0)+(e>>>0)+(r>>>0)+(a>>>0)+(c>>>0),kf=(t,e,r,a,c,o)=>e+r+a+c+o+(t/2**32|0)|0;function pn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function dt(t,e=""){if(!Number.isSafeInteger(t)||t<0){const r=e&&`"${e}" `;throw new Error(`${r}expected integer >= 0, got ${t}`)}}function de(t,e,r=""){const a=pn(t),c=t?.length,o=e!==void 0;if(!a||o&&c!==e){const i=r&&`"${r}" `,n=o?` of length ${e}`:"",u=a?`length=${c}`:`type=${typeof t}`;throw new Error(i+"expected Uint8Array"+n+", got "+u)}return t}function ks(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash must wrapped by utils.createHasher");dt(t.outputLen),dt(t.blockLen)}function Ht(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function yn(t,e){de(t,void 0,"digestInto() output");const r=e.outputLen;if(t.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function Uf(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function cr(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ut(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Rn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ft(t,e){return t<<32-e|t>>>e}const Us=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ds(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Kt=Us?t=>t:t=>Ds(t);function Df(t){for(let e=0;e<t.length;e++)t[e]=Ds(t[e]);return t}const it=Us?t=>t:Df,Ps=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Pf=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Kr(t){if(de(t),Ps)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Pf[t[r]];return e}const Pt={_0:48,_9:57,A:65,F:70,a:97,f:102};function oi(t){if(t>=Pt._0&&t<=Pt._9)return t-Pt._0;if(t>=Pt.A&&t<=Pt.F)return t-(Pt.A-10);if(t>=Pt.a&&t<=Pt.f)return t-(Pt.a-10)}function Lr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(Ps)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const a=new Uint8Array(r);for(let c=0,o=0;c<r;c++,o+=2){const i=oi(t.charCodeAt(o)),n=oi(t.charCodeAt(o+1));if(i===void 0||n===void 0){const u=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+o)}a[c]=i*16+n}return a}function Ct(...t){let e=0;for(let a=0;a<t.length;a++){const c=t[a];de(c),e+=c.length}const r=new Uint8Array(e);for(let a=0,c=0;a<t.length;a++){const o=t[a];r.set(o,c),c+=o.length}return r}function nr(t,e={}){const r=(c,o)=>t(o).update(c).digest(),a=t(void 0);return r.outputLen=a.outputLen,r.blockLen=a.blockLen,r.create=c=>t(c),Object.assign(r,e),Object.freeze(r)}function Ka(t=32){const e=typeof globalThis=="object"?globalThis.crypto:null;if(typeof e?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return e.getRandomValues(new Uint8Array(t))}const Vr=t=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,t])}),Of=BigInt(0),Br=BigInt(1),Kf=BigInt(2),Vf=BigInt(7),Ff=BigInt(256),Mf=BigInt(113),Os=[],Ks=[],Vs=[];for(let t=0,e=Br,r=1,a=0;t<24;t++){[r,a]=[a,(2*r+3*a)%5],Os.push(2*(5*a+r)),Ks.push((t+1)*(t+2)/2%64);let c=Of;for(let o=0;o<7;o++)e=(e<<Br^(e>>Vf)*Mf)%Ff,e&Kf&&(c^=Br<<(Br<<BigInt(o))-Br);Vs.push(c)}const Fs=Ls(Vs,!0),Hf=Fs[0],qf=Fs[1],fi=(t,e,r)=>r>32?If(t,e,r):Tf(t,e,r),ci=(t,e,r)=>r>32?_f(t,e,r):Af(t,e,r);function Gf(t,e=24){const r=new Uint32Array(10);for(let a=24-e;a<24;a++){for(let i=0;i<10;i++)r[i]=t[i]^t[i+10]^t[i+20]^t[i+30]^t[i+40];for(let i=0;i<10;i+=2){const n=(i+8)%10,u=(i+2)%10,h=r[u],m=r[u+1],B=fi(h,m,1)^r[n],v=ci(h,m,1)^r[n+1];for(let d=0;d<50;d+=10)t[i+d]^=B,t[i+d+1]^=v}let c=t[2],o=t[3];for(let i=0;i<24;i++){const n=Ks[i],u=fi(c,o,n),h=ci(c,o,n),m=Os[i];c=t[m],o=t[m+1],t[m]=u,t[m+1]=h}for(let i=0;i<50;i+=10){for(let n=0;n<10;n++)r[n]=t[i+n];for(let n=0;n<10;n++)t[i+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=Hf[a],t[1]^=qf[a]}ut(r)}class gn{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(e,r,a,c=!1,o=24){if(this.blockLen=e,this.suffix=r,this.outputLen=a,this.enableXOF=c,this.rounds=o,dt(a,"outputLen"),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=cr(this.state)}clone(){return this._cloneInto()}keccak(){it(this.state32),Gf(this.state32,this.rounds),it(this.state32),this.posOut=0,this.pos=0}update(e){Ht(this),de(e);const{blockLen:r,state:a}=this,c=e.length;for(let o=0;o<c;){const i=Math.min(r-this.pos,c-o);for(let n=0;n<i;n++)a[this.pos++]^=e[o++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:a,blockLen:c}=this;e[a]^=r,(r&128)!==0&&a===c-1&&this.keccak(),e[c-1]^=128,this.keccak()}writeInto(e){Ht(this,!1),de(e),this.finish();const r=this.state,{blockLen:a}=this;for(let c=0,o=e.length;c<o;){this.posOut>=a&&this.keccak();const i=Math.min(a-this.posOut,o-c);e.set(r.subarray(this.posOut,this.posOut+i),c),this.posOut+=i,c+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return dt(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(yn(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ut(this.state)}_cloneInto(e){const{blockLen:r,suffix:a,outputLen:c,rounds:o,enableXOF:i}=this;return e||=new gn(r,a,c,i,o),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=a,e.outputLen=c,e.enableXOF=i,e.destroyed=this.destroyed,e}}const $f=(t,e,r,a={})=>nr(()=>new gn(e,t,r),a),zf=$f(6,136,32,Vr(8)),Yf=(t,e,r,a={})=>nr((c={})=>new gn(e,t,c.dkLen===void 0?r:c.dkLen,!0),a),Qf=Yf(31,136,32,Vr(12));const Va=BigInt(0),wa=BigInt(1);function ur(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}" `;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function Ms(t){if(typeof t=="bigint"){if(!on(t))throw new Error("positive bigint expected, got "+t)}else dt(t);return t}function Qr(t){const e=Ms(t).toString(16);return e.length&1?"0"+e:e}function Hs(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Va:BigInt("0x"+t)}function vn(t){return Hs(Kr(t))}function kr(t){return Hs(Kr(Ta(de(t)).reverse()))}function Fa(t,e){dt(e),t=Ms(t);const r=Lr(t.toString(16).padStart(e*2,"0"));if(r.length!==e)throw new Error("number too large");return r}function qs(t,e){return Fa(t,e).reverse()}function Ta(t){return Uint8Array.from(t)}function Xf(t){return Uint8Array.from(t,(e,r)=>{const a=e.charCodeAt(0);if(e.length!==1||a>127)throw new Error(`string contains non-ASCII character "${t[r]}" with code ${a} at position ${r}`);return a})}const on=t=>typeof t=="bigint"&&Va<=t;function jf(t,e,r){return on(t)&&on(e)&&on(r)&&e<=t&&t<r}function Aa(t,e,r,a){if(!jf(e,r,a))throw new Error("expected valid "+t+": "+r+" <= n < "+a+", got "+e)}function Zf(t){let e;for(e=0;t>Va;t>>=wa,e+=1);return e}const Ma=t=>(wa<<BigInt(t))-wa;function Wf(t,e,r){if(dt(t,"hashLen"),dt(e,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");const a=S=>new Uint8Array(S),c=Uint8Array.of(),o=Uint8Array.of(0),i=Uint8Array.of(1),n=1e3;let u=a(t),h=a(t),m=0;const B=()=>{u.fill(1),h.fill(0),m=0},v=(...S)=>r(h,Ct(u,...S)),d=(S=c)=>{h=v(o,S),u=v(),S.length!==0&&(h=v(i,S),u=v())},p=()=>{if(m++>=n)throw new Error("drbg: tried max amount of iterations");let S=0;const f=[];for(;S<e;){u=v();const g=u.slice();f.push(g),S+=u.length}return Ct(...f)};return(S,f)=>{B(),d(S);let g;for(;!(g=f(p()));)d();return B(),g}}function Fr(t,e={},r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function a(o,i,n){const u=t[o];if(n&&u===void 0)return;const h=typeof u;if(h!==i||u===null)throw new Error(`param "${o}" is invalid: expected ${i}, got ${h}`)}const c=(o,i)=>Object.entries(o).forEach(([n,u])=>a(n,u,i));c(e,!1),c(r,!0)}function cn(t){const e=new WeakMap;return(r,...a)=>{const c=e.get(r);if(c!==void 0)return c;const o=t(r,...a);return e.set(r,o),o}}const ct=BigInt(0),Je=BigInt(1),ir=BigInt(2),Gs=BigInt(3),$s=BigInt(4),zs=BigInt(5),Jf=BigInt(7),Ys=BigInt(8),ec=BigInt(9),Qs=BigInt(16);function Se(t,e){const r=t%e;return r>=ct?r:e+r}function me(t,e,r){let a=t;for(;e-- >ct;)a*=a,a%=r;return a}function ui(t,e){if(t===ct)throw new Error("invert: expected non-zero number");if(e<=ct)throw new Error("invert: expected positive modulus, got "+e);let r=Se(t,e),a=e,c=ct,o=Je;for(;r!==ct;){const n=a/r,u=a%r,h=c-o*n;a=r,r=u,c=o,o=h}if(a!==Je)throw new Error("invert: does not exist");return Se(c,e)}function Ha(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function Xs(t,e){const r=(t.ORDER+Je)/$s,a=t.pow(e,r);return Ha(t,a,e),a}function tc(t,e){const r=(t.ORDER-zs)/Ys,a=t.mul(e,ir),c=t.pow(a,r),o=t.mul(e,c),i=t.mul(t.mul(o,ir),c),n=t.mul(o,t.sub(i,t.ONE));return Ha(t,n,e),n}function rc(t){const e=lr(t),r=js(t),a=r(e,e.neg(e.ONE)),c=r(e,a),o=r(e,e.neg(a)),i=(t+Jf)/Qs;return(n,u)=>{let h=n.pow(u,i),m=n.mul(h,a);const B=n.mul(h,c),v=n.mul(h,o),d=n.eql(n.sqr(m),u),p=n.eql(n.sqr(B),u);h=n.cmov(h,m,d),m=n.cmov(v,B,p);const C=n.eql(n.sqr(m),u),S=n.cmov(h,m,C);return Ha(n,S,u),S}}function js(t){if(t<Gs)throw new Error("sqrt is not defined for small field");let e=t-Je,r=0;for(;e%ir===ct;)e/=ir,r++;let a=ir;const c=lr(t);for(;li(c,a)===1;)if(a++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Xs;let o=c.pow(a,e);const i=(e+Je)/ir;return function(u,h){if(u.is0(h))return h;if(li(u,h)!==1)throw new Error("Cannot find square root");let m=r,B=u.mul(u.ONE,o),v=u.pow(h,e),d=u.pow(h,i);for(;!u.eql(v,u.ONE);){if(u.is0(v))return u.ZERO;let p=1,C=u.sqr(v);for(;!u.eql(C,u.ONE);)if(p++,C=u.sqr(C),p===m)throw new Error("Cannot find square root");const S=Je<<BigInt(m-p-1),f=u.pow(B,S);m=p,B=u.sqr(f),v=u.mul(v,B),d=u.mul(d,f)}return d}}function nc(t){return t%$s===Gs?Xs:t%Ys===zs?tc:t%Qs===ec?rc(t):js(t)}const ac=(t,e)=>(Se(t,e)&Je)===Je,ic=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function sc(t){const e={ORDER:"bigint",BYTES:"number",BITS:"number"},r=ic.reduce((a,c)=>(a[c]="function",a),e);return Fr(t,r),t}function oc(t,e,r){if(r<ct)throw new Error("invalid exponent, negatives unsupported");if(r===ct)return t.ONE;if(r===Je)return e;let a=t.ONE,c=e;for(;r>ct;)r&Je&&(a=t.mul(a,c)),c=t.sqr(c),r>>=Je;return a}function Zs(t,e,r=!1){const a=new Array(e.length).fill(r?t.ZERO:void 0),c=e.reduce((i,n,u)=>t.is0(n)?i:(a[u]=i,t.mul(i,n)),t.ONE),o=t.inv(c);return e.reduceRight((i,n,u)=>t.is0(n)?i:(a[u]=t.mul(i,a[u]),t.mul(i,n)),o),a}function li(t,e){const r=(t.ORDER-Je)/ir,a=t.pow(e,r),c=t.eql(a,t.ONE),o=t.eql(a,t.ZERO),i=t.eql(a,t.neg(t.ONE));if(!c&&!o&&!i)throw new Error("invalid Legendre symbol result");return c?1:o?0:-1}function fc(t,e){e!==void 0&&dt(e);const r=e!==void 0?e:t.toString(2).length,a=Math.ceil(r/8);return{nBitLength:r,nByteLength:a}}class cc{ORDER;BITS;BYTES;isLE;ZERO=ct;ONE=Je;_lengths;_sqrt;_mod;constructor(e,r={}){if(e<=ct)throw new Error("invalid field: expected ORDER > 0, got "+e);let a;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(a=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));const{nBitLength:c,nByteLength:o}=fc(e,a);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=e,this.BITS=c,this.BYTES=o,this._sqrt=void 0,Object.preventExtensions(this)}create(e){return Se(e,this.ORDER)}isValid(e){if(typeof e!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof e);return ct<=e&&e<this.ORDER}is0(e){return e===ct}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}isOdd(e){return(e&Je)===Je}neg(e){return Se(-e,this.ORDER)}eql(e,r){return e===r}sqr(e){return Se(e*e,this.ORDER)}add(e,r){return Se(e+r,this.ORDER)}sub(e,r){return Se(e-r,this.ORDER)}mul(e,r){return Se(e*r,this.ORDER)}pow(e,r){return oc(this,e,r)}div(e,r){return Se(e*ui(r,this.ORDER),this.ORDER)}sqrN(e){return e*e}addN(e,r){return e+r}subN(e,r){return e-r}mulN(e,r){return e*r}inv(e){return ui(e,this.ORDER)}sqrt(e){return this._sqrt||(this._sqrt=nc(this.ORDER)),this._sqrt(this,e)}toBytes(e){return this.isLE?qs(e,this.BYTES):Fa(e,this.BYTES)}fromBytes(e,r=!1){de(e);const{_lengths:a,BYTES:c,isLE:o,ORDER:i,_mod:n}=this;if(a){if(!a.includes(e.length)||e.length>c)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);const h=new Uint8Array(c);h.set(e,o?0:h.length-e.length),e=h}if(e.length!==c)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+e.length);let u=o?kr(e):vn(e);if(n&&(u=Se(u,i)),!r&&!this.isValid(u))throw new Error("invalid field element: outside of range 0..ORDER");return u}invertBatch(e){return Zs(this,e)}cmov(e,r,a){return a?r:e}}function lr(t,e={}){return new cc(t,e)}function Ws(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Js(t){const e=Ws(t);return e+Math.ceil(e/2)}function uc(t,e,r=!1){de(t);const a=t.length,c=Ws(e),o=Js(e);if(a<16||a<o||a>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+a);const i=r?kr(t):vn(t),n=Se(i,e-Je)+Je;return r?qs(n,c):Fa(n,c)}const mr=BigInt(0),sr=BigInt(1);function un(t,e){const r=e.negate();return t?r:e}function Ir(t,e){const r=Zs(t.Fp,e.map(a=>a.Z));return e.map((a,c)=>t.fromAffine(a.toAffine(r[c])))}function eo(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Nn(t,e){eo(t,e);const r=Math.ceil(e/t)+1,a=2**(t-1),c=2**t,o=Ma(t),i=BigInt(t);return{windows:r,windowSize:a,mask:o,maxNumber:c,shiftBy:i}}function hi(t,e,r){const{windowSize:a,mask:c,maxNumber:o,shiftBy:i}=r;let n=Number(t&c),u=t>>i;n>a&&(n-=o,u+=sr);const h=e*a,m=h+Math.abs(n)-1,B=n===0,v=n<0,d=e%2!==0;return{nextN:u,offset:m,isZero:B,isNeg:v,isNegF:d,offsetF:h}}const Ln=new WeakMap,to=new WeakMap;function kn(t){return to.get(t)||1}function di(t){if(t!==mr)throw new Error("invalid wNAF")}class ro{BASE;ZERO;Fn;bits;constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,a=this.ZERO){let c=e;for(;r>mr;)r&sr&&(a=a.add(c)),c=c.double(),r>>=sr;return a}precomputeWindow(e,r){const{windows:a,windowSize:c}=Nn(r,this.bits),o=[];let i=e,n=i;for(let u=0;u<a;u++){n=i,o.push(n);for(let h=1;h<c;h++)n=n.add(i),o.push(n);i=n.double()}return o}wNAF(e,r,a){if(!this.Fn.isValid(a))throw new Error("invalid scalar");let c=this.ZERO,o=this.BASE;const i=Nn(e,this.bits);for(let n=0;n<i.windows;n++){const{nextN:u,offset:h,isZero:m,isNeg:B,isNegF:v,offsetF:d}=hi(a,n,i);a=u,m?o=o.add(un(v,r[d])):c=c.add(un(B,r[h]))}return di(a),{p:c,f:o}}wNAFUnsafe(e,r,a,c=this.ZERO){const o=Nn(e,this.bits);for(let i=0;i<o.windows&&a!==mr;i++){const{nextN:n,offset:u,isZero:h,isNeg:m}=hi(a,i,o);if(a=n,!h){const B=r[u];c=c.add(m?B.negate():B)}}return di(a),c}getPrecomputes(e,r,a){let c=Ln.get(r);return c||(c=this.precomputeWindow(r,e),e!==1&&(typeof a=="function"&&(c=a(c)),Ln.set(r,c))),c}cached(e,r,a){const c=kn(e);return this.wNAF(c,this.getPrecomputes(c,e,a),r)}unsafe(e,r,a,c){const o=kn(e);return o===1?this._unsafeLadder(e,r,c):this.wNAFUnsafe(o,this.getPrecomputes(o,e,a),r,c)}createCache(e,r){eo(r,this.bits),to.set(e,r),Ln.delete(e)}hasCache(e){return kn(e)!==1}}function lc(t,e,r,a){let c=e,o=t.ZERO,i=t.ZERO;for(;r>mr||a>mr;)r&sr&&(o=o.add(c)),a&sr&&(i=i.add(c)),c=c.double(),r>>=sr,a>>=sr;return{p1:o,p2:i}}function pi(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return sc(e),e}else return lr(t,{isLE:r})}function no(t,e,r={},a){if(a===void 0&&(a=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const u of["p","n","h"]){const h=e[u];if(!(typeof h=="bigint"&&h>mr))throw new Error(`CURVE.${u} must be positive bigint`)}const c=pi(e.p,r.Fp,a),o=pi(e.n,r.Fn,a),n=["Gx","Gy","a",t==="weierstrass"?"b":"d"];for(const u of n)if(!c.isValid(e[u]))throw new Error(`CURVE.${u} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:c,Fn:o}}function ao(t,e){return function(a){const c=t(a);return{secretKey:c,publicKey:e(c)}}}const zt=BigInt(0),Xe=BigInt(1),Un=BigInt(2),hc=BigInt(8);function dc(t,e,r,a){const c=t.sqr(r),o=t.sqr(a),i=t.add(t.mul(e.a,c),o),n=t.add(t.ONE,t.mul(e.d,t.mul(c,o)));return t.eql(i,n)}function io(t,e={}){const r=no("edwards",t,e,e.FpFnLE),{Fp:a,Fn:c}=r;let o=r.CURVE;const{h:i}=o;Fr(e,{},{uvRatio:"function"});const n=Un<<BigInt(c.BYTES*8)-Xe,u=S=>a.create(S),h=e.uvRatio||((S,f)=>{try{return{isValid:!0,value:a.sqrt(a.div(S,f))}}catch{return{isValid:!1,value:zt}}});if(!dc(a,o,o.Gx,o.Gy))throw new Error("bad curve params: generator point");function m(S,f,g=!1){const E=g?Xe:zt;return Aa("coordinate "+S,f,E,n),f}function B(S){if(!(S instanceof p))throw new Error("EdwardsPoint expected")}const v=cn((S,f)=>{const{X:g,Y:E,Z:T}=S,I=S.is0();f==null&&(f=I?hc:a.inv(T));const x=u(g*f),l=u(E*f),s=a.mul(T,f);if(I)return{x:zt,y:Xe};if(s!==Xe)throw new Error("invZ was invalid");return{x,y:l}}),d=cn(S=>{const{a:f,d:g}=o;if(S.is0())throw new Error("bad point: ZERO");const{X:E,Y:T,Z:I,T:x}=S,l=u(E*E),s=u(T*T),w=u(I*I),N=u(w*w),O=u(l*f),_=u(w*u(O+s)),D=u(N+u(g*u(l*s)));if(_!==D)throw new Error("bad point: equation left != right (1)");const V=u(E*T),P=u(I*x);if(V!==P)throw new Error("bad point: equation left != right (2)");return!0});class p{static BASE=new p(o.Gx,o.Gy,Xe,u(o.Gx*o.Gy));static ZERO=new p(zt,Xe,Xe,zt);static Fp=a;static Fn=c;X;Y;Z;T;constructor(f,g,E,T){this.X=m("x",f),this.Y=m("y",g),this.Z=m("z",E,!0),this.T=m("t",T),Object.freeze(this)}static CURVE(){return o}static fromAffine(f){if(f instanceof p)throw new Error("extended point not allowed");const{x:g,y:E}=f||{};return m("x",g),m("y",E),new p(g,E,Xe,u(g*E))}static fromBytes(f,g=!1){const E=a.BYTES,{a:T,d:I}=o;f=Ta(de(f,E,"point")),ur(g,"zip215");const x=Ta(f),l=f[E-1];x[E-1]=l&-129;const s=kr(x),w=g?n:a.ORDER;Aa("point.y",s,zt,w);const N=u(s*s),O=u(N-Xe),_=u(I*N-T);let{isValid:D,value:V}=h(O,_);if(!D)throw new Error("bad point: invalid y coordinate");const P=(V&Xe)===Xe,M=(l&128)!==0;if(!g&&V===zt&&M)throw new Error("bad point: x=0 and x_0=1");return M!==P&&(V=u(-V)),p.fromAffine({x:V,y:s})}static fromHex(f,g=!1){return p.fromBytes(Lr(f),g)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(f=8,g=!0){return C.createCache(this,f),g||this.multiply(Un),this}assertValidity(){d(this)}equals(f){B(f);const{X:g,Y:E,Z:T}=this,{X:I,Y:x,Z:l}=f,s=u(g*l),w=u(I*T),N=u(E*l),O=u(x*T);return s===w&&N===O}is0(){return this.equals(p.ZERO)}negate(){return new p(u(-this.X),this.Y,this.Z,u(-this.T))}double(){const{a:f}=o,{X:g,Y:E,Z:T}=this,I=u(g*g),x=u(E*E),l=u(Un*u(T*T)),s=u(f*I),w=g+E,N=u(u(w*w)-I-x),O=s+x,_=O-l,D=s-x,V=u(N*_),P=u(O*D),M=u(N*D),q=u(_*O);return new p(V,P,q,M)}add(f){B(f);const{a:g,d:E}=o,{X:T,Y:I,Z:x,T:l}=this,{X:s,Y:w,Z:N,T:O}=f,_=u(T*s),D=u(I*w),V=u(l*E*O),P=u(x*N),M=u((T+I)*(s+w)-_-D),q=P-V,z=P+V,G=u(D-g*_),Y=u(M*q),j=u(z*G),te=u(M*G),ue=u(q*z);return new p(Y,j,ue,te)}subtract(f){return this.add(f.negate())}multiply(f){if(!c.isValidNot0(f))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:g,f:E}=C.cached(this,f,T=>Ir(p,T));return Ir(p,[g,E])[0]}multiplyUnsafe(f,g=p.ZERO){if(!c.isValid(f))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return f===zt?p.ZERO:this.is0()||f===Xe?this:C.unsafe(this,f,E=>Ir(p,E),g)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return C.unsafe(this,o.n).is0()}toAffine(f){return v(this,f)}clearCofactor(){return i===Xe?this:this.multiplyUnsafe(i)}toBytes(){const{x:f,y:g}=this.toAffine(),E=a.toBytes(g);return E[E.length-1]|=f&Xe?128:0,E}toHex(){return Kr(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const C=new ro(p,c.BITS);return p.BASE.precompute(8),p}function so(t,e,r={}){if(typeof e!="function")throw new Error('"hash" function param is required');Fr(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:a}=r,{BASE:c,Fp:o,Fn:i}=t,n=r.randomBytes||Ka,u=r.adjustScalarBytes||(s=>s),h=r.domain||((s,w,N)=>{if(ur(N,"phflag"),w.length||N)throw new Error("Contexts/pre-hash are not supported");return s});function m(s){return i.create(kr(s))}function B(s){const w=E.secretKey;de(s,E.secretKey,"secretKey");const N=de(e(s),2*w,"hashedSecretKey"),O=u(N.slice(0,w)),_=N.slice(w,2*w),D=m(O);return{head:O,prefix:_,scalar:D}}function v(s){const{head:w,prefix:N,scalar:O}=B(s),_=c.multiply(O),D=_.toBytes();return{head:w,prefix:N,scalar:O,point:_,pointBytes:D}}function d(s){return v(s).pointBytes}function p(s=Uint8Array.of(),...w){const N=Ct(...w);return m(e(h(N,de(s,void 0,"context"),!!a)))}function C(s,w,N={}){s=de(s,void 0,"message"),a&&(s=a(s));const{prefix:O,scalar:_,pointBytes:D}=v(w),V=p(N.context,O,s),P=c.multiply(V).toBytes(),M=p(N.context,P,D,s),q=i.create(V+M*_);if(!i.isValid(q))throw new Error("sign failed: invalid s");const z=Ct(P,i.toBytes(q));return de(z,E.signature,"result")}const S={zip215:!0};function f(s,w,N,O=S){const{context:_,zip215:D}=O,V=E.signature;s=de(s,V,"signature"),w=de(w,void 0,"message"),N=de(N,E.publicKey,"publicKey"),D!==void 0&&ur(D,"zip215"),a&&(w=a(w));const P=V/2,M=s.subarray(0,P),q=kr(s.subarray(P,V));let z,G,Y;try{z=t.fromBytes(N,D),G=t.fromBytes(M,D),Y=c.multiplyUnsafe(q)}catch{return!1}if(!D&&z.isSmallOrder())return!1;const j=p(_,G.toBytes(),z.toBytes(),w);return G.add(z.multiplyUnsafe(j)).subtract(Y).clearCofactor().is0()}const g=o.BYTES,E={secretKey:g,publicKey:g,signature:2*g,seed:g};function T(s=n(E.seed)){return de(s,E.seed,"seed")}function I(s){return pn(s)&&s.length===i.BYTES}function x(s,w){try{return!!t.fromBytes(s,w)}catch{return!1}}const l={getExtendedPublicKey:v,randomSecretKey:T,isValidSecretKey:I,isValidPublicKey:x,toMontgomery(s){const{y:w}=t.fromBytes(s),N=E.publicKey,O=N===32;if(!O&&N!==57)throw new Error("only defined for 25519 and 448");const _=O?o.div(Xe+w,Xe-w):o.div(w-Xe,w+Xe);return o.toBytes(_)},toMontgomerySecret(s){const w=E.secretKey;de(s,w);const N=e(s.subarray(0,w));return u(N).subarray(0,w)}};return Object.freeze({keygen:ao(T,d),getPublicKey:d,sign:C,verify:f,utils:l,Point:t,lengths:E})}const mn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),oo={p:mn,n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},pc=nr(()=>Qf.create({dkLen:114})),yc=BigInt(1),yi=BigInt(2),gi=BigInt(3),gc=BigInt(11),vc=BigInt(22),vi=BigInt(44),mc=BigInt(88),Ec=BigInt(223);function xc(t){const e=mn,r=t*t*t%e,a=r*r*t%e,c=me(a,gi,e)*a%e,o=me(c,gi,e)*a%e,i=me(o,yi,e)*r%e,n=me(i,gc,e)*i%e,u=me(n,vc,e)*n%e,h=me(u,vi,e)*u%e,m=me(h,mc,e)*h%e,B=me(m,vi,e)*u%e,v=me(B,yi,e)*r%e,d=me(v,yc,e)*t%e;return me(d,Ec,e)*v%e}function Sc(t){return t[0]&=252,t[55]|=128,t[56]=0,t}function Cc(t,e){const r=mn,a=Se(t*t*e,r),c=Se(a*t,r),o=Se(c*a*e,r),i=xc(o),n=Se(c*i,r),u=Se(n*n,r);return{isValid:Se(u*e,r)===t,value:n}}const bc=lr(mn,{BITS:456,isLE:!0}),Bc=lr(oo.n,{BITS:456,isLE:!0});function wc(t,e,r){if(e.length>255)throw new Error("context must be smaller than 255, got: "+e.length);return Ct(Xf("SigEd448"),new Uint8Array([r?1:0,e.length]),e,t)}const Tc=io(oo,{Fp:bc,Fn:Bc,uvRatio:Cc});function Ac(t){return so(Tc,pc,Object.assign({adjustScalarBytes:Sc,domain:wc},t))}const Ic=Ac({});function _c(t,e,r){return t&e^~t&r}function Rc(t,e,r){return t&e^t&r^e&r}class fo{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(e,r,a,c){this.blockLen=e,this.outputLen=r,this.padOffset=a,this.isLE=c,this.buffer=new Uint8Array(e),this.view=Rn(this.buffer)}update(e){Ht(this),de(e);const{view:r,buffer:a,blockLen:c}=this,o=e.length;for(let i=0;i<o;){const n=Math.min(c-this.pos,o-i);if(n===c){const u=Rn(e);for(;c<=o-i;i+=c)this.process(u,i);continue}a.set(e.subarray(i,i+n),this.pos),this.pos+=n,i+=n,this.pos===c&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ht(this),yn(e,this),this.finished=!0;const{buffer:r,view:a,blockLen:c,isLE:o}=this;let{pos:i}=this;r[i++]=128,ut(this.buffer.subarray(i)),this.padOffset>c-i&&(this.process(a,0),i=0);for(let B=i;B<c;B++)r[B]=0;a.setBigUint64(c-8,BigInt(this.length*8),o),this.process(a,0);const n=Rn(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const h=u/4,m=this.get();if(h>m.length)throw new Error("_sha2: outputLen bigger than state");for(let B=0;B<h;B++)n.setUint32(4*B,m[B],o)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}_cloneInto(e){e||=new this.constructor,e.set(...this.get());const{blockLen:r,buffer:a,length:c,finished:o,destroyed:i,pos:n}=this;return e.destroyed=i,e.finished=o,e.length=c,e.pos=n,c%r&&e.buffer.set(a),e}clone(){return this._cloneInto()}}const Vt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),rt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Nc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Yt=new Uint32Array(64);class Lc extends fo{constructor(e){super(64,e,8,!1)}get(){const{A:e,B:r,C:a,D:c,E:o,F:i,G:n,H:u}=this;return[e,r,a,c,o,i,n,u]}set(e,r,a,c,o,i,n,u){this.A=e|0,this.B=r|0,this.C=a|0,this.D=c|0,this.E=o|0,this.F=i|0,this.G=n|0,this.H=u|0}process(e,r){for(let B=0;B<16;B++,r+=4)Yt[B]=e.getUint32(r,!1);for(let B=16;B<64;B++){const v=Yt[B-15],d=Yt[B-2],p=ft(v,7)^ft(v,18)^v>>>3,C=ft(d,17)^ft(d,19)^d>>>10;Yt[B]=C+Yt[B-7]+p+Yt[B-16]|0}let{A:a,B:c,C:o,D:i,E:n,F:u,G:h,H:m}=this;for(let B=0;B<64;B++){const v=ft(n,6)^ft(n,11)^ft(n,25),d=m+v+_c(n,u,h)+Nc[B]+Yt[B]|0,C=(ft(a,2)^ft(a,13)^ft(a,22))+Rc(a,c,o)|0;m=h,h=u,u=n,n=i+d|0,i=o,o=c,c=a,a=d+C|0}a=a+this.A|0,c=c+this.B|0,o=o+this.C|0,i=i+this.D|0,n=n+this.E|0,u=u+this.F|0,h=h+this.G|0,m=m+this.H|0,this.set(a,c,o,i,n,u,h,m)}roundClean(){ut(Yt)}destroy(){this.set(0,0,0,0,0,0,0,0),ut(this.buffer)}}class kc extends Lc{A=Vt[0]|0;B=Vt[1]|0;C=Vt[2]|0;D=Vt[3]|0;E=Vt[4]|0;F=Vt[5]|0;G=Vt[6]|0;H=Vt[7]|0;constructor(){super(32)}}const co=Ls(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Uc=co[0],Dc=co[1],Qt=new Uint32Array(80),Xt=new Uint32Array(80);class uo extends fo{constructor(e){super(128,e,16,!1)}get(){const{Ah:e,Al:r,Bh:a,Bl:c,Ch:o,Cl:i,Dh:n,Dl:u,Eh:h,El:m,Fh:B,Fl:v,Gh:d,Gl:p,Hh:C,Hl:S}=this;return[e,r,a,c,o,i,n,u,h,m,B,v,d,p,C,S]}set(e,r,a,c,o,i,n,u,h,m,B,v,d,p,C,S){this.Ah=e|0,this.Al=r|0,this.Bh=a|0,this.Bl=c|0,this.Ch=o|0,this.Cl=i|0,this.Dh=n|0,this.Dl=u|0,this.Eh=h|0,this.El=m|0,this.Fh=B|0,this.Fl=v|0,this.Gh=d|0,this.Gl=p|0,this.Hh=C|0,this.Hl=S|0}process(e,r){for(let E=0;E<16;E++,r+=4)Qt[E]=e.getUint32(r),Xt[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const T=Qt[E-15]|0,I=Xt[E-15]|0,x=er(T,I,1)^er(T,I,8)^ii(T,I,7),l=tr(T,I,1)^tr(T,I,8)^si(T,I,7),s=Qt[E-2]|0,w=Xt[E-2]|0,N=er(s,w,19)^wr(s,w,61)^ii(s,w,6),O=tr(s,w,19)^Tr(s,w,61)^si(s,w,6),_=Rf(l,O,Xt[E-7],Xt[E-16]),D=Nf(_,x,N,Qt[E-7],Qt[E-16]);Qt[E]=D|0,Xt[E]=_|0}let{Ah:a,Al:c,Bh:o,Bl:i,Ch:n,Cl:u,Dh:h,Dl:m,Eh:B,El:v,Fh:d,Fl:p,Gh:C,Gl:S,Hh:f,Hl:g}=this;for(let E=0;E<80;E++){const T=er(B,v,14)^er(B,v,18)^wr(B,v,41),I=tr(B,v,14)^tr(B,v,18)^Tr(B,v,41),x=B&d^~B&C,l=v&p^~v&S,s=Lf(g,I,l,Dc[E],Xt[E]),w=kf(s,f,T,x,Uc[E],Qt[E]),N=s|0,O=er(a,c,28)^wr(a,c,34)^wr(a,c,39),_=tr(a,c,28)^Tr(a,c,34)^Tr(a,c,39),D=a&o^a&n^o&n,V=c&i^c&u^i&u;f=C|0,g=S|0,C=d|0,S=p|0,d=B|0,p=v|0,{h:B,l:v}=St(h|0,m|0,w|0,N|0),h=n|0,m=u|0,n=o|0,u=i|0,o=a|0,i=c|0;const P=Pa(N,_,V);a=Oa(P,w,O,D),c=P|0}({h:a,l:c}=St(this.Ah|0,this.Al|0,a|0,c|0)),{h:o,l:i}=St(this.Bh|0,this.Bl|0,o|0,i|0),{h:n,l:u}=St(this.Ch|0,this.Cl|0,n|0,u|0),{h,l:m}=St(this.Dh|0,this.Dl|0,h|0,m|0),{h:B,l:v}=St(this.Eh|0,this.El|0,B|0,v|0),{h:d,l:p}=St(this.Fh|0,this.Fl|0,d|0,p|0),{h:C,l:S}=St(this.Gh|0,this.Gl|0,C|0,S|0),{h:f,l:g}=St(this.Hh|0,this.Hl|0,f|0,g|0),this.set(a,c,o,i,n,u,h,m,B,v,d,p,C,S,f,g)}roundClean(){ut(Qt,Xt)}destroy(){ut(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Pc extends uo{Ah=rt[0]|0;Al=rt[1]|0;Bh=rt[2]|0;Bl=rt[3]|0;Ch=rt[4]|0;Cl=rt[5]|0;Dh=rt[6]|0;Dl=rt[7]|0;Eh=rt[8]|0;El=rt[9]|0;Fh=rt[10]|0;Fl=rt[11]|0;Gh=rt[12]|0;Gl=rt[13]|0;Hh=rt[14]|0;Hl=rt[15]|0;constructor(){super(64)}}class Oc extends uo{Ah=tt[0]|0;Al=tt[1]|0;Bh=tt[2]|0;Bl=tt[3]|0;Ch=tt[4]|0;Cl=tt[5]|0;Dh=tt[6]|0;Dl=tt[7]|0;Eh=tt[8]|0;El=tt[9]|0;Fh=tt[10]|0;Fl=tt[11]|0;Gh=tt[12]|0;Gl=tt[13]|0;Hh=tt[14]|0;Hl=tt[15]|0;constructor(){super(48)}}const lo=nr(()=>new kc,Vr(1)),ho=nr(()=>new Pc,Vr(3)),Kc=nr(()=>new Oc,Vr(2));const Vc=BigInt(1),mi=BigInt(2),Fc=BigInt(5),Mc=BigInt(8),qa=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Hc={p:qa,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Mc,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function qc(t){const e=BigInt(10),r=BigInt(20),a=BigInt(40),c=BigInt(80),o=qa,n=t*t%o*t%o,u=me(n,mi,o)*n%o,h=me(u,Vc,o)*t%o,m=me(h,Fc,o)*h%o,B=me(m,e,o)*m%o,v=me(B,r,o)*B%o,d=me(v,a,o)*v%o,p=me(d,c,o)*d%o,C=me(p,c,o)*d%o,S=me(C,e,o)*m%o;return{pow_p_5_8:me(S,mi,o)*t%o,b2:n}}function Gc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Ei=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function $c(t,e){const r=qa,a=Se(e*e*e,r),c=Se(a*a*e,r),o=qc(t*c).pow_p_5_8;let i=Se(t*a*o,r);const n=Se(e*i*i,r),u=i,h=Se(i*Ei,r),m=n===t,B=n===Se(-t,r),v=n===Se(-t*Ei,r);return m&&(i=u),(B||v)&&(i=h),ac(i,r)&&(i=Se(-i,r)),{isValid:m||B,value:i}}const zc=io(Hc,{uvRatio:$c});function Yc(t){return so(zc,ho,Object.assign({adjustScalarBytes:Gc},t))}const Qc=Yc({});class po{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(e,r){if(ks(e),de(r,void 0,"key"),this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,c=new Uint8Array(a);c.set(r.length>a?e.create().update(r).digest():r);for(let o=0;o<c.length;o++)c[o]^=54;this.iHash.update(c),this.oHash=e.create();for(let o=0;o<c.length;o++)c[o]^=106;this.oHash.update(c),ut(c)}update(e){return Ht(this),this.iHash.update(e),this}digestInto(e){Ht(this),de(e,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:a,finished:c,destroyed:o,blockLen:i,outputLen:n}=this;return e=e,e.finished=c,e.destroyed=o,e.blockLen=i,e.outputLen=n,e.oHash=r._cloneInto(e.oHash),e.iHash=a._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const yo=(t,e,r)=>new po(t,e).update(r).digest();yo.create=(t,e)=>new po(t,e);const xi=(t,e)=>(t+(t>=0?e:-e)/go)/e;function Xc(t,e,r){const[[a,c],[o,i]]=e,n=xi(i*t,r),u=xi(-c*t,r);let h=t-n*a-u*o,m=-n*c-u*i;const B=h<Mt,v=m<Mt;B&&(h=-h),v&&(m=-m);const d=Ma(Math.ceil(Zf(r)/2))+vr;if(h<Mt||h>=d||m<Mt||m>=d)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:B,k1:h,k2neg:v,k2:m}}function Ia(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Dn(t,e){const r={};for(let a of Object.keys(e))r[a]=t[a]===void 0?e[a]:t[a];return ur(r.lowS,"lowS"),ur(r.prehash,"prehash"),r.format!==void 0&&Ia(r.format),r}class jc extends Error{constructor(e=""){super(e)}}const rr={Err:jc,_tlv:{encode:(t,e)=>{const{Err:r}=rr;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const a=e.length/2,c=Qr(a);if(c.length/2&128)throw new r("tlv.encode: long form length too big");const o=a>127?Qr(c.length/2|128):"";return Qr(t)+o+c+e},decode(t,e){const{Err:r}=rr;let a=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[a++]!==t)throw new r("tlv.decode: wrong tlv");const c=e[a++],o=!!(c&128);let i=0;if(!o)i=c;else{const u=c&127;if(!u)throw new r("tlv.decode(long): indefinite length not supported");if(u>4)throw new r("tlv.decode(long): byte length is too big");const h=e.subarray(a,a+u);if(h.length!==u)throw new r("tlv.decode: length bytes not complete");if(h[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const m of h)i=i<<8|m;if(a+=u,i<128)throw new r("tlv.decode(long): not minimal encoding")}const n=e.subarray(a,a+i);if(n.length!==i)throw new r("tlv.decode: wrong value length");return{v:n,l:e.subarray(a+i)}}},_int:{encode(t){const{Err:e}=rr;if(t<Mt)throw new e("integer: negative integers are not allowed");let r=Qr(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=rr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return vn(t)}},toSig(t){const{Err:e,_int:r,_tlv:a}=rr,c=de(t,void 0,"signature"),{v:o,l:i}=a.decode(48,c);if(i.length)throw new e("invalid signature: left bytes after parsing");const{v:n,l:u}=a.decode(2,o),{v:h,l:m}=a.decode(2,u);if(m.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(n),s:r.decode(h)}},hexFromSig(t){const{_tlv:e,_int:r}=rr,a=e.encode(2,r.encode(t.r)),c=e.encode(2,r.encode(t.s)),o=a+c;return e.encode(48,o)}},Mt=BigInt(0),vr=BigInt(1),go=BigInt(2),Xr=BigInt(3),Zc=BigInt(4);function En(t,e={}){const r=no("weierstrass",t,e),{Fp:a,Fn:c}=r;let o=r.CURVE;const{h:i,n}=o;Fr(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});const{endo:u}=e;if(u&&(!a.is0(o.a)||typeof u.beta!="bigint"||!Array.isArray(u.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const h=mo(a,c);function m(){if(!a.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function B(_,D,V){const{x:P,y:M}=D.toAffine(),q=a.toBytes(P);if(ur(V,"isCompressed"),V){m();const z=!a.isOdd(M);return Ct(vo(z),q)}else return Ct(Uint8Array.of(4),q,a.toBytes(M))}function v(_){de(_,void 0,"Point");const{publicKey:D,publicKeyUncompressed:V}=h,P=_.length,M=_[0],q=_.subarray(1);if(P===D&&(M===2||M===3)){const z=a.fromBytes(q);if(!a.isValid(z))throw new Error("bad point: is not on curve, wrong x");const G=C(z);let Y;try{Y=a.sqrt(G)}catch(ue){const X=ue instanceof Error?": "+ue.message:"";throw new Error("bad point: is not on curve, sqrt error"+X)}m();const j=a.isOdd(Y);return(M&1)===1!==j&&(Y=a.neg(Y)),{x:z,y:Y}}else if(P===V&&M===4){const z=a.BYTES,G=a.fromBytes(q.subarray(0,z)),Y=a.fromBytes(q.subarray(z,z*2));if(!S(G,Y))throw new Error("bad point: is not on curve");return{x:G,y:Y}}else throw new Error(`bad point: got length ${P}, expected compressed=${D} or uncompressed=${V}`)}const d=e.toBytes||B,p=e.fromBytes||v;function C(_){const D=a.sqr(_),V=a.mul(D,_);return a.add(a.add(V,a.mul(_,o.a)),o.b)}function S(_,D){const V=a.sqr(D),P=C(_);return a.eql(V,P)}if(!S(o.Gx,o.Gy))throw new Error("bad curve params: generator point");const f=a.mul(a.pow(o.a,Xr),Zc),g=a.mul(a.sqr(o.b),BigInt(27));if(a.is0(a.add(f,g)))throw new Error("bad curve params: a or b");function E(_,D,V=!1){if(!a.isValid(D)||V&&a.is0(D))throw new Error(`bad point coordinate ${_}`);return D}function T(_){if(!(_ instanceof w))throw new Error("Weierstrass Point expected")}function I(_){if(!u||!u.basises)throw new Error("no endo");return Xc(_,u.basises,c.ORDER)}const x=cn((_,D)=>{const{X:V,Y:P,Z:M}=_;if(a.eql(M,a.ONE))return{x:V,y:P};const q=_.is0();D==null&&(D=q?a.ONE:a.inv(M));const z=a.mul(V,D),G=a.mul(P,D),Y=a.mul(M,D);if(q)return{x:a.ZERO,y:a.ZERO};if(!a.eql(Y,a.ONE))throw new Error("invZ was invalid");return{x:z,y:G}}),l=cn(_=>{if(_.is0()){if(e.allowInfinityPoint&&!a.is0(_.Y))return;throw new Error("bad point: ZERO")}const{x:D,y:V}=_.toAffine();if(!a.isValid(D)||!a.isValid(V))throw new Error("bad point: x or y not field elements");if(!S(D,V))throw new Error("bad point: equation left != right");if(!_.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function s(_,D,V,P,M){return V=new w(a.mul(V.X,_),V.Y,V.Z),D=un(P,D),V=un(M,V),D.add(V)}class w{static BASE=new w(o.Gx,o.Gy,a.ONE);static ZERO=new w(a.ZERO,a.ONE,a.ZERO);static Fp=a;static Fn=c;X;Y;Z;constructor(D,V,P){this.X=E("x",D),this.Y=E("y",V,!0),this.Z=E("z",P),Object.freeze(this)}static CURVE(){return o}static fromAffine(D){const{x:V,y:P}=D||{};if(!D||!a.isValid(V)||!a.isValid(P))throw new Error("invalid affine point");if(D instanceof w)throw new Error("projective point not allowed");return a.is0(V)&&a.is0(P)?w.ZERO:new w(V,P,a.ONE)}static fromBytes(D){const V=w.fromAffine(p(de(D,void 0,"point")));return V.assertValidity(),V}static fromHex(D){return w.fromBytes(Lr(D))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(D=8,V=!0){return O.createCache(this,D),V||this.multiply(Xr),this}assertValidity(){l(this)}hasEvenY(){const{y:D}=this.toAffine();if(!a.isOdd)throw new Error("Field doesn't support isOdd");return!a.isOdd(D)}equals(D){T(D);const{X:V,Y:P,Z:M}=this,{X:q,Y:z,Z:G}=D,Y=a.eql(a.mul(V,G),a.mul(q,M)),j=a.eql(a.mul(P,G),a.mul(z,M));return Y&&j}negate(){return new w(this.X,a.neg(this.Y),this.Z)}double(){const{a:D,b:V}=o,P=a.mul(V,Xr),{X:M,Y:q,Z:z}=this;let G=a.ZERO,Y=a.ZERO,j=a.ZERO,te=a.mul(M,M),ue=a.mul(q,q),X=a.mul(z,z),re=a.mul(M,q);return re=a.add(re,re),j=a.mul(M,z),j=a.add(j,j),G=a.mul(D,j),Y=a.mul(P,X),Y=a.add(G,Y),G=a.sub(ue,Y),Y=a.add(ue,Y),Y=a.mul(G,Y),G=a.mul(re,G),j=a.mul(P,j),X=a.mul(D,X),re=a.sub(te,X),re=a.mul(D,re),re=a.add(re,j),j=a.add(te,te),te=a.add(j,te),te=a.add(te,X),te=a.mul(te,re),Y=a.add(Y,te),X=a.mul(q,z),X=a.add(X,X),te=a.mul(X,re),G=a.sub(G,te),j=a.mul(X,ue),j=a.add(j,j),j=a.add(j,j),new w(G,Y,j)}add(D){T(D);const{X:V,Y:P,Z:M}=this,{X:q,Y:z,Z:G}=D;let Y=a.ZERO,j=a.ZERO,te=a.ZERO;const ue=o.a,X=a.mul(o.b,Xr);let re=a.mul(V,q),W=a.mul(P,z),pe=a.mul(M,G),le=a.add(V,P),b=a.add(q,z);le=a.mul(le,b),b=a.add(re,W),le=a.sub(le,b),b=a.add(V,M);let U=a.add(q,G);return b=a.mul(b,U),U=a.add(re,pe),b=a.sub(b,U),U=a.add(P,M),Y=a.add(z,G),U=a.mul(U,Y),Y=a.add(W,pe),U=a.sub(U,Y),te=a.mul(ue,b),Y=a.mul(X,pe),te=a.add(Y,te),Y=a.sub(W,te),te=a.add(W,te),j=a.mul(Y,te),W=a.add(re,re),W=a.add(W,re),pe=a.mul(ue,pe),b=a.mul(X,b),W=a.add(W,pe),pe=a.sub(re,pe),pe=a.mul(ue,pe),b=a.add(b,pe),re=a.mul(W,b),j=a.add(j,re),re=a.mul(U,b),Y=a.mul(le,Y),Y=a.sub(Y,re),re=a.mul(le,W),te=a.mul(U,te),te=a.add(te,re),new w(Y,j,te)}subtract(D){return this.add(D.negate())}is0(){return this.equals(w.ZERO)}multiply(D){const{endo:V}=e;if(!c.isValidNot0(D))throw new Error("invalid scalar: out of range");let P,M;const q=z=>O.cached(this,z,G=>Ir(w,G));if(V){const{k1neg:z,k1:G,k2neg:Y,k2:j}=I(D),{p:te,f:ue}=q(G),{p:X,f:re}=q(j);M=ue.add(re),P=s(V.beta,te,X,z,Y)}else{const{p:z,f:G}=q(D);P=z,M=G}return Ir(w,[P,M])[0]}multiplyUnsafe(D){const{endo:V}=e,P=this;if(!c.isValid(D))throw new Error("invalid scalar: out of range");if(D===Mt||P.is0())return w.ZERO;if(D===vr)return P;if(O.hasCache(this))return this.multiply(D);if(V){const{k1neg:M,k1:q,k2neg:z,k2:G}=I(D),{p1:Y,p2:j}=lc(w,P,q,G);return s(V.beta,Y,j,M,z)}else return O.unsafe(P,D)}toAffine(D){return x(this,D)}isTorsionFree(){const{isTorsionFree:D}=e;return i===vr?!0:D?D(w,this):O.unsafe(this,n).is0()}clearCofactor(){const{clearCofactor:D}=e;return i===vr?this:D?D(w,this):this.multiplyUnsafe(i)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}toBytes(D=!0){return ur(D,"isCompressed"),this.assertValidity(),d(w,this,D)}toHex(D=!0){return Kr(this.toBytes(D))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const N=c.BITS,O=new ro(w,e.endo?Math.ceil(N/2):N);return w.BASE.precompute(8),w}function vo(t){return Uint8Array.of(t?2:3)}function mo(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function Wc(t,e={}){const{Fn:r}=t,a=e.randomBytes||Ka,c=Object.assign(mo(t.Fp,r),{seed:Js(r.ORDER)});function o(d){try{const p=r.fromBytes(d);return r.isValidNot0(p)}catch{return!1}}function i(d,p){const{publicKey:C,publicKeyUncompressed:S}=c;try{const f=d.length;return p===!0&&f!==C||p===!1&&f!==S?!1:!!t.fromBytes(d)}catch{return!1}}function n(d=a(c.seed)){return uc(de(d,c.seed,"seed"),r.ORDER)}function u(d,p=!0){return t.BASE.multiply(r.fromBytes(d)).toBytes(p)}function h(d){const{secretKey:p,publicKey:C,publicKeyUncompressed:S}=c;if(!pn(d)||"_lengths"in r&&r._lengths||p===C)return;const f=de(d,void 0,"key").length;return f===C||f===S}function m(d,p,C=!0){if(h(d)===!0)throw new Error("first arg must be private key");if(h(p)===!1)throw new Error("second arg must be public key");const S=r.fromBytes(d);return t.fromBytes(p).multiply(S).toBytes(C)}const B={isValidSecretKey:o,isValidPublicKey:i,randomSecretKey:n},v=ao(n,u);return Object.freeze({getPublicKey:u,getSharedSecret:m,keygen:v,Point:t,utils:B,lengths:c})}function xn(t,e,r={}){ks(e),Fr(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);const a=r.randomBytes||Ka,c=r.hmac||((V,P)=>yo(e,V,P)),{Fp:o,Fn:i}=t,{ORDER:n,BITS:u}=i,{keygen:h,getPublicKey:m,getSharedSecret:B,utils:v,lengths:d}=Wc(t,r),p={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},C=n*go<o.ORDER;function S(V){const P=n>>vr;return V>P}function f(V,P){if(!i.isValidNot0(P))throw new Error(`invalid signature ${V}: out of range 1..Point.Fn.ORDER`);return P}function g(){if(C)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function E(V,P){Ia(P);const M=d.signature,q=P==="compact"?M:P==="recovered"?M+1:void 0;return de(V,q)}class T{r;s;recovery;constructor(P,M,q){if(this.r=f("r",P),this.s=f("s",M),q!=null){if(g(),![0,1,2,3].includes(q))throw new Error("invalid recovery id");this.recovery=q}Object.freeze(this)}static fromBytes(P,M=p.format){E(P,M);let q;if(M==="der"){const{r:j,s:te}=rr.toSig(de(P));return new T(j,te)}M==="recovered"&&(q=P[0],M="compact",P=P.subarray(1));const z=d.signature/2,G=P.subarray(0,z),Y=P.subarray(z,z*2);return new T(i.fromBytes(G),i.fromBytes(Y),q)}static fromHex(P,M){return this.fromBytes(Lr(P),M)}assertRecovery(){const{recovery:P}=this;if(P==null)throw new Error("invalid recovery id: must be present");return P}addRecoveryBit(P){return new T(this.r,this.s,P)}recoverPublicKey(P){const{r:M,s:q}=this,z=this.assertRecovery(),G=z===2||z===3?M+n:M;if(!o.isValid(G))throw new Error("invalid recovery id: sig.r+curve.n != R.x");const Y=o.toBytes(G),j=t.fromBytes(Ct(vo((z&1)===0),Y)),te=i.inv(G),ue=x(de(P,void 0,"msgHash")),X=i.create(-ue*te),re=i.create(q*te),W=t.BASE.multiplyUnsafe(X).add(j.multiplyUnsafe(re));if(W.is0())throw new Error("invalid recovery: point at infinify");return W.assertValidity(),W}hasHighS(){return S(this.s)}toBytes(P=p.format){if(Ia(P),P==="der")return Lr(rr.hexFromSig(this));const{r:M,s:q}=this,z=i.toBytes(M),G=i.toBytes(q);return P==="recovered"?(g(),Ct(Uint8Array.of(this.assertRecovery()),z,G)):Ct(z,G)}toHex(P){return Kr(this.toBytes(P))}}const I=r.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const M=vn(P),q=P.length*8-u;return q>0?M>>BigInt(q):M},x=r.bits2int_modN||function(P){return i.create(I(P))},l=Ma(u);function s(V){return Aa("num < 2^"+u,V,Mt,l),i.toBytes(V)}function w(V,P){return de(V,void 0,"message"),P?de(e(V),void 0,"prehashed message"):V}function N(V,P,M){const{lowS:q,prehash:z,extraEntropy:G}=Dn(M,p);V=w(V,z);const Y=x(V),j=i.fromBytes(P);if(!i.isValidNot0(j))throw new Error("invalid private key");const te=[s(j),s(Y)];if(G!=null&&G!==!1){const W=G===!0?a(d.secretKey):G;te.push(de(W,void 0,"extraEntropy"))}const ue=Ct(...te),X=Y;function re(W){const pe=I(W);if(!i.isValidNot0(pe))return;const le=i.inv(pe),b=t.BASE.multiply(pe).toAffine(),U=i.create(b.x);if(U===Mt)return;const k=i.create(le*i.create(X+U*j));if(k===Mt)return;let y=(b.x===U?0:2)|Number(b.y&vr),R=k;return q&&S(k)&&(R=i.neg(k),y^=1),new T(U,R,C?void 0:y)}return{seed:ue,k2sig:re}}function O(V,P,M={}){const{seed:q,k2sig:z}=N(V,P,M);return Wf(e.outputLen,i.BYTES,c)(q,z).toBytes(M.format)}function _(V,P,M,q={}){const{lowS:z,prehash:G,format:Y}=Dn(q,p);if(M=de(M,void 0,"publicKey"),P=w(P,G),!pn(V)){const j=V instanceof T?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+j)}E(V,Y);try{const j=T.fromBytes(V,Y),te=t.fromBytes(M);if(z&&j.hasHighS())return!1;const{r:ue,s:X}=j,re=x(P),W=i.inv(X),pe=i.create(re*W),le=i.create(ue*W),b=t.BASE.multiplyUnsafe(pe).add(te.multiplyUnsafe(le));return b.is0()?!1:i.create(b.x)===ue}catch{return!1}}function D(V,P,M={}){const{prehash:q}=Dn(M,p);return P=w(P,q),T.fromBytes(V,"recovered").recoverPublicKey(P).toBytes()}return Object.freeze({keygen:h,getPublicKey:m,getSharedSecret:B,utils:v,lengths:d,Point:t,sign:O,verify:_,recoverPublicKey:D,Signature:T,hash:e})}const Jc={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},eu={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Eo={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},tu=En(Jc),ru=xn(tu,lo),nu=En(eu),au=xn(nu,Kc),iu=lr(Eo.n,{allowedLengths:[65,66]}),su=En(Eo,{Fn:iu}),ou=xn(su,ho);const Ga={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},fu={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Si=BigInt(2);function cu(t){const e=Ga.p,r=BigInt(3),a=BigInt(6),c=BigInt(11),o=BigInt(22),i=BigInt(23),n=BigInt(44),u=BigInt(88),h=t*t*t%e,m=h*h*t%e,B=me(m,r,e)*m%e,v=me(B,r,e)*m%e,d=me(v,Si,e)*h%e,p=me(d,c,e)*d%e,C=me(p,o,e)*p%e,S=me(C,n,e)*C%e,f=me(S,u,e)*S%e,g=me(f,n,e)*C%e,E=me(g,r,e)*m%e,T=me(E,i,e)*p%e,I=me(T,a,e)*h%e,x=me(I,Si,e);if(!_a.eql(_a.sqr(x),t))throw new Error("Cannot find square root");return x}const _a=lr(Ga.p,{sqrt:cu}),uu=En(Ga,{Fp:_a,endo:fu}),lu=xn(uu,lo);function At(t){return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}function Ur(t){const e=t.replace(/\s+/g,"");if(e.length%2!==0)throw new Error("Invalid hex string: length must be even");const r=new Uint8Array(e.length/2);for(let a=0;a<e.length;a+=2){const c=Number.parseInt(e.substring(a,a+2),16);if(Number.isNaN(c))throw new Error(`Invalid hex string: invalid character at position ${a}`);r[a/2]=c}return r}function hu(t){return t==="secp256k1"||t==="p256"||t==="p384"||t==="p521"}function Sn(t){switch(t){case"secp256k1":return lu;case"p256":return ru;case"p384":return au;case"p521":return ou;case"ed25519":return Qc;case"ed448":return Ic;default:throw new Error(`Unsupported curve: ${t}`)}}function du(t="secp256k1"){const e=Sn(t),r=e.utils.randomSecretKey(),a=e.getPublicKey(r);return{privateKey:At(r),publicKey:At(a),curve:t}}function xo(t,e,r="secp256k1"){try{const a=Sn(r),c=Ur(e);if(r==="ed25519"||r==="ed448"){const u=a.sign(t,c),h=u instanceof Uint8Array?u:new Uint8Array(u);return{signature:At(h)}}const o=a.sign(t,c),i=o instanceof Uint8Array?o:new Uint8Array(o),n=At(i);return r==="secp256k1"&&typeof o=="object"&&"recovery"in o?{signature:n,recoveryId:o.recovery}:{signature:n}}catch(a){throw new Error(`ECDSA signing failed: ${a instanceof Error?a.message:String(a)}`)}}function So(t,e,r,a="secp256k1"){try{const c=Sn(a),o=Ur(r),i=Ur(e);return c.verify(i,t,o)}catch(c){if(c instanceof Error&&c.message.includes("Invalid signature"))return!1;throw new Error(`ECDSA verification failed: ${c instanceof Error?c.message:String(c)}`)}}function pu(t,e,r="secp256k1"){try{const a=Sn(r),c=Ur(t),o=Ur(e);if(!hu(r))throw new Error(`ECDH is not supported for ${r}`);const n=a.getSharedSecret(c,o);return{sharedSecret:At(n)}}catch(a){throw new Error(`ECDH computation failed: ${a instanceof Error?a.message:String(a)}`)}}function yu(t,e,r="ed25519"){return xo(t,e,r)}function gu(t,e,r,a="ed25519"){return So(t,e,r,a)}let fr=null,Ci=!1;async function Mr(){if(!(Ci&&fr))try{const t=(await Ce(async()=>{const{default:e}=await import("./ibe_wasm-Drswr2Qh.js");return{default:e}},[],import.meta.url)).default;fr=await t({module_or_path:new URL(""+new URL("ibe_wasm_bg-C_JPAl-h.wasm",import.meta.url).href,import.meta.url).href}),fr.init(),Ci=!0}catch(t){throw new Error(`Failed to initialize IBE WebAssembly module: ${t}`)}}async function vu(){if(await Mr(),!fr)throw new Error("IBE module not initialized");const{IBE:t}=await Ce(async()=>{const{IBE:r}=await import("./ibe_wasm-Drswr2Qh.js");return{IBE:r}},[],import.meta.url),e=new t;try{const r=e.setup();if(r instanceof Error)throw r;const a=r.master_key,c=r.public_params;if(!a||!c)throw new Error("Failed to get master_key or public_params from setup result");return{masterKey:a,publicParams:c}}catch(r){throw new Error(`IBE setup failed: ${r}`)}}async function mu(t,e){if(await Mr(),!fr)throw new Error("IBE module not initialized");const{IBE:r}=await Ce(async()=>{const{IBE:c}=await import("./ibe_wasm-Drswr2Qh.js");return{IBE:c}},[],import.meta.url),a=new r;try{return a.extract(t,e)}catch(c){throw new Error(`IBE extract failed: ${c}`)}}async function Eu(t,e,r){if(await Mr(),!fr)throw new Error("IBE module not initialized");const{IBE:a}=await Ce(async()=>{const{IBE:o}=await import("./ibe_wasm-Drswr2Qh.js");return{IBE:o}},[],import.meta.url),c=new a;try{return c.encrypt(t,e,r)}catch(o){throw new Error(`IBE encrypt failed: ${o}`)}}async function xu(t,e){if(await Mr(),!fr)throw new Error("IBE module not initialized");const{IBE:r}=await Ce(async()=>{const{IBE:c}=await import("./ibe_wasm-Drswr2Qh.js");return{IBE:c}},[],import.meta.url),a=new r;try{return a.decrypt(t,e)}catch(c){throw new Error(`IBE decrypt failed: ${c}`)}}var Su=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function bu(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var c=!1;try{c=this instanceof a}catch{}return c?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var c=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,c.get?c:{enumerable:!0,get:function(){return t[a]}})}),r}var Pn,bi;function ge(){return bi||(bi=1,Pn={options:{usePureJavaScript:!1}}),Pn}var On={exports:{}},Kn,Bi;function Bu(){if(Bi)return Kn;Bi=1;var t={};Kn=t;var e={};t.encode=function(a,c,o){if(typeof c!="string")throw new TypeError('"alphabet" must be a string.');if(o!==void 0&&typeof o!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(a instanceof Uint8Array))i=r(a,c);else{var n=0,u=c.length,h=c.charAt(0),m=[0];for(n=0;n<a.length;++n){for(var B=0,v=a[n];B<m.length;++B)v+=m[B]<<8,m[B]=v%u,v=v/u|0;for(;v>0;)m.push(v%u),v=v/u|0}for(n=0;a[n]===0&&n<a.length-1;++n)i+=h;for(n=m.length-1;n>=0;--n)i+=c[m[n]]}if(o){var d=new RegExp(".{1,"+o+"}","g");i=i.match(d).join(`\r
`)}return i},t.decode=function(a,c){if(typeof a!="string")throw new TypeError('"input" must be a string.');if(typeof c!="string")throw new TypeError('"alphabet" must be a string.');var o=e[c];if(!o){o=e[c]=[];for(var i=0;i<c.length;++i)o[c.charCodeAt(i)]=i}a=a.replace(/\s/g,"");for(var n=c.length,u=c.charAt(0),h=[0],i=0;i<a.length;i++){var m=o[a.charCodeAt(i)];if(m===void 0)return;for(var B=0,v=m;B<h.length;++B)v+=h[B]*n,h[B]=v&255,v>>=8;for(;v>0;)h.push(v&255),v>>=8}for(var d=0;a[d]===u&&d<a.length-1;++d)h.push(0);return typeof Buffer<"u"?Buffer.from(h.reverse()):new Uint8Array(h.reverse())};function r(a,c){var o=0,i=c.length,n=c.charAt(0),u=[0];for(o=0;o<a.length();++o){for(var h=0,m=a.at(o);h<u.length;++h)m+=u[h]<<8,u[h]=m%i,m=m/i|0;for(;m>0;)u.push(m%i),m=m/i|0}var B="";for(o=0;a.at(o)===0&&o<a.length()-1;++o)B+=n;for(o=u.length-1;o>=0;--o)B+=c[u[o]];return B}return Kn}var wi;function Ee(){if(wi)return On.exports;wi=1;var t=ge(),e=Bu(),r=On.exports=t.util=t.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){r.nextTick=process.nextTick,typeof setImmediate=="function"?r.setImmediate=setImmediate:r.setImmediate=r.nextTick;return}if(typeof setImmediate=="function"){r.setImmediate=function(){return setImmediate.apply(void 0,arguments)},r.nextTick=function(l){return setImmediate(l)};return}if(r.setImmediate=function(l){setTimeout(l,0)},typeof window<"u"&&typeof window.postMessage=="function"){let l=function(s){if(s.source===window&&s.data===f){s.stopPropagation();var w=g.slice();g.length=0,w.forEach(function(N){N()})}};var f="forge.setImmediate",g=[];r.setImmediate=function(s){g.push(s),g.length===1&&window.postMessage(f,"*")},window.addEventListener("message",l,!0)}if(typeof MutationObserver<"u"){var E=Date.now(),T=!0,I=document.createElement("div"),g=[];new MutationObserver(function(){var s=g.slice();g.length=0,s.forEach(function(w){w()})}).observe(I,{attributes:!0});var x=r.setImmediate;r.setImmediate=function(s){Date.now()-E>15?(E=Date.now(),x(s)):(g.push(s),g.length===1&&I.setAttribute("a",T=!T))}}r.nextTick=r.setImmediate})(),r.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,r.globalScope=(function(){return r.isNodejs?Su:typeof self>"u"?window:self})(),r.isArray=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"},r.isArrayBuffer=function(f){return typeof ArrayBuffer<"u"&&f instanceof ArrayBuffer},r.isArrayBufferView=function(f){return f&&r.isArrayBuffer(f.buffer)&&f.byteLength!==void 0};function a(f){if(!(f===8||f===16||f===24||f===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+f)}r.ByteBuffer=c;function c(f){if(this.data="",this.read=0,typeof f=="string")this.data=f;else if(r.isArrayBuffer(f)||r.isArrayBufferView(f))if(typeof Buffer<"u"&&f instanceof Buffer)this.data=f.toString("binary");else{var g=new Uint8Array(f);try{this.data=String.fromCharCode.apply(null,g)}catch{for(var E=0;E<g.length;++E)this.putByte(g[E])}}else(f instanceof c||typeof f=="object"&&typeof f.data=="string"&&typeof f.read=="number")&&(this.data=f.data,this.read=f.read);this._constructedStringLength=0}r.ByteStringBuffer=c;var o=4096;r.ByteStringBuffer.prototype._optimizeConstructedString=function(f){this._constructedStringLength+=f,this._constructedStringLength>o&&(this.data.substr(0,1),this._constructedStringLength=0)},r.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},r.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},r.ByteStringBuffer.prototype.putByte=function(f){return this.putBytes(String.fromCharCode(f))},r.ByteStringBuffer.prototype.fillWithByte=function(f,g){f=String.fromCharCode(f);for(var E=this.data;g>0;)g&1&&(E+=f),g>>>=1,g>0&&(f+=f);return this.data=E,this._optimizeConstructedString(g),this},r.ByteStringBuffer.prototype.putBytes=function(f){return this.data+=f,this._optimizeConstructedString(f.length),this},r.ByteStringBuffer.prototype.putString=function(f){return this.putBytes(r.encodeUtf8(f))},r.ByteStringBuffer.prototype.putInt16=function(f){return this.putBytes(String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},r.ByteStringBuffer.prototype.putInt24=function(f){return this.putBytes(String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},r.ByteStringBuffer.prototype.putInt32=function(f){return this.putBytes(String.fromCharCode(f>>24&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},r.ByteStringBuffer.prototype.putInt16Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255))},r.ByteStringBuffer.prototype.putInt24Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f>>16&255))},r.ByteStringBuffer.prototype.putInt32Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>24&255))},r.ByteStringBuffer.prototype.putInt=function(f,g){a(g);var E="";do g-=8,E+=String.fromCharCode(f>>g&255);while(g>0);return this.putBytes(E)},r.ByteStringBuffer.prototype.putSignedInt=function(f,g){return f<0&&(f+=2<<g-1),this.putInt(f,g)},r.ByteStringBuffer.prototype.putBuffer=function(f){return this.putBytes(f.getBytes())},r.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},r.ByteStringBuffer.prototype.getInt16=function(){var f=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,f},r.ByteStringBuffer.prototype.getInt24=function(){var f=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,f},r.ByteStringBuffer.prototype.getInt32=function(){var f=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,f},r.ByteStringBuffer.prototype.getInt16Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,f},r.ByteStringBuffer.prototype.getInt24Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,f},r.ByteStringBuffer.prototype.getInt32Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,f},r.ByteStringBuffer.prototype.getInt=function(f){a(f);var g=0;do g=(g<<8)+this.data.charCodeAt(this.read++),f-=8;while(f>0);return g},r.ByteStringBuffer.prototype.getSignedInt=function(f){var g=this.getInt(f),E=2<<f-2;return g>=E&&(g-=E<<1),g},r.ByteStringBuffer.prototype.getBytes=function(f){var g;return f?(f=Math.min(this.length(),f),g=this.data.slice(this.read,this.read+f),this.read+=f):f===0?g="":(g=this.read===0?this.data:this.data.slice(this.read),this.clear()),g},r.ByteStringBuffer.prototype.bytes=function(f){return typeof f>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+f)},r.ByteStringBuffer.prototype.at=function(f){return this.data.charCodeAt(this.read+f)},r.ByteStringBuffer.prototype.setAt=function(f,g){return this.data=this.data.substr(0,this.read+f)+String.fromCharCode(g)+this.data.substr(this.read+f+1),this},r.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},r.ByteStringBuffer.prototype.copy=function(){var f=r.createBuffer(this.data);return f.read=this.read,f},r.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},r.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},r.ByteStringBuffer.prototype.truncate=function(f){var g=Math.max(0,this.length()-f);return this.data=this.data.substr(this.read,g),this.read=0,this},r.ByteStringBuffer.prototype.toHex=function(){for(var f="",g=this.read;g<this.data.length;++g){var E=this.data.charCodeAt(g);E<16&&(f+="0"),f+=E.toString(16)}return f},r.ByteStringBuffer.prototype.toString=function(){return r.decodeUtf8(this.bytes())};function i(f,g){g=g||{},this.read=g.readOffset||0,this.growSize=g.growSize||1024;var E=r.isArrayBuffer(f),T=r.isArrayBufferView(f);if(E||T){E?this.data=new DataView(f):this.data=new DataView(f.buffer,f.byteOffset,f.byteLength),this.write="writeOffset"in g?g.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,f!=null&&this.putBytes(f),"writeOffset"in g&&(this.write=g.writeOffset)}r.DataBuffer=i,r.DataBuffer.prototype.length=function(){return this.write-this.read},r.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},r.DataBuffer.prototype.accommodate=function(f,g){if(this.length()>=f)return this;g=Math.max(g||this.growSize,f);var E=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),T=new Uint8Array(this.length()+g);return T.set(E),this.data=new DataView(T.buffer),this},r.DataBuffer.prototype.putByte=function(f){return this.accommodate(1),this.data.setUint8(this.write++,f),this},r.DataBuffer.prototype.fillWithByte=function(f,g){this.accommodate(g);for(var E=0;E<g;++E)this.data.setUint8(f);return this},r.DataBuffer.prototype.putBytes=function(f,g){if(r.isArrayBufferView(f)){var E=new Uint8Array(f.buffer,f.byteOffset,f.byteLength),T=E.byteLength-E.byteOffset;this.accommodate(T);var I=new Uint8Array(this.data.buffer,this.write);return I.set(E),this.write+=T,this}if(r.isArrayBuffer(f)){var E=new Uint8Array(f);this.accommodate(E.byteLength);var I=new Uint8Array(this.data.buffer);return I.set(E,this.write),this.write+=E.byteLength,this}if(f instanceof r.DataBuffer||typeof f=="object"&&typeof f.read=="number"&&typeof f.write=="number"&&r.isArrayBufferView(f.data)){var E=new Uint8Array(f.data.byteLength,f.read,f.length());this.accommodate(E.byteLength);var I=new Uint8Array(f.data.byteLength,this.write);return I.set(E),this.write+=E.byteLength,this}if(f instanceof r.ByteStringBuffer&&(f=f.data,g="binary"),g=g||"binary",typeof f=="string"){var x;if(g==="hex")return this.accommodate(Math.ceil(f.length/2)),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.hex.decode(f,x,this.write),this;if(g==="base64")return this.accommodate(Math.ceil(f.length/4)*3),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.base64.decode(f,x,this.write),this;if(g==="utf8"&&(f=r.encodeUtf8(f),g="binary"),g==="binary"||g==="raw")return this.accommodate(f.length),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.raw.decode(x),this;if(g==="utf16")return this.accommodate(f.length*2),x=new Uint16Array(this.data.buffer,this.write),this.write+=r.text.utf16.encode(x),this;throw new Error("Invalid encoding: "+g)}throw Error("Invalid parameter: "+f)},r.DataBuffer.prototype.putBuffer=function(f){return this.putBytes(f),f.clear(),this},r.DataBuffer.prototype.putString=function(f){return this.putBytes(f,"utf16")},r.DataBuffer.prototype.putInt16=function(f){return this.accommodate(2),this.data.setInt16(this.write,f),this.write+=2,this},r.DataBuffer.prototype.putInt24=function(f){return this.accommodate(3),this.data.setInt16(this.write,f>>8&65535),this.data.setInt8(this.write,f>>16&255),this.write+=3,this},r.DataBuffer.prototype.putInt32=function(f){return this.accommodate(4),this.data.setInt32(this.write,f),this.write+=4,this},r.DataBuffer.prototype.putInt16Le=function(f){return this.accommodate(2),this.data.setInt16(this.write,f,!0),this.write+=2,this},r.DataBuffer.prototype.putInt24Le=function(f){return this.accommodate(3),this.data.setInt8(this.write,f>>16&255),this.data.setInt16(this.write,f>>8&65535,!0),this.write+=3,this},r.DataBuffer.prototype.putInt32Le=function(f){return this.accommodate(4),this.data.setInt32(this.write,f,!0),this.write+=4,this},r.DataBuffer.prototype.putInt=function(f,g){a(g),this.accommodate(g/8);do g-=8,this.data.setInt8(this.write++,f>>g&255);while(g>0);return this},r.DataBuffer.prototype.putSignedInt=function(f,g){return a(g),this.accommodate(g/8),f<0&&(f+=2<<g-1),this.putInt(f,g)},r.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},r.DataBuffer.prototype.getInt16=function(){var f=this.data.getInt16(this.read);return this.read+=2,f},r.DataBuffer.prototype.getInt24=function(){var f=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,f},r.DataBuffer.prototype.getInt32=function(){var f=this.data.getInt32(this.read);return this.read+=4,f},r.DataBuffer.prototype.getInt16Le=function(){var f=this.data.getInt16(this.read,!0);return this.read+=2,f},r.DataBuffer.prototype.getInt24Le=function(){var f=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,f},r.DataBuffer.prototype.getInt32Le=function(){var f=this.data.getInt32(this.read,!0);return this.read+=4,f},r.DataBuffer.prototype.getInt=function(f){a(f);var g=0;do g=(g<<8)+this.data.getInt8(this.read++),f-=8;while(f>0);return g},r.DataBuffer.prototype.getSignedInt=function(f){var g=this.getInt(f),E=2<<f-2;return g>=E&&(g-=E<<1),g},r.DataBuffer.prototype.getBytes=function(f){var g;return f?(f=Math.min(this.length(),f),g=this.data.slice(this.read,this.read+f),this.read+=f):f===0?g="":(g=this.read===0?this.data:this.data.slice(this.read),this.clear()),g},r.DataBuffer.prototype.bytes=function(f){return typeof f>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+f)},r.DataBuffer.prototype.at=function(f){return this.data.getUint8(this.read+f)},r.DataBuffer.prototype.setAt=function(f,g){return this.data.setUint8(f,g),this},r.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},r.DataBuffer.prototype.copy=function(){return new r.DataBuffer(this)},r.DataBuffer.prototype.compact=function(){if(this.read>0){var f=new Uint8Array(this.data.buffer,this.read),g=new Uint8Array(f.byteLength);g.set(f),this.data=new DataView(g),this.write-=this.read,this.read=0}return this},r.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},r.DataBuffer.prototype.truncate=function(f){return this.write=Math.max(0,this.length()-f),this.read=Math.min(this.read,this.write),this},r.DataBuffer.prototype.toHex=function(){for(var f="",g=this.read;g<this.data.byteLength;++g){var E=this.data.getUint8(g);E<16&&(f+="0"),f+=E.toString(16)}return f},r.DataBuffer.prototype.toString=function(f){var g=new Uint8Array(this.data,this.read,this.length());if(f=f||"utf8",f==="binary"||f==="raw")return r.binary.raw.encode(g);if(f==="hex")return r.binary.hex.encode(g);if(f==="base64")return r.binary.base64.encode(g);if(f==="utf8")return r.text.utf8.decode(g);if(f==="utf16")return r.text.utf16.decode(g);throw new Error("Invalid encoding: "+f)},r.createBuffer=function(f,g){return g=g||"raw",f!==void 0&&g==="utf8"&&(f=r.encodeUtf8(f)),new r.ByteBuffer(f)},r.fillString=function(f,g){for(var E="";g>0;)g&1&&(E+=f),g>>>=1,g>0&&(f+=f);return E},r.xorBytes=function(f,g,E){for(var T="",I="",x="",l=0,s=0;E>0;--E,++l)I=f.charCodeAt(l)^g.charCodeAt(l),s>=10&&(T+=x,x="",s=0),x+=String.fromCharCode(I),++s;return T+=x,T},r.hexToBytes=function(f){var g="",E=0;for(f.length&!0&&(E=1,g+=String.fromCharCode(parseInt(f[0],16)));E<f.length;E+=2)g+=String.fromCharCode(parseInt(f.substr(E,2),16));return g},r.bytesToHex=function(f){return r.createBuffer(f).toHex()},r.int32ToBytes=function(f){return String.fromCharCode(f>>24&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255)};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],h="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";r.encode64=function(f,g){for(var E="",T="",I,x,l,s=0;s<f.length;)I=f.charCodeAt(s++),x=f.charCodeAt(s++),l=f.charCodeAt(s++),E+=n.charAt(I>>2),E+=n.charAt((I&3)<<4|x>>4),isNaN(x)?E+="==":(E+=n.charAt((x&15)<<2|l>>6),E+=isNaN(l)?"=":n.charAt(l&63)),g&&E.length>g&&(T+=E.substr(0,g)+`\r
`,E=E.substr(g));return T+=E,T},r.decode64=function(f){f=f.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var g="",E,T,I,x,l=0;l<f.length;)E=u[f.charCodeAt(l++)-43],T=u[f.charCodeAt(l++)-43],I=u[f.charCodeAt(l++)-43],x=u[f.charCodeAt(l++)-43],g+=String.fromCharCode(E<<2|T>>4),I!==64&&(g+=String.fromCharCode((T&15)<<4|I>>2),x!==64&&(g+=String.fromCharCode((I&3)<<6|x)));return g},r.encodeUtf8=function(f){return unescape(encodeURIComponent(f))},r.decodeUtf8=function(f){return decodeURIComponent(escape(f))},r.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},r.binary.raw.encode=function(f){return String.fromCharCode.apply(null,f)},r.binary.raw.decode=function(f,g,E){var T=g;T||(T=new Uint8Array(f.length)),E=E||0;for(var I=E,x=0;x<f.length;++x)T[I++]=f.charCodeAt(x);return g?I-E:T},r.binary.hex.encode=r.bytesToHex,r.binary.hex.decode=function(f,g,E){var T=g;T||(T=new Uint8Array(Math.ceil(f.length/2))),E=E||0;var I=0,x=E;for(f.length&1&&(I=1,T[x++]=parseInt(f[0],16));I<f.length;I+=2)T[x++]=parseInt(f.substr(I,2),16);return g?x-E:T},r.binary.base64.encode=function(f,g){for(var E="",T="",I,x,l,s=0;s<f.byteLength;)I=f[s++],x=f[s++],l=f[s++],E+=n.charAt(I>>2),E+=n.charAt((I&3)<<4|x>>4),isNaN(x)?E+="==":(E+=n.charAt((x&15)<<2|l>>6),E+=isNaN(l)?"=":n.charAt(l&63)),g&&E.length>g&&(T+=E.substr(0,g)+`\r
`,E=E.substr(g));return T+=E,T},r.binary.base64.decode=function(f,g,E){var T=g;T||(T=new Uint8Array(Math.ceil(f.length/4)*3)),f=f.replace(/[^A-Za-z0-9\+\/\=]/g,""),E=E||0;for(var I,x,l,s,w=0,N=E;w<f.length;)I=u[f.charCodeAt(w++)-43],x=u[f.charCodeAt(w++)-43],l=u[f.charCodeAt(w++)-43],s=u[f.charCodeAt(w++)-43],T[N++]=I<<2|x>>4,l!==64&&(T[N++]=(x&15)<<4|l>>2,s!==64&&(T[N++]=(l&3)<<6|s));return g?N-E:T.subarray(0,N)},r.binary.base58.encode=function(f,g){return r.binary.baseN.encode(f,h,g)},r.binary.base58.decode=function(f,g){return r.binary.baseN.decode(f,h,g)},r.text={utf8:{},utf16:{}},r.text.utf8.encode=function(f,g,E){f=r.encodeUtf8(f);var T=g;T||(T=new Uint8Array(f.length)),E=E||0;for(var I=E,x=0;x<f.length;++x)T[I++]=f.charCodeAt(x);return g?I-E:T},r.text.utf8.decode=function(f){return r.decodeUtf8(String.fromCharCode.apply(null,f))},r.text.utf16.encode=function(f,g,E){var T=g;T||(T=new Uint8Array(f.length*2));var I=new Uint16Array(T.buffer);E=E||0;for(var x=E,l=E,s=0;s<f.length;++s)I[l++]=f.charCodeAt(s),x+=2;return g?x-E:T},r.text.utf16.decode=function(f){return String.fromCharCode.apply(null,new Uint16Array(f.buffer))},r.deflate=function(f,g,E){if(g=r.decode64(f.deflate(r.encode64(g)).rval),E){var T=2,I=g.charCodeAt(1);I&32&&(T=6),g=g.substring(T,g.length-4)}return g},r.inflate=function(f,g,E){var T=f.inflate(r.encode64(g)).rval;return T===null?null:r.decode64(T)};var m=function(f,g,E){if(!f)throw new Error("WebStorage not available.");var T;if(E===null?T=f.removeItem(g):(E=r.encode64(JSON.stringify(E)),T=f.setItem(g,E)),typeof T<"u"&&T.rval!==!0){var I=new Error(T.error.message);throw I.id=T.error.id,I.name=T.error.name,I}},B=function(f,g){if(!f)throw new Error("WebStorage not available.");var E=f.getItem(g);if(f.init)if(E.rval===null){if(E.error){var T=new Error(E.error.message);throw T.id=E.error.id,T.name=E.error.name,T}E=null}else E=E.rval;return E!==null&&(E=JSON.parse(r.decode64(E))),E},v=function(f,g,E,T){var I=B(f,g);I===null&&(I={}),I[E]=T,m(f,g,I)},d=function(f,g,E){var T=B(f,g);return T!==null&&(T=E in T?T[E]:null),T},p=function(f,g,E){var T=B(f,g);if(T!==null&&E in T){delete T[E];var I=!0;for(var x in T){I=!1;break}I&&(T=null),m(f,g,T)}},C=function(f,g){m(f,g,null)},S=function(f,g,E){var T=null;typeof E>"u"&&(E=["web","flash"]);var I,x=!1,l=null;for(var s in E){I=E[s];try{if(I==="flash"||I==="both"){if(g[0]===null)throw new Error("Flash local storage not available.");T=f.apply(this,g),x=I==="flash"}(I==="web"||I==="both")&&(g[0]=localStorage,T=f.apply(this,g),x=!0)}catch(w){l=w}if(x)break}if(!x)throw l;return T};return r.setItem=function(f,g,E,T,I){S(v,arguments,I)},r.getItem=function(f,g,E,T){return S(d,arguments,T)},r.removeItem=function(f,g,E,T){S(p,arguments,T)},r.clearItems=function(f,g,E){S(C,arguments,E)},r.isEmpty=function(f){for(var g in f)if(f.hasOwnProperty(g))return!1;return!0},r.format=function(f){for(var g=/%./g,E,T,I=0,x=[],l=0;E=g.exec(f);){T=f.substring(l,g.lastIndex-2),T.length>0&&x.push(T),l=g.lastIndex;var s=E[0][1];switch(s){case"s":case"o":I<arguments.length?x.push(arguments[I+++1]):x.push("<?>");break;case"%":x.push("%");break;default:x.push("<%"+s+"?>")}}return x.push(f.substring(l)),x.join("")},r.formatNumber=function(f,g,E,T){var I=f,x=isNaN(g=Math.abs(g))?2:g,l=E===void 0?",":E,s=T===void 0?".":T,w=I<0?"-":"",N=parseInt(I=Math.abs(+I||0).toFixed(x),10)+"",O=N.length>3?N.length%3:0;return w+(O?N.substr(0,O)+s:"")+N.substr(O).replace(/(\d{3})(?=\d)/g,"$1"+s)+(x?l+Math.abs(I-N).toFixed(x).slice(2):"")},r.formatSize=function(f){return f>=1073741824?f=r.formatNumber(f/1073741824,2,".","")+" GiB":f>=1048576?f=r.formatNumber(f/1048576,2,".","")+" MiB":f>=1024?f=r.formatNumber(f/1024,0)+" KiB":f=r.formatNumber(f,0)+" bytes",f},r.bytesFromIP=function(f){return f.indexOf(".")!==-1?r.bytesFromIPv4(f):f.indexOf(":")!==-1?r.bytesFromIPv6(f):null},r.bytesFromIPv4=function(f){if(f=f.split("."),f.length!==4)return null;for(var g=r.createBuffer(),E=0;E<f.length;++E){var T=parseInt(f[E],10);if(isNaN(T))return null;g.putByte(T)}return g.getBytes()},r.bytesFromIPv6=function(f){var g=0;f=f.split(":").filter(function(l){return l.length===0&&++g,!0});for(var E=(8-f.length+g)*2,T=r.createBuffer(),I=0;I<8;++I){if(!f[I]||f[I].length===0){T.fillWithByte(0,E),E=0;continue}var x=r.hexToBytes(f[I]);x.length<2&&T.putByte(0),T.putBytes(x)}return T.getBytes()},r.bytesToIP=function(f){return f.length===4?r.bytesToIPv4(f):f.length===16?r.bytesToIPv6(f):null},r.bytesToIPv4=function(f){if(f.length!==4)return null;for(var g=[],E=0;E<f.length;++E)g.push(f.charCodeAt(E));return g.join(".")},r.bytesToIPv6=function(f){if(f.length!==16)return null;for(var g=[],E=[],T=0,I=0;I<f.length;I+=2){for(var x=r.bytesToHex(f[I]+f[I+1]);x[0]==="0"&&x!=="0";)x=x.substr(1);if(x==="0"){var l=E[E.length-1],s=g.length;!l||s!==l.end+1?E.push({start:s,end:s}):(l.end=s,l.end-l.start>E[T].end-E[T].start&&(T=E.length-1))}g.push(x)}if(E.length>0){var w=E[T];w.end-w.start>0&&(g.splice(w.start,w.end-w.start+1,""),w.start===0&&g.unshift(""),w.end===7&&g.push(""))}return g.join(":")},r.estimateCores=function(f,g){if(typeof f=="function"&&(g=f,f={}),f=f||{},"cores"in r&&!f.update)return g(null,r.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return r.cores=navigator.hardwareConcurrency,g(null,r.cores);if(typeof Worker>"u")return r.cores=1,g(null,r.cores);if(typeof Blob>"u")return r.cores=2,g(null,r.cores);var E=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(l){var s=Date.now(),w=s+4;self.postMessage({st:s,et:w})})}).toString(),")()"],{type:"application/javascript"}));T([],5,16);function T(l,s,w){if(s===0){var N=Math.floor(l.reduce(function(O,_){return O+_},0)/l.length);return r.cores=Math.max(1,N),URL.revokeObjectURL(E),g(null,r.cores)}I(w,function(O,_){l.push(x(w,_)),T(l,s-1,w)})}function I(l,s){for(var w=[],N=[],O=0;O<l;++O){var _=new Worker(E);_.addEventListener("message",function(D){if(N.push(D.data),N.length===l){for(var V=0;V<l;++V)w[V].terminate();s(null,N)}}),w.push(_)}for(var O=0;O<l;++O)w[O].postMessage(O)}function x(l,s){for(var w=[],N=0;N<l;++N)for(var O=s[N],_=w[N]=[],D=0;D<l;++D)if(N!==D){var V=s[D];(O.st>V.st&&O.st<V.et||V.st>O.st&&V.st<O.et)&&_.push(D)}return w.reduce(function(P,M){return Math.max(P,M.length)},0)}},On.exports}var Vn,Ti;function $a(){if(Ti)return Vn;Ti=1;var t=ge();Ee(),Vn=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(r,a){var c=r;if(typeof c=="string"&&(c=t.cipher.getAlgorithm(c),c&&(c=c())),!c)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:c,key:a,decrypt:!1})},t.cipher.createDecipher=function(r,a){var c=r;if(typeof c=="string"&&(c=t.cipher.getAlgorithm(c),c&&(c=c())),!c)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:c,key:a,decrypt:!0})},t.cipher.registerAlgorithm=function(r,a){r=r.toUpperCase(),t.cipher.algorithms[r]=a},t.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in t.cipher.algorithms?t.cipher.algorithms[r]:null};var e=t.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};return e.prototype.start=function(r){r=r||{};var a={};for(var c in r)a[c]=r[c];a.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=r.output||t.util.createBuffer(),this.mode.start(a)},e.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(c){return r(this.blockSize,c,!1)},this.mode.unpad=function(c){return r(this.blockSize,c,!0)});var a={};return a.decrypt=this._decrypt,a.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,a)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,a))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,a))},Vn}var Fn={exports:{}},Ai;function Co(){if(Ai)return Fn.exports;Ai=1;var t=ge();Ee(),t.cipher=t.cipher||{};var e=Fn.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(o){o=o||{},this.name="ECB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(o){},e.ecb.prototype.encrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u])},e.ecb.prototype.decrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u])},e.ecb.prototype.pad=function(o,i){var n=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();return o.fillWithByte(n,n),!0},e.ecb.prototype.unpad=function(o,i){if(i.overflow>0)return!1;var n=o.length(),u=o.at(n-1);return u>this.blockSize<<2?!1:(o.truncate(u),!0)},e.cbc=function(o){o=o||{},this.name="CBC",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(o){if(o.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in o)this._iv=r(o.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=this._prev[u]^o.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._prev[u]^this._outBlock[u]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(o,i){var n=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();return o.fillWithByte(n,n),!0},e.cbc.prototype.unpad=function(o,i){if(i.overflow>0)return!1;var n=o.length(),u=o.at(n-1);return u>this.blockSize<<2?!1:(o.truncate(u),!0)},e.cfb=function(o){o=o||{},this.name="CFB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var h=0;h<this._ints;++h)this._inBlock[h]=o.getInt32()^this._outBlock[h],i.putInt32(this._inBlock[h]);return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialBlock[h]=o.getInt32()^this._outBlock[h],this._partialOutput.putInt32(this._partialBlock[h]);if(m>0)o.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._partialBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var h=0;h<this._ints;++h)this._inBlock[h]=o.getInt32(),i.putInt32(this._inBlock[h]^this._outBlock[h]);return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialBlock[h]=o.getInt32(),this._partialOutput.putInt32(this._partialBlock[h]^this._outBlock[h]);if(m>0)o.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._partialBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.ofb=function(o){o=o||{},this.name="OFB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(o,i,n){var u=o.length();if(o.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var h=0;h<this._ints;++h)i.putInt32(o.getInt32()^this._outBlock[h]),this._inBlock[h]=this._outBlock[h];return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(o.getInt32()^this._outBlock[h]);if(m>0)o.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._outBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(o){o=o||{},this.name="CTR",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize)for(var h=0;h<this._ints;++h)i.putInt32(o.getInt32()^this._outBlock[h]);else{var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(o.getInt32()^this._outBlock[h]);if(m>0&&(o.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0}a(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(o){o=o||{},this.name="GCM",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");var i=t.util.createBuffer(o.iv);this._cipherLength=0;var n;if("additionalData"in o?n=t.util.createBuffer(o.additionalData):n=t.util.createBuffer(),"tagLength"in o?this._tagLength=o.tagLength:this._tagLength=128,this._tag=null,o.decrypt&&(this._tag=t.util.createBuffer(o.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var u=i.length();if(u===12)this._j0=[i.getInt32(),i.getInt32(),i.getInt32(),1];else{for(this._j0=[0,0,0,0];i.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[i.getInt32(),i.getInt32(),i.getInt32(),i.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(c(u*8)))}this._inBlock=this._j0.slice(0),a(this._inBlock),this._partialBytes=0,n=t.util.createBuffer(n),this._aDataLength=c(n.length()*8);var h=n.length()%this.blockSize;for(h&&n.fillWithByte(0,this.blockSize-h),this._s=[0,0,0,0];n.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()])},e.gcm.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var h=0;h<this._ints;++h)i.putInt32(this._outBlock[h]^=o.getInt32());this._cipherLength+=this.blockSize}else{var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(o.getInt32()^this._outBlock[h]);if(m<=0||n){if(n){var B=u%this.blockSize;this._cipherLength+=B,this._partialOutput.truncate(this.blockSize-B)}else this._cipherLength+=this.blockSize;for(var h=0;h<this._ints;++h)this._outBlock[h]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return o.read-=this.blockSize,i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),a(this._inBlock)},e.gcm.prototype.decrypt=function(o,i,n){var u=o.length();if(u<this.blockSize&&!(n&&u>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),a(this._inBlock),this._hashBlock[0]=o.getInt32(),this._hashBlock[1]=o.getInt32(),this._hashBlock[2]=o.getInt32(),this._hashBlock[3]=o.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var h=0;h<this._ints;++h)i.putInt32(this._outBlock[h]^this._hashBlock[h]);u<this.blockSize?this._cipherLength+=u%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(o,i){var n=!0;i.decrypt&&i.overflow&&o.truncate(this.blockSize-i.overflow),this.tag=t.util.createBuffer();var u=this._aDataLength.concat(c(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,u);var h=[];this.cipher.encrypt(this._j0,h);for(var m=0;m<this._ints;++m)this.tag.putInt32(this._s[m]^h[m]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),i.decrypt&&this.tag.bytes()!==this._tag&&(n=!1),n},e.gcm.prototype.multiply=function(o,i){for(var n=[0,0,0,0],u=i.slice(0),h=0;h<128;++h){var m=o[h/32|0]&1<<31-h%32;m&&(n[0]^=u[0],n[1]^=u[1],n[2]^=u[2],n[3]^=u[3]),this.pow(u,u)}return n},e.gcm.prototype.pow=function(o,i){for(var n=o[3]&1,u=3;u>0;--u)i[u]=o[u]>>>1|(o[u-1]&1)<<31;i[0]=o[0]>>>1,n&&(i[0]^=this._R)},e.gcm.prototype.tableMultiply=function(o){for(var i=[0,0,0,0],n=0;n<32;++n){var u=n/8|0,h=o[u]>>>(7-n%8)*4&15,m=this._m[n][h];i[0]^=m[0],i[1]^=m[1],i[2]^=m[2],i[3]^=m[3]}return i},e.gcm.prototype.ghash=function(o,i,n){return i[0]^=n[0],i[1]^=n[1],i[2]^=n[2],i[3]^=n[3],this.tableMultiply(i)},e.gcm.prototype.generateHashTable=function(o,i){for(var n=8/i,u=4*n,h=16*n,m=new Array(h),B=0;B<h;++B){var v=[0,0,0,0],d=B/u|0,p=(u-1-B%u)*i;v[d]=1<<i-1<<p,m[B]=this.generateSubHashTable(this.multiply(v,o),i)}return m},e.gcm.prototype.generateSubHashTable=function(o,i){var n=1<<i,u=n>>>1,h=new Array(n);h[u]=o.slice(0);for(var m=u>>>1;m>0;)this.pow(h[2*m],h[m]=[]),m>>=1;for(m=2;m<u;){for(var B=1;B<m;++B){var v=h[m],d=h[B];h[m+B]=[v[0]^d[0],v[1]^d[1],v[2]^d[2],v[3]^d[3]]}m*=2}for(h[0]=[0,0,0,0],m=u+1;m<n;++m){var p=h[m^u];h[m]=[o[0]^p[0],o[1]^p[1],o[2]^p[2],o[3]^p[3]]}return h};function r(o,i){if(typeof o=="string"&&(o=t.util.createBuffer(o)),t.util.isArray(o)&&o.length>4){var n=o;o=t.util.createBuffer();for(var u=0;u<n.length;++u)o.putByte(n[u])}if(o.length()<i)throw new Error("Invalid IV length; got "+o.length()+" bytes and expected "+i+" bytes.");if(!t.util.isArray(o)){for(var h=[],m=i/4,u=0;u<m;++u)h.push(o.getInt32());o=h}return o}function a(o){o[o.length-1]=o[o.length-1]+1&4294967295}function c(o){return[o/4294967296|0,o&4294967295]}return Fn.exports}var Mn,Ii;function hr(){if(Ii)return Mn;Ii=1;var t=ge();$a(),Co(),Ee(),Mn=t.aes=t.aes||{},t.aes.startEncrypting=function(d,p,C,S){var f=v({key:d,output:C,decrypt:!1,mode:S});return f.start(p),f},t.aes.createEncryptionCipher=function(d,p){return v({key:d,output:null,decrypt:!1,mode:p})},t.aes.startDecrypting=function(d,p,C,S){var f=v({key:d,output:C,decrypt:!0,mode:S});return f.start(p),f},t.aes.createDecryptionCipher=function(d,p){return v({key:d,output:null,decrypt:!0,mode:p})},t.aes.Algorithm=function(d,p){r||h();var C=this;C.name=d,C.mode=new p({blockSize:16,cipher:{encrypt:function(S,f){return B(C._w,S,f,!1)},decrypt:function(S,f){return B(C._w,S,f,!0)}}}),C._init=!1},t.aes.Algorithm.prototype.initialize=function(d){if(!this._init){var p=d.key,C;if(typeof p=="string"&&(p.length===16||p.length===24||p.length===32))p=t.util.createBuffer(p);else if(t.util.isArray(p)&&(p.length===16||p.length===24||p.length===32)){C=p,p=t.util.createBuffer();for(var S=0;S<C.length;++S)p.putByte(C[S])}if(!t.util.isArray(p)){C=p,p=[];var f=C.length();if(f===16||f===24||f===32){f=f>>>2;for(var S=0;S<f;++S)p.push(C.getInt32())}}if(!t.util.isArray(p)||!(p.length===4||p.length===6||p.length===8))throw new Error("Invalid key parameter.");var g=this.mode.name,E=["CFB","OFB","CTR","GCM"].indexOf(g)!==-1;this._w=m(p,d.decrypt&&!E),this._init=!0}},t.aes._expandKey=function(d,p){return r||h(),m(d,p)},t.aes._updateBlock=B,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(d,p){var C=function(){return new t.aes.Algorithm(d,p)};t.cipher.registerAlgorithm(d,C)}var r=!1,a=4,c,o,i,n,u;function h(){r=!0,i=[0,1,2,4,8,16,32,64,128,27,54];for(var d=new Array(256),p=0;p<128;++p)d[p]=p<<1,d[p+128]=p+128<<1^283;c=new Array(256),o=new Array(256),n=new Array(4),u=new Array(4);for(var p=0;p<4;++p)n[p]=new Array(256),u[p]=new Array(256);for(var C=0,S=0,f,g,E,T,I,x,l,p=0;p<256;++p){T=S^S<<1^S<<2^S<<3^S<<4,T=T>>8^T&255^99,c[C]=T,o[T]=C,I=d[T],f=d[C],g=d[f],E=d[g],x=I<<24^T<<16^T<<8^(T^I),l=(f^g^E)<<24^(C^E)<<16^(C^g^E)<<8^(C^f^E);for(var s=0;s<4;++s)n[s][C]=x,u[s][T]=l,x=x<<24|x>>>8,l=l<<24|l>>>8;C===0?C=S=1:(C=f^d[d[d[f^E]]],S^=d[d[S]])}}function m(d,p){for(var C=d.slice(0),S,f=1,g=C.length,E=g+6+1,T=a*E,I=g;I<T;++I)S=C[I-1],I%g===0?(S=c[S>>>16&255]<<24^c[S>>>8&255]<<16^c[S&255]<<8^c[S>>>24]^i[f]<<24,f++):g>6&&I%g===4&&(S=c[S>>>24]<<24^c[S>>>16&255]<<16^c[S>>>8&255]<<8^c[S&255]),C[I]=C[I-g]^S;if(p){var x,l=u[0],s=u[1],w=u[2],N=u[3],O=C.slice(0);T=C.length;for(var I=0,_=T-a;I<T;I+=a,_-=a)if(I===0||I===T-a)O[I]=C[_],O[I+1]=C[_+3],O[I+2]=C[_+2],O[I+3]=C[_+1];else for(var D=0;D<a;++D)x=C[_+D],O[I+(3&-D)]=l[c[x>>>24]]^s[c[x>>>16&255]]^w[c[x>>>8&255]]^N[c[x&255]];C=O}return C}function B(d,p,C,S){var f=d.length/4-1,g,E,T,I,x;S?(g=u[0],E=u[1],T=u[2],I=u[3],x=o):(g=n[0],E=n[1],T=n[2],I=n[3],x=c);var l,s,w,N,O,_,D;l=p[0]^d[0],s=p[S?3:1]^d[1],w=p[2]^d[2],N=p[S?1:3]^d[3];for(var V=3,P=1;P<f;++P)O=g[l>>>24]^E[s>>>16&255]^T[w>>>8&255]^I[N&255]^d[++V],_=g[s>>>24]^E[w>>>16&255]^T[N>>>8&255]^I[l&255]^d[++V],D=g[w>>>24]^E[N>>>16&255]^T[l>>>8&255]^I[s&255]^d[++V],N=g[N>>>24]^E[l>>>16&255]^T[s>>>8&255]^I[w&255]^d[++V],l=O,s=_,w=D;C[0]=x[l>>>24]<<24^x[s>>>16&255]<<16^x[w>>>8&255]<<8^x[N&255]^d[++V],C[S?3:1]=x[s>>>24]<<24^x[w>>>16&255]<<16^x[N>>>8&255]<<8^x[l&255]^d[++V],C[2]=x[w>>>24]<<24^x[N>>>16&255]<<16^x[l>>>8&255]<<8^x[s&255]^d[++V],C[S?1:3]=x[N>>>24]<<24^x[l>>>16&255]<<16^x[s>>>8&255]<<8^x[w&255]^d[++V]}function v(d){d=d||{};var p=(d.mode||"CBC").toUpperCase(),C="AES-"+p,S;d.decrypt?S=t.cipher.createDecipher(C,d.key):S=t.cipher.createCipher(C,d.key);var f=S.start;return S.start=function(g,E){var T=null;E instanceof t.util.ByteBuffer&&(T=E,E={}),E=E||{},E.output=T,E.iv=g,f.call(S,E)},S}return Mn}var Hn={exports:{}},qn={exports:{}},Gn={exports:{}},_i;function dr(){if(_i)return Gn.exports;_i=1;var t=ge();t.pki=t.pki||{};var e=Gn.exports=t.pki.oids=t.oids=t.oids||{};function r(c,o){e[c]=o,e[o]=c}function a(c,o){e[c]=o}return r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("1.3.14.3.2.29","sha1WithRSASignature"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("2.16.840.1.101.3.4.2.4","sha224"),r("2.16.840.1.101.3.4.2.5","sha512-224"),r("2.16.840.1.101.3.4.2.6","sha512-256"),r("1.2.840.113549.2.2","md2"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.4","surname"),r("2.5.4.5","serialNumber"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.12","title"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("2.5.4.42","givenName"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),a("2.5.29.1","authorityKeyIdentifier"),a("2.5.29.2","keyAttributes"),a("2.5.29.3","certificatePolicies"),a("2.5.29.4","keyUsageRestriction"),a("2.5.29.5","policyMapping"),a("2.5.29.6","subtreesConstraint"),a("2.5.29.7","subjectAltName"),a("2.5.29.8","issuerAltName"),a("2.5.29.9","subjectDirectoryAttributes"),a("2.5.29.10","basicConstraints"),a("2.5.29.11","nameConstraints"),a("2.5.29.12","policyConstraints"),a("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),a("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),a("2.5.29.20","cRLNumber"),a("2.5.29.21","cRLReason"),a("2.5.29.22","expirationDate"),a("2.5.29.23","instructionCode"),a("2.5.29.24","invalidityDate"),a("2.5.29.25","cRLDistributionPoints"),a("2.5.29.26","issuingDistributionPoint"),a("2.5.29.27","deltaCRLIndicator"),a("2.5.29.28","issuingDistributionPoint"),a("2.5.29.29","certificateIssuer"),a("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),a("2.5.29.33","policyMappings"),a("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),a("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),a("2.5.29.46","freshestCRL"),a("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping"),Gn.exports}var Ri;function kt(){if(Ri)return qn.exports;Ri=1;var t=ge();Ee(),dr();var e=qn.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(i,n,u,h,m){if(t.util.isArray(h)){for(var B=[],v=0;v<h.length;++v)h[v]!==void 0&&B.push(h[v]);h=B}var d={tagClass:i,type:n,constructed:u,composed:u||t.util.isArray(h),value:h};return m&&"bitStringContents"in m&&(d.bitStringContents=m.bitStringContents,d.original=e.copy(d)),d},e.copy=function(i,n){var u;if(t.util.isArray(i)){u=[];for(var h=0;h<i.length;++h)u.push(e.copy(i[h],n));return u}return typeof i=="string"?i:(u={tagClass:i.tagClass,type:i.type,constructed:i.constructed,composed:i.composed,value:e.copy(i.value,n)},n&&!n.excludeBitStringContents&&(u.bitStringContents=i.bitStringContents),u)},e.equals=function(i,n,u){if(t.util.isArray(i)){if(!t.util.isArray(n)||i.length!==n.length)return!1;for(var h=0;h<i.length;++h)if(!e.equals(i[h],n[h]))return!1;return!0}if(typeof i!=typeof n)return!1;if(typeof i=="string")return i===n;var m=i.tagClass===n.tagClass&&i.type===n.type&&i.constructed===n.constructed&&i.composed===n.composed&&e.equals(i.value,n.value);return u&&u.includeBitStringContents&&(m=m&&i.bitStringContents===n.bitStringContents),m},e.getBerValueLength=function(i){var n=i.getByte();if(n!==128){var u,h=n&128;return h?u=i.getInt((n&127)<<3):u=n,u}};function r(i,n,u){if(u>n){var h=new Error("Too few bytes to parse DER.");throw h.available=i.length(),h.remaining=n,h.requested=u,h}}var a=function(i,n){var u=i.getByte();if(n--,u!==128){var h,m=u&128;if(!m)h=u;else{var B=u&127;r(i,n,B),h=i.getInt(B<<3)}if(h<0)throw new Error("Negative length: "+h);return h}};e.fromDer=function(i,n){n===void 0&&(n={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof n=="boolean"&&(n={strict:n,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in n||(n.strict=!0),"parseAllBytes"in n||(n.parseAllBytes=!0),"decodeBitStrings"in n||(n.decodeBitStrings=!0),typeof i=="string"&&(i=t.util.createBuffer(i));var u=i.length(),h=c(i,i.length(),0,n);if(n.parseAllBytes&&i.length()!==0){var m=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw m.byteCount=u,m.remaining=i.length(),m}return h};function c(i,n,u,h){var m;r(i,n,2);var B=i.getByte();n--;var v=B&192,d=B&31;m=i.length();var p=a(i,n);if(n-=m-i.length(),p!==void 0&&p>n){if(h.strict){var C=new Error("Too few bytes to read ASN.1 value.");throw C.available=i.length(),C.remaining=n,C.requested=p,C}p=n}var S,f,g=(B&32)===32;if(g)if(S=[],p===void 0)for(;;){if(r(i,n,2),i.bytes(2)==="\0\0"){i.getBytes(2),n-=2;break}m=i.length(),S.push(c(i,n,u+1,h)),n-=m-i.length()}else for(;p>0;)m=i.length(),S.push(c(i,p,u+1,h)),n-=m-i.length(),p-=m-i.length();if(S===void 0&&v===e.Class.UNIVERSAL&&d===e.Type.BITSTRING&&(f=i.bytes(p)),S===void 0&&h.decodeBitStrings&&v===e.Class.UNIVERSAL&&d===e.Type.BITSTRING&&p>1){var E=i.read,T=n,I=0;if(d===e.Type.BITSTRING&&(r(i,n,1),I=i.getByte(),n--),I===0)try{m=i.length();var x={strict:!0,decodeBitStrings:!0},l=c(i,n,u+1,x),s=m-i.length();n-=s,d==e.Type.BITSTRING&&s++;var w=l.tagClass;s===p&&(w===e.Class.UNIVERSAL||w===e.Class.CONTEXT_SPECIFIC)&&(S=[l])}catch{}S===void 0&&(i.read=E,n=T)}if(S===void 0){if(p===void 0){if(h.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=n}if(d===e.Type.BMPSTRING)for(S="";p>0;p-=2)r(i,n,2),S+=String.fromCharCode(i.getInt16()),n-=2;else S=i.getBytes(p),n-=p}var N=f===void 0?null:{bitStringContents:f};return e.create(v,d,g,S,N)}e.toDer=function(i){var n=t.util.createBuffer(),u=i.tagClass|i.type,h=t.util.createBuffer(),m=!1;if("bitStringContents"in i&&(m=!0,i.original&&(m=e.equals(i,i.original))),m)h.putBytes(i.bitStringContents);else if(i.composed){i.constructed?u|=32:h.putByte(0);for(var B=0;B<i.value.length;++B)i.value[B]!==void 0&&h.putBuffer(e.toDer(i.value[B]))}else if(i.type===e.Type.BMPSTRING)for(var B=0;B<i.value.length;++B)h.putInt16(i.value.charCodeAt(B));else i.type===e.Type.INTEGER&&i.value.length>1&&(i.value.charCodeAt(0)===0&&(i.value.charCodeAt(1)&128)===0||i.value.charCodeAt(0)===255&&(i.value.charCodeAt(1)&128)===128)?h.putBytes(i.value.substr(1)):h.putBytes(i.value);if(n.putByte(u),h.length()<=127)n.putByte(h.length()&127);else{var v=h.length(),d="";do d+=String.fromCharCode(v&255),v=v>>>8;while(v>0);n.putByte(d.length|128);for(var B=d.length-1;B>=0;--B)n.putByte(d.charCodeAt(B))}return n.putBuffer(h),n},e.oidToDer=function(i){var n=i.split("."),u=t.util.createBuffer();u.putByte(40*parseInt(n[0],10)+parseInt(n[1],10));for(var h,m,B,v,d=2;d<n.length;++d){h=!0,m=[],B=parseInt(n[d],10);do v=B&127,B=B>>>7,h||(v|=128),m.push(v),h=!1;while(B>0);for(var p=m.length-1;p>=0;--p)u.putByte(m[p])}return u},e.derToOid=function(i){var n;typeof i=="string"&&(i=t.util.createBuffer(i));var u=i.getByte();n=Math.floor(u/40)+"."+u%40;for(var h=0;i.length()>0;)u=i.getByte(),h=h<<7,u&128?h+=u&127:(n+="."+(h+u),h=0);return n},e.utcTimeToDate=function(i){var n=new Date,u=parseInt(i.substr(0,2),10);u=u>=50?1900+u:2e3+u;var h=parseInt(i.substr(2,2),10)-1,m=parseInt(i.substr(4,2),10),B=parseInt(i.substr(6,2),10),v=parseInt(i.substr(8,2),10),d=0;if(i.length>11){var p=i.charAt(10),C=10;p!=="+"&&p!=="-"&&(d=parseInt(i.substr(10,2),10),C+=2)}if(n.setUTCFullYear(u,h,m),n.setUTCHours(B,v,d,0),C&&(p=i.charAt(C),p==="+"||p==="-")){var S=parseInt(i.substr(C+1,2),10),f=parseInt(i.substr(C+4,2),10),g=S*60+f;g*=6e4,p==="+"?n.setTime(+n-g):n.setTime(+n+g)}return n},e.generalizedTimeToDate=function(i){var n=new Date,u=parseInt(i.substr(0,4),10),h=parseInt(i.substr(4,2),10)-1,m=parseInt(i.substr(6,2),10),B=parseInt(i.substr(8,2),10),v=parseInt(i.substr(10,2),10),d=parseInt(i.substr(12,2),10),p=0,C=0,S=!1;i.charAt(i.length-1)==="Z"&&(S=!0);var f=i.length-5,g=i.charAt(f);if(g==="+"||g==="-"){var E=parseInt(i.substr(f+1,2),10),T=parseInt(i.substr(f+4,2),10);C=E*60+T,C*=6e4,g==="+"&&(C*=-1),S=!0}return i.charAt(14)==="."&&(p=parseFloat(i.substr(14),10)*1e3),S?(n.setUTCFullYear(u,h,m),n.setUTCHours(B,v,d,p),n.setTime(+n+C)):(n.setFullYear(u,h,m),n.setHours(B,v,d,p)),n},e.dateToUtcTime=function(i){if(typeof i=="string")return i;var n="",u=[];u.push((""+i.getUTCFullYear()).substr(2)),u.push(""+(i.getUTCMonth()+1)),u.push(""+i.getUTCDate()),u.push(""+i.getUTCHours()),u.push(""+i.getUTCMinutes()),u.push(""+i.getUTCSeconds());for(var h=0;h<u.length;++h)u[h].length<2&&(n+="0"),n+=u[h];return n+="Z",n},e.dateToGeneralizedTime=function(i){if(typeof i=="string")return i;var n="",u=[];u.push(""+i.getUTCFullYear()),u.push(""+(i.getUTCMonth()+1)),u.push(""+i.getUTCDate()),u.push(""+i.getUTCHours()),u.push(""+i.getUTCMinutes()),u.push(""+i.getUTCSeconds());for(var h=0;h<u.length;++h)u[h].length<2&&(n+="0"),n+=u[h];return n+="Z",n},e.integerToDer=function(i){var n=t.util.createBuffer();if(i>=-128&&i<128)return n.putSignedInt(i,8);if(i>=-32768&&i<32768)return n.putSignedInt(i,16);if(i>=-8388608&&i<8388608)return n.putSignedInt(i,24);if(i>=-2147483648&&i<2147483648)return n.putSignedInt(i,32);var u=new Error("Integer too large; max is 32-bits.");throw u.integer=i,u},e.derToInteger=function(i){typeof i=="string"&&(i=t.util.createBuffer(i));var n=i.length()*8;if(n>32)throw new Error("Integer too large; max is 32-bits.");return i.getSignedInt(n)},e.validate=function(i,n,u,h){var m=!1;if((i.tagClass===n.tagClass||typeof n.tagClass>"u")&&(i.type===n.type||typeof n.type>"u"))if(i.constructed===n.constructed||typeof n.constructed>"u"){if(m=!0,n.value&&t.util.isArray(n.value))for(var B=0,v=0;m&&v<n.value.length;++v)m=n.value[v].optional||!1,i.value[B]&&(m=e.validate(i.value[B],n.value[v],u,h),m?++B:n.value[v].optional&&(m=!0)),!m&&h&&h.push("["+n.name+'] Tag class "'+n.tagClass+'", type "'+n.type+'" expected value length "'+n.value.length+'", got "'+i.value.length+'"');if(m&&u&&(n.capture&&(u[n.capture]=i.value),n.captureAsn1&&(u[n.captureAsn1]=i),n.captureBitStringContents&&"bitStringContents"in i&&(u[n.captureBitStringContents]=i.bitStringContents),n.captureBitStringValue&&"bitStringContents"in i))if(i.bitStringContents.length<2)u[n.captureBitStringValue]="";else{var d=i.bitStringContents.charCodeAt(0);if(d!==0)throw new Error("captureBitStringValue only supported for zero unused bits");u[n.captureBitStringValue]=i.bitStringContents.slice(1)}}else h&&h.push("["+n.name+'] Expected constructed "'+n.constructed+'", got "'+i.constructed+'"');else h&&(i.tagClass!==n.tagClass&&h.push("["+n.name+'] Expected tag class "'+n.tagClass+'", got "'+i.tagClass+'"'),i.type!==n.type&&h.push("["+n.name+'] Expected type "'+n.type+'", got "'+i.type+'"'));return m};var o=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(i,n,u){var h="";n=n||0,u=u||2,n>0&&(h+=`
`);for(var m="",B=0;B<n*u;++B)m+=" ";switch(h+=m+"Tag: ",i.tagClass){case e.Class.UNIVERSAL:h+="Universal:";break;case e.Class.APPLICATION:h+="Application:";break;case e.Class.CONTEXT_SPECIFIC:h+="Context-Specific:";break;case e.Class.PRIVATE:h+="Private:";break}if(i.tagClass===e.Class.UNIVERSAL)switch(h+=i.type,i.type){case e.Type.NONE:h+=" (None)";break;case e.Type.BOOLEAN:h+=" (Boolean)";break;case e.Type.INTEGER:h+=" (Integer)";break;case e.Type.BITSTRING:h+=" (Bit string)";break;case e.Type.OCTETSTRING:h+=" (Octet string)";break;case e.Type.NULL:h+=" (Null)";break;case e.Type.OID:h+=" (Object Identifier)";break;case e.Type.ODESC:h+=" (Object Descriptor)";break;case e.Type.EXTERNAL:h+=" (External or Instance of)";break;case e.Type.REAL:h+=" (Real)";break;case e.Type.ENUMERATED:h+=" (Enumerated)";break;case e.Type.EMBEDDED:h+=" (Embedded PDV)";break;case e.Type.UTF8:h+=" (UTF8)";break;case e.Type.ROID:h+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:h+=" (Sequence)";break;case e.Type.SET:h+=" (Set)";break;case e.Type.PRINTABLESTRING:h+=" (Printable String)";break;case e.Type.IA5String:h+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:h+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:h+=" (Generalized time)";break;case e.Type.BMPSTRING:h+=" (BMP String)";break}else h+=i.type;if(h+=`
`,h+=m+"Constructed: "+i.constructed+`
`,i.composed){for(var v=0,d="",B=0;B<i.value.length;++B)i.value[B]!==void 0&&(v+=1,d+=e.prettyPrint(i.value[B],n+1,u),B+1<i.value.length&&(d+=","));h+=m+"Sub values: "+v+d}else{if(h+=m+"Value: ",i.type===e.Type.OID){var p=e.derToOid(i.value);h+=p,t.pki&&t.pki.oids&&p in t.pki.oids&&(h+=" ("+t.pki.oids[p]+") ")}if(i.type===e.Type.INTEGER)try{h+=e.derToInteger(i.value)}catch{h+="0x"+t.util.bytesToHex(i.value)}else if(i.type===e.Type.BITSTRING){if(i.value.length>1?h+="0x"+t.util.bytesToHex(i.value.slice(1)):h+="(none)",i.value.length>0){var C=i.value.charCodeAt(0);C==1?h+=" (1 unused bit shown)":C>1&&(h+=" ("+C+" unused bits shown)")}}else if(i.type===e.Type.OCTETSTRING)o.test(i.value)||(h+="("+i.value+") "),h+="0x"+t.util.bytesToHex(i.value);else if(i.type===e.Type.UTF8)try{h+=t.util.decodeUtf8(i.value)}catch(S){if(S.message==="URI malformed")h+="0x"+t.util.bytesToHex(i.value)+" (malformed UTF8)";else throw S}else i.type===e.Type.PRINTABLESTRING||i.type===e.Type.IA5String?h+=i.value:o.test(i.value)?h+="0x"+t.util.bytesToHex(i.value):i.value.length===0?h+="[null]":h+=i.value}return h},qn.exports}var $n={exports:{}},zn,Ni;function qt(){if(Ni)return zn;Ni=1;var t=ge();return zn=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},zn}var Li;function Hr(){if(Li)return $n.exports;Li=1;var t=ge();qt(),Ee();var e=$n.exports=t.hmac=t.hmac||{};return e.create=function(){var r=null,a=null,c=null,o=null,i={};return i.start=function(n,u){if(n!==null)if(typeof n=="string")if(n=n.toLowerCase(),n in t.md.algorithms)a=t.md.algorithms[n].create();else throw new Error('Unknown hash algorithm "'+n+'"');else a=n;if(u===null)u=r;else{if(typeof u=="string")u=t.util.createBuffer(u);else if(t.util.isArray(u)){var h=u;u=t.util.createBuffer();for(var m=0;m<h.length;++m)u.putByte(h[m])}var B=u.length();B>a.blockLength&&(a.start(),a.update(u.bytes()),u=a.digest()),c=t.util.createBuffer(),o=t.util.createBuffer(),B=u.length();for(var m=0;m<B;++m){var h=u.at(m);c.putByte(54^h),o.putByte(92^h)}if(B<a.blockLength)for(var h=a.blockLength-B,m=0;m<h;++m)c.putByte(54),o.putByte(92);r=u,c=c.bytes(),o=o.bytes()}a.start(),a.update(c)},i.update=function(n){a.update(n)},i.getMac=function(){var n=a.digest().bytes();return a.start(),a.update(o),a.update(n),a.digest()},i.digest=i.getMac,i},$n.exports}var Yn={exports:{}},ki;function za(){if(ki)return Yn.exports;ki=1;var t=ge();qt(),Ee();var e=Yn.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){i||n();var h=null,m=t.util.createBuffer(),B=new Array(16),v={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return v.start=function(){v.messageLength=0,v.fullMessageLength=v.messageLength64=[];for(var d=v.messageLengthSize/4,p=0;p<d;++p)v.fullMessageLength.push(0);return m=t.util.createBuffer(),h={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},v},v.start(),v.update=function(d,p){p==="utf8"&&(d=t.util.encodeUtf8(d));var C=d.length;v.messageLength+=C,C=[C/4294967296>>>0,C>>>0];for(var S=v.fullMessageLength.length-1;S>=0;--S)v.fullMessageLength[S]+=C[1],C[1]=C[0]+(v.fullMessageLength[S]/4294967296>>>0),v.fullMessageLength[S]=v.fullMessageLength[S]>>>0,C[0]=C[1]/4294967296>>>0;return m.putBytes(d),u(h,B,m),(m.read>2048||m.length()===0)&&m.compact(),v},v.digest=function(){var d=t.util.createBuffer();d.putBytes(m.bytes());var p=v.fullMessageLength[v.fullMessageLength.length-1]+v.messageLengthSize,C=p&v.blockLength-1;d.putBytes(r.substr(0,v.blockLength-C));for(var S,f=0,g=v.fullMessageLength.length-1;g>=0;--g)S=v.fullMessageLength[g]*8+f,f=S/4294967296>>>0,d.putInt32Le(S>>>0);var E={h0:h.h0,h1:h.h1,h2:h.h2,h3:h.h3};u(E,B,d);var T=t.util.createBuffer();return T.putInt32Le(E.h0),T.putInt32Le(E.h1),T.putInt32Le(E.h2),T.putInt32Le(E.h3),T},v};var r=null,a=null,c=null,o=null,i=!1;function n(){r="",r+=t.util.fillString("\0",64),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],c=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],o=new Array(64);for(var h=0;h<64;++h)o[h]=Math.floor(Math.abs(Math.sin(h+1))*4294967296);i=!0}function u(h,m,B){for(var v,d,p,C,S,f,g,E,T=B.length();T>=64;){for(d=h.h0,p=h.h1,C=h.h2,S=h.h3,E=0;E<16;++E)m[E]=B.getInt32Le(),f=S^p&(C^S),v=d+f+o[E]+m[E],g=c[E],d=S,S=C,C=p,p+=v<<g|v>>>32-g;for(;E<32;++E)f=C^S&(p^C),v=d+f+o[E]+m[a[E]],g=c[E],d=S,S=C,C=p,p+=v<<g|v>>>32-g;for(;E<48;++E)f=p^C^S,v=d+f+o[E]+m[a[E]],g=c[E],d=S,S=C,C=p,p+=v<<g|v>>>32-g;for(;E<64;++E)f=C^(p|~S),v=d+f+o[E]+m[a[E]],g=c[E],d=S,S=C,C=p,p+=v<<g|v>>>32-g;h.h0=h.h0+d|0,h.h1=h.h1+p|0,h.h2=h.h2+C|0,h.h3=h.h3+S|0,T-=64}}return Yn.exports}var Qn={exports:{}},Ui;function Cr(){if(Ui)return Qn.exports;Ui=1;var t=ge();Ee();var e=Qn.exports=t.pem=t.pem||{};e.encode=function(c,o){o=o||{};var i="-----BEGIN "+c.type+`-----\r
`,n;if(c.procType&&(n={name:"Proc-Type",values:[String(c.procType.version),c.procType.type]},i+=r(n)),c.contentDomain&&(n={name:"Content-Domain",values:[c.contentDomain]},i+=r(n)),c.dekInfo&&(n={name:"DEK-Info",values:[c.dekInfo.algorithm]},c.dekInfo.parameters&&n.values.push(c.dekInfo.parameters),i+=r(n)),c.headers)for(var u=0;u<c.headers.length;++u)i+=r(c.headers[u]);return c.procType&&(i+=`\r
`),i+=t.util.encode64(c.body,o.maxline||64)+`\r
`,i+="-----END "+c.type+`-----\r
`,i},e.decode=function(c){for(var o=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,u=/\r?\n/,h;h=i.exec(c),!!h;){var m=h[1];m==="NEW CERTIFICATE REQUEST"&&(m="CERTIFICATE REQUEST");var B={type:m,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(h[3])};if(o.push(B),!!h[2]){for(var v=h[2].split(u),d=0;h&&d<v.length;){for(var p=v[d].replace(/\s+$/,""),C=d+1;C<v.length;++C){var S=v[C];if(!/\s/.test(S[0]))break;p+=S,d=C}if(h=p.match(n),h){for(var f={name:h[1],values:[]},g=h[2].split(","),E=0;E<g.length;++E)f.values.push(a(g[E]));if(B.procType)if(!B.contentDomain&&f.name==="Content-Domain")B.contentDomain=g[0]||"";else if(!B.dekInfo&&f.name==="DEK-Info"){if(f.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');B.dekInfo={algorithm:g[0],parameters:g[1]||null}}else B.headers.push(f);else{if(f.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(f.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');B.procType={version:g[0],type:g[1]}}}++d}if(B.procType==="ENCRYPTED"&&!B.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(o.length===0)throw new Error("Invalid PEM formatted message.");return o};function r(c){for(var o=c.name+": ",i=[],n=function(v,d){return" "+d},u=0;u<c.values.length;++u)i.push(c.values[u].replace(/^(\S+\r\n)/,n));o+=i.join(",")+`\r
`;for(var h=0,m=-1,u=0;u<o.length;++u,++h)if(h>65&&m!==-1){var B=o[m];B===","?(++m,o=o.substr(0,m)+`\r
 `+o.substr(m)):o=o.substr(0,m)+`\r
`+B+o.substr(m+1),h=u-m-1,m=-1,++u}else(o[u]===" "||o[u]==="	"||o[u]===",")&&(m=u);return o}function a(c){return c.replace(/^\s+/,"")}return Qn.exports}var Xn={exports:{}},jn,Di;function Cn(){if(Di)return jn;Di=1;var t=ge();$a(),Co(),Ee(),jn=t.des=t.des||{},t.des.startEncrypting=function(d,p,C,S){var f=v({key:d,output:C,decrypt:!1,mode:S||(p===null?"ECB":"CBC")});return f.start(p),f},t.des.createEncryptionCipher=function(d,p){return v({key:d,output:null,decrypt:!1,mode:p})},t.des.startDecrypting=function(d,p,C,S){var f=v({key:d,output:C,decrypt:!0,mode:S||(p===null?"ECB":"CBC")});return f.start(p),f},t.des.createDecryptionCipher=function(d,p){return v({key:d,output:null,decrypt:!0,mode:p})},t.des.Algorithm=function(d,p){var C=this;C.name=d,C.mode=new p({blockSize:8,cipher:{encrypt:function(S,f){return B(C._keys,S,f,!1)},decrypt:function(S,f){return B(C._keys,S,f,!0)}}}),C._init=!1},t.des.Algorithm.prototype.initialize=function(d){if(!this._init){var p=t.util.createBuffer(d.key);if(this.name.indexOf("3DES")===0&&p.length()!==24)throw new Error("Invalid Triple-DES key size: "+p.length()*8);this._keys=m(p),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(d,p){var C=function(){return new t.des.Algorithm(d,p)};t.cipher.registerAlgorithm(d,C)}var r=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],a=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],o=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],i=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],n=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],u=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],h=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function m(d){for(var p=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],C=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],S=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],f=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],g=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],E=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],T=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],I=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],x=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],s=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],w=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],N=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],O=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],_=d.length()>8?3:1,D=[],V=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],P=0,M,q=0;q<_;q++){var z=d.getInt32(),G=d.getInt32();M=(z>>>4^G)&252645135,G^=M,z^=M<<4,M=(G>>>-16^z)&65535,z^=M,G^=M<<-16,M=(z>>>2^G)&858993459,G^=M,z^=M<<2,M=(G>>>-16^z)&65535,z^=M,G^=M<<-16,M=(z>>>1^G)&1431655765,G^=M,z^=M<<1,M=(G>>>8^z)&16711935,z^=M,G^=M<<8,M=(z>>>1^G)&1431655765,G^=M,z^=M<<1,M=z<<8|G>>>20&240,z=G<<24|G<<8&16711680|G>>>8&65280|G>>>24&240,G=M;for(var Y=0;Y<V.length;++Y){V[Y]?(z=z<<2|z>>>26,G=G<<2|G>>>26):(z=z<<1|z>>>27,G=G<<1|G>>>27),z&=-15,G&=-15;var j=p[z>>>28]|C[z>>>24&15]|S[z>>>20&15]|f[z>>>16&15]|g[z>>>12&15]|E[z>>>8&15]|T[z>>>4&15],te=I[G>>>28]|x[G>>>24&15]|l[G>>>20&15]|s[G>>>16&15]|w[G>>>12&15]|N[G>>>8&15]|O[G>>>4&15];M=(te>>>16^j)&65535,D[P++]=j^M,D[P++]=te^M<<16}}return D}function B(d,p,C,S){var f=d.length===32?3:9,g;f===3?g=S?[30,-2,-2]:[0,32,2]:g=S?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var E,T=p[0],I=p[1];E=(T>>>4^I)&252645135,I^=E,T^=E<<4,E=(T>>>16^I)&65535,I^=E,T^=E<<16,E=(I>>>2^T)&858993459,T^=E,I^=E<<2,E=(I>>>8^T)&16711935,T^=E,I^=E<<8,E=(T>>>1^I)&1431655765,I^=E,T^=E<<1,T=T<<1|T>>>31,I=I<<1|I>>>31;for(var x=0;x<f;x+=3){for(var l=g[x+1],s=g[x+2],w=g[x];w!=l;w+=s){var N=I^d[w],O=(I>>>4|I<<28)^d[w+1];E=T,T=I,I=E^(a[N>>>24&63]|o[N>>>16&63]|n[N>>>8&63]|h[N&63]|r[O>>>24&63]|c[O>>>16&63]|i[O>>>8&63]|u[O&63])}E=T,T=I,I=E}T=T>>>1|T<<31,I=I>>>1|I<<31,E=(T>>>1^I)&1431655765,I^=E,T^=E<<1,E=(I>>>8^T)&16711935,T^=E,I^=E<<8,E=(I>>>2^T)&858993459,T^=E,I^=E<<2,E=(T>>>16^I)&65535,I^=E,T^=E<<16,E=(T>>>4^I)&252645135,I^=E,T^=E<<4,C[0]=T,C[1]=I}function v(d){d=d||{};var p=(d.mode||"CBC").toUpperCase(),C="DES-"+p,S;d.decrypt?S=t.cipher.createDecipher(C,d.key):S=t.cipher.createCipher(C,d.key);var f=S.start;return S.start=function(g,E){var T=null;E instanceof t.util.ByteBuffer&&(T=E,E={}),E=E||{},E.output=T,E.iv=g,f.call(S,E)},S}return jn}const wu={},_t=Object.freeze(Object.defineProperty({__proto__:null,default:wu},Symbol.toStringTag,{value:"Module"})),Ya=bu(_t);var Zn,Pi;function Qa(){if(Pi)return Zn;Pi=1;var t=ge();Hr(),qt(),Ee();var e=t.pkcs5=t.pkcs5||{},r;return t.util.isNodejs&&!t.options.usePureJavaScript&&(r=Ya),Zn=t.pbkdf2=e.pbkdf2=function(a,c,o,i,n,u){if(typeof n=="function"&&(u=n,n=null),t.util.isNodejs&&!t.options.usePureJavaScript&&r.pbkdf2&&(n===null||typeof n!="object")&&(r.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),a=Buffer.from(a,"binary"),c=Buffer.from(c,"binary"),u?r.pbkdf2Sync.length===4?r.pbkdf2(a,c,o,i,function(x,l){if(x)return u(x);u(null,l.toString("binary"))}):r.pbkdf2(a,c,o,i,n,function(x,l){if(x)return u(x);u(null,l.toString("binary"))}):r.pbkdf2Sync.length===4?r.pbkdf2Sync(a,c,o,i).toString("binary"):r.pbkdf2Sync(a,c,o,i,n).toString("binary");if((typeof n>"u"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in t.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=t.md[n].create()}var h=n.digestLength;if(i>4294967295*h){var m=new Error("Derived key is too long.");if(u)return u(m);throw m}var B=Math.ceil(i/h),v=i-(B-1)*h,d=t.hmac.create();d.start(n,a);var p="",C,S,f;if(!u){for(var g=1;g<=B;++g){d.start(null,null),d.update(c),d.update(t.util.int32ToBytes(g)),C=f=d.digest().getBytes();for(var E=2;E<=o;++E)d.start(null,null),d.update(f),S=d.digest().getBytes(),C=t.util.xorBytes(C,S,h),f=S;p+=g<B?C:C.substr(0,v)}return p}var g=1,E;function T(){if(g>B)return u(null,p);d.start(null,null),d.update(c),d.update(t.util.int32ToBytes(g)),C=f=d.digest().getBytes(),E=2,I()}function I(){if(E<=o)return d.start(null,null),d.update(f),S=d.digest().getBytes(),C=t.util.xorBytes(C,S,h),f=S,++E,t.util.setImmediate(I);p+=g<B?C:C.substr(0,v),++g,T()}T()},Zn}var jr={exports:{}},Wn={exports:{}},Oi;function bo(){if(Oi)return Wn.exports;Oi=1;var t=ge();qt(),Ee();var e=Wn.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){a||o();var n=null,u=t.util.createBuffer(),h=new Array(64),m={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return m.start=function(){m.messageLength=0,m.fullMessageLength=m.messageLength64=[];for(var B=m.messageLengthSize/4,v=0;v<B;++v)m.fullMessageLength.push(0);return u=t.util.createBuffer(),n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},m},m.start(),m.update=function(B,v){v==="utf8"&&(B=t.util.encodeUtf8(B));var d=B.length;m.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var p=m.fullMessageLength.length-1;p>=0;--p)m.fullMessageLength[p]+=d[1],d[1]=d[0]+(m.fullMessageLength[p]/4294967296>>>0),m.fullMessageLength[p]=m.fullMessageLength[p]>>>0,d[0]=d[1]/4294967296>>>0;return u.putBytes(B),i(n,h,u),(u.read>2048||u.length()===0)&&u.compact(),m},m.digest=function(){var B=t.util.createBuffer();B.putBytes(u.bytes());var v=m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize,d=v&m.blockLength-1;B.putBytes(r.substr(0,m.blockLength-d));for(var p,C,S=m.fullMessageLength[0]*8,f=0;f<m.fullMessageLength.length-1;++f)p=m.fullMessageLength[f+1]*8,C=p/4294967296>>>0,S+=C,B.putInt32(S>>>0),S=p>>>0;B.putInt32(S);var g={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};i(g,h,B);var E=t.util.createBuffer();return E.putInt32(g.h0),E.putInt32(g.h1),E.putInt32(g.h2),E.putInt32(g.h3),E.putInt32(g.h4),E.putInt32(g.h5),E.putInt32(g.h6),E.putInt32(g.h7),E},m};var r=null,a=!1,c=null;function o(){r="",r+=t.util.fillString("\0",64),c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=!0}function i(n,u,h){for(var m,B,v,d,p,C,S,f,g,E,T,I,x,l,s,w=h.length();w>=64;){for(S=0;S<16;++S)u[S]=h.getInt32();for(;S<64;++S)m=u[S-2],m=(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10,B=u[S-15],B=(B>>>7|B<<25)^(B>>>18|B<<14)^B>>>3,u[S]=m+u[S-7]+B+u[S-16]|0;for(f=n.h0,g=n.h1,E=n.h2,T=n.h3,I=n.h4,x=n.h5,l=n.h6,s=n.h7,S=0;S<64;++S)d=(I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7),p=l^I&(x^l),v=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),C=f&g|E&(f^g),m=s+d+p+c[S]+u[S],B=v+C,s=l,l=x,x=I,I=T+m>>>0,T=E,E=g,g=f,f=m+B>>>0;n.h0=n.h0+f|0,n.h1=n.h1+g|0,n.h2=n.h2+E|0,n.h3=n.h3+T|0,n.h4=n.h4+I|0,n.h5=n.h5+x|0,n.h6=n.h6+l|0,n.h7=n.h7+s|0,w-=64}}return Wn.exports}var Jn={exports:{}},Ki;function Bo(){if(Ki)return Jn.exports;Ki=1;var t=ge();Ee();var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=Ya);var r=Jn.exports=t.prng=t.prng||{};return r.create=function(a){for(var c={plugin:a,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},o=a.md,i=new Array(32),n=0;n<32;++n)i[n]=o.create();c.pools=i,c.pool=0,c.generate=function(v,d){if(!d)return c.generateSync(v);var p=c.plugin.cipher,C=c.plugin.increment,S=c.plugin.formatKey,f=c.plugin.formatSeed,g=t.util.createBuffer();c.key=null,E();function E(T){if(T)return d(T);if(g.length()>=v)return d(null,g.getBytes(v));if(c.generated>1048575&&(c.key=null),c.key===null)return t.util.nextTick(function(){u(E)});var I=p(c.key,c.seed);c.generated+=I.length,g.putBytes(I),c.key=S(p(c.key,C(c.seed))),c.seed=f(p(c.key,c.seed)),t.util.setImmediate(E)}},c.generateSync=function(v){var d=c.plugin.cipher,p=c.plugin.increment,C=c.plugin.formatKey,S=c.plugin.formatSeed;c.key=null;for(var f=t.util.createBuffer();f.length()<v;){c.generated>1048575&&(c.key=null),c.key===null&&h();var g=d(c.key,c.seed);c.generated+=g.length,f.putBytes(g),c.key=C(d(c.key,p(c.seed))),c.seed=S(d(c.key,c.seed))}return f.getBytes(v)};function u(v){if(c.pools[0].messageLength>=32)return m(),v();var d=32-c.pools[0].messageLength<<5;c.seedFile(d,function(p,C){if(p)return v(p);c.collect(C),m(),v()})}function h(){if(c.pools[0].messageLength>=32)return m();var v=32-c.pools[0].messageLength<<5;c.collect(c.seedFileSync(v)),m()}function m(){c.reseeds=c.reseeds===4294967295?0:c.reseeds+1;var v=c.plugin.md.create();v.update(c.keyBytes);for(var d=1,p=0;p<32;++p)c.reseeds%d===0&&(v.update(c.pools[p].digest().getBytes()),c.pools[p].start()),d=d<<1;c.keyBytes=v.digest().getBytes(),v.start(),v.update(c.keyBytes);var C=v.digest().getBytes();c.key=c.plugin.formatKey(c.keyBytes),c.seed=c.plugin.formatSeed(C),c.generated=0}function B(v){var d=null,p=t.util.globalScope,C=p.crypto||p.msCrypto;C&&C.getRandomValues&&(d=function(s){return C.getRandomValues(s)});var S=t.util.createBuffer();if(d)for(;S.length()<v;){var f=Math.max(1,Math.min(v-S.length(),65536)/4),g=new Uint32Array(Math.floor(f));try{d(g);for(var E=0;E<g.length;++E)S.putInt32(g[E])}catch(s){if(!(typeof QuotaExceededError<"u"&&s instanceof QuotaExceededError))throw s}}if(S.length()<v)for(var T,I,x,l=Math.floor(Math.random()*65536);S.length()<v;){I=16807*(l&65535),T=16807*(l>>16),I+=(T&32767)<<16,I+=T>>15,I=(I&2147483647)+(I>>31),l=I&4294967295;for(var E=0;E<3;++E)x=l>>>(E<<3),x^=Math.floor(Math.random()*256),S.putByte(x&255)}return S.getBytes(v)}return e?(c.seedFile=function(v,d){e.randomBytes(v,function(p,C){if(p)return d(p);d(null,C.toString())})},c.seedFileSync=function(v){return e.randomBytes(v).toString()}):(c.seedFile=function(v,d){try{d(null,B(v))}catch(p){d(p)}},c.seedFileSync=B),c.collect=function(v){for(var d=v.length,p=0;p<d;++p)c.pools[c.pool].update(v.substr(p,1)),c.pool=c.pool===31?0:c.pool+1},c.collectInt=function(v,d){for(var p="",C=0;C<d;C+=8)p+=String.fromCharCode(v>>C&255);c.collect(p)},c.registerWorker=function(v){if(v===self)c.seedFile=function(p,C){function S(f){var g=f.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",S),C(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",S),self.postMessage({forge:{prng:{needed:p}}})};else{var d=function(p){var C=p.data;C.forge&&C.forge.prng&&c.seedFile(C.forge.prng.needed,function(S,f){v.postMessage({forge:{prng:{err:S,bytes:f}}})})};v.addEventListener("message",d)}},c},Jn.exports}var Vi;function Bt(){if(Vi)return jr.exports;Vi=1;var t=ge();return hr(),bo(),Bo(),Ee(),(function(){if(t.random&&t.random.getBytes){jr.exports=t.random;return}(function(e){var r={},a=new Array(4),c=t.util.createBuffer();r.formatKey=function(v){var d=t.util.createBuffer(v);return v=new Array(4),v[0]=d.getInt32(),v[1]=d.getInt32(),v[2]=d.getInt32(),v[3]=d.getInt32(),t.aes._expandKey(v,!1)},r.formatSeed=function(v){var d=t.util.createBuffer(v);return v=new Array(4),v[0]=d.getInt32(),v[1]=d.getInt32(),v[2]=d.getInt32(),v[3]=d.getInt32(),v},r.cipher=function(v,d){return t.aes._updateBlock(v,d,a,!1),c.putInt32(a[0]),c.putInt32(a[1]),c.putInt32(a[2]),c.putInt32(a[3]),c.getBytes()},r.increment=function(v){return++v[3],v},r.md=t.md.sha256;function o(){var v=t.prng.create(r);return v.getBytes=function(d,p){return v.generate(d,p)},v.getBytesSync=function(d){return v.generate(d)},v}var i=o(),n=null,u=t.util.globalScope,h=u.crypto||u.msCrypto;if(h&&h.getRandomValues&&(n=function(v){return h.getRandomValues(v)}),t.options.usePureJavaScript||!t.util.isNodejs&&!n){if(i.collectInt(+new Date,32),typeof navigator<"u"){var m="";for(var B in navigator)try{typeof navigator[B]=="string"&&(m+=navigator[B])}catch{}i.collect(m),m=null}e&&(e().mousemove(function(v){i.collectInt(v.clientX,16),i.collectInt(v.clientY,16)}),e().keypress(function(v){i.collectInt(v.charCode,8)}))}if(!t.random)t.random=i;else for(var B in i)t.random[B]=i[B];t.random.createInstance=o,jr.exports=t.random})(typeof jQuery<"u"?jQuery:null)})(),jr.exports}var ea,Fi;function wo(){if(Fi)return ea;Fi=1;var t=ge();Ee();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],a=function(i,n){return i<<n&65535|(i&65535)>>16-n},c=function(i,n){return(i&65535)>>n|i<<16-n&65535};ea=t.rc2=t.rc2||{},t.rc2.expandKey=function(i,n){typeof i=="string"&&(i=t.util.createBuffer(i)),n=n||128;var u=i,h=i.length(),m=n,B=Math.ceil(m/8),v=255>>(m&7),d;for(d=h;d<128;d++)u.putByte(e[u.at(d-1)+u.at(d-h)&255]);for(u.setAt(128-B,e[u.at(128-B)&v]),d=127-B;d>=0;d--)u.setAt(d,e[u.at(d+1)^u.at(d+B)]);return u};var o=function(i,n,u){var h=!1,m=null,B=null,v=null,d,p,C,S,f=[];for(i=t.rc2.expandKey(i,n),C=0;C<64;C++)f.push(i.getInt16Le());u?(d=function(T){for(C=0;C<4;C++)T[C]+=f[S]+(T[(C+3)%4]&T[(C+2)%4])+(~T[(C+3)%4]&T[(C+1)%4]),T[C]=a(T[C],r[C]),S++},p=function(T){for(C=0;C<4;C++)T[C]+=f[T[(C+3)%4]&63]}):(d=function(T){for(C=3;C>=0;C--)T[C]=c(T[C],r[C]),T[C]-=f[S]+(T[(C+3)%4]&T[(C+2)%4])+(~T[(C+3)%4]&T[(C+1)%4]),S--},p=function(T){for(C=3;C>=0;C--)T[C]-=f[T[(C+3)%4]&63]});var g=function(T){var I=[];for(C=0;C<4;C++){var x=m.getInt16Le();v!==null&&(u?x^=v.getInt16Le():v.putInt16Le(x)),I.push(x&65535)}S=u?0:63;for(var l=0;l<T.length;l++)for(var s=0;s<T[l][0];s++)T[l][1](I);for(C=0;C<4;C++)v!==null&&(u?v.putInt16Le(I[C]):I[C]^=v.getInt16Le()),B.putInt16Le(I[C])},E=null;return E={start:function(T,I){T&&typeof T=="string"&&(T=t.util.createBuffer(T)),h=!1,m=t.util.createBuffer(),B=I||new t.util.createBuffer,v=T,E.output=B},update:function(T){for(h||m.putBuffer(T);m.length()>=8;)g([[5,d],[1,p],[6,d],[1,p],[5,d]])},finish:function(T){var I=!0;if(u)if(T)I=T(8,m,!u);else{var x=m.length()===8?8:8-m.length();m.fillWithByte(x,x)}if(I&&(h=!0,E.update()),!u&&(I=m.length()===0,I))if(T)I=T(8,B,!u);else{var l=B.length(),s=B.at(l-1);s>l?I=!1:B.truncate(s)}return I}},E};return t.rc2.startEncrypting=function(i,n,u){var h=t.rc2.createEncryptionCipher(i,128);return h.start(n,u),h},t.rc2.createEncryptionCipher=function(i,n){return o(i,n,!0)},t.rc2.startDecrypting=function(i,n,u){var h=t.rc2.createDecryptionCipher(i,128);return h.start(n,u),h},t.rc2.createDecryptionCipher=function(i,n){return o(i,n,!1)},ea}var ta,Mi;function bn(){if(Mi)return ta;Mi=1;var t=ge();ta=t.jsbn=t.jsbn||{};var e;function r(A,L,K){this.data=[],A!=null&&(typeof A=="number"?this.fromNumber(A,L,K):L==null&&typeof A!="string"?this.fromString(A,256):this.fromString(A,L))}t.jsbn.BigInteger=r;function a(){return new r(null)}function c(A,L,K,$,Z,ee){for(;--ee>=0;){var oe=L*this.data[A++]+K.data[$]+Z;Z=Math.floor(oe/67108864),K.data[$++]=oe&67108863}return Z}function o(A,L,K,$,Z,ee){for(var oe=L&32767,ne=L>>15;--ee>=0;){var xe=this.data[A]&32767,Qe=this.data[A++]>>15,yt=ne*xe+Qe*oe;xe=oe*xe+((yt&32767)<<15)+K.data[$]+(Z&1073741823),Z=(xe>>>30)+(yt>>>15)+ne*Qe+(Z>>>30),K.data[$++]=xe&1073741823}return Z}function i(A,L,K,$,Z,ee){for(var oe=L&16383,ne=L>>14;--ee>=0;){var xe=this.data[A]&16383,Qe=this.data[A++]>>14,yt=ne*xe+Qe*oe;xe=oe*xe+((yt&16383)<<14)+K.data[$]+Z,Z=(xe>>28)+(yt>>14)+ne*Qe,K.data[$++]=xe&268435455}return Z}typeof navigator>"u"?(r.prototype.am=i,e=28):navigator.appName=="Microsoft Internet Explorer"?(r.prototype.am=o,e=30):navigator.appName!="Netscape"?(r.prototype.am=c,e=26):(r.prototype.am=i,e=28),r.prototype.DB=e,r.prototype.DM=(1<<e)-1,r.prototype.DV=1<<e;var n=52;r.prototype.FV=Math.pow(2,n),r.prototype.F1=n-e,r.prototype.F2=2*e-n;var u="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array,m,B;for(m=48,B=0;B<=9;++B)h[m++]=B;for(m=97,B=10;B<36;++B)h[m++]=B;for(m=65,B=10;B<36;++B)h[m++]=B;function v(A){return u.charAt(A)}function d(A,L){var K=h[A.charCodeAt(L)];return K??-1}function p(A){for(var L=this.t-1;L>=0;--L)A.data[L]=this.data[L];A.t=this.t,A.s=this.s}function C(A){this.t=1,this.s=A<0?-1:0,A>0?this.data[0]=A:A<-1?this.data[0]=A+this.DV:this.t=0}function S(A){var L=a();return L.fromInt(A),L}function f(A,L){var K;if(L==16)K=4;else if(L==8)K=3;else if(L==256)K=8;else if(L==2)K=1;else if(L==32)K=5;else if(L==4)K=2;else{this.fromRadix(A,L);return}this.t=0,this.s=0;for(var $=A.length,Z=!1,ee=0;--$>=0;){var oe=K==8?A[$]&255:d(A,$);if(oe<0){A.charAt($)=="-"&&(Z=!0);continue}Z=!1,ee==0?this.data[this.t++]=oe:ee+K>this.DB?(this.data[this.t-1]|=(oe&(1<<this.DB-ee)-1)<<ee,this.data[this.t++]=oe>>this.DB-ee):this.data[this.t-1]|=oe<<ee,ee+=K,ee>=this.DB&&(ee-=this.DB)}K==8&&(A[0]&128)!=0&&(this.s=-1,ee>0&&(this.data[this.t-1]|=(1<<this.DB-ee)-1<<ee)),this.clamp(),Z&&r.ZERO.subTo(this,this)}function g(){for(var A=this.s&this.DM;this.t>0&&this.data[this.t-1]==A;)--this.t}function E(A){if(this.s<0)return"-"+this.negate().toString(A);var L;if(A==16)L=4;else if(A==8)L=3;else if(A==2)L=1;else if(A==32)L=5;else if(A==4)L=2;else return this.toRadix(A);var K=(1<<L)-1,$,Z=!1,ee="",oe=this.t,ne=this.DB-oe*this.DB%L;if(oe-- >0)for(ne<this.DB&&($=this.data[oe]>>ne)>0&&(Z=!0,ee=v($));oe>=0;)ne<L?($=(this.data[oe]&(1<<ne)-1)<<L-ne,$|=this.data[--oe]>>(ne+=this.DB-L)):($=this.data[oe]>>(ne-=L)&K,ne<=0&&(ne+=this.DB,--oe)),$>0&&(Z=!0),Z&&(ee+=v($));return Z?ee:"0"}function T(){var A=a();return r.ZERO.subTo(this,A),A}function I(){return this.s<0?this.negate():this}function x(A){var L=this.s-A.s;if(L!=0)return L;var K=this.t;if(L=K-A.t,L!=0)return this.s<0?-L:L;for(;--K>=0;)if((L=this.data[K]-A.data[K])!=0)return L;return 0}function l(A){var L=1,K;return(K=A>>>16)!=0&&(A=K,L+=16),(K=A>>8)!=0&&(A=K,L+=8),(K=A>>4)!=0&&(A=K,L+=4),(K=A>>2)!=0&&(A=K,L+=2),(K=A>>1)!=0&&(A=K,L+=1),L}function s(){return this.t<=0?0:this.DB*(this.t-1)+l(this.data[this.t-1]^this.s&this.DM)}function w(A,L){var K;for(K=this.t-1;K>=0;--K)L.data[K+A]=this.data[K];for(K=A-1;K>=0;--K)L.data[K]=0;L.t=this.t+A,L.s=this.s}function N(A,L){for(var K=A;K<this.t;++K)L.data[K-A]=this.data[K];L.t=Math.max(this.t-A,0),L.s=this.s}function O(A,L){var K=A%this.DB,$=this.DB-K,Z=(1<<$)-1,ee=Math.floor(A/this.DB),oe=this.s<<K&this.DM,ne;for(ne=this.t-1;ne>=0;--ne)L.data[ne+ee+1]=this.data[ne]>>$|oe,oe=(this.data[ne]&Z)<<K;for(ne=ee-1;ne>=0;--ne)L.data[ne]=0;L.data[ee]=oe,L.t=this.t+ee+1,L.s=this.s,L.clamp()}function _(A,L){L.s=this.s;var K=Math.floor(A/this.DB);if(K>=this.t){L.t=0;return}var $=A%this.DB,Z=this.DB-$,ee=(1<<$)-1;L.data[0]=this.data[K]>>$;for(var oe=K+1;oe<this.t;++oe)L.data[oe-K-1]|=(this.data[oe]&ee)<<Z,L.data[oe-K]=this.data[oe]>>$;$>0&&(L.data[this.t-K-1]|=(this.s&ee)<<Z),L.t=this.t-K,L.clamp()}function D(A,L){for(var K=0,$=0,Z=Math.min(A.t,this.t);K<Z;)$+=this.data[K]-A.data[K],L.data[K++]=$&this.DM,$>>=this.DB;if(A.t<this.t){for($-=A.s;K<this.t;)$+=this.data[K],L.data[K++]=$&this.DM,$>>=this.DB;$+=this.s}else{for($+=this.s;K<A.t;)$-=A.data[K],L.data[K++]=$&this.DM,$>>=this.DB;$-=A.s}L.s=$<0?-1:0,$<-1?L.data[K++]=this.DV+$:$>0&&(L.data[K++]=$),L.t=K,L.clamp()}function V(A,L){var K=this.abs(),$=A.abs(),Z=K.t;for(L.t=Z+$.t;--Z>=0;)L.data[Z]=0;for(Z=0;Z<$.t;++Z)L.data[Z+K.t]=K.am(0,$.data[Z],L,Z,0,K.t);L.s=0,L.clamp(),this.s!=A.s&&r.ZERO.subTo(L,L)}function P(A){for(var L=this.abs(),K=A.t=2*L.t;--K>=0;)A.data[K]=0;for(K=0;K<L.t-1;++K){var $=L.am(K,L.data[K],A,2*K,0,1);(A.data[K+L.t]+=L.am(K+1,2*L.data[K],A,2*K+1,$,L.t-K-1))>=L.DV&&(A.data[K+L.t]-=L.DV,A.data[K+L.t+1]=1)}A.t>0&&(A.data[A.t-1]+=L.am(K,L.data[K],A,2*K,0,1)),A.s=0,A.clamp()}function M(A,L,K){var $=A.abs();if(!($.t<=0)){var Z=this.abs();if(Z.t<$.t){L?.fromInt(0),K!=null&&this.copyTo(K);return}K==null&&(K=a());var ee=a(),oe=this.s,ne=A.s,xe=this.DB-l($.data[$.t-1]);xe>0?($.lShiftTo(xe,ee),Z.lShiftTo(xe,K)):($.copyTo(ee),Z.copyTo(K));var Qe=ee.t,yt=ee.data[Qe-1];if(yt!=0){var ht=yt*(1<<this.F1)+(Qe>1?ee.data[Qe-2]>>this.F2:0),Dt=this.FV/ht,$r=(1<<this.F1)/ht,Et=1<<this.F2,xt=K.t,zr=xt-Qe,$t=L??a();for(ee.dlShiftTo(zr,$t),K.compareTo($t)>=0&&(K.data[K.t++]=1,K.subTo($t,K)),r.ONE.dlShiftTo(Qe,$t),$t.subTo(ee,ee);ee.t<Qe;)ee.data[ee.t++]=0;for(;--zr>=0;){var _n=K.data[--xt]==yt?this.DM:Math.floor(K.data[xt]*Dt+(K.data[xt-1]+Et)*$r);if((K.data[xt]+=ee.am(0,_n,K,zr,0,Qe))<_n)for(ee.dlShiftTo(zr,$t),K.subTo($t,K);K.data[xt]<--_n;)K.subTo($t,K)}L!=null&&(K.drShiftTo(Qe,L),oe!=ne&&r.ZERO.subTo(L,L)),K.t=Qe,K.clamp(),xe>0&&K.rShiftTo(xe,K),oe<0&&r.ZERO.subTo(K,K)}}}function q(A){var L=a();return this.abs().divRemTo(A,null,L),this.s<0&&L.compareTo(r.ZERO)>0&&A.subTo(L,L),L}function z(A){this.m=A}function G(A){return A.s<0||A.compareTo(this.m)>=0?A.mod(this.m):A}function Y(A){return A}function j(A){A.divRemTo(this.m,null,A)}function te(A,L,K){A.multiplyTo(L,K),this.reduce(K)}function ue(A,L){A.squareTo(L),this.reduce(L)}z.prototype.convert=G,z.prototype.revert=Y,z.prototype.reduce=j,z.prototype.mulTo=te,z.prototype.sqrTo=ue;function X(){if(this.t<1)return 0;var A=this.data[0];if((A&1)==0)return 0;var L=A&3;return L=L*(2-(A&15)*L)&15,L=L*(2-(A&255)*L)&255,L=L*(2-((A&65535)*L&65535))&65535,L=L*(2-A*L%this.DV)%this.DV,L>0?this.DV-L:-L}function re(A){this.m=A,this.mp=A.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<A.DB-15)-1,this.mt2=2*A.t}function W(A){var L=a();return A.abs().dlShiftTo(this.m.t,L),L.divRemTo(this.m,null,L),A.s<0&&L.compareTo(r.ZERO)>0&&this.m.subTo(L,L),L}function pe(A){var L=a();return A.copyTo(L),this.reduce(L),L}function le(A){for(;A.t<=this.mt2;)A.data[A.t++]=0;for(var L=0;L<this.m.t;++L){var K=A.data[L]&32767,$=K*this.mpl+((K*this.mph+(A.data[L]>>15)*this.mpl&this.um)<<15)&A.DM;for(K=L+this.m.t,A.data[K]+=this.m.am(0,$,A,L,0,this.m.t);A.data[K]>=A.DV;)A.data[K]-=A.DV,A.data[++K]++}A.clamp(),A.drShiftTo(this.m.t,A),A.compareTo(this.m)>=0&&A.subTo(this.m,A)}function b(A,L){A.squareTo(L),this.reduce(L)}function U(A,L,K){A.multiplyTo(L,K),this.reduce(K)}re.prototype.convert=W,re.prototype.revert=pe,re.prototype.reduce=le,re.prototype.mulTo=U,re.prototype.sqrTo=b;function k(){return(this.t>0?this.data[0]&1:this.s)==0}function y(A,L){if(A>4294967295||A<1)return r.ONE;var K=a(),$=a(),Z=L.convert(this),ee=l(A)-1;for(Z.copyTo(K);--ee>=0;)if(L.sqrTo(K,$),(A&1<<ee)>0)L.mulTo($,Z,K);else{var oe=K;K=$,$=oe}return L.revert(K)}function R(A,L){var K;return A<256||L.isEven()?K=new z(L):K=new re(L),this.exp(A,K)}r.prototype.copyTo=p,r.prototype.fromInt=C,r.prototype.fromString=f,r.prototype.clamp=g,r.prototype.dlShiftTo=w,r.prototype.drShiftTo=N,r.prototype.lShiftTo=O,r.prototype.rShiftTo=_,r.prototype.subTo=D,r.prototype.multiplyTo=V,r.prototype.squareTo=P,r.prototype.divRemTo=M,r.prototype.invDigit=X,r.prototype.isEven=k,r.prototype.exp=y,r.prototype.toString=E,r.prototype.negate=T,r.prototype.abs=I,r.prototype.compareTo=x,r.prototype.bitLength=s,r.prototype.mod=q,r.prototype.modPowInt=R,r.ZERO=S(0),r.ONE=S(1);function H(){var A=a();return this.copyTo(A),A}function F(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function J(){return this.t==0?this.s:this.data[0]<<24>>24}function ie(){return this.t==0?this.s:this.data[0]<<16>>16}function ce(A){return Math.floor(Math.LN2*this.DB/Math.log(A))}function Q(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function se(A){if(A==null&&(A=10),this.signum()==0||A<2||A>36)return"0";var L=this.chunkSize(A),K=Math.pow(A,L),$=S(K),Z=a(),ee=a(),oe="";for(this.divRemTo($,Z,ee);Z.signum()>0;)oe=(K+ee.intValue()).toString(A).substr(1)+oe,Z.divRemTo($,Z,ee);return ee.intValue().toString(A)+oe}function he(A,L){this.fromInt(0),L==null&&(L=10);for(var K=this.chunkSize(L),$=Math.pow(L,K),Z=!1,ee=0,oe=0,ne=0;ne<A.length;++ne){var xe=d(A,ne);if(xe<0){A.charAt(ne)=="-"&&this.signum()==0&&(Z=!0);continue}oe=L*oe+xe,++ee>=K&&(this.dMultiply($),this.dAddOffset(oe,0),ee=0,oe=0)}ee>0&&(this.dMultiply(Math.pow(L,ee)),this.dAddOffset(oe,0)),Z&&r.ZERO.subTo(this,this)}function ve(A,L,K){if(typeof L=="number")if(A<2)this.fromInt(1);else for(this.fromNumber(A,K),this.testBit(A-1)||this.bitwiseTo(r.ONE.shiftLeft(A-1),Ne,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(L);)this.dAddOffset(2,0),this.bitLength()>A&&this.subTo(r.ONE.shiftLeft(A-1),this);else{var $=new Array,Z=A&7;$.length=(A>>3)+1,L.nextBytes($),Z>0?$[0]&=(1<<Z)-1:$[0]=0,this.fromString($,256)}}function ye(){var A=this.t,L=new Array;L[0]=this.s;var K=this.DB-A*this.DB%8,$,Z=0;if(A-- >0)for(K<this.DB&&($=this.data[A]>>K)!=(this.s&this.DM)>>K&&(L[Z++]=$|this.s<<this.DB-K);A>=0;)K<8?($=(this.data[A]&(1<<K)-1)<<8-K,$|=this.data[--A]>>(K+=this.DB-8)):($=this.data[A]>>(K-=8)&255,K<=0&&(K+=this.DB,--A)),($&128)!=0&&($|=-256),Z==0&&(this.s&128)!=($&128)&&++Z,(Z>0||$!=this.s)&&(L[Z++]=$);return L}function we(A){return this.compareTo(A)==0}function Re(A){return this.compareTo(A)<0?this:A}function _e(A){return this.compareTo(A)>0?this:A}function Te(A,L,K){var $,Z,ee=Math.min(A.t,this.t);for($=0;$<ee;++$)K.data[$]=L(this.data[$],A.data[$]);if(A.t<this.t){for(Z=A.s&this.DM,$=ee;$<this.t;++$)K.data[$]=L(this.data[$],Z);K.t=this.t}else{for(Z=this.s&this.DM,$=ee;$<A.t;++$)K.data[$]=L(Z,A.data[$]);K.t=A.t}K.s=L(this.s,A.s),K.clamp()}function be(A,L){return A&L}function Be(A){var L=a();return this.bitwiseTo(A,be,L),L}function Ne(A,L){return A|L}function je(A){var L=a();return this.bitwiseTo(A,Ne,L),L}function Ze(A,L){return A^L}function nt(A){var L=a();return this.bitwiseTo(A,Ze,L),L}function at(A,L){return A&~L}function lt(A){var L=a();return this.bitwiseTo(A,at,L),L}function pt(){for(var A=a(),L=0;L<this.t;++L)A.data[L]=this.DM&~this.data[L];return A.t=this.t,A.s=~this.s,A}function vt(A){var L=a();return A<0?this.rShiftTo(-A,L):this.lShiftTo(A,L),L}function wt(A){var L=a();return A<0?this.lShiftTo(-A,L):this.rShiftTo(A,L),L}function Ut(A){if(A==0)return-1;var L=0;return(A&65535)==0&&(A>>=16,L+=16),(A&255)==0&&(A>>=8,L+=8),(A&15)==0&&(A>>=4,L+=4),(A&3)==0&&(A>>=2,L+=2),(A&1)==0&&++L,L}function Gt(){for(var A=0;A<this.t;++A)if(this.data[A]!=0)return A*this.DB+Ut(this.data[A]);return this.s<0?this.t*this.DB:-1}function ar(A){for(var L=0;A!=0;)A&=A-1,++L;return L}function yr(){for(var A=0,L=this.s&this.DM,K=0;K<this.t;++K)A+=ar(this.data[K]^L);return A}function br(A){var L=Math.floor(A/this.DB);return L>=this.t?this.s!=0:(this.data[L]&1<<A%this.DB)!=0}function Gr(A,L){var K=r.ONE.shiftLeft(A);return this.bitwiseTo(K,L,K),K}function Ue(A){return this.changeBit(A,Ne)}function De(A){return this.changeBit(A,at)}function Pe(A){return this.changeBit(A,Ze)}function Oe(A,L){for(var K=0,$=0,Z=Math.min(A.t,this.t);K<Z;)$+=this.data[K]+A.data[K],L.data[K++]=$&this.DM,$>>=this.DB;if(A.t<this.t){for($+=A.s;K<this.t;)$+=this.data[K],L.data[K++]=$&this.DM,$>>=this.DB;$+=this.s}else{for($+=this.s;K<A.t;)$+=A.data[K],L.data[K++]=$&this.DM,$>>=this.DB;$+=A.s}L.s=$<0?-1:0,$>0?L.data[K++]=$:$<-1&&(L.data[K++]=this.DV+$),L.t=K,L.clamp()}function Ke(A){var L=a();return this.addTo(A,L),L}function Ve(A){var L=a();return this.subTo(A,L),L}function Fe(A){var L=a();return this.multiplyTo(A,L),L}function Me(A){var L=a();return this.divRemTo(A,L,null),L}function He(A){var L=a();return this.divRemTo(A,null,L),L}function qe(A){var L=a(),K=a();return this.divRemTo(A,L,K),new Array(L,K)}function Ge(A){this.data[this.t]=this.am(0,A-1,this,0,0,this.t),++this.t,this.clamp()}function $e(A,L){if(A!=0){for(;this.t<=L;)this.data[this.t++]=0;for(this.data[L]+=A;this.data[L]>=this.DV;)this.data[L]-=this.DV,++L>=this.t&&(this.data[this.t++]=0),++this.data[L]}}function Ae(){}function Le(A){return A}function ze(A,L,K){A.multiplyTo(L,K)}function Ye(A,L){A.squareTo(L)}Ae.prototype.convert=Le,Ae.prototype.revert=Le,Ae.prototype.mulTo=ze,Ae.prototype.sqrTo=Ye;function tf(A){return this.exp(A,new Ae)}function rf(A,L,K){var $=Math.min(this.t+A.t,L);for(K.s=0,K.t=$;$>0;)K.data[--$]=0;var Z;for(Z=K.t-this.t;$<Z;++$)K.data[$+this.t]=this.am(0,A.data[$],K,$,0,this.t);for(Z=Math.min(A.t,L);$<Z;++$)this.am(0,A.data[$],K,$,0,L-$);K.clamp()}function nf(A,L,K){--L;var $=K.t=this.t+A.t-L;for(K.s=0;--$>=0;)K.data[$]=0;for($=Math.max(L-this.t,0);$<A.t;++$)K.data[this.t+$-L]=this.am(L-$,A.data[$],K,0,0,this.t+$-L);K.clamp(),K.drShiftTo(1,K)}function gr(A){this.r2=a(),this.q3=a(),r.ONE.dlShiftTo(2*A.t,this.r2),this.mu=this.r2.divide(A),this.m=A}function af(A){if(A.s<0||A.t>2*this.m.t)return A.mod(this.m);if(A.compareTo(this.m)<0)return A;var L=a();return A.copyTo(L),this.reduce(L),L}function sf(A){return A}function of(A){for(A.drShiftTo(this.m.t-1,this.r2),A.t>this.m.t+1&&(A.t=this.m.t+1,A.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);A.compareTo(this.r2)<0;)A.dAddOffset(1,this.m.t+1);for(A.subTo(this.r2,A);A.compareTo(this.m)>=0;)A.subTo(this.m,A)}function ff(A,L){A.squareTo(L),this.reduce(L)}function cf(A,L,K){A.multiplyTo(L,K),this.reduce(K)}gr.prototype.convert=af,gr.prototype.revert=sf,gr.prototype.reduce=of,gr.prototype.mulTo=cf,gr.prototype.sqrTo=ff;function uf(A,L){var K=A.bitLength(),$,Z=S(1),ee;if(K<=0)return Z;K<18?$=1:K<48?$=3:K<144?$=4:K<768?$=5:$=6,K<8?ee=new z(L):L.isEven()?ee=new gr(L):ee=new re(L);var oe=new Array,ne=3,xe=$-1,Qe=(1<<$)-1;if(oe[1]=ee.convert(this),$>1){var yt=a();for(ee.sqrTo(oe[1],yt);ne<=Qe;)oe[ne]=a(),ee.mulTo(yt,oe[ne-2],oe[ne]),ne+=2}var ht=A.t-1,Dt,$r=!0,Et=a(),xt;for(K=l(A.data[ht])-1;ht>=0;){for(K>=xe?Dt=A.data[ht]>>K-xe&Qe:(Dt=(A.data[ht]&(1<<K+1)-1)<<xe-K,ht>0&&(Dt|=A.data[ht-1]>>this.DB+K-xe)),ne=$;(Dt&1)==0;)Dt>>=1,--ne;if((K-=ne)<0&&(K+=this.DB,--ht),$r)oe[Dt].copyTo(Z),$r=!1;else{for(;ne>1;)ee.sqrTo(Z,Et),ee.sqrTo(Et,Z),ne-=2;ne>0?ee.sqrTo(Z,Et):(xt=Z,Z=Et,Et=xt),ee.mulTo(Et,oe[Dt],Z)}for(;ht>=0&&(A.data[ht]&1<<K)==0;)ee.sqrTo(Z,Et),xt=Z,Z=Et,Et=xt,--K<0&&(K=this.DB-1,--ht)}return ee.revert(Z)}function lf(A){var L=this.s<0?this.negate():this.clone(),K=A.s<0?A.negate():A.clone();if(L.compareTo(K)<0){var $=L;L=K,K=$}var Z=L.getLowestSetBit(),ee=K.getLowestSetBit();if(ee<0)return L;for(Z<ee&&(ee=Z),ee>0&&(L.rShiftTo(ee,L),K.rShiftTo(ee,K));L.signum()>0;)(Z=L.getLowestSetBit())>0&&L.rShiftTo(Z,L),(Z=K.getLowestSetBit())>0&&K.rShiftTo(Z,K),L.compareTo(K)>=0?(L.subTo(K,L),L.rShiftTo(1,L)):(K.subTo(L,K),K.rShiftTo(1,K));return ee>0&&K.lShiftTo(ee,K),K}function hf(A){if(A<=0)return 0;var L=this.DV%A,K=this.s<0?A-1:0;if(this.t>0)if(L==0)K=this.data[0]%A;else for(var $=this.t-1;$>=0;--$)K=(L*K+this.data[$])%A;return K}function df(A){var L=A.isEven();if(this.isEven()&&L||A.signum()==0)return r.ZERO;for(var K=A.clone(),$=this.clone(),Z=S(1),ee=S(0),oe=S(0),ne=S(1);K.signum()!=0;){for(;K.isEven();)K.rShiftTo(1,K),L?((!Z.isEven()||!ee.isEven())&&(Z.addTo(this,Z),ee.subTo(A,ee)),Z.rShiftTo(1,Z)):ee.isEven()||ee.subTo(A,ee),ee.rShiftTo(1,ee);for(;$.isEven();)$.rShiftTo(1,$),L?((!oe.isEven()||!ne.isEven())&&(oe.addTo(this,oe),ne.subTo(A,ne)),oe.rShiftTo(1,oe)):ne.isEven()||ne.subTo(A,ne),ne.rShiftTo(1,ne);K.compareTo($)>=0?(K.subTo($,K),L&&Z.subTo(oe,Z),ee.subTo(ne,ee)):($.subTo(K,$),L&&oe.subTo(Z,oe),ne.subTo(ee,ne))}if($.compareTo(r.ONE)!=0)return r.ZERO;if(ne.compareTo(A)>=0)return ne.subtract(A);if(ne.signum()<0)ne.addTo(A,ne);else return ne;return ne.signum()<0?ne.add(A):ne}var mt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],pf=(1<<26)/mt[mt.length-1];function yf(A){var L,K=this.abs();if(K.t==1&&K.data[0]<=mt[mt.length-1]){for(L=0;L<mt.length;++L)if(K.data[0]==mt[L])return!0;return!1}if(K.isEven())return!1;for(L=1;L<mt.length;){for(var $=mt[L],Z=L+1;Z<mt.length&&$<pf;)$*=mt[Z++];for($=K.modInt($);L<Z;)if($%mt[L++]==0)return!1}return K.millerRabin(A)}function gf(A){var L=this.subtract(r.ONE),K=L.getLowestSetBit();if(K<=0)return!1;for(var $=L.shiftRight(K),Z=vf(),ee,oe=0;oe<A;++oe){do ee=new r(this.bitLength(),Z);while(ee.compareTo(r.ONE)<=0||ee.compareTo(L)>=0);var ne=ee.modPow($,this);if(ne.compareTo(r.ONE)!=0&&ne.compareTo(L)!=0){for(var xe=1;xe++<K&&ne.compareTo(L)!=0;)if(ne=ne.modPowInt(2,this),ne.compareTo(r.ONE)==0)return!1;if(ne.compareTo(L)!=0)return!1}}return!0}function vf(){return{nextBytes:function(A){for(var L=0;L<A.length;++L)A[L]=Math.floor(Math.random()*256)}}}return r.prototype.chunkSize=ce,r.prototype.toRadix=se,r.prototype.fromRadix=he,r.prototype.fromNumber=ve,r.prototype.bitwiseTo=Te,r.prototype.changeBit=Gr,r.prototype.addTo=Oe,r.prototype.dMultiply=Ge,r.prototype.dAddOffset=$e,r.prototype.multiplyLowerTo=rf,r.prototype.multiplyUpperTo=nf,r.prototype.modInt=hf,r.prototype.millerRabin=gf,r.prototype.clone=H,r.prototype.intValue=F,r.prototype.byteValue=J,r.prototype.shortValue=ie,r.prototype.signum=Q,r.prototype.toByteArray=ye,r.prototype.equals=we,r.prototype.min=Re,r.prototype.max=_e,r.prototype.and=Be,r.prototype.or=je,r.prototype.xor=nt,r.prototype.andNot=lt,r.prototype.not=pt,r.prototype.shiftLeft=vt,r.prototype.shiftRight=wt,r.prototype.getLowestSetBit=Gt,r.prototype.bitCount=yr,r.prototype.testBit=br,r.prototype.setBit=Ue,r.prototype.clearBit=De,r.prototype.flipBit=Pe,r.prototype.add=Ke,r.prototype.subtract=Ve,r.prototype.multiply=Fe,r.prototype.divide=Me,r.prototype.remainder=He,r.prototype.divideAndRemainder=qe,r.prototype.modPow=uf,r.prototype.modInverse=df,r.prototype.pow=tf,r.prototype.gcd=lf,r.prototype.isProbablePrime=yf,ta}var ra={exports:{}},na={exports:{}},Hi;function qr(){if(Hi)return na.exports;Hi=1;var t=ge();qt(),Ee();var e=na.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){a||c();var i=null,n=t.util.createBuffer(),u=new Array(80),h={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return h.start=function(){h.messageLength=0,h.fullMessageLength=h.messageLength64=[];for(var m=h.messageLengthSize/4,B=0;B<m;++B)h.fullMessageLength.push(0);return n=t.util.createBuffer(),i={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},h},h.start(),h.update=function(m,B){B==="utf8"&&(m=t.util.encodeUtf8(m));var v=m.length;h.messageLength+=v,v=[v/4294967296>>>0,v>>>0];for(var d=h.fullMessageLength.length-1;d>=0;--d)h.fullMessageLength[d]+=v[1],v[1]=v[0]+(h.fullMessageLength[d]/4294967296>>>0),h.fullMessageLength[d]=h.fullMessageLength[d]>>>0,v[0]=v[1]/4294967296>>>0;return n.putBytes(m),o(i,u,n),(n.read>2048||n.length()===0)&&n.compact(),h},h.digest=function(){var m=t.util.createBuffer();m.putBytes(n.bytes());var B=h.fullMessageLength[h.fullMessageLength.length-1]+h.messageLengthSize,v=B&h.blockLength-1;m.putBytes(r.substr(0,h.blockLength-v));for(var d,p,C=h.fullMessageLength[0]*8,S=0;S<h.fullMessageLength.length-1;++S)d=h.fullMessageLength[S+1]*8,p=d/4294967296>>>0,C+=p,m.putInt32(C>>>0),C=d>>>0;m.putInt32(C);var f={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3,h4:i.h4};o(f,u,m);var g=t.util.createBuffer();return g.putInt32(f.h0),g.putInt32(f.h1),g.putInt32(f.h2),g.putInt32(f.h3),g.putInt32(f.h4),g},h};var r=null,a=!1;function c(){r="",r+=t.util.fillString("\0",64),a=!0}function o(i,n,u){for(var h,m,B,v,d,p,C,S,f=u.length();f>=64;){for(m=i.h0,B=i.h1,v=i.h2,d=i.h3,p=i.h4,S=0;S<16;++S)h=u.getInt32(),n[S]=h,C=d^B&(v^d),h=(m<<5|m>>>27)+C+p+1518500249+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<20;++S)h=n[S-3]^n[S-8]^n[S-14]^n[S-16],h=h<<1|h>>>31,n[S]=h,C=d^B&(v^d),h=(m<<5|m>>>27)+C+p+1518500249+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<32;++S)h=n[S-3]^n[S-8]^n[S-14]^n[S-16],h=h<<1|h>>>31,n[S]=h,C=B^v^d,h=(m<<5|m>>>27)+C+p+1859775393+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<40;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,C=B^v^d,h=(m<<5|m>>>27)+C+p+1859775393+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<60;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,C=B&v|d&(B^v),h=(m<<5|m>>>27)+C+p+2400959708+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<80;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,C=B^v^d,h=(m<<5|m>>>27)+C+p+3395469782+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;i.h0=i.h0+m|0,i.h1=i.h1+B|0,i.h2=i.h2+v|0,i.h3=i.h3+d|0,i.h4=i.h4+p|0,f-=64}}return na.exports}var qi;function To(){if(qi)return ra.exports;qi=1;var t=ge();Ee(),Bt(),qr();var e=ra.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(a,c,o){var i,n,u,h;typeof o=="string"?(i=o,n=arguments[3]||void 0,u=arguments[4]||void 0):o&&(i=o.label||void 0,n=o.seed||void 0,u=o.md||void 0,o.mgf1&&o.mgf1.md&&(h=o.mgf1.md)),u?u.start():u=t.md.sha1.create(),h||(h=u);var m=Math.ceil(a.n.bitLength()/8),B=m-2*u.digestLength-2;if(c.length>B){var v=new Error("RSAES-OAEP input message length is too long.");throw v.length=c.length,v.maxLength=B,v}i||(i=""),u.update(i,"raw");for(var d=u.digest(),p="",C=B-c.length,S=0;S<C;S++)p+="\0";var f=d.getBytes()+p+""+c;if(!n)n=t.random.getBytes(u.digestLength);else if(n.length!==u.digestLength){var v=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw v.seedLength=n.length,v.digestLength=u.digestLength,v}var g=r(n,m-u.digestLength-1,h),E=t.util.xorBytes(f,g,f.length),T=r(E,u.digestLength,h),I=t.util.xorBytes(n,T,n.length);return"\0"+I+E},e.decode_rsa_oaep=function(a,c,o){var i,n,u;typeof o=="string"?(i=o,n=arguments[3]||void 0):o&&(i=o.label||void 0,n=o.md||void 0,o.mgf1&&o.mgf1.md&&(u=o.mgf1.md));var h=Math.ceil(a.n.bitLength()/8);if(c.length!==h){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=c.length,E.expectedLength=h,E}if(n===void 0?n=t.md.sha1.create():n.start(),u||(u=n),h<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var m=n.digest().getBytes(),B=c.charAt(0),v=c.substring(1,n.digestLength+1),d=c.substring(1+n.digestLength),p=r(d,n.digestLength,u),C=t.util.xorBytes(v,p,v.length),S=r(C,h-n.digestLength-1,u),f=t.util.xorBytes(d,S,d.length),g=f.substring(0,n.digestLength),E=B!=="\0",T=0;T<n.digestLength;++T)E|=m.charAt(T)!==g.charAt(T);for(var I=1,x=n.digestLength,l=n.digestLength;l<f.length;l++){var s=f.charCodeAt(l),w=s&1^1,N=I?65534:0;E|=s&N,I=I&w,x+=I}if(E||f.charCodeAt(x)!==1)throw new Error("Invalid RSAES-OAEP padding.");return f.substring(x+1)};function r(a,c,o){o||(o=t.md.sha1.create());for(var i="",n=Math.ceil(c/o.digestLength),u=0;u<n;++u){var h=String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255);o.start(),o.update(a+h),i+=o.digest().getBytes()}return i.substring(0,c)}return ra.exports}var Zr={exports:{}},Gi;function Ao(){if(Gi)return Zr.exports;Gi=1;var t=ge();return Ee(),bn(),Bt(),(function(){if(t.prime){Zr.exports=t.prime;return}var e=Zr.exports=t.prime=t.prime||{},r=t.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],c=new r(null);c.fromInt(30);var o=function(v,d){return v|d};e.generateProbablePrime=function(v,d,p){typeof d=="function"&&(p=d,d={}),d=d||{};var C=d.algorithm||"PRIMEINC";typeof C=="string"&&(C={name:C}),C.options=C.options||{};var S=d.prng||t.random,f={nextBytes:function(g){for(var E=S.getBytesSync(g.length),T=0;T<g.length;++T)g[T]=E.charCodeAt(T)}};if(C.name==="PRIMEINC")return i(v,f,C.options,p);throw new Error("Invalid prime generation algorithm: "+C.name)};function i(v,d,p,C){return"workers"in p?h(v,d,p,C):n(v,d,p,C)}function n(v,d,p,C){var S=m(v,d),f=0,g=B(S.bitLength());"millerRabinTests"in p&&(g=p.millerRabinTests);var E=10;"maxBlockTime"in p&&(E=p.maxBlockTime),u(S,v,d,f,g,E,C)}function u(v,d,p,C,S,f,g){var E=+new Date;do{if(v.bitLength()>d&&(v=m(d,p)),v.isProbablePrime(S))return g(null,v);v.dAddOffset(a[C++%8],0)}while(f<0||+new Date-E<f);t.util.setImmediate(function(){u(v,d,p,C,S,f,g)})}function h(v,d,p,C){if(typeof Worker>"u")return n(v,d,p,C);var S=m(v,d),f=p.workers,g=p.workLoad||100,E=g*30/8,T=p.workerScript||"forge/prime.worker.js";if(f===-1)return t.util.estimateCores(function(x,l){x&&(l=2),f=l-1,I()});I();function I(){f=Math.max(1,f);for(var x=[],l=0;l<f;++l)x[l]=new Worker(T);for(var l=0;l<f;++l)x[l].addEventListener("message",w);var s=!1;function w(N){if(!s){var O=N.data;if(O.found){for(var _=0;_<x.length;++_)x[_].terminate();return s=!0,C(null,new r(O.prime,16))}S.bitLength()>v&&(S=m(v,d));var D=S.toString(16);N.target.postMessage({hex:D,workLoad:g}),S.dAddOffset(E,0)}}}}function m(v,d){var p=new r(v,d),C=v-1;return p.testBit(C)||p.bitwiseTo(r.ONE.shiftLeft(C),o,p),p.dAddOffset(31-p.mod(c).byteValue(),0),p}function B(v){return v<=100?27:v<=150?18:v<=200?15:v<=250?12:v<=300?9:v<=350?8:v<=400?7:v<=500?6:v<=600?5:v<=800?4:v<=1250?3:2}})(),Zr.exports}var aa,$i;function Bn(){if($i)return aa;$i=1;var t=ge();if(kt(),bn(),dr(),To(),Ao(),Bt(),Ee(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.util.isNodejs?Ya:null,a=t.asn1,c=t.util;t.pki=t.pki||{},aa=t.pki.rsa=t.rsa=t.rsa||{};var o=t.pki,i=[6,4,2,4,2,4,6,2],n={name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},h={name:"RSAPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},m=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},B={name:"DigestInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},v=function(l){var s;if(l.algorithm in o.oids)s=o.oids[l.algorithm];else{var w=new Error("Unknown message digest algorithm.");throw w.algorithm=l.algorithm,w}var N=a.oidToDer(s).getBytes(),O=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]),_=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);_.value.push(a.create(a.Class.UNIVERSAL,a.Type.OID,!1,N)),_.value.push(a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,""));var D=a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,l.digest().getBytes());return O.value.push(_),O.value.push(D),a.toDer(O).getBytes()},d=function(l,s,w){if(w)return l.modPow(s.e,s.n);if(!s.p||!s.q)return l.modPow(s.d,s.n);s.dP||(s.dP=s.d.mod(s.p.subtract(e.ONE))),s.dQ||(s.dQ=s.d.mod(s.q.subtract(e.ONE))),s.qInv||(s.qInv=s.q.modInverse(s.p));var N;do N=new e(t.util.bytesToHex(t.random.getBytes(s.n.bitLength()/8)),16);while(N.compareTo(s.n)>=0||!N.gcd(s.n).equals(e.ONE));l=l.multiply(N.modPow(s.e,s.n)).mod(s.n);for(var O=l.mod(s.p).modPow(s.dP,s.p),_=l.mod(s.q).modPow(s.dQ,s.q);O.compareTo(_)<0;)O=O.add(s.p);var D=O.subtract(_).multiply(s.qInv).mod(s.p).multiply(s.q).add(_);return D=D.multiply(N.modInverse(s.n)).mod(s.n),D};o.rsa.encrypt=function(l,s,w){var N=w,O,_=Math.ceil(s.n.bitLength()/8);w!==!1&&w!==!0?(N=w===2,O=p(l,s,w)):(O=t.util.createBuffer(),O.putBytes(l));for(var D=new e(O.toHex(),16),V=d(D,s,N),P=V.toString(16),M=t.util.createBuffer(),q=_-Math.ceil(P.length/2);q>0;)M.putByte(0),--q;return M.putBytes(t.util.hexToBytes(P)),M.getBytes()},o.rsa.decrypt=function(l,s,w,N){var O=Math.ceil(s.n.bitLength()/8);if(l.length!==O){var _=new Error("Encrypted message length is invalid.");throw _.length=l.length,_.expected=O,_}var D=new e(t.util.createBuffer(l).toHex(),16);if(D.compareTo(s.n)>=0)throw new Error("Encrypted message is invalid.");for(var V=d(D,s,w),P=V.toString(16),M=t.util.createBuffer(),q=O-Math.ceil(P.length/2);q>0;)M.putByte(0),--q;return M.putBytes(t.util.hexToBytes(P)),N!==!1?C(M.getBytes(),s,w):M.getBytes()},o.rsa.createKeyPairGenerationState=function(l,s,w){typeof l=="string"&&(l=parseInt(l,10)),l=l||2048,w=w||{};var N=w.prng||t.random,O={nextBytes:function(V){for(var P=N.getBytesSync(V.length),M=0;M<V.length;++M)V[M]=P.charCodeAt(M)}},_=w.algorithm||"PRIMEINC",D;if(_==="PRIMEINC")D={algorithm:_,state:0,bits:l,rng:O,eInt:s||65537,e:new e(null),p:null,q:null,qBits:l>>1,pBits:l-(l>>1),pqState:0,num:null,keys:null},D.e.fromInt(D.eInt);else throw new Error("Invalid key generation algorithm: "+_);return D},o.rsa.stepKeyPairGenerationState=function(l,s){"algorithm"in l||(l.algorithm="PRIMEINC");var w=new e(null);w.fromInt(30);for(var N=0,O=function(z,G){return z|G},_=+new Date,D,V=0;l.keys===null&&(s<=0||V<s);){if(l.state===0){var P=l.p===null?l.pBits:l.qBits,M=P-1;l.pqState===0?(l.num=new e(P,l.rng),l.num.testBit(M)||l.num.bitwiseTo(e.ONE.shiftLeft(M),O,l.num),l.num.dAddOffset(31-l.num.mod(w).byteValue(),0),N=0,++l.pqState):l.pqState===1?l.num.bitLength()>P?l.pqState=0:l.num.isProbablePrime(g(l.num.bitLength()))?++l.pqState:l.num.dAddOffset(i[N++%8],0):l.pqState===2?l.pqState=l.num.subtract(e.ONE).gcd(l.e).compareTo(e.ONE)===0?3:0:l.pqState===3&&(l.pqState=0,l.p===null?l.p=l.num:l.q=l.num,l.p!==null&&l.q!==null&&++l.state,l.num=null)}else if(l.state===1)l.p.compareTo(l.q)<0&&(l.num=l.p,l.p=l.q,l.q=l.num),++l.state;else if(l.state===2)l.p1=l.p.subtract(e.ONE),l.q1=l.q.subtract(e.ONE),l.phi=l.p1.multiply(l.q1),++l.state;else if(l.state===3)l.phi.gcd(l.e).compareTo(e.ONE)===0?++l.state:(l.p=null,l.q=null,l.state=0);else if(l.state===4)l.n=l.p.multiply(l.q),l.n.bitLength()===l.bits?++l.state:(l.q=null,l.state=0);else if(l.state===5){var q=l.e.modInverse(l.phi);l.keys={privateKey:o.rsa.setPrivateKey(l.n,l.e,q,l.p,l.q,q.mod(l.p1),q.mod(l.q1),l.q.modInverse(l.p)),publicKey:o.rsa.setPublicKey(l.n,l.e)}}D=+new Date,V+=D-_,_=D}return l.keys!==null},o.rsa.generateKeyPair=function(l,s,w,N){if(arguments.length===1?typeof l=="object"?(w=l,l=void 0):typeof l=="function"&&(N=l,l=void 0):arguments.length===2?typeof l=="number"?typeof s=="function"?(N=s,s=void 0):typeof s!="number"&&(w=s,s=void 0):(w=l,N=s,l=void 0,s=void 0):arguments.length===3&&(typeof s=="number"?typeof w=="function"&&(N=w,w=void 0):(N=w,w=s,s=void 0)),w=w||{},l===void 0&&(l=w.bits||2048),s===void 0&&(s=w.e||65537),!t.options.usePureJavaScript&&!w.prng&&l>=256&&l<=16384&&(s===65537||s===3)){if(N){if(E("generateKeyPair"))return r.generateKeyPair("rsa",{modulusLength:l,publicExponent:s,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(V,P,M){if(V)return N(V);N(null,{privateKey:o.privateKeyFromPem(M),publicKey:o.publicKeyFromPem(P)})});if(T("generateKey")&&T("exportKey"))return c.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:l,publicExponent:x(s),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(V){return c.globalScope.crypto.subtle.exportKey("pkcs8",V.privateKey)}).then(void 0,function(V){N(V)}).then(function(V){if(V){var P=o.privateKeyFromAsn1(a.fromDer(t.util.createBuffer(V)));N(null,{privateKey:P,publicKey:o.setRsaPublicKey(P.n,P.e)})}});if(I("generateKey")&&I("exportKey")){var O=c.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:l,publicExponent:x(s),hash:{name:"SHA-256"}},!0,["sign","verify"]);O.oncomplete=function(V){var P=V.target.result,M=c.globalScope.msCrypto.subtle.exportKey("pkcs8",P.privateKey);M.oncomplete=function(q){var z=q.target.result,G=o.privateKeyFromAsn1(a.fromDer(t.util.createBuffer(z)));N(null,{privateKey:G,publicKey:o.setRsaPublicKey(G.n,G.e)})},M.onerror=function(q){N(q)}},O.onerror=function(V){N(V)};return}}else if(E("generateKeyPairSync")){var _=r.generateKeyPairSync("rsa",{modulusLength:l,publicExponent:s,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:o.privateKeyFromPem(_.privateKey),publicKey:o.publicKeyFromPem(_.publicKey)}}}var D=o.rsa.createKeyPairGenerationState(l,s,w);if(!N)return o.rsa.stepKeyPairGenerationState(D,0),D.keys;S(D,w,N)},o.setRsaPublicKey=o.rsa.setPublicKey=function(l,s){var w={n:l,e:s};return w.encrypt=function(N,O,_){if(typeof O=="string"?O=O.toUpperCase():O===void 0&&(O="RSAES-PKCS1-V1_5"),O==="RSAES-PKCS1-V1_5")O={encode:function(V,P,M){return p(V,P,2).getBytes()}};else if(O==="RSA-OAEP"||O==="RSAES-OAEP")O={encode:function(V,P){return t.pkcs1.encode_rsa_oaep(P,V,_)}};else if(["RAW","NONE","NULL",null].indexOf(O)!==-1)O={encode:function(V){return V}};else if(typeof O=="string")throw new Error('Unsupported encryption scheme: "'+O+'".');var D=O.encode(N,w,!0);return o.rsa.encrypt(D,w,!0)},w.verify=function(N,O,_,D){typeof _=="string"?_=_.toUpperCase():_===void 0&&(_="RSASSA-PKCS1-V1_5"),D===void 0&&(D={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in D||(D._parseAllDigestBytes=!0),_==="RSASSA-PKCS1-V1_5"?_={verify:function(P,M){M=C(M,w,!0);var q=a.fromDer(M,{parseAllBytes:D._parseAllDigestBytes}),z={},G=[];if(!a.validate(q,B,z,G)){var Y=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw Y.errors=G,Y}var j=a.derToOid(z.algorithmIdentifier);if(!(j===t.oids.md2||j===t.oids.md5||j===t.oids.sha1||j===t.oids.sha224||j===t.oids.sha256||j===t.oids.sha384||j===t.oids.sha512||j===t.oids["sha512-224"]||j===t.oids["sha512-256"])){var Y=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw Y.oid=j,Y}if((j===t.oids.md2||j===t.oids.md5)&&!("parameters"in z))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return P===z.digest}}:(_==="NONE"||_==="NULL"||_===null)&&(_={verify:function(P,M){return M=C(M,w,!0),P===M}});var V=o.rsa.decrypt(O,w,!0,!1);return _.verify(N,V,w.n.bitLength())},w},o.setRsaPrivateKey=o.rsa.setPrivateKey=function(l,s,w,N,O,_,D,V){var P={n:l,e:s,d:w,p:N,q:O,dP:_,dQ:D,qInv:V};return P.decrypt=function(M,q,z){typeof q=="string"?q=q.toUpperCase():q===void 0&&(q="RSAES-PKCS1-V1_5");var G=o.rsa.decrypt(M,P,!1,!1);if(q==="RSAES-PKCS1-V1_5")q={decode:C};else if(q==="RSA-OAEP"||q==="RSAES-OAEP")q={decode:function(Y,j){return t.pkcs1.decode_rsa_oaep(j,Y,z)}};else if(["RAW","NONE","NULL",null].indexOf(q)!==-1)q={decode:function(Y){return Y}};else throw new Error('Unsupported encryption scheme: "'+q+'".');return q.decode(G,P,!1)},P.sign=function(M,q){var z=!1;typeof q=="string"&&(q=q.toUpperCase()),q===void 0||q==="RSASSA-PKCS1-V1_5"?(q={encode:v},z=1):(q==="NONE"||q==="NULL"||q===null)&&(q={encode:function(){return M}},z=1);var G=q.encode(M,P.n.bitLength());return o.rsa.encrypt(G,P,z)},P},o.wrapRsaPrivateKey=function(l){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(0).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.oids.rsaEncryption).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(l).getBytes())])},o.privateKeyFromAsn1=function(l){var s={},w=[];if(a.validate(l,n,s,w)&&(l=a.fromDer(t.util.createBuffer(s.privateKey))),s={},w=[],!a.validate(l,u,s,w)){var N=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw N.errors=w,N}var O,_,D,V,P,M,q,z;return O=t.util.createBuffer(s.privateKeyModulus).toHex(),_=t.util.createBuffer(s.privateKeyPublicExponent).toHex(),D=t.util.createBuffer(s.privateKeyPrivateExponent).toHex(),V=t.util.createBuffer(s.privateKeyPrime1).toHex(),P=t.util.createBuffer(s.privateKeyPrime2).toHex(),M=t.util.createBuffer(s.privateKeyExponent1).toHex(),q=t.util.createBuffer(s.privateKeyExponent2).toHex(),z=t.util.createBuffer(s.privateKeyCoefficient).toHex(),o.setRsaPrivateKey(new e(O,16),new e(_,16),new e(D,16),new e(V,16),new e(P,16),new e(M,16),new e(q,16),new e(z,16))},o.privateKeyToAsn1=o.privateKeyToRSAPrivateKey=function(l){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(0).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.n)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.e)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.d)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.p)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.q)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.dP)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.dQ)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.qInv))])},o.publicKeyFromAsn1=function(l){var s={},w=[];if(a.validate(l,m,s,w)){var N=a.derToOid(s.publicKeyOid);if(N!==o.oids.rsaEncryption){var O=new Error("Cannot read public key. Unknown OID.");throw O.oid=N,O}l=s.rsaPublicKey}if(w=[],!a.validate(l,h,s,w)){var O=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw O.errors=w,O}var _=t.util.createBuffer(s.publicKeyModulus).toHex(),D=t.util.createBuffer(s.publicKeyExponent).toHex();return o.setRsaPublicKey(new e(_,16),new e(D,16))},o.publicKeyToAsn1=o.publicKeyToSubjectPublicKeyInfo=function(l){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.oids.rsaEncryption).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,[o.publicKeyToRSAPublicKey(l)])])},o.publicKeyToRSAPublicKey=function(l){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.n)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(l.e))])};function p(l,s,w){var N=t.util.createBuffer(),O=Math.ceil(s.n.bitLength()/8);if(l.length>O-11){var _=new Error("Message is too long for PKCS#1 v1.5 padding.");throw _.length=l.length,_.max=O-11,_}N.putByte(0),N.putByte(w);var D=O-3-l.length,V;if(w===0||w===1){V=w===0?0:255;for(var P=0;P<D;++P)N.putByte(V)}else for(;D>0;){for(var M=0,q=t.random.getBytes(D),P=0;P<D;++P)V=q.charCodeAt(P),V===0?++M:N.putByte(V);D=M}return N.putByte(0),N.putBytes(l),N}function C(l,s,w,N){var O=Math.ceil(s.n.bitLength()/8),_=t.util.createBuffer(l),D=_.getByte(),V=_.getByte();if(D!==0||w&&V!==0&&V!==1||!w&&V!=2||w&&V===0&&typeof N>"u")throw new Error("Encryption block is invalid.");var P=0;if(V===0){P=O-3-N;for(var M=0;M<P;++M)if(_.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(V===1)for(P=0;_.length()>1;){if(_.getByte()!==255){--_.read;break}++P}else if(V===2)for(P=0;_.length()>1;){if(_.getByte()===0){--_.read;break}++P}var q=_.getByte();if(q!==0||P!==O-3-_.length())throw new Error("Encryption block is invalid.");return _.getBytes()}function S(l,s,w){typeof s=="function"&&(w=s,s={}),s=s||{};var N={algorithm:{name:s.algorithm||"PRIMEINC",options:{workers:s.workers||2,workLoad:s.workLoad||100,workerScript:s.workerScript}}};"prng"in s&&(N.prng=s.prng),O();function O(){_(l.pBits,function(V,P){if(V)return w(V);if(l.p=P,l.q!==null)return D(V,l.q);_(l.qBits,D)})}function _(V,P){t.prime.generateProbablePrime(V,N,P)}function D(V,P){if(V)return w(V);if(l.q=P,l.p.compareTo(l.q)<0){var M=l.p;l.p=l.q,l.q=M}if(l.p.subtract(e.ONE).gcd(l.e).compareTo(e.ONE)!==0){l.p=null,O();return}if(l.q.subtract(e.ONE).gcd(l.e).compareTo(e.ONE)!==0){l.q=null,_(l.qBits,D);return}if(l.p1=l.p.subtract(e.ONE),l.q1=l.q.subtract(e.ONE),l.phi=l.p1.multiply(l.q1),l.phi.gcd(l.e).compareTo(e.ONE)!==0){l.p=l.q=null,O();return}if(l.n=l.p.multiply(l.q),l.n.bitLength()!==l.bits){l.q=null,_(l.qBits,D);return}var q=l.e.modInverse(l.phi);l.keys={privateKey:o.rsa.setPrivateKey(l.n,l.e,q,l.p,l.q,q.mod(l.p1),q.mod(l.q1),l.q.modInverse(l.p)),publicKey:o.rsa.setPublicKey(l.n,l.e)},w(null,l.keys)}}function f(l){var s=l.toString(16);s[0]>="8"&&(s="00"+s);var w=t.util.hexToBytes(s);return w.length>1&&(w.charCodeAt(0)===0&&(w.charCodeAt(1)&128)===0||w.charCodeAt(0)===255&&(w.charCodeAt(1)&128)===128)?w.substr(1):w}function g(l){return l<=100?27:l<=150?18:l<=200?15:l<=250?12:l<=300?9:l<=350?8:l<=400?7:l<=500?6:l<=600?5:l<=800?4:l<=1250?3:2}function E(l){return t.util.isNodejs&&typeof r[l]=="function"}function T(l){return typeof c.globalScope<"u"&&typeof c.globalScope.crypto=="object"&&typeof c.globalScope.crypto.subtle=="object"&&typeof c.globalScope.crypto.subtle[l]=="function"}function I(l){return typeof c.globalScope<"u"&&typeof c.globalScope.msCrypto=="object"&&typeof c.globalScope.msCrypto.subtle=="object"&&typeof c.globalScope.msCrypto.subtle[l]=="function"}function x(l){for(var s=t.util.hexToBytes(l.toString(16)),w=new Uint8Array(s.length),N=0;N<s.length;++N)w[N]=s.charCodeAt(N);return w}return aa}var ia,zi;function Io(){if(zi)return ia;zi=1;var t=ge();if(hr(),kt(),Cn(),qt(),dr(),Qa(),Cr(),Bt(),wo(),Bn(),Ee(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.asn1,a=t.pki=t.pki||{};ia=a.pbe=t.pbe=t.pbe||{};var c=a.oids,o={name:"EncryptedPrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},i={name:"PBES2Algorithms",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},n={name:"pkcs-12PbeParams",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"iterations"}]};a.encryptPrivateKeyInfo=function(v,d,p){p=p||{},p.saltSize=p.saltSize||8,p.count=p.count||2048,p.algorithm=p.algorithm||"aes128",p.prfAlgorithm=p.prfAlgorithm||"sha1";var C=t.random.getBytesSync(p.saltSize),S=p.count,f=r.integerToDer(S),g,E,T;if(p.algorithm.indexOf("aes")===0||p.algorithm==="des"){var I,x,l;switch(p.algorithm){case"aes128":g=16,I=16,x=c["aes128-CBC"],l=t.aes.createEncryptionCipher;break;case"aes192":g=24,I=16,x=c["aes192-CBC"],l=t.aes.createEncryptionCipher;break;case"aes256":g=32,I=16,x=c["aes256-CBC"],l=t.aes.createEncryptionCipher;break;case"des":g=8,I=8,x=c.desCBC,l=t.des.createEncryptionCipher;break;default:var s=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=p.algorithm,s}var w="hmacWith"+p.prfAlgorithm.toUpperCase(),N=m(w),O=t.pkcs5.pbkdf2(d,C,S,g,N),_=t.random.getBytesSync(I),D=l(O);D.start(_),D.update(r.toDer(v)),D.finish(),T=D.output.getBytes();var V=B(C,f,g,w);E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(c.pkcs5PBES2).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(c.pkcs5PBKDF2).getBytes()),V]),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(x).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,_)])])])}else if(p.algorithm==="3des"){g=24;var P=new t.util.ByteBuffer(C),O=a.pbe.generatePkcs12Key(d,P,1,S,g),_=a.pbe.generatePkcs12Key(d,P,2,S,g),D=t.des.createEncryptionCipher(O);D.start(_),D.update(r.toDer(v)),D.finish(),T=D.output.getBytes(),E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(c["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,C),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,f.getBytes())])])}else{var s=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=p.algorithm,s}var M=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[E,r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,T)]);return M},a.decryptPrivateKeyInfo=function(v,d){var p=null,C={},S=[];if(!r.validate(v,o,C,S)){var f=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=S,f}var g=r.derToOid(C.encryptionOid),E=a.pbe.getCipher(g,C.encryptionParams,d),T=t.util.createBuffer(C.encryptedData);return E.update(T),E.finish()&&(p=r.fromDer(E.output)),p},a.encryptedPrivateKeyToPem=function(v,d){var p={type:"ENCRYPTED PRIVATE KEY",body:r.toDer(v).getBytes()};return t.pem.encode(p,{maxline:d})},a.encryptedPrivateKeyFromPem=function(v){var d=t.pem.decode(v)[0];if(d.type!=="ENCRYPTED PRIVATE KEY"){var p=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw p.headerType=d.type,p}if(d.procType&&d.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return r.fromDer(d.body)},a.encryptRsaPrivateKey=function(v,d,p){if(p=p||{},!p.legacy){var C=a.wrapRsaPrivateKey(a.privateKeyToAsn1(v));return C=a.encryptPrivateKeyInfo(C,d,p),a.encryptedPrivateKeyToPem(C)}var S,f,g,E;switch(p.algorithm){case"aes128":S="AES-128-CBC",g=16,f=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes192":S="AES-192-CBC",g=24,f=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes256":S="AES-256-CBC",g=32,f=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"3des":S="DES-EDE3-CBC",g=24,f=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;case"des":S="DES-CBC",g=8,f=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;default:var T=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+p.algorithm+'".');throw T.algorithm=p.algorithm,T}var I=t.pbe.opensslDeriveBytes(d,f.substr(0,8),g),x=E(I);x.start(f),x.update(r.toDer(a.privateKeyToAsn1(v))),x.finish();var l={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:S,parameters:t.util.bytesToHex(f).toUpperCase()},body:x.output.getBytes()};return t.pem.encode(l)},a.decryptRsaPrivateKey=function(v,d){var p=null,C=t.pem.decode(v)[0];if(C.type!=="ENCRYPTED PRIVATE KEY"&&C.type!=="PRIVATE KEY"&&C.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw S.headerType=S,S}if(C.procType&&C.procType.type==="ENCRYPTED"){var f,g;switch(C.dekInfo.algorithm){case"DES-CBC":f=8,g=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":f=24,g=t.des.createDecryptionCipher;break;case"AES-128-CBC":f=16,g=t.aes.createDecryptionCipher;break;case"AES-192-CBC":f=24,g=t.aes.createDecryptionCipher;break;case"AES-256-CBC":f=32,g=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":f=5,g=function(l){return t.rc2.createDecryptionCipher(l,40)};break;case"RC2-64-CBC":f=8,g=function(l){return t.rc2.createDecryptionCipher(l,64)};break;case"RC2-128-CBC":f=16,g=function(l){return t.rc2.createDecryptionCipher(l,128)};break;default:var S=new Error('Could not decrypt private key; unsupported encryption algorithm "'+C.dekInfo.algorithm+'".');throw S.algorithm=C.dekInfo.algorithm,S}var E=t.util.hexToBytes(C.dekInfo.parameters),T=t.pbe.opensslDeriveBytes(d,E.substr(0,8),f),I=g(T);if(I.start(E),I.update(t.util.createBuffer(C.body)),I.finish())p=I.output.getBytes();else return p}else p=C.body;return C.type==="ENCRYPTED PRIVATE KEY"?p=a.decryptPrivateKeyInfo(r.fromDer(p),d):p=r.fromDer(p),p!==null&&(p=a.privateKeyFromAsn1(p)),p},a.pbe.generatePkcs12Key=function(v,d,p,C,S,f){var g,E;if(typeof f>"u"||f===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');f=t.md.sha1.create()}var T=f.digestLength,I=f.blockLength,x=new t.util.ByteBuffer,l=new t.util.ByteBuffer;if(v!=null){for(E=0;E<v.length;E++)l.putInt16(v.charCodeAt(E));l.putInt16(0)}var s=l.length(),w=d.length(),N=new t.util.ByteBuffer;N.fillWithByte(p,I);var O=I*Math.ceil(w/I),_=new t.util.ByteBuffer;for(E=0;E<O;E++)_.putByte(d.at(E%w));var D=I*Math.ceil(s/I),V=new t.util.ByteBuffer;for(E=0;E<D;E++)V.putByte(l.at(E%s));var P=_;P.putBuffer(V);for(var M=Math.ceil(S/T),q=1;q<=M;q++){var z=new t.util.ByteBuffer;z.putBytes(N.bytes()),z.putBytes(P.bytes());for(var G=0;G<C;G++)f.start(),f.update(z.getBytes()),z=f.digest();var Y=new t.util.ByteBuffer;for(E=0;E<I;E++)Y.putByte(z.at(E%T));var j=Math.ceil(w/I)+Math.ceil(s/I),te=new t.util.ByteBuffer;for(g=0;g<j;g++){var ue=new t.util.ByteBuffer(P.getBytes(I)),X=511;for(E=Y.length()-1;E>=0;E--)X=X>>8,X+=Y.at(E)+ue.at(E),ue.setAt(E,X&255);te.putBuffer(ue)}P=te,x.putBuffer(z)}return x.truncate(x.length()-S),x},a.pbe.getCipher=function(v,d,p){switch(v){case a.oids.pkcs5PBES2:return a.pbe.getCipherForPBES2(v,d,p);case a.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case a.oids["pbewithSHAAnd40BitRC2-CBC"]:return a.pbe.getCipherForPKCS12PBE(v,d,p);default:var C=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw C.oid=v,C.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],C}},a.pbe.getCipherForPBES2=function(v,d,p){var C={},S=[];if(!r.validate(d,i,C,S)){var f=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=S,f}if(v=r.derToOid(C.kdfOid),v!==a.oids.pkcs5PBKDF2){var f=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw f.oid=v,f.supportedOids=["pkcs5PBKDF2"],f}if(v=r.derToOid(C.encOid),v!==a.oids["aes128-CBC"]&&v!==a.oids["aes192-CBC"]&&v!==a.oids["aes256-CBC"]&&v!==a.oids["des-EDE3-CBC"]&&v!==a.oids.desCBC){var f=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw f.oid=v,f.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],f}var g=C.kdfSalt,E=t.util.createBuffer(C.kdfIterationCount);E=E.getInt(E.length()<<3);var T,I;switch(a.oids[v]){case"aes128-CBC":T=16,I=t.aes.createDecryptionCipher;break;case"aes192-CBC":T=24,I=t.aes.createDecryptionCipher;break;case"aes256-CBC":T=32,I=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":T=24,I=t.des.createDecryptionCipher;break;case"desCBC":T=8,I=t.des.createDecryptionCipher;break}var x=h(C.prfOid),l=t.pkcs5.pbkdf2(p,g,E,T,x),s=C.encIv,w=I(l);return w.start(s),w},a.pbe.getCipherForPKCS12PBE=function(v,d,p){var C={},S=[];if(!r.validate(d,n,C,S)){var f=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=S,f}var g=t.util.createBuffer(C.salt),E=t.util.createBuffer(C.iterations);E=E.getInt(E.length()<<3);var T,I,x;switch(v){case a.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:T=24,I=8,x=t.des.startDecrypting;break;case a.oids["pbewithSHAAnd40BitRC2-CBC"]:T=5,I=8,x=function(O,_){var D=t.rc2.createDecryptionCipher(O,40);return D.start(_,null),D};break;default:var f=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw f.oid=v,f}var l=h(C.prfOid),s=a.pbe.generatePkcs12Key(p,g,1,E,T,l);l.start();var w=a.pbe.generatePkcs12Key(p,g,2,E,I,l);return x(s,w)},a.pbe.opensslDeriveBytes=function(v,d,p,C){if(typeof C>"u"||C===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');C=t.md.md5.create()}d===null&&(d="");for(var S=[u(C,v+d)],f=16,g=1;f<p;++g,f+=16)S.push(u(C,S[g-1]+v+d));return S.join("").substr(0,p)};function u(v,d){return v.start().update(d).digest().getBytes()}function h(v){var d;if(!v)d="hmacWithSHA1";else if(d=a.oids[r.derToOid(v)],!d){var p=new Error("Unsupported PRF OID.");throw p.oid=v,p.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],p}return m(d)}function m(v){var d=t.md;switch(v){case"hmacWithSHA224":d=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":v=v.substr(8).toLowerCase();break;default:var p=new Error("Unsupported PRF algorithm.");throw p.algorithm=v,p.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],p}if(!d||!(v in d))throw new Error("Unknown hash algorithm: "+v);return d[v].create()}function B(v,d,p,C){var S=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,v),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,d.getBytes())]);return C!=="hmacWithSHA1"&&S.value.push(r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,t.util.hexToBytes(p.toString(16))),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(a.oids[C]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.NULL,!1,"")])),S}return ia}var sa={exports:{}},oa={exports:{}},Yi;function _o(){if(Yi)return oa.exports;Yi=1;var t=ge();kt(),Ee();var e=t.asn1,r=oa.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=r;var a={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=a;var c={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(c)},r.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(c)};var o={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return r.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},a,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[o]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},oa.exports}var fa={exports:{}},ca={exports:{}},Qi;function Ro(){if(Qi)return ca.exports;Qi=1;var t=ge();Ee(),t.mgf=t.mgf||{};var e=ca.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};return e.create=function(r){var a={generate:function(c,o){for(var i=new t.util.ByteBuffer,n=Math.ceil(o/r.digestLength),u=0;u<n;u++){var h=new t.util.ByteBuffer;h.putInt32(u),r.start(),r.update(c+h.getBytes()),i.putBuffer(r.digest())}return i.truncate(i.length()-o),i.getBytes()}};return a},ca.exports}var ua,Xi;function Tu(){if(Xi)return ua;Xi=1;var t=ge();return Ro(),ua=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1,ua}var la={exports:{}},ji;function Xa(){if(ji)return la.exports;ji=1;var t=ge();Bt(),Ee();var e=la.exports=t.pss=t.pss||{};return e.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var a=r.md,c=r.mgf,o=a.digestLength,i=r.salt||null;typeof i=="string"&&(i=t.util.createBuffer(i));var n;if("saltLength"in r)n=r.saltLength;else if(i!==null)n=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==n)throw new Error("Given salt length does not match length of given salt.");var u=r.prng||t.random,h={};return h.encode=function(m,B){var v,d=B-1,p=Math.ceil(d/8),C=m.digest().getBytes();if(p<o+n+2)throw new Error("Message is too long to encrypt.");var S;i===null?S=u.getBytesSync(n):S=i.bytes();var f=new t.util.ByteBuffer;f.fillWithByte(0,8),f.putBytes(C),f.putBytes(S),a.start(),a.update(f.getBytes());var g=a.digest().getBytes(),E=new t.util.ByteBuffer;E.fillWithByte(0,p-n-o-2),E.putByte(1),E.putBytes(S);var T=E.getBytes(),I=p-o-1,x=c.generate(g,I),l="";for(v=0;v<I;v++)l+=String.fromCharCode(T.charCodeAt(v)^x.charCodeAt(v));var s=65280>>8*p-d&255;return l=String.fromCharCode(l.charCodeAt(0)&~s)+l.substr(1),l+g+""},h.verify=function(m,B,v){var d,p=v-1,C=Math.ceil(p/8);if(B=B.substr(-C),C<o+n+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(B.charCodeAt(C-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var S=C-o-1,f=B.substr(0,S),g=B.substr(S,o),E=65280>>8*C-p&255;if((f.charCodeAt(0)&E)!==0)throw new Error("Bits beyond keysize not zero as expected.");var T=c.generate(g,S),I="";for(d=0;d<S;d++)I+=String.fromCharCode(f.charCodeAt(d)^T.charCodeAt(d));I=String.fromCharCode(I.charCodeAt(0)&~E)+I.substr(1);var x=C-o-n-2;for(d=0;d<x;d++)if(I.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(I.charCodeAt(x)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var l=I.substr(-n),s=new t.util.ByteBuffer;s.fillWithByte(0,8),s.putBytes(m),s.putBytes(l),a.start(),a.update(s.getBytes());var w=a.digest().getBytes();return g===w},h},la.exports}var Zi;function ja(){if(Zi)return fa.exports;Zi=1;var t=ge();hr(),kt(),Cn(),qt(),Tu(),dr(),Cr(),Xa(),Bn(),Ee();var e=t.asn1,r=fa.exports=t.pki=t.pki||{},a=r.oids,c={};c.CN=a.commonName,c.commonName="CN",c.C=a.countryName,c.countryName="C",c.L=a.localityName,c.localityName="L",c.ST=a.stateOrProvinceName,c.stateOrProvinceName="ST",c.O=a.organizationName,c.organizationName="O",c.OU=a.organizationalUnitName,c.organizationalUnitName="OU",c.E=a.emailAddress,c.emailAddress="E";var o=t.pki.rsa.publicKeyValidator,i={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},o,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},n={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},u={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},o,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},h={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[u,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};r.RDNAttributesAsArray=function(x,l){for(var s=[],w,N,O,_=0;_<x.value.length;++_){w=x.value[_];for(var D=0;D<w.value.length;++D)O={},N=w.value[D],O.type=e.derToOid(N.value[0].value),O.value=N.value[1].value,O.valueTagClass=N.value[1].type,O.type in a&&(O.name=a[O.type],O.name in c&&(O.shortName=c[O.name])),l&&(l.update(O.type),l.update(O.value)),s.push(O)}return s},r.CRIAttributesAsArray=function(x){for(var l=[],s=0;s<x.length;++s)for(var w=x[s],N=e.derToOid(w.value[0].value),O=w.value[1].value,_=0;_<O.length;++_){var D={};if(D.type=N,D.value=O[_].value,D.valueTagClass=O[_].type,D.type in a&&(D.name=a[D.type],D.name in c&&(D.shortName=c[D.name])),D.type===a.extensionRequest){D.extensions=[];for(var V=0;V<D.value.length;++V)D.extensions.push(r.certificateExtensionFromAsn1(D.value[V]))}l.push(D)}return l};function m(x,l){typeof l=="string"&&(l={shortName:l});for(var s=null,w,N=0;s===null&&N<x.attributes.length;++N)w=x.attributes[N],(l.type&&l.type===w.type||l.name&&l.name===w.name||l.shortName&&l.shortName===w.shortName)&&(s=w);return s}var B=function(x,l,s){var w={};if(x!==a["RSASSA-PSS"])return w;s&&(w={hash:{algorithmOid:a.sha1},mgf:{algorithmOid:a.mgf1,hash:{algorithmOid:a.sha1}},saltLength:20});var N={},O=[];if(!e.validate(l,n,N,O)){var _=new Error("Cannot read RSASSA-PSS parameter block.");throw _.errors=O,_}return N.hashOid!==void 0&&(w.hash=w.hash||{},w.hash.algorithmOid=e.derToOid(N.hashOid)),N.maskGenOid!==void 0&&(w.mgf=w.mgf||{},w.mgf.algorithmOid=e.derToOid(N.maskGenOid),w.mgf.hash=w.mgf.hash||{},w.mgf.hash.algorithmOid=e.derToOid(N.maskGenHashOid)),N.saltLength!==void 0&&(w.saltLength=N.saltLength.charCodeAt(0)),w},v=function(x){switch(a[x.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var l=new Error("Could not compute "+x.type+" digest. Unknown signature OID.");throw l.signatureOid=x.signatureOid,l}},d=function(x){var l=x.certificate,s;switch(l.signatureOid){case a.sha1WithRSAEncryption:case a.sha1WithRSASignature:break;case a["RSASSA-PSS"]:var w,N;if(w=a[l.signatureParameters.mgf.hash.algorithmOid],w===void 0||t.md[w]===void 0){var O=new Error("Unsupported MGF hash function.");throw O.oid=l.signatureParameters.mgf.hash.algorithmOid,O.name=w,O}if(N=a[l.signatureParameters.mgf.algorithmOid],N===void 0||t.mgf[N]===void 0){var O=new Error("Unsupported MGF function.");throw O.oid=l.signatureParameters.mgf.algorithmOid,O.name=N,O}if(N=t.mgf[N].create(t.md[w].create()),w=a[l.signatureParameters.hash.algorithmOid],w===void 0||t.md[w]===void 0){var O=new Error("Unsupported RSASSA-PSS hash function.");throw O.oid=l.signatureParameters.hash.algorithmOid,O.name=w,O}s=t.pss.create(t.md[w].create(),N,l.signatureParameters.saltLength);break}return l.publicKey.verify(x.md.digest().getBytes(),x.signature,s)};r.certificateFromPem=function(x,l,s){var w=t.pem.decode(x)[0];if(w.type!=="CERTIFICATE"&&w.type!=="X509 CERTIFICATE"&&w.type!=="TRUSTED CERTIFICATE"){var N=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw N.headerType=w.type,N}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var O=e.fromDer(w.body,s);return r.certificateFromAsn1(O,l)},r.certificateToPem=function(x,l){var s={type:"CERTIFICATE",body:e.toDer(r.certificateToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:l})},r.publicKeyFromPem=function(x){var l=t.pem.decode(x)[0];if(l.type!=="PUBLIC KEY"&&l.type!=="RSA PUBLIC KEY"){var s=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw s.headerType=l.type,s}if(l.procType&&l.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var w=e.fromDer(l.body);return r.publicKeyFromAsn1(w)},r.publicKeyToPem=function(x,l){var s={type:"PUBLIC KEY",body:e.toDer(r.publicKeyToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:l})},r.publicKeyToRSAPublicKeyPem=function(x,l){var s={type:"RSA PUBLIC KEY",body:e.toDer(r.publicKeyToRSAPublicKey(x)).getBytes()};return t.pem.encode(s,{maxline:l})},r.getPublicKeyFingerprint=function(x,l){l=l||{};var s=l.md||t.md.sha1.create(),w=l.type||"RSAPublicKey",N;switch(w){case"RSAPublicKey":N=e.toDer(r.publicKeyToRSAPublicKey(x)).getBytes();break;case"SubjectPublicKeyInfo":N=e.toDer(r.publicKeyToAsn1(x)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+l.type+'".')}s.start(),s.update(N);var O=s.digest();if(l.encoding==="hex"){var _=O.toHex();return l.delimiter?_.match(/.{2}/g).join(l.delimiter):_}else{if(l.encoding==="binary")return O.getBytes();if(l.encoding)throw new Error('Unknown encoding "'+l.encoding+'".')}return O},r.certificationRequestFromPem=function(x,l,s){var w=t.pem.decode(x)[0];if(w.type!=="CERTIFICATE REQUEST"){var N=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw N.headerType=w.type,N}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var O=e.fromDer(w.body,s);return r.certificationRequestFromAsn1(O,l)},r.certificationRequestToPem=function(x,l){var s={type:"CERTIFICATE REQUEST",body:e.toDer(r.certificationRequestToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:l})},r.createCertificate=function(){var x={};return x.version=2,x.serialNumber="00",x.signatureOid=null,x.signature=null,x.siginfo={},x.siginfo.algorithmOid=null,x.validity={},x.validity.notBefore=new Date,x.validity.notAfter=new Date,x.issuer={},x.issuer.getField=function(l){return m(x.issuer,l)},x.issuer.addField=function(l){C([l]),x.issuer.attributes.push(l)},x.issuer.attributes=[],x.issuer.hash=null,x.subject={},x.subject.getField=function(l){return m(x.subject,l)},x.subject.addField=function(l){C([l]),x.subject.attributes.push(l)},x.subject.attributes=[],x.subject.hash=null,x.extensions=[],x.publicKey=null,x.md=null,x.setSubject=function(l,s){C(l),x.subject.attributes=l,delete x.subject.uniqueId,s&&(x.subject.uniqueId=s),x.subject.hash=null},x.setIssuer=function(l,s){C(l),x.issuer.attributes=l,delete x.issuer.uniqueId,s&&(x.issuer.uniqueId=s),x.issuer.hash=null},x.setExtensions=function(l){for(var s=0;s<l.length;++s)S(l[s],{cert:x});x.extensions=l},x.getExtension=function(l){typeof l=="string"&&(l={name:l});for(var s=null,w,N=0;s===null&&N<x.extensions.length;++N)w=x.extensions[N],(l.id&&w.id===l.id||l.name&&w.name===l.name)&&(s=w);return s},x.sign=function(l,s){x.md=s||t.md.sha1.create();var w=a[x.md.algorithm+"WithRSAEncryption"];if(!w){var N=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw N.algorithm=x.md.algorithm,N}x.signatureOid=x.siginfo.algorithmOid=w,x.tbsCertificate=r.getTBSCertificate(x);var O=e.toDer(x.tbsCertificate);x.md.update(O.getBytes()),x.signature=l.sign(x.md)},x.verify=function(l){var s=!1;if(!x.issued(l)){var w=l.issuer,N=x.subject,O=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw O.expectedIssuer=N.attributes,O.actualIssuer=w.attributes,O}var _=l.md;if(_===null){_=v({signatureOid:l.signatureOid,type:"certificate"});var D=l.tbsCertificate||r.getTBSCertificate(l),V=e.toDer(D);_.update(V.getBytes())}return _!==null&&(s=d({certificate:x,md:_,signature:l.signature})),s},x.isIssuer=function(l){var s=!1,w=x.issuer,N=l.subject;if(w.hash&&N.hash)s=w.hash===N.hash;else if(w.attributes.length===N.attributes.length){s=!0;for(var O,_,D=0;s&&D<w.attributes.length;++D)O=w.attributes[D],_=N.attributes[D],(O.type!==_.type||O.value!==_.value)&&(s=!1)}return s},x.issued=function(l){return l.isIssuer(x)},x.generateSubjectKeyIdentifier=function(){return r.getPublicKeyFingerprint(x.publicKey,{type:"RSAPublicKey"})},x.verifySubjectKeyIdentifier=function(){for(var l=a.subjectKeyIdentifier,s=0;s<x.extensions.length;++s){var w=x.extensions[s];if(w.id===l){var N=x.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(w.subjectKeyIdentifier)===N}}return!1},x},r.certificateFromAsn1=function(x,l){var s={},w=[];if(!e.validate(x,i,s,w)){var N=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw N.errors=w,N}var O=e.derToOid(s.publicKeyOid);if(O!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var _=r.createCertificate();_.version=s.certVersion?s.certVersion.charCodeAt(0):0;var D=t.util.createBuffer(s.certSerialNumber);_.serialNumber=D.toHex(),_.signatureOid=t.asn1.derToOid(s.certSignatureOid),_.signatureParameters=B(_.signatureOid,s.certSignatureParams,!0),_.siginfo.algorithmOid=t.asn1.derToOid(s.certinfoSignatureOid),_.siginfo.parameters=B(_.siginfo.algorithmOid,s.certinfoSignatureParams,!1),_.signature=s.certSignature;var V=[];if(s.certValidity1UTCTime!==void 0&&V.push(e.utcTimeToDate(s.certValidity1UTCTime)),s.certValidity2GeneralizedTime!==void 0&&V.push(e.generalizedTimeToDate(s.certValidity2GeneralizedTime)),s.certValidity3UTCTime!==void 0&&V.push(e.utcTimeToDate(s.certValidity3UTCTime)),s.certValidity4GeneralizedTime!==void 0&&V.push(e.generalizedTimeToDate(s.certValidity4GeneralizedTime)),V.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(V.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(_.validity.notBefore=V[0],_.validity.notAfter=V[1],_.tbsCertificate=s.tbsCertificate,l){_.md=v({signatureOid:_.signatureOid,type:"certificate"});var P=e.toDer(_.tbsCertificate);_.md.update(P.getBytes())}var M=t.md.sha1.create(),q=e.toDer(s.certIssuer);M.update(q.getBytes()),_.issuer.getField=function(Y){return m(_.issuer,Y)},_.issuer.addField=function(Y){C([Y]),_.issuer.attributes.push(Y)},_.issuer.attributes=r.RDNAttributesAsArray(s.certIssuer),s.certIssuerUniqueId&&(_.issuer.uniqueId=s.certIssuerUniqueId),_.issuer.hash=M.digest().toHex();var z=t.md.sha1.create(),G=e.toDer(s.certSubject);return z.update(G.getBytes()),_.subject.getField=function(Y){return m(_.subject,Y)},_.subject.addField=function(Y){C([Y]),_.subject.attributes.push(Y)},_.subject.attributes=r.RDNAttributesAsArray(s.certSubject),s.certSubjectUniqueId&&(_.subject.uniqueId=s.certSubjectUniqueId),_.subject.hash=z.digest().toHex(),s.certExtensions?_.extensions=r.certificateExtensionsFromAsn1(s.certExtensions):_.extensions=[],_.publicKey=r.publicKeyFromAsn1(s.subjectPublicKeyInfo),_},r.certificateExtensionsFromAsn1=function(x){for(var l=[],s=0;s<x.value.length;++s)for(var w=x.value[s],N=0;N<w.value.length;++N)l.push(r.certificateExtensionFromAsn1(w.value[N]));return l},r.certificateExtensionFromAsn1=function(x){var l={};if(l.id=e.derToOid(x.value[0].value),l.critical=!1,x.value[1].type===e.Type.BOOLEAN?(l.critical=x.value[1].value.charCodeAt(0)!==0,l.value=x.value[2].value):l.value=x.value[1].value,l.id in a){if(l.name=a[l.id],l.name==="keyUsage"){var s=e.fromDer(l.value),w=0,N=0;s.value.length>1&&(w=s.value.charCodeAt(1),N=s.value.length>2?s.value.charCodeAt(2):0),l.digitalSignature=(w&128)===128,l.nonRepudiation=(w&64)===64,l.keyEncipherment=(w&32)===32,l.dataEncipherment=(w&16)===16,l.keyAgreement=(w&8)===8,l.keyCertSign=(w&4)===4,l.cRLSign=(w&2)===2,l.encipherOnly=(w&1)===1,l.decipherOnly=(N&128)===128}else if(l.name==="basicConstraints"){var s=e.fromDer(l.value);s.value.length>0&&s.value[0].type===e.Type.BOOLEAN?l.cA=s.value[0].value.charCodeAt(0)!==0:l.cA=!1;var O=null;s.value.length>0&&s.value[0].type===e.Type.INTEGER?O=s.value[0].value:s.value.length>1&&(O=s.value[1].value),O!==null&&(l.pathLenConstraint=e.derToInteger(O))}else if(l.name==="extKeyUsage")for(var s=e.fromDer(l.value),_=0;_<s.value.length;++_){var D=e.derToOid(s.value[_].value);D in a?l[a[D]]=!0:l[D]=!0}else if(l.name==="nsCertType"){var s=e.fromDer(l.value),w=0;s.value.length>1&&(w=s.value.charCodeAt(1)),l.client=(w&128)===128,l.server=(w&64)===64,l.email=(w&32)===32,l.objsign=(w&16)===16,l.reserved=(w&8)===8,l.sslCA=(w&4)===4,l.emailCA=(w&2)===2,l.objCA=(w&1)===1}else if(l.name==="subjectAltName"||l.name==="issuerAltName"){l.altNames=[];for(var V,s=e.fromDer(l.value),P=0;P<s.value.length;++P){V=s.value[P];var M={type:V.type,value:V.value};switch(l.altNames.push(M),V.type){case 1:case 2:case 6:break;case 7:M.ip=t.util.bytesToIP(V.value);break;case 8:M.oid=e.derToOid(V.value);break}}}else if(l.name==="subjectKeyIdentifier"){var s=e.fromDer(l.value);l.subjectKeyIdentifier=t.util.bytesToHex(s.value)}}return l},r.certificationRequestFromAsn1=function(x,l){var s={},w=[];if(!e.validate(x,h,s,w)){var N=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw N.errors=w,N}var O=e.derToOid(s.publicKeyOid);if(O!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var _=r.createCertificationRequest();if(_.version=s.csrVersion?s.csrVersion.charCodeAt(0):0,_.signatureOid=t.asn1.derToOid(s.csrSignatureOid),_.signatureParameters=B(_.signatureOid,s.csrSignatureParams,!0),_.siginfo.algorithmOid=t.asn1.derToOid(s.csrSignatureOid),_.siginfo.parameters=B(_.siginfo.algorithmOid,s.csrSignatureParams,!1),_.signature=s.csrSignature,_.certificationRequestInfo=s.certificationRequestInfo,l){_.md=v({signatureOid:_.signatureOid,type:"certification request"});var D=e.toDer(_.certificationRequestInfo);_.md.update(D.getBytes())}var V=t.md.sha1.create();return _.subject.getField=function(P){return m(_.subject,P)},_.subject.addField=function(P){C([P]),_.subject.attributes.push(P)},_.subject.attributes=r.RDNAttributesAsArray(s.certificationRequestInfoSubject,V),_.subject.hash=V.digest().toHex(),_.publicKey=r.publicKeyFromAsn1(s.subjectPublicKeyInfo),_.getAttribute=function(P){return m(_,P)},_.addAttribute=function(P){C([P]),_.attributes.push(P)},_.attributes=r.CRIAttributesAsArray(s.certificationRequestInfoAttributes||[]),_},r.createCertificationRequest=function(){var x={};return x.version=0,x.signatureOid=null,x.signature=null,x.siginfo={},x.siginfo.algorithmOid=null,x.subject={},x.subject.getField=function(l){return m(x.subject,l)},x.subject.addField=function(l){C([l]),x.subject.attributes.push(l)},x.subject.attributes=[],x.subject.hash=null,x.publicKey=null,x.attributes=[],x.getAttribute=function(l){return m(x,l)},x.addAttribute=function(l){C([l]),x.attributes.push(l)},x.md=null,x.setSubject=function(l){C(l),x.subject.attributes=l,x.subject.hash=null},x.setAttributes=function(l){C(l),x.attributes=l},x.sign=function(l,s){x.md=s||t.md.sha1.create();var w=a[x.md.algorithm+"WithRSAEncryption"];if(!w){var N=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw N.algorithm=x.md.algorithm,N}x.signatureOid=x.siginfo.algorithmOid=w,x.certificationRequestInfo=r.getCertificationRequestInfo(x);var O=e.toDer(x.certificationRequestInfo);x.md.update(O.getBytes()),x.signature=l.sign(x.md)},x.verify=function(){var l=!1,s=x.md;if(s===null){s=v({signatureOid:x.signatureOid,type:"certification request"});var w=x.certificationRequestInfo||r.getCertificationRequestInfo(x),N=e.toDer(w);s.update(N.getBytes())}return s!==null&&(l=d({certificate:x,md:s,signature:x.signature})),l},x};function p(x){for(var l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),s,w,N=x.attributes,O=0;O<N.length;++O){s=N[O];var _=s.value,D=e.Type.PRINTABLESTRING;"valueTagClass"in s&&(D=s.valueTagClass,D===e.Type.UTF8&&(_=t.util.encodeUtf8(_))),w=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(s.type).getBytes()),e.create(e.Class.UNIVERSAL,D,!1,_)])]),l.value.push(w)}return l}function C(x){for(var l,s=0;s<x.length;++s){if(l=x[s],typeof l.name>"u"&&(l.type&&l.type in r.oids?l.name=r.oids[l.type]:l.shortName&&l.shortName in c&&(l.name=r.oids[c[l.shortName]])),typeof l.type>"u")if(l.name&&l.name in r.oids)l.type=r.oids[l.name];else{var w=new Error("Attribute type not specified.");throw w.attribute=l,w}if(typeof l.shortName>"u"&&l.name&&l.name in c&&(l.shortName=c[l.name]),l.type===a.extensionRequest&&(l.valueConstructed=!0,l.valueTagClass=e.Type.SEQUENCE,!l.value&&l.extensions)){l.value=[];for(var N=0;N<l.extensions.length;++N)l.value.push(r.certificateExtensionToAsn1(S(l.extensions[N])))}if(typeof l.value>"u"){var w=new Error("Attribute value not specified.");throw w.attribute=l,w}}}function S(x,l){if(l=l||{},typeof x.name>"u"&&x.id&&x.id in r.oids&&(x.name=r.oids[x.id]),typeof x.id>"u")if(x.name&&x.name in r.oids)x.id=r.oids[x.name];else{var s=new Error("Extension ID not specified.");throw s.extension=x,s}if(typeof x.value<"u")return x;if(x.name==="keyUsage"){var w=0,N=0,O=0;x.digitalSignature&&(N|=128,w=7),x.nonRepudiation&&(N|=64,w=6),x.keyEncipherment&&(N|=32,w=5),x.dataEncipherment&&(N|=16,w=4),x.keyAgreement&&(N|=8,w=3),x.keyCertSign&&(N|=4,w=2),x.cRLSign&&(N|=2,w=1),x.encipherOnly&&(N|=1,w=0),x.decipherOnly&&(O|=128,w=7);var _=String.fromCharCode(w);O!==0?_+=String.fromCharCode(N)+String.fromCharCode(O):N!==0&&(_+=String.fromCharCode(N)),x.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,_)}else if(x.name==="basicConstraints")x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),x.cA&&x.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"")),"pathLenConstraint"in x&&x.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.pathLenConstraint).getBytes()));else if(x.name==="extKeyUsage"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var D=x.value.value;for(var V in x)x[V]===!0&&(V in a?D.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a[V]).getBytes())):V.indexOf(".")!==-1&&D.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(V).getBytes())))}else if(x.name==="nsCertType"){var w=0,N=0;x.client&&(N|=128,w=7),x.server&&(N|=64,w=6),x.email&&(N|=32,w=5),x.objsign&&(N|=16,w=4),x.reserved&&(N|=8,w=3),x.sslCA&&(N|=4,w=2),x.emailCA&&(N|=2,w=1),x.objCA&&(N|=1,w=0);var _=String.fromCharCode(w);N!==0&&(_+=String.fromCharCode(N)),x.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,_)}else if(x.name==="subjectAltName"||x.name==="issuerAltName"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var P,M=0;M<x.altNames.length;++M){P=x.altNames[M];var _=P.value;if(P.type===7&&P.ip){if(_=t.util.bytesFromIP(P.ip),_===null){var s=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw s.extension=x,s}}else P.type===8&&(P.oid?_=e.oidToDer(e.oidToDer(P.oid)):_=e.oidToDer(_));x.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,P.type,!1,_))}}else if(x.name==="nsComment"&&l.cert){if(!/^[\x00-\x7F]*$/.test(x.comment)||x.comment.length<1||x.comment.length>128)throw new Error('Invalid "nsComment" content.');x.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,x.comment)}else if(x.name==="subjectKeyIdentifier"&&l.cert){var q=l.cert.generateSubjectKeyIdentifier();x.subjectKeyIdentifier=q.toHex(),x.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,q.getBytes())}else if(x.name==="authorityKeyIdentifier"&&l.cert){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var D=x.value.value;if(x.keyIdentifier){var z=x.keyIdentifier===!0?l.cert.generateSubjectKeyIdentifier().getBytes():x.keyIdentifier;D.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,z))}if(x.authorityCertIssuer){var G=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[p(x.authorityCertIssuer===!0?l.cert.issuer:x.authorityCertIssuer)])];D.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,G))}if(x.serialNumber){var Y=t.util.hexToBytes(x.serialNumber===!0?l.cert.serialNumber:x.serialNumber);D.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,Y))}}else if(x.name==="cRLDistributionPoints"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var D=x.value.value,j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),te=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),P,M=0;M<x.altNames.length;++M){P=x.altNames[M];var _=P.value;if(P.type===7&&P.ip){if(_=t.util.bytesFromIP(P.ip),_===null){var s=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw s.extension=x,s}}else P.type===8&&(P.oid?_=e.oidToDer(e.oidToDer(P.oid)):_=e.oidToDer(_));te.value.push(e.create(e.Class.CONTEXT_SPECIFIC,P.type,!1,_))}j.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[te])),D.push(j)}if(typeof x.value>"u"){var s=new Error("Extension value not specified.");throw s.extension=x,s}return x}function f(x,l){switch(x){case a["RSASSA-PSS"]:var s=[];return l.hash.algorithmOid!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(l.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),l.mgf.algorithmOid!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(l.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(l.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),l.saltLength!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(l.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,s);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function g(x){var l=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(x.attributes.length===0)return l;for(var s=x.attributes,w=0;w<s.length;++w){var N=s[w],O=N.value,_=e.Type.UTF8;"valueTagClass"in N&&(_=N.valueTagClass),_===e.Type.UTF8&&(O=t.util.encodeUtf8(O));var D=!1;"valueConstructed"in N&&(D=N.valueConstructed);var V=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(N.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,_,D,O)])]);l.value.push(V)}return l}var E=new Date("1950-01-01T00:00:00Z"),T=new Date("2050-01-01T00:00:00Z");function I(x){return x>=E&&x<T?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(x)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(x))}return r.getTBSCertificate=function(x){var l=I(x.validity.notBefore),s=I(x.validity.notAfter),w=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(x.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.siginfo.algorithmOid).getBytes()),f(x.siginfo.algorithmOid,x.siginfo.parameters)]),p(x.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[l,s]),p(x.subject),r.publicKeyToAsn1(x.publicKey)]);return x.issuer.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.issuer.uniqueId)])),x.subject.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.subject.uniqueId)])),x.extensions.length>0&&w.value.push(r.certificateExtensionsToAsn1(x.extensions)),w},r.getCertificationRequestInfo=function(x){var l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.version).getBytes()),p(x.subject),r.publicKeyToAsn1(x.publicKey),g(x)]);return l},r.distinguishedNameToAsn1=function(x){return p(x)},r.certificateToAsn1=function(x){var l=x.tbsCertificate||r.getTBSCertificate(x);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[l,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.signatureOid).getBytes()),f(x.signatureOid,x.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.signature)])},r.certificateExtensionsToAsn1=function(x){var l=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),s=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);l.value.push(s);for(var w=0;w<x.length;++w)s.value.push(r.certificateExtensionToAsn1(x[w]));return l},r.certificateExtensionToAsn1=function(x){var l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);l.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.id).getBytes())),x.critical&&l.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,""));var s=x.value;return typeof x.value!="string"&&(s=e.toDer(s).getBytes()),l.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s)),l},r.certificationRequestToAsn1=function(x){var l=x.certificationRequestInfo||r.getCertificationRequestInfo(x);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[l,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.signatureOid).getBytes()),f(x.signatureOid,x.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.signature)])},r.createCaStore=function(x){var l={certs:{}};l.getIssuer=function(_){var D=s(_.issuer);return D},l.addCertificate=function(_){if(typeof _=="string"&&(_=t.pki.certificateFromPem(_)),w(_.subject),!l.hasCertificate(_))if(_.subject.hash in l.certs){var D=l.certs[_.subject.hash];t.util.isArray(D)||(D=[D]),D.push(_),l.certs[_.subject.hash]=D}else l.certs[_.subject.hash]=_},l.hasCertificate=function(_){typeof _=="string"&&(_=t.pki.certificateFromPem(_));var D=s(_.subject);if(!D)return!1;t.util.isArray(D)||(D=[D]);for(var V=e.toDer(r.certificateToAsn1(_)).getBytes(),P=0;P<D.length;++P){var M=e.toDer(r.certificateToAsn1(D[P])).getBytes();if(V===M)return!0}return!1},l.listAllCertificates=function(){var _=[];for(var D in l.certs)if(l.certs.hasOwnProperty(D)){var V=l.certs[D];if(!t.util.isArray(V))_.push(V);else for(var P=0;P<V.length;++P)_.push(V[P])}return _},l.removeCertificate=function(_){var D;if(typeof _=="string"&&(_=t.pki.certificateFromPem(_)),w(_.subject),!l.hasCertificate(_))return null;var V=s(_.subject);if(!t.util.isArray(V))return D=l.certs[_.subject.hash],delete l.certs[_.subject.hash],D;for(var P=e.toDer(r.certificateToAsn1(_)).getBytes(),M=0;M<V.length;++M){var q=e.toDer(r.certificateToAsn1(V[M])).getBytes();P===q&&(D=V[M],V.splice(M,1))}return V.length===0&&delete l.certs[_.subject.hash],D};function s(_){return w(_),l.certs[_.hash]||null}function w(_){if(!_.hash){var D=t.md.sha1.create();_.attributes=r.RDNAttributesAsArray(p(_),D),_.hash=D.digest().toHex()}}if(x)for(var N=0;N<x.length;++N){var O=x[N];l.addCertificate(O)}return l},r.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},r.verifyCertificateChain=function(x,l,s){typeof s=="function"&&(s={verify:s}),s=s||{},l=l.slice(0);var w=l.slice(0),N=s.validityCheckDate;typeof N>"u"&&(N=new Date);var O=!0,_=null,D=0;do{var V=l.shift(),P=null,M=!1;if(N&&(N<V.validity.notBefore||N>V.validity.notAfter)&&(_={message:"Certificate is not valid yet or has expired.",error:r.certificateError.certificate_expired,notBefore:V.validity.notBefore,notAfter:V.validity.notAfter,now:N}),_===null){if(P=l[0]||x.getIssuer(V),P===null&&V.isIssuer(V)&&(M=!0,P=V),P){var q=P;t.util.isArray(q)||(q=[q]);for(var z=!1;!z&&q.length>0;){P=q.shift();try{z=P.verify(V)}catch{}}z||(_={message:"Certificate signature is invalid.",error:r.certificateError.bad_certificate})}_===null&&(!P||M)&&!x.hasCertificate(V)&&(_={message:"Certificate is not trusted.",error:r.certificateError.unknown_ca})}if(_===null&&P&&!V.isIssuer(P)&&(_={message:"Certificate issuer is invalid.",error:r.certificateError.bad_certificate}),_===null)for(var G={keyUsage:!0,basicConstraints:!0},Y=0;_===null&&Y<V.extensions.length;++Y){var j=V.extensions[Y];j.critical&&!(j.name in G)&&(_={message:"Certificate has an unsupported critical extension.",error:r.certificateError.unsupported_certificate})}if(_===null&&(!O||l.length===0&&(!P||M))){var te=V.getExtension("basicConstraints"),ue=V.getExtension("keyUsage");if(ue!==null&&(!ue.keyCertSign||te===null)&&(_={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:r.certificateError.bad_certificate}),_===null&&te!==null&&!te.cA&&(_={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:r.certificateError.bad_certificate}),_===null&&ue!==null&&"pathLenConstraint"in te){var X=D-1;X>te.pathLenConstraint&&(_={message:"Certificate basicConstraints pathLenConstraint violated.",error:r.certificateError.bad_certificate})}}var re=_===null?!0:_.error,W=s.verify?s.verify(re,D,w):re;if(W===!0)_=null;else throw re===!0&&(_={message:"The application rejected the certificate.",error:r.certificateError.bad_certificate}),(W||W===0)&&(typeof W=="object"&&!t.util.isArray(W)?(W.message&&(_.message=W.message),W.error&&(_.error=W.error)):typeof W=="string"&&(_.error=W)),_;O=!1,++D}while(l.length>0);return!0},fa.exports}var Wi;function No(){if(Wi)return sa.exports;Wi=1;var t=ge();kt(),Hr(),dr(),_o(),Io(),Bt(),Bn(),qr(),Ee(),ja();var e=t.asn1,r=t.pki,a=sa.exports=t.pkcs12=t.pkcs12||{},c={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},o={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},c,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},i={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},n={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},u={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function h(C,S,f,g){for(var E=[],T=0;T<C.length;T++)for(var I=0;I<C[T].safeBags.length;I++){var x=C[T].safeBags[I];if(!(g!==void 0&&x.type!==g)){if(S===null){E.push(x);continue}x.attributes[S]!==void 0&&x.attributes[S].indexOf(f)>=0&&E.push(x)}}return E}a.pkcs12FromAsn1=function(C,S,f){typeof S=="string"?(f=S,S=!0):S===void 0&&(S=!0);var g={},E=[];if(!e.validate(C,o,g,E)){var T=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw T.errors=T,T}var I={version:g.version.charCodeAt(0),safeContents:[],getBags:function(P){var M={},q;return"localKeyId"in P?q=P.localKeyId:"localKeyIdHex"in P&&(q=t.util.hexToBytes(P.localKeyIdHex)),q===void 0&&!("friendlyName"in P)&&"bagType"in P&&(M[P.bagType]=h(I.safeContents,null,null,P.bagType)),q!==void 0&&(M.localKeyId=h(I.safeContents,"localKeyId",q,P.bagType)),"friendlyName"in P&&(M.friendlyName=h(I.safeContents,"friendlyName",P.friendlyName,P.bagType)),M},getBagsByFriendlyName:function(P,M){return h(I.safeContents,"friendlyName",P,M)},getBagsByLocalKeyId:function(P,M){return h(I.safeContents,"localKeyId",P,M)}};if(g.version.charCodeAt(0)!==3){var T=new Error("PKCS#12 PFX of version other than 3 not supported.");throw T.version=g.version.charCodeAt(0),T}if(e.derToOid(g.contentType)!==r.oids.data){var T=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw T.oid=e.derToOid(g.contentType),T}var x=g.content.value[0];if(x.tagClass!==e.Class.UNIVERSAL||x.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(x=m(x),g.mac){var l=null,s=0,w=e.derToOid(g.macAlgorithm);switch(w){case r.oids.sha1:l=t.md.sha1.create(),s=20;break;case r.oids.sha256:l=t.md.sha256.create(),s=32;break;case r.oids.sha384:l=t.md.sha384.create(),s=48;break;case r.oids.sha512:l=t.md.sha512.create(),s=64;break;case r.oids.md5:l=t.md.md5.create(),s=16;break}if(l===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+w);var N=new t.util.ByteBuffer(g.macSalt),O="macIterations"in g?parseInt(t.util.bytesToHex(g.macIterations),16):1,_=a.generateKey(f,N,3,O,s,l),D=t.hmac.create();D.start(l,_),D.update(x.value);var V=D.getMac();if(V.getBytes()!==g.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return B(I,x.value,S,f),I};function m(C){if(C.composed||C.constructed){for(var S=t.util.createBuffer(),f=0;f<C.value.length;++f)S.putBytes(C.value[f].value);C.composed=C.constructed=!1,C.value=S.getBytes()}return C}function B(C,S,f,g){if(S=e.fromDer(S,f),S.tagClass!==e.Class.UNIVERSAL||S.type!==e.Type.SEQUENCE||S.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var E=0;E<S.value.length;E++){var T=S.value[E],I={},x=[];if(!e.validate(T,c,I,x)){var l=new Error("Cannot read ContentInfo.");throw l.errors=x,l}var s={encrypted:!1},w=null,N=I.content.value[0];switch(e.derToOid(I.contentType)){case r.oids.data:if(N.tagClass!==e.Class.UNIVERSAL||N.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");w=m(N).value;break;case r.oids.encryptedData:w=v(N,g),s.encrypted=!0;break;default:var l=new Error("Unsupported PKCS#12 contentType.");throw l.contentType=e.derToOid(I.contentType),l}s.safeBags=d(w,f,g),C.safeContents.push(s)}}function v(C,S){var f={},g=[];if(!e.validate(C,t.pkcs7.asn1.encryptedDataValidator,f,g)){var E=new Error("Cannot read EncryptedContentInfo.");throw E.errors=g,E}var T=e.derToOid(f.contentType);if(T!==r.oids.data){var E=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw E.oid=T,E}T=e.derToOid(f.encAlgorithm);var I=r.pbe.getCipher(T,f.encParameter,S),x=m(f.encryptedContentAsn1),l=t.util.createBuffer(x.value);if(I.update(l),!I.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return I.output.getBytes()}function d(C,S,f){if(!S&&C.length===0)return[];if(C=e.fromDer(C,S),C.tagClass!==e.Class.UNIVERSAL||C.type!==e.Type.SEQUENCE||C.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var g=[],E=0;E<C.value.length;E++){var T=C.value[E],I={},x=[];if(!e.validate(T,i,I,x)){var l=new Error("Cannot read SafeBag.");throw l.errors=x,l}var s={type:e.derToOid(I.bagId),attributes:p(I.bagAttributes)};g.push(s);var w,N,O=I.bagValue.value[0];switch(s.type){case r.oids.pkcs8ShroudedKeyBag:if(O=r.decryptPrivateKeyInfo(O,f),O===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case r.oids.keyBag:try{s.key=r.privateKeyFromAsn1(O)}catch{s.key=null,s.asn1=O}continue;case r.oids.certBag:w=u,N=function(){if(e.derToOid(I.certId)!==r.oids.x509Certificate){var D=new Error("Unsupported certificate type, only X.509 supported.");throw D.oid=e.derToOid(I.certId),D}var V=e.fromDer(I.cert,S);try{s.cert=r.certificateFromAsn1(V,!0)}catch{s.cert=null,s.asn1=V}};break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=s.type,l}if(w!==void 0&&!e.validate(O,w,I,x)){var l=new Error("Cannot read PKCS#12 "+w.name);throw l.errors=x,l}N()}return g}function p(C){var S={};if(C!==void 0)for(var f=0;f<C.length;++f){var g={},E=[];if(!e.validate(C[f],n,g,E)){var T=new Error("Cannot read PKCS#12 BagAttribute.");throw T.errors=E,T}var I=e.derToOid(g.oid);if(r.oids[I]!==void 0){S[r.oids[I]]=[];for(var x=0;x<g.values.length;++x)S[r.oids[I]].push(g.values[x].value)}}return S}return a.toPkcs12Asn1=function(C,S,f,g){g=g||{},g.saltSize=g.saltSize||8,g.count=g.count||2048,g.algorithm=g.algorithm||g.encAlgorithm||"aes128","useMac"in g||(g.useMac=!0),"localKeyId"in g||(g.localKeyId=null),"generateLocalKeyId"in g||(g.generateLocalKeyId=!0);var E=g.localKeyId,T;if(E!==null)E=t.util.hexToBytes(E);else if(g.generateLocalKeyId)if(S){var I=t.util.isArray(S)?S[0]:S;typeof I=="string"&&(I=r.certificateFromPem(I));var x=t.md.sha1.create();x.update(e.toDer(r.certificateToAsn1(I)).getBytes()),E=x.digest().getBytes()}else E=t.random.getBytes(20);var l=[];E!==null&&l.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,E)])])),"friendlyName"in g&&l.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,g.friendlyName)])])),l.length>0&&(T=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,l));var s=[],w=[];S!==null&&(t.util.isArray(S)?w=S:w=[S]);for(var N=[],O=0;O<w.length;++O){S=w[O],typeof S=="string"&&(S=r.certificateFromPem(S));var _=O===0?T:void 0,D=r.certificateToAsn1(S),V=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(D).getBytes())])])]),_]);N.push(V)}if(N.length>0){var P=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,N),M=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(P).getBytes())])]);s.push(M)}var q=null;if(C!==null){var z=r.wrapRsaPrivateKey(r.privateKeyToAsn1(C));f===null?q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[z]),T]):q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[r.encryptPrivateKeyInfo(z,f,g)]),T]);var G=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[q]),Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(G).getBytes())])]);s.push(Y)}var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,s),te;if(g.useMac){var x=t.md.sha1.create(),ue=new t.util.ByteBuffer(t.random.getBytes(g.saltSize)),X=g.count,C=a.generateKey(f,ue,3,X,20),re=t.hmac.create();re.start(x,C),re.update(e.toDer(j).getBytes());var W=re.getMac();te=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,W.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ue.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(X).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(j).getBytes())])]),te])},a.generateKey=t.pbe.generatePkcs12Key,sa.exports}var Ji;function Lo(){if(Ji)return Xn.exports;Ji=1;var t=ge();kt(),dr(),Io(),Cr(),Qa(),No(),Xa(),Bn(),Ee(),ja();var e=t.asn1,r=Xn.exports=t.pki=t.pki||{};return r.pemToDer=function(a){var c=t.pem.decode(a)[0];if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(c.body)},r.privateKeyFromPem=function(a){var c=t.pem.decode(a)[0];if(c.type!=="PRIVATE KEY"&&c.type!=="RSA PRIVATE KEY"){var o=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw o.headerType=c.type,o}if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var i=e.fromDer(c.body);return r.privateKeyFromAsn1(i)},r.privateKeyToPem=function(a,c){var o={type:"RSA PRIVATE KEY",body:e.toDer(r.privateKeyToAsn1(a)).getBytes()};return t.pem.encode(o,{maxline:c})},r.privateKeyInfoToPem=function(a,c){var o={type:"PRIVATE KEY",body:e.toDer(a).getBytes()};return t.pem.encode(o,{maxline:c})},Xn.exports}var ha,es;function ko(){if(es)return ha;es=1;var t=ge();kt(),Hr(),za(),Cr(),Lo(),Bt(),qr(),Ee();var e=function(b,U,k,y){var R=t.util.createBuffer(),H=b.length>>1,F=H+(b.length&1),J=b.substr(0,F),ie=b.substr(H,F),ce=t.util.createBuffer(),Q=t.hmac.create();k=U+k;var se=Math.ceil(y/16),he=Math.ceil(y/20);Q.start("MD5",J);var ve=t.util.createBuffer();ce.putBytes(k);for(var ye=0;ye<se;++ye)Q.start(null,null),Q.update(ce.getBytes()),ce.putBuffer(Q.digest()),Q.start(null,null),Q.update(ce.bytes()+k),ve.putBuffer(Q.digest());Q.start("SHA1",ie);var we=t.util.createBuffer();ce.clear(),ce.putBytes(k);for(var ye=0;ye<he;++ye)Q.start(null,null),Q.update(ce.getBytes()),ce.putBuffer(Q.digest()),Q.start(null,null),Q.update(ce.bytes()+k),we.putBuffer(Q.digest());return R.putBytes(t.util.xorBytes(ve.getBytes(),we.getBytes(),y)),R},r=function(b,U,k){var y=t.hmac.create();y.start("SHA1",b);var R=t.util.createBuffer();return R.putInt32(U[0]),R.putInt32(U[1]),R.putByte(k.type),R.putByte(k.version.major),R.putByte(k.version.minor),R.putInt16(k.length),R.putBytes(k.fragment.bytes()),y.update(R.getBytes()),y.digest().getBytes()},a=function(b,U,k){var y=!1;try{var R=b.deflate(U.fragment.getBytes());U.fragment=t.util.createBuffer(R),U.length=R.length,y=!0}catch{}return y},c=function(b,U,k){var y=!1;try{var R=b.inflate(U.fragment.getBytes());U.fragment=t.util.createBuffer(R),U.length=R.length,y=!0}catch{}return y},o=function(b,U){var k=0;switch(U){case 1:k=b.getByte();break;case 2:k=b.getInt16();break;case 3:k=b.getInt24();break;case 4:k=b.getInt32();break}return t.util.createBuffer(b.getBytes(k))},i=function(b,U,k){b.putInt(k.length(),U<<3),b.putBuffer(k)},n={};n.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},n.SupportedVersions=[n.Versions.TLS_1_1,n.Versions.TLS_1_0],n.Version=n.SupportedVersions[0],n.MaxFragment=15360,n.ConnectionEnd={server:0,client:1},n.PRFAlgorithm={tls_prf_sha256:0},n.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},n.CipherType={stream:0,block:1,aead:2},n.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},n.CompressionMethod={none:0,deflate:1},n.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},n.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},n.Alert={},n.Alert.Level={warning:1,fatal:2},n.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},n.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},n.CipherSuites={},n.getCipherSuite=function(b){var U=null;for(var k in n.CipherSuites){var y=n.CipherSuites[k];if(y.id[0]===b.charCodeAt(0)&&y.id[1]===b.charCodeAt(1)){U=y;break}}return U},n.handleUnexpected=function(b,U){var k=!b.open&&b.entity===n.ConnectionEnd.client;k||b.error(b,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unexpected_message}})},n.handleHelloRequest=function(b,U,k){!b.handshaking&&b.handshakes>0&&(n.queue(b,n.createAlert(b,{level:n.Alert.Level.warning,description:n.Alert.Description.no_renegotiation})),n.flush(b)),b.process()},n.parseHelloMessage=function(b,U,k){var y=null,R=b.entity===n.ConnectionEnd.client;if(k<38)b.error(b,{message:R?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});else{var H=U.fragment,F=H.length();if(y={version:{major:H.getByte(),minor:H.getByte()},random:t.util.createBuffer(H.getBytes(32)),session_id:o(H,1),extensions:[]},R?(y.cipher_suite=H.getBytes(2),y.compression_method=H.getByte()):(y.cipher_suites=o(H,2),y.compression_methods=o(H,1)),F=k-(F-H.length()),F>0){for(var J=o(H,2);J.length()>0;)y.extensions.push({type:[J.getByte(),J.getByte()],data:o(J,2)});if(!R)for(var ie=0;ie<y.extensions.length;++ie){var ce=y.extensions[ie];if(ce.type[0]===0&&ce.type[1]===0)for(var Q=o(ce.data,2);Q.length()>0;){var se=Q.getByte();if(se!==0)break;b.session.extensions.server_name.serverNameList.push(o(Q,2).getBytes())}}}if(b.session.version&&(y.version.major!==b.session.version.major||y.version.minor!==b.session.version.minor))return b.error(b,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}});if(R)b.session.cipherSuite=n.getCipherSuite(y.cipher_suite);else for(var he=t.util.createBuffer(y.cipher_suites.bytes());he.length()>0&&(b.session.cipherSuite=n.getCipherSuite(he.getBytes(2)),b.session.cipherSuite===null););if(b.session.cipherSuite===null)return b.error(b,{message:"No cipher suites in common.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(y.cipher_suite)});R?b.session.compressionMethod=y.compression_method:b.session.compressionMethod=n.CompressionMethod.none}return y},n.createSecurityParameters=function(b,U){var k=b.entity===n.ConnectionEnd.client,y=U.random.bytes(),R=k?b.session.sp.client_random:y,H=k?y:n.createRandom().getBytes();b.session.sp={entity:b.entity,prf_algorithm:n.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:b.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:R,server_random:H}},n.handleServerHello=function(b,U,k){var y=n.parseHelloMessage(b,U,k);if(!b.fail){if(y.version.minor<=b.version.minor)b.version.minor=y.version.minor;else return b.error(b,{message:"Incompatible TLS version.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}});b.session.version=b.version;var R=y.session_id.bytes();R.length>0&&R===b.session.id?(b.expect=d,b.session.resuming=!0,b.session.sp.server_random=y.random.bytes()):(b.expect=h,b.session.resuming=!1,n.createSecurityParameters(b,y)),b.session.id=R,b.process()}},n.handleClientHello=function(b,U,k){var y=n.parseHelloMessage(b,U,k);if(!b.fail){var R=y.session_id.bytes(),H=null;if(b.sessionCache&&(H=b.sessionCache.getSession(R),H===null?R="":(H.version.major!==y.version.major||H.version.minor>y.version.minor)&&(H=null,R="")),R.length===0&&(R=t.random.getBytes(32)),b.session.id=R,b.session.clientHelloVersion=y.version,b.session.sp={},H)b.version=b.session.version=H.version,b.session.sp=H.sp;else{for(var F,J=1;J<n.SupportedVersions.length&&(F=n.SupportedVersions[J],!(F.minor<=y.version.minor));++J);b.version={major:F.major,minor:F.minor},b.session.version=b.version}H!==null?(b.expect=I,b.session.resuming=!0,b.session.sp.client_random=y.random.bytes()):(b.expect=b.verifyClient!==!1?g:E,b.session.resuming=!1,n.createSecurityParameters(b,y)),b.open=!0,n.queue(b,n.createRecord(b,{type:n.ContentType.handshake,data:n.createServerHello(b)})),b.session.resuming?(n.queue(b,n.createRecord(b,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),b.state.pending=n.createConnectionState(b),b.state.current.write=b.state.pending.write,n.queue(b,n.createRecord(b,{type:n.ContentType.handshake,data:n.createFinished(b)}))):(n.queue(b,n.createRecord(b,{type:n.ContentType.handshake,data:n.createCertificate(b)})),b.fail||(n.queue(b,n.createRecord(b,{type:n.ContentType.handshake,data:n.createServerKeyExchange(b)})),b.verifyClient!==!1&&n.queue(b,n.createRecord(b,{type:n.ContentType.handshake,data:n.createCertificateRequest(b)})),n.queue(b,n.createRecord(b,{type:n.ContentType.handshake,data:n.createServerHelloDone(b)})))),n.flush(b),b.process()}},n.handleCertificate=function(b,U,k){if(k<3)return b.error(b,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var y=U.fragment,R={certificate_list:o(y,3)},H,F,J=[];try{for(;R.certificate_list.length()>0;)H=o(R.certificate_list,3),F=t.asn1.fromDer(H),H=t.pki.certificateFromAsn1(F,!0),J.push(H)}catch(ce){return b.error(b,{message:"Could not parse certificate list.",cause:ce,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate}})}var ie=b.entity===n.ConnectionEnd.client;(ie||b.verifyClient===!0)&&J.length===0?b.error(b,{message:ie?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}}):J.length===0?b.expect=ie?m:E:(ie?b.session.serverCertificate=J[0]:b.session.clientCertificate=J[0],n.verifyCertificateChain(b,J)&&(b.expect=ie?m:E)),b.process()},n.handleServerKeyExchange=function(b,U,k){if(k>0)return b.error(b,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unsupported_certificate}});b.expect=B,b.process()},n.handleClientKeyExchange=function(b,U,k){if(k<48)return b.error(b,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unsupported_certificate}});var y=U.fragment,R={enc_pre_master_secret:o(y,2).getBytes()},H=null;if(b.getPrivateKey)try{H=b.getPrivateKey(b,b.session.serverCertificate),H=t.pki.privateKeyFromPem(H)}catch(ie){b.error(b,{message:"Could not get private key.",cause:ie,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}})}if(H===null)return b.error(b,{message:"No private key set.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}});try{var F=b.session.sp;F.pre_master_secret=H.decrypt(R.enc_pre_master_secret);var J=b.session.clientHelloVersion;if(J.major!==F.pre_master_secret.charCodeAt(0)||J.minor!==F.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{F.pre_master_secret=t.random.getBytes(48)}b.expect=I,b.session.clientCertificate!==null&&(b.expect=T),b.process()},n.handleCertificateRequest=function(b,U,k){if(k<3)return b.error(b,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var y=U.fragment,R={certificate_types:o(y,1),certificate_authorities:o(y,2)};b.session.certificateRequest=R,b.expect=v,b.process()},n.handleCertificateVerify=function(b,U,k){if(k<2)return b.error(b,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var y=U.fragment;y.read-=4;var R=y.bytes();y.read+=4;var H={signature:o(y,2).getBytes()},F=t.util.createBuffer();F.putBuffer(b.session.md5.digest()),F.putBuffer(b.session.sha1.digest()),F=F.getBytes();try{var J=b.session.clientCertificate;if(!J.publicKey.verify(F,H.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");b.session.md5.update(R),b.session.sha1.update(R)}catch{return b.error(b,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.handshake_failure}})}b.expect=I,b.process()},n.handleServerHelloDone=function(b,U,k){if(k>0)return b.error(b,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.record_overflow}});if(b.serverCertificate===null){var y={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.insufficient_security}},R=0,H=b.verify(b,y.alert.description,R,[]);if(H!==!0)return(H||H===0)&&(typeof H=="object"&&!t.util.isArray(H)?(H.message&&(y.message=H.message),H.alert&&(y.alert.description=H.alert)):typeof H=="number"&&(y.alert.description=H)),b.error(b,y)}b.session.certificateRequest!==null&&(U=n.createRecord(b,{type:n.ContentType.handshake,data:n.createCertificate(b)}),n.queue(b,U)),U=n.createRecord(b,{type:n.ContentType.handshake,data:n.createClientKeyExchange(b)}),n.queue(b,U),b.expect=S;var F=function(J,ie){J.session.certificateRequest!==null&&J.session.clientCertificate!==null&&n.queue(J,n.createRecord(J,{type:n.ContentType.handshake,data:n.createCertificateVerify(J,ie)})),n.queue(J,n.createRecord(J,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),J.state.pending=n.createConnectionState(J),J.state.current.write=J.state.pending.write,n.queue(J,n.createRecord(J,{type:n.ContentType.handshake,data:n.createFinished(J)})),J.expect=d,n.flush(J),J.process()};if(b.session.certificateRequest===null||b.session.clientCertificate===null)return F(b,null);n.getClientSignature(b,F)},n.handleChangeCipherSpec=function(b,U){if(U.fragment.getByte()!==1)return b.error(b,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var k=b.entity===n.ConnectionEnd.client;(b.session.resuming&&k||!b.session.resuming&&!k)&&(b.state.pending=n.createConnectionState(b)),b.state.current.read=b.state.pending.read,(!b.session.resuming&&k||b.session.resuming&&!k)&&(b.state.pending=null),b.expect=k?p:x,b.process()},n.handleFinished=function(b,U,k){var y=U.fragment;y.read-=4;var R=y.bytes();y.read+=4;var H=U.fragment.getBytes();y=t.util.createBuffer(),y.putBuffer(b.session.md5.digest()),y.putBuffer(b.session.sha1.digest());var F=b.entity===n.ConnectionEnd.client,J=F?"server finished":"client finished",ie=b.session.sp,ce=12,Q=e;if(y=Q(ie.master_secret,J,y.getBytes(),ce),y.getBytes()!==H)return b.error(b,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.decrypt_error}});b.session.md5.update(R),b.session.sha1.update(R),(b.session.resuming&&F||!b.session.resuming&&!F)&&(n.queue(b,n.createRecord(b,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),b.state.current.write=b.state.pending.write,b.state.pending=null,n.queue(b,n.createRecord(b,{type:n.ContentType.handshake,data:n.createFinished(b)}))),b.expect=F?C:l,b.handshaking=!1,++b.handshakes,b.peerCertificate=F?b.session.serverCertificate:b.session.clientCertificate,n.flush(b),b.isConnected=!0,b.connected(b),b.process()},n.handleAlert=function(b,U){var k=U.fragment,y={level:k.getByte(),description:k.getByte()},R;switch(y.description){case n.Alert.Description.close_notify:R="Connection closed.";break;case n.Alert.Description.unexpected_message:R="Unexpected message.";break;case n.Alert.Description.bad_record_mac:R="Bad record MAC.";break;case n.Alert.Description.decryption_failed:R="Decryption failed.";break;case n.Alert.Description.record_overflow:R="Record overflow.";break;case n.Alert.Description.decompression_failure:R="Decompression failed.";break;case n.Alert.Description.handshake_failure:R="Handshake failure.";break;case n.Alert.Description.bad_certificate:R="Bad certificate.";break;case n.Alert.Description.unsupported_certificate:R="Unsupported certificate.";break;case n.Alert.Description.certificate_revoked:R="Certificate revoked.";break;case n.Alert.Description.certificate_expired:R="Certificate expired.";break;case n.Alert.Description.certificate_unknown:R="Certificate unknown.";break;case n.Alert.Description.illegal_parameter:R="Illegal parameter.";break;case n.Alert.Description.unknown_ca:R="Unknown certificate authority.";break;case n.Alert.Description.access_denied:R="Access denied.";break;case n.Alert.Description.decode_error:R="Decode error.";break;case n.Alert.Description.decrypt_error:R="Decrypt error.";break;case n.Alert.Description.export_restriction:R="Export restriction.";break;case n.Alert.Description.protocol_version:R="Unsupported protocol version.";break;case n.Alert.Description.insufficient_security:R="Insufficient security.";break;case n.Alert.Description.internal_error:R="Internal error.";break;case n.Alert.Description.user_canceled:R="User canceled.";break;case n.Alert.Description.no_renegotiation:R="Renegotiation not supported.";break;default:R="Unknown error.";break}if(y.description===n.Alert.Description.close_notify)return b.close();b.error(b,{message:R,send:!1,origin:b.entity===n.ConnectionEnd.client?"server":"client",alert:y}),b.process()},n.handleHandshake=function(b,U){var k=U.fragment,y=k.getByte(),R=k.getInt24();if(R>k.length())return b.fragmented=U,U.fragment=t.util.createBuffer(),k.read-=4,b.process();b.fragmented=null,k.read-=4;var H=k.bytes(R+4);k.read+=4,y in te[b.entity][b.expect]?(b.entity===n.ConnectionEnd.server&&!b.open&&!b.fail&&(b.handshaking=!0,b.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),y!==n.HandshakeType.hello_request&&y!==n.HandshakeType.certificate_verify&&y!==n.HandshakeType.finished&&(b.session.md5.update(H),b.session.sha1.update(H)),te[b.entity][b.expect][y](b,U,R)):n.handleUnexpected(b,U)},n.handleApplicationData=function(b,U){b.data.putBuffer(U.fragment),b.dataReady(b),b.process()},n.handleHeartbeat=function(b,U){var k=U.fragment,y=k.getByte(),R=k.getInt16(),H=k.getBytes(R);if(y===n.HeartbeatMessageType.heartbeat_request){if(b.handshaking||R>H.length)return b.process();n.queue(b,n.createRecord(b,{type:n.ContentType.heartbeat,data:n.createHeartbeat(n.HeartbeatMessageType.heartbeat_response,H)})),n.flush(b)}else if(y===n.HeartbeatMessageType.heartbeat_response){if(H!==b.expectedHeartbeatPayload)return b.process();b.heartbeatReceived&&b.heartbeatReceived(b,t.util.createBuffer(H))}b.process()};var u=0,h=1,m=2,B=3,v=4,d=5,p=6,C=7,S=8,f=0,g=1,E=2,T=3,I=4,x=5,l=6,s=n.handleUnexpected,w=n.handleChangeCipherSpec,N=n.handleAlert,O=n.handleHandshake,_=n.handleApplicationData,D=n.handleHeartbeat,V=[];V[n.ConnectionEnd.client]=[[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[w,N,s,s,D],[s,N,O,s,D],[s,N,O,_,D],[s,N,O,s,D]],V[n.ConnectionEnd.server]=[[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[w,N,s,s,D],[s,N,O,s,D],[s,N,O,_,D],[s,N,O,s,D]];var P=n.handleHelloRequest,M=n.handleServerHello,q=n.handleCertificate,z=n.handleServerKeyExchange,G=n.handleCertificateRequest,Y=n.handleServerHelloDone,j=n.handleFinished,te=[];te[n.ConnectionEnd.client]=[[s,s,M,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,q,z,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,z,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,j],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s]];var ue=n.handleClientHello,X=n.handleClientKeyExchange,re=n.handleCertificateVerify;te[n.ConnectionEnd.server]=[[s,ue,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,q,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,X,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,re,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,j],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s]],n.generateKeys=function(b,U){var k=e,y=U.client_random+U.server_random;b.session.resuming||(U.master_secret=k(U.pre_master_secret,"master secret",y,48).bytes(),U.pre_master_secret=null),y=U.server_random+U.client_random;var R=2*U.mac_key_length+2*U.enc_key_length,H=b.version.major===n.Versions.TLS_1_0.major&&b.version.minor===n.Versions.TLS_1_0.minor;H&&(R+=2*U.fixed_iv_length);var F=k(U.master_secret,"key expansion",y,R),J={client_write_MAC_key:F.getBytes(U.mac_key_length),server_write_MAC_key:F.getBytes(U.mac_key_length),client_write_key:F.getBytes(U.enc_key_length),server_write_key:F.getBytes(U.enc_key_length)};return H&&(J.client_write_IV=F.getBytes(U.fixed_iv_length),J.server_write_IV=F.getBytes(U.fixed_iv_length)),J},n.createConnectionState=function(b){var U=b.entity===n.ConnectionEnd.client,k=function(){var H={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(F){return!0},compressionState:null,compressFunction:function(F){return!0},updateSequenceNumber:function(){H.sequenceNumber[1]===4294967295?(H.sequenceNumber[1]=0,++H.sequenceNumber[0]):++H.sequenceNumber[1]}};return H},y={read:k(),write:k()};if(y.read.update=function(H,F){return y.read.cipherFunction(F,y.read)?y.read.compressFunction(H,F,y.read)||H.error(H,{message:"Could not decompress record.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.decompression_failure}}):H.error(H,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_record_mac}}),!H.fail},y.write.update=function(H,F){return y.write.compressFunction(H,F,y.write)?y.write.cipherFunction(F,y.write)||H.error(H,{message:"Could not encrypt record.",send:!1,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}):H.error(H,{message:"Could not compress record.",send:!1,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}),!H.fail},b.session){var R=b.session.sp;switch(b.session.cipherSuite.initSecurityParameters(R),R.keys=n.generateKeys(b,R),y.read.macKey=U?R.keys.server_write_MAC_key:R.keys.client_write_MAC_key,y.write.macKey=U?R.keys.client_write_MAC_key:R.keys.server_write_MAC_key,b.session.cipherSuite.initConnectionState(y,b,R),R.compression_algorithm){case n.CompressionMethod.none:break;case n.CompressionMethod.deflate:y.read.compressFunction=c,y.write.compressFunction=a;break;default:throw new Error("Unsupported compression algorithm.")}}return y},n.createRandom=function(){var b=new Date,U=+b+b.getTimezoneOffset()*6e4,k=t.util.createBuffer();return k.putInt32(U),k.putBytes(t.random.getBytes(28)),k},n.createRecord=function(b,U){if(!U.data)return null;var k={type:U.type,version:{major:b.version.major,minor:b.version.minor},length:U.data.length(),fragment:U.data};return k},n.createAlert=function(b,U){var k=t.util.createBuffer();return k.putByte(U.level),k.putByte(U.description),n.createRecord(b,{type:n.ContentType.alert,data:k})},n.createClientHello=function(b){b.session.clientHelloVersion={major:b.version.major,minor:b.version.minor};for(var U=t.util.createBuffer(),k=0;k<b.cipherSuites.length;++k){var y=b.cipherSuites[k];U.putByte(y.id[0]),U.putByte(y.id[1])}var R=U.length(),H=t.util.createBuffer();H.putByte(n.CompressionMethod.none);var F=H.length(),J=t.util.createBuffer();if(b.virtualHost){var ie=t.util.createBuffer();ie.putByte(0),ie.putByte(0);var ce=t.util.createBuffer();ce.putByte(0),i(ce,2,t.util.createBuffer(b.virtualHost));var Q=t.util.createBuffer();i(Q,2,ce),i(ie,2,Q),J.putBuffer(ie)}var se=J.length();se>0&&(se+=2);var he=b.session.id,ve=he.length+1+2+4+28+2+R+1+F+se,ye=t.util.createBuffer();return ye.putByte(n.HandshakeType.client_hello),ye.putInt24(ve),ye.putByte(b.version.major),ye.putByte(b.version.minor),ye.putBytes(b.session.sp.client_random),i(ye,1,t.util.createBuffer(he)),i(ye,2,U),i(ye,1,H),se>0&&i(ye,2,J),ye},n.createServerHello=function(b){var U=b.session.id,k=U.length+1+2+4+28+2+1,y=t.util.createBuffer();return y.putByte(n.HandshakeType.server_hello),y.putInt24(k),y.putByte(b.version.major),y.putByte(b.version.minor),y.putBytes(b.session.sp.server_random),i(y,1,t.util.createBuffer(U)),y.putByte(b.session.cipherSuite.id[0]),y.putByte(b.session.cipherSuite.id[1]),y.putByte(b.session.compressionMethod),y},n.createCertificate=function(b){var U=b.entity===n.ConnectionEnd.client,k=null;if(b.getCertificate){var y;U?y=b.session.certificateRequest:y=b.session.extensions.server_name.serverNameList,k=b.getCertificate(b,y)}var R=t.util.createBuffer();if(k!==null)try{t.util.isArray(k)||(k=[k]);for(var H=null,F=0;F<k.length;++F){var J=t.pem.decode(k[F])[0];if(J.type!=="CERTIFICATE"&&J.type!=="X509 CERTIFICATE"&&J.type!=="TRUSTED CERTIFICATE"){var ie=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ie.headerType=J.type,ie}if(J.procType&&J.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ce=t.util.createBuffer(J.body);H===null&&(H=t.asn1.fromDer(ce.bytes(),!1));var Q=t.util.createBuffer();i(Q,3,ce),R.putBuffer(Q)}k=t.pki.certificateFromAsn1(H),U?b.session.clientCertificate=k:b.session.serverCertificate=k}catch(ve){return b.error(b,{message:"Could not send certificate list.",cause:ve,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate}})}var se=3+R.length(),he=t.util.createBuffer();return he.putByte(n.HandshakeType.certificate),he.putInt24(se),i(he,3,R),he},n.createClientKeyExchange=function(b){var U=t.util.createBuffer();U.putByte(b.session.clientHelloVersion.major),U.putByte(b.session.clientHelloVersion.minor),U.putBytes(t.random.getBytes(46));var k=b.session.sp;k.pre_master_secret=U.getBytes();var y=b.session.serverCertificate.publicKey;U=y.encrypt(k.pre_master_secret);var R=U.length+2,H=t.util.createBuffer();return H.putByte(n.HandshakeType.client_key_exchange),H.putInt24(R),H.putInt16(U.length),H.putBytes(U),H},n.createServerKeyExchange=function(b){var U=t.util.createBuffer();return U},n.getClientSignature=function(b,U){var k=t.util.createBuffer();k.putBuffer(b.session.md5.digest()),k.putBuffer(b.session.sha1.digest()),k=k.getBytes(),b.getSignature=b.getSignature||function(y,R,H){var F=null;if(y.getPrivateKey)try{F=y.getPrivateKey(y,y.session.clientCertificate),F=t.pki.privateKeyFromPem(F)}catch(J){y.error(y,{message:"Could not get private key.",cause:J,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}})}F===null?y.error(y,{message:"No private key set.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}):R=F.sign(R,null),H(y,R)},b.getSignature(b,k,U)},n.createCertificateVerify=function(b,U){var k=U.length+2,y=t.util.createBuffer();return y.putByte(n.HandshakeType.certificate_verify),y.putInt24(k),y.putInt16(U.length),y.putBytes(U),y},n.createCertificateRequest=function(b){var U=t.util.createBuffer();U.putByte(1);var k=t.util.createBuffer();for(var y in b.caStore.certs){var R=b.caStore.certs[y],H=t.pki.distinguishedNameToAsn1(R.subject),F=t.asn1.toDer(H);k.putInt16(F.length()),k.putBuffer(F)}var J=1+U.length()+2+k.length(),ie=t.util.createBuffer();return ie.putByte(n.HandshakeType.certificate_request),ie.putInt24(J),i(ie,1,U),i(ie,2,k),ie},n.createServerHelloDone=function(b){var U=t.util.createBuffer();return U.putByte(n.HandshakeType.server_hello_done),U.putInt24(0),U},n.createChangeCipherSpec=function(){var b=t.util.createBuffer();return b.putByte(1),b},n.createFinished=function(b){var U=t.util.createBuffer();U.putBuffer(b.session.md5.digest()),U.putBuffer(b.session.sha1.digest());var k=b.entity===n.ConnectionEnd.client,y=b.session.sp,R=12,H=e,F=k?"client finished":"server finished";U=H(y.master_secret,F,U.getBytes(),R);var J=t.util.createBuffer();return J.putByte(n.HandshakeType.finished),J.putInt24(U.length()),J.putBuffer(U),J},n.createHeartbeat=function(b,U,k){typeof k>"u"&&(k=U.length);var y=t.util.createBuffer();y.putByte(b),y.putInt16(k),y.putBytes(U);var R=y.length(),H=Math.max(16,R-k-3);return y.putBytes(t.random.getBytes(H)),y},n.queue=function(b,U){if(U&&!(U.fragment.length()===0&&(U.type===n.ContentType.handshake||U.type===n.ContentType.alert||U.type===n.ContentType.change_cipher_spec))){if(U.type===n.ContentType.handshake){var k=U.fragment.bytes();b.session.md5.update(k),b.session.sha1.update(k),k=null}var y;if(U.fragment.length()<=n.MaxFragment)y=[U];else{y=[];for(var R=U.fragment.bytes();R.length>n.MaxFragment;)y.push(n.createRecord(b,{type:U.type,data:t.util.createBuffer(R.slice(0,n.MaxFragment))})),R=R.slice(n.MaxFragment);R.length>0&&y.push(n.createRecord(b,{type:U.type,data:t.util.createBuffer(R)}))}for(var H=0;H<y.length&&!b.fail;++H){var F=y[H],J=b.state.current.write;J.update(b,F)&&b.records.push(F)}}},n.flush=function(b){for(var U=0;U<b.records.length;++U){var k=b.records[U];b.tlsData.putByte(k.type),b.tlsData.putByte(k.version.major),b.tlsData.putByte(k.version.minor),b.tlsData.putInt16(k.fragment.length()),b.tlsData.putBuffer(b.records[U].fragment)}return b.records=[],b.tlsDataReady(b)};var W=function(b){switch(b){case!0:return!0;case t.pki.certificateError.bad_certificate:return n.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return n.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return n.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return n.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return n.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return n.Alert.Description.unknown_ca;default:return n.Alert.Description.bad_certificate}},pe=function(b){switch(b){case!0:return!0;case n.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case n.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case n.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case n.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case n.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case n.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};n.verifyCertificateChain=function(b,U){try{var k={};for(var y in b.verifyOptions)k[y]=b.verifyOptions[y];k.verify=function(H,F,J){var ie=W(H),ce=b.verify(b,H,F,J);if(ce!==!0){if(typeof ce=="object"&&!t.util.isArray(ce)){var Q=new Error("The application rejected the certificate.");throw Q.send=!0,Q.alert={level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate},ce.message&&(Q.message=ce.message),ce.alert&&(Q.alert.description=ce.alert),Q}ce!==H&&(ce=pe(ce))}return ce},t.pki.verifyCertificateChain(b.caStore,U,k)}catch(H){var R=H;(typeof R!="object"||t.util.isArray(R))&&(R={send:!0,alert:{level:n.Alert.Level.fatal,description:W(H)}}),"send"in R||(R.send=!0),"alert"in R||(R.alert={level:n.Alert.Level.fatal,description:W(R.error)}),b.error(b,R)}return!b.fail},n.createSessionCache=function(b,U){var k=null;if(b&&b.getSession&&b.setSession&&b.order)k=b;else{k={},k.cache=b||{},k.capacity=Math.max(U||100,1),k.order=[];for(var y in b)k.order.length<=U?k.order.push(y):delete b[y];k.getSession=function(R){var H=null,F=null;if(R?F=t.util.bytesToHex(R):k.order.length>0&&(F=k.order[0]),F!==null&&F in k.cache){H=k.cache[F],delete k.cache[F];for(var J in k.order)if(k.order[J]===F){k.order.splice(J,1);break}}return H},k.setSession=function(R,H){if(k.order.length===k.capacity){var F=k.order.shift();delete k.cache[F]}var F=t.util.bytesToHex(R);k.order.push(F),k.cache[F]=H}}return k},n.createConnection=function(b){var U=null;b.caStore?t.util.isArray(b.caStore)?U=t.pki.createCaStore(b.caStore):U=b.caStore:U=t.pki.createCaStore();var k=b.cipherSuites||null;if(k===null){k=[];for(var y in n.CipherSuites)k.push(n.CipherSuites[y])}var R=b.server?n.ConnectionEnd.server:n.ConnectionEnd.client,H=b.sessionCache?n.createSessionCache(b.sessionCache):null,F={version:{major:n.Version.major,minor:n.Version.minor},entity:R,sessionId:b.sessionId,caStore:U,sessionCache:H,cipherSuites:k,connected:b.connected,virtualHost:b.virtualHost||null,verifyClient:b.verifyClient||!1,verify:b.verify||function(Q,se,he,ve){return se},verifyOptions:b.verifyOptions||{},getCertificate:b.getCertificate||null,getPrivateKey:b.getPrivateKey||null,getSignature:b.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:b.tlsDataReady,dataReady:b.dataReady,heartbeatReceived:b.heartbeatReceived,closed:b.closed,error:function(Q,se){se.origin=se.origin||(Q.entity===n.ConnectionEnd.client?"client":"server"),se.send&&(n.queue(Q,n.createAlert(Q,se.alert)),n.flush(Q));var he=se.fatal!==!1;he&&(Q.fail=!0),b.error(Q,se),he&&Q.close(!1)},deflate:b.deflate||null,inflate:b.inflate||null};F.reset=function(Q){F.version={major:n.Version.major,minor:n.Version.minor},F.record=null,F.session=null,F.peerCertificate=null,F.state={pending:null,current:null},F.expect=F.entity===n.ConnectionEnd.client?u:f,F.fragmented=null,F.records=[],F.open=!1,F.handshakes=0,F.handshaking=!1,F.isConnected=!1,F.fail=!(Q||typeof Q>"u"),F.input.clear(),F.tlsData.clear(),F.data.clear(),F.state.current=n.createConnectionState(F)},F.reset();var J=function(Q,se){var he=se.type-n.ContentType.change_cipher_spec,ve=V[Q.entity][Q.expect];he in ve?ve[he](Q,se):n.handleUnexpected(Q,se)},ie=function(Q){var se=0,he=Q.input,ve=he.length();if(ve<5)se=5-ve;else{Q.record={type:he.getByte(),version:{major:he.getByte(),minor:he.getByte()},length:he.getInt16(),fragment:t.util.createBuffer(),ready:!1};var ye=Q.record.version.major===Q.version.major;ye&&Q.session&&Q.session.version&&(ye=Q.record.version.minor===Q.version.minor),ye||Q.error(Q,{message:"Incompatible TLS version.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}})}return se},ce=function(Q){var se=0,he=Q.input,ve=he.length();if(ve<Q.record.length)se=Q.record.length-ve;else{Q.record.fragment.putBytes(he.getBytes(Q.record.length)),he.compact();var ye=Q.state.current.read;ye.update(Q,Q.record)&&(Q.fragmented!==null&&(Q.fragmented.type===Q.record.type?(Q.fragmented.fragment.putBuffer(Q.record.fragment),Q.record=Q.fragmented):Q.error(Q,{message:"Invalid fragmented record.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unexpected_message}})),Q.record.ready=!0)}return se};return F.handshake=function(Q){if(F.entity!==n.ConnectionEnd.client)F.error(F,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(F.handshaking)F.error(F,{message:"Handshake already in progress.",fatal:!1});else{F.fail&&!F.open&&F.handshakes===0&&(F.fail=!1),F.handshaking=!0,Q=Q||"";var se=null;Q.length>0&&(F.sessionCache&&(se=F.sessionCache.getSession(Q)),se===null&&(Q="")),Q.length===0&&F.sessionCache&&(se=F.sessionCache.getSession(),se!==null&&(Q=se.id)),F.session={id:Q,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},se&&(F.version=se.version,F.session.sp=se.sp),F.session.sp.client_random=n.createRandom().getBytes(),F.open=!0,n.queue(F,n.createRecord(F,{type:n.ContentType.handshake,data:n.createClientHello(F)})),n.flush(F)}},F.process=function(Q){var se=0;return Q&&F.input.putBytes(Q),F.fail||(F.record!==null&&F.record.ready&&F.record.fragment.isEmpty()&&(F.record=null),F.record===null&&(se=ie(F)),!F.fail&&F.record!==null&&!F.record.ready&&(se=ce(F)),!F.fail&&F.record!==null&&F.record.ready&&J(F,F.record)),se},F.prepare=function(Q){return n.queue(F,n.createRecord(F,{type:n.ContentType.application_data,data:t.util.createBuffer(Q)})),n.flush(F)},F.prepareHeartbeatRequest=function(Q,se){return Q instanceof t.util.ByteBuffer&&(Q=Q.bytes()),typeof se>"u"&&(se=Q.length),F.expectedHeartbeatPayload=Q,n.queue(F,n.createRecord(F,{type:n.ContentType.heartbeat,data:n.createHeartbeat(n.HeartbeatMessageType.heartbeat_request,Q,se)})),n.flush(F)},F.close=function(Q){if(!F.fail&&F.sessionCache&&F.session){var se={id:F.session.id,version:F.session.version,sp:F.session.sp};se.sp.keys=null,F.sessionCache.setSession(se.id,se)}F.open&&(F.open=!1,F.input.clear(),(F.isConnected||F.handshaking)&&(F.isConnected=F.handshaking=!1,n.queue(F,n.createAlert(F,{level:n.Alert.Level.warning,description:n.Alert.Description.close_notify})),n.flush(F)),F.closed(F)),F.reset(Q)},F},ha=t.tls=t.tls||{};for(var le in n)typeof n[le]!="function"&&(t.tls[le]=n[le]);return t.tls.prf_tls1=e,t.tls.hmac_sha1=r,t.tls.createSessionCache=n.createSessionCache,t.tls.createConnection=n.createConnection,ha}var ts;function Au(){if(ts)return Hn.exports;ts=1;var t=ge();hr(),ko();var e=Hn.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(u){u.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,u.cipher_type=e.CipherType.block,u.enc_key_length=16,u.block_length=16,u.fixed_iv_length=16,u.record_iv_length=16,u.mac_algorithm=e.MACAlgorithm.hmac_sha1,u.mac_length=20,u.mac_key_length=20},initConnectionState:r},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(u){u.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,u.cipher_type=e.CipherType.block,u.enc_key_length=32,u.block_length=16,u.fixed_iv_length=16,u.record_iv_length=16,u.mac_algorithm=e.MACAlgorithm.hmac_sha1,u.mac_length=20,u.mac_key_length=20},initConnectionState:r};function r(u,h,m){var B=h.entity===t.tls.ConnectionEnd.client;u.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",B?m.keys.server_write_key:m.keys.client_write_key),iv:B?m.keys.server_write_IV:m.keys.client_write_IV},u.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",B?m.keys.client_write_key:m.keys.server_write_key),iv:B?m.keys.client_write_IV:m.keys.server_write_IV},u.read.cipherFunction=i,u.write.cipherFunction=a,u.read.macLength=u.write.macLength=m.mac_length,u.read.macFunction=u.write.macFunction=e.hmac_sha1}function a(u,h){var m=!1,B=h.macFunction(h.macKey,h.sequenceNumber,u);u.fragment.putBytes(B),h.updateSequenceNumber();var v;u.version.minor===e.Versions.TLS_1_0.minor?v=h.cipherState.init?null:h.cipherState.iv:v=t.random.getBytesSync(16),h.cipherState.init=!0;var d=h.cipherState.cipher;return d.start({iv:v}),u.version.minor>=e.Versions.TLS_1_1.minor&&d.output.putBytes(v),d.update(u.fragment),d.finish(c)&&(u.fragment=d.output,u.length=u.fragment.length(),m=!0),m}function c(u,h,m){if(!m){var B=u-h.length()%u;h.fillWithByte(B-1,B)}return!0}function o(u,h,m){var B=!0;if(m){for(var v=h.length(),d=h.last(),p=v-1-d;p<v-1;++p)B=B&&h.at(p)==d;B&&h.truncate(d+1)}return B}function i(u,h){var m=!1,B;u.version.minor===e.Versions.TLS_1_0.minor?B=h.cipherState.init?null:h.cipherState.iv:B=u.fragment.getBytes(16),h.cipherState.init=!0;var v=h.cipherState.cipher;v.start({iv:B}),v.update(u.fragment),m=v.finish(o);var d=h.macLength,p=t.random.getBytesSync(d),C=v.output.length();C>=d?(u.fragment=v.output.getBytes(C-d),p=v.output.getBytes(d)):u.fragment=v.output.getBytes(),u.fragment=t.util.createBuffer(u.fragment),u.length=u.fragment.length();var S=h.macFunction(h.macKey,h.sequenceNumber,u);return h.updateSequenceNumber(),m=n(h.macKey,p,S)&&m,m}function n(u,h,m){var B=t.hmac.create();return B.start("SHA1",u),B.update(h),h=B.digest().getBytes(),B.start(null,null),B.update(m),m=B.digest().getBytes(),h===m}return Hn.exports}var da={exports:{}},rs;function Uo(){if(rs)return da.exports;rs=1;var t=ge();qt(),Ee();var e=da.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var r=t.sha384=t.sha512.sha384=t.sha512.sha384||{};r.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=r,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(h){if(c||n(),typeof h>"u"&&(h="SHA-512"),!(h in i))throw new Error("Invalid SHA-512 algorithm: "+h);for(var m=i[h],B=null,v=t.util.createBuffer(),d=new Array(80),p=0;p<80;++p)d[p]=new Array(2);var C=64;switch(h){case"SHA-384":C=48;break;case"SHA-512/256":C=32;break;case"SHA-512/224":C=28;break}var S={algorithm:h.replace("-","").toLowerCase(),blockLength:128,digestLength:C,messageLength:0,fullMessageLength:null,messageLengthSize:16};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength128=[];for(var f=S.messageLengthSize/4,g=0;g<f;++g)S.fullMessageLength.push(0);v=t.util.createBuffer(),B=new Array(m.length);for(var g=0;g<m.length;++g)B[g]=m[g].slice(0);return S},S.start(),S.update=function(f,g){g==="utf8"&&(f=t.util.encodeUtf8(f));var E=f.length;S.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var T=S.fullMessageLength.length-1;T>=0;--T)S.fullMessageLength[T]+=E[1],E[1]=E[0]+(S.fullMessageLength[T]/4294967296>>>0),S.fullMessageLength[T]=S.fullMessageLength[T]>>>0,E[0]=E[1]/4294967296>>>0;return v.putBytes(f),u(B,d,v),(v.read>2048||v.length()===0)&&v.compact(),S},S.digest=function(){var f=t.util.createBuffer();f.putBytes(v.bytes());var g=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,E=g&S.blockLength-1;f.putBytes(a.substr(0,S.blockLength-E));for(var T,I,x=S.fullMessageLength[0]*8,l=0;l<S.fullMessageLength.length-1;++l)T=S.fullMessageLength[l+1]*8,I=T/4294967296>>>0,x+=I,f.putInt32(x>>>0),x=T>>>0;f.putInt32(x);for(var s=new Array(B.length),l=0;l<B.length;++l)s[l]=B[l].slice(0);u(s,d,f);var w=t.util.createBuffer(),N;h==="SHA-512"?N=s.length:h==="SHA-384"?N=s.length-2:N=s.length-4;for(var l=0;l<N;++l)w.putInt32(s[l][0]),(l!==N-1||h!=="SHA-512/224")&&w.putInt32(s[l][1]);return w},S};var a=null,c=!1,o=null,i=null;function n(){a="",a+=t.util.fillString("\0",128),o=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],i={},i["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],i["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],i["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],i["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],c=!0}function u(h,m,B){for(var v,d,p,C,S,f,g,E,T,I,x,l,s,w,N,O,_,D,V,P,M,q,z,G,Y,j,te,ue,X,re,W,pe,le,b,U,k=B.length();k>=128;){for(X=0;X<16;++X)m[X][0]=B.getInt32()>>>0,m[X][1]=B.getInt32()>>>0;for(;X<80;++X)pe=m[X-2],re=pe[0],W=pe[1],v=((re>>>19|W<<13)^(W>>>29|re<<3)^re>>>6)>>>0,d=((re<<13|W>>>19)^(W<<3|re>>>29)^(re<<26|W>>>6))>>>0,b=m[X-15],re=b[0],W=b[1],p=((re>>>1|W<<31)^(re>>>8|W<<24)^re>>>7)>>>0,C=((re<<31|W>>>1)^(re<<24|W>>>8)^(re<<25|W>>>7))>>>0,le=m[X-7],U=m[X-16],W=d+le[1]+C+U[1],m[X][0]=v+le[0]+p+U[0]+(W/4294967296>>>0)>>>0,m[X][1]=W>>>0;for(s=h[0][0],w=h[0][1],N=h[1][0],O=h[1][1],_=h[2][0],D=h[2][1],V=h[3][0],P=h[3][1],M=h[4][0],q=h[4][1],z=h[5][0],G=h[5][1],Y=h[6][0],j=h[6][1],te=h[7][0],ue=h[7][1],X=0;X<80;++X)g=((M>>>14|q<<18)^(M>>>18|q<<14)^(q>>>9|M<<23))>>>0,E=((M<<18|q>>>14)^(M<<14|q>>>18)^(q<<23|M>>>9))>>>0,T=(Y^M&(z^Y))>>>0,I=(j^q&(G^j))>>>0,S=((s>>>28|w<<4)^(w>>>2|s<<30)^(w>>>7|s<<25))>>>0,f=((s<<4|w>>>28)^(w<<30|s>>>2)^(w<<25|s>>>7))>>>0,x=(s&N|_&(s^N))>>>0,l=(w&O|D&(w^O))>>>0,W=ue+E+I+o[X][1]+m[X][1],v=te+g+T+o[X][0]+m[X][0]+(W/4294967296>>>0)>>>0,d=W>>>0,W=f+l,p=S+x+(W/4294967296>>>0)>>>0,C=W>>>0,te=Y,ue=j,Y=z,j=G,z=M,G=q,W=P+d,M=V+v+(W/4294967296>>>0)>>>0,q=W>>>0,V=_,P=D,_=N,D=O,N=s,O=w,W=d+C,s=v+p+(W/4294967296>>>0)>>>0,w=W>>>0;W=h[0][1]+w,h[0][0]=h[0][0]+s+(W/4294967296>>>0)>>>0,h[0][1]=W>>>0,W=h[1][1]+O,h[1][0]=h[1][0]+N+(W/4294967296>>>0)>>>0,h[1][1]=W>>>0,W=h[2][1]+D,h[2][0]=h[2][0]+_+(W/4294967296>>>0)>>>0,h[2][1]=W>>>0,W=h[3][1]+P,h[3][0]=h[3][0]+V+(W/4294967296>>>0)>>>0,h[3][1]=W>>>0,W=h[4][1]+q,h[4][0]=h[4][0]+M+(W/4294967296>>>0)>>>0,h[4][1]=W>>>0,W=h[5][1]+G,h[5][0]=h[5][0]+z+(W/4294967296>>>0)>>>0,h[5][1]=W>>>0,W=h[6][1]+j,h[6][0]=h[6][0]+Y+(W/4294967296>>>0)>>>0,h[6][1]=W>>>0,W=h[7][1]+ue,h[7][0]=h[7][0]+te+(W/4294967296>>>0)>>>0,h[7][1]=W>>>0,k-=128}}return da.exports}var Wr={},ns;function Iu(){if(ns)return Wr;ns=1;var t=ge();kt();var e=t.asn1;return Wr.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Wr.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},Wr}var pa,as;function _u(){if(as)return pa;as=1;var t=ge();bn(),Bt(),Uo(),Ee();var e=Iu(),r=e.publicKeyValidator,a=e.privateKeyValidator;if(typeof c>"u")var c=t.jsbn.BigInteger;var o=t.util.ByteBuffer,i=typeof Buffer>"u"?Uint8Array:Buffer;t.pki=t.pki||{},pa=t.pki.ed25519=t.ed25519=t.ed25519||{};var n=t.ed25519;n.constants={},n.constants.PUBLIC_KEY_BYTE_LENGTH=32,n.constants.PRIVATE_KEY_BYTE_LENGTH=64,n.constants.SEED_BYTE_LENGTH=32,n.constants.SIGN_BYTE_LENGTH=64,n.constants.HASH_BYTE_LENGTH=64,n.generateKeyPair=function(b){b=b||{};var U=b.seed;if(U===void 0)U=t.random.getBytesSync(n.constants.SEED_BYTE_LENGTH);else if(typeof U=="string"){if(U.length!==n.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+n.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(U instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');U=u({message:U,encoding:"binary"});for(var k=new i(n.constants.PUBLIC_KEY_BYTE_LENGTH),y=new i(n.constants.PRIVATE_KEY_BYTE_LENGTH),R=0;R<32;++R)y[R]=U[R];return g(k,y),{publicKey:k,privateKey:y}},n.privateKeyFromAsn1=function(b){var U={},k=[],y=t.asn1.validate(b,a,U,k);if(!y){var R=new Error("Invalid Key.");throw R.errors=k,R}var H=t.asn1.derToOid(U.privateKeyOid),F=t.oids.EdDSA25519;if(H!==F)throw new Error('Invalid OID "'+H+'"; OID must be "'+F+'".');var J=U.privateKey,ie=u({message:t.asn1.fromDer(J).value,encoding:"binary"});return{privateKeyBytes:ie}},n.publicKeyFromAsn1=function(b){var U={},k=[],y=t.asn1.validate(b,r,U,k);if(!y){var R=new Error("Invalid Key.");throw R.errors=k,R}var H=t.asn1.derToOid(U.publicKeyOid),F=t.oids.EdDSA25519;if(H!==F)throw new Error('Invalid OID "'+H+'"; OID must be "'+F+'".');var J=U.ed25519PublicKey;if(J.length!==n.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return u({message:J,encoding:"binary"})},n.publicKeyFromPrivateKey=function(b){b=b||{};var U=u({message:b.privateKey,encoding:"binary"});if(U.length!==n.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+n.constants.PRIVATE_KEY_BYTE_LENGTH);for(var k=new i(n.constants.PUBLIC_KEY_BYTE_LENGTH),y=0;y<k.length;++y)k[y]=U[32+y];return k},n.sign=function(b){b=b||{};var U=u(b),k=u({message:b.privateKey,encoding:"binary"});if(k.length===n.constants.SEED_BYTE_LENGTH){var y=n.generateKeyPair({seed:k});k=y.privateKey}else if(k.length!==n.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+n.constants.SEED_BYTE_LENGTH+" or "+n.constants.PRIVATE_KEY_BYTE_LENGTH);var R=new i(n.constants.SIGN_BYTE_LENGTH+U.length);E(R,U,U.length,k);for(var H=new i(n.constants.SIGN_BYTE_LENGTH),F=0;F<H.length;++F)H[F]=R[F];return H},n.verify=function(b){b=b||{};var U=u(b);if(b.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var k=u({message:b.signature,encoding:"binary"});if(k.length!==n.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+n.constants.SIGN_BYTE_LENGTH);var y=u({message:b.publicKey,encoding:"binary"});if(y.length!==n.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+n.constants.PUBLIC_KEY_BYTE_LENGTH);var R=new i(n.constants.SIGN_BYTE_LENGTH+U.length),H=new i(n.constants.SIGN_BYTE_LENGTH+U.length),F;for(F=0;F<n.constants.SIGN_BYTE_LENGTH;++F)R[F]=k[F];for(F=0;F<U.length;++F)R[F+n.constants.SIGN_BYTE_LENGTH]=U[F];return T(H,R,R.length,y)>=0};function u(b){var U=b.message;if(U instanceof Uint8Array||U instanceof i)return U;var k=b.encoding;if(U===void 0)if(b.md)U=b.md.digest().getBytes(),k="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof U=="string"&&!k)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof U=="string"){if(typeof Buffer<"u")return Buffer.from(U,k);U=new o(U,k)}else if(!(U instanceof o))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var y=new i(U.length()),R=0;R<y.length;++R)y[R]=U.at(R);return y}var h=X(),m=X([1]),B=X([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=X([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=X([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),p=X([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),S=X([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(b,U){var k=t.md.sha512.create(),y=new o(b);k.update(y.getBytes(U),"binary");var R=k.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(R,"binary");for(var H=new i(n.constants.HASH_BYTE_LENGTH),F=0;F<64;++F)H[F]=R.charCodeAt(F);return H}function g(b,U){var k=[X(),X(),X(),X()],y,R=f(U,32);for(R[0]&=248,R[31]&=127,R[31]|=64,G(k,R),w(b,k),y=0;y<32;++y)U[y+32]=b[y];return 0}function E(b,U,k,y){var R,H,F=new Float64Array(64),J=[X(),X(),X(),X()],ie=f(y,32);ie[0]&=248,ie[31]&=127,ie[31]|=64;var ce=k+64;for(R=0;R<k;++R)b[64+R]=U[R];for(R=0;R<32;++R)b[32+R]=ie[32+R];var Q=f(b.subarray(32),k+32);for(x(Q),G(J,Q),w(b,J),R=32;R<64;++R)b[R]=y[R];var se=f(b,k+64);for(x(se),R=32;R<64;++R)F[R]=0;for(R=0;R<32;++R)F[R]=Q[R];for(R=0;R<32;++R)for(H=0;H<32;H++)F[R+H]+=se[R]*ie[H];return I(b.subarray(32),F),ce}function T(b,U,k,y){var R,H,F=new i(32),J=[X(),X(),X(),X()],ie=[X(),X(),X(),X()];if(H=-1,k<64||O(ie,y))return-1;for(R=0;R<k;++R)b[R]=U[R];for(R=0;R<32;++R)b[R+32]=y[R];var ce=f(b,k);if(x(ce),z(J,ie,ce),G(ie,U.subarray(32)),l(J,ie),w(F,J),k-=64,P(U,0,F,0)){for(R=0;R<k;++R)b[R]=0;return-1}for(R=0;R<k;++R)b[R]=U[R+64];return H=k,H}function I(b,U){var k,y,R,H;for(y=63;y>=32;--y){for(k=0,R=y-32,H=y-12;R<H;++R)U[R]+=k-16*U[y]*C[R-(y-32)],k=U[R]+128>>8,U[R]-=k*256;U[R]+=k,U[y]=0}for(k=0,R=0;R<32;++R)U[R]+=k-(U[31]>>4)*C[R],k=U[R]>>8,U[R]&=255;for(R=0;R<32;++R)U[R]-=k*C[R];for(y=0;y<32;++y)U[y+1]+=U[y]>>8,b[y]=U[y]&255}function x(b){for(var U=new Float64Array(64),k=0;k<64;++k)U[k]=b[k],b[k]=0;I(b,U)}function l(b,U){var k=X(),y=X(),R=X(),H=X(),F=X(),J=X(),ie=X(),ce=X(),Q=X();W(k,b[1],b[0]),W(Q,U[1],U[0]),le(k,k,Q),re(y,b[0],b[1]),re(Q,U[0],U[1]),le(y,y,Q),le(R,b[3],U[3]),le(R,R,v),le(H,b[2],U[2]),re(H,H,H),W(F,y,k),W(J,H,R),re(ie,H,R),re(ce,y,k),le(b[0],F,J),le(b[1],ce,ie),le(b[2],ie,J),le(b[3],F,ce)}function s(b,U,k){for(var y=0;y<4;++y)ue(b[y],U[y],k)}function w(b,U){var k=X(),y=X(),R=X();j(R,U[2]),le(k,U[0],R),le(y,U[1],R),N(b,y),b[31]^=q(k)<<7}function N(b,U){var k,y,R,H=X(),F=X();for(k=0;k<16;++k)F[k]=U[k];for(te(F),te(F),te(F),y=0;y<2;++y){for(H[0]=F[0]-65517,k=1;k<15;++k)H[k]=F[k]-65535-(H[k-1]>>16&1),H[k-1]&=65535;H[15]=F[15]-32767-(H[14]>>16&1),R=H[15]>>16&1,H[14]&=65535,ue(F,H,1-R)}for(k=0;k<16;k++)b[2*k]=F[k]&255,b[2*k+1]=F[k]>>8}function O(b,U){var k=X(),y=X(),R=X(),H=X(),F=X(),J=X(),ie=X();return Y(b[2],m),_(b[1],U),pe(R,b[1]),le(H,R,B),W(R,R,b[2]),re(H,b[2],H),pe(F,H),pe(J,F),le(ie,J,F),le(k,ie,R),le(k,k,H),D(k,k),le(k,k,R),le(k,k,H),le(k,k,H),le(b[0],k,H),pe(y,b[0]),le(y,y,H),V(y,R)&&le(b[0],b[0],S),pe(y,b[0]),le(y,y,H),V(y,R)?-1:(q(b[0])===U[31]>>7&&W(b[0],h,b[0]),le(b[3],b[0],b[1]),0)}function _(b,U){var k;for(k=0;k<16;++k)b[k]=U[2*k]+(U[2*k+1]<<8);b[15]&=32767}function D(b,U){var k=X(),y;for(y=0;y<16;++y)k[y]=U[y];for(y=250;y>=0;--y)pe(k,k),y!==1&&le(k,k,U);for(y=0;y<16;++y)b[y]=k[y]}function V(b,U){var k=new i(32),y=new i(32);return N(k,b),N(y,U),P(k,0,y,0)}function P(b,U,k,y){return M(b,U,k,y,32)}function M(b,U,k,y,R){var H,F=0;for(H=0;H<R;++H)F|=b[U+H]^k[y+H];return(1&F-1>>>8)-1}function q(b){var U=new i(32);return N(U,b),U[0]&1}function z(b,U,k){var y,R;for(Y(b[0],h),Y(b[1],m),Y(b[2],m),Y(b[3],h),R=255;R>=0;--R)y=k[R/8|0]>>(R&7)&1,s(b,U,y),l(U,b),l(b,b),s(b,U,y)}function G(b,U){var k=[X(),X(),X(),X()];Y(k[0],d),Y(k[1],p),Y(k[2],m),le(k[3],d,p),z(b,k,U)}function Y(b,U){var k;for(k=0;k<16;k++)b[k]=U[k]|0}function j(b,U){var k=X(),y;for(y=0;y<16;++y)k[y]=U[y];for(y=253;y>=0;--y)pe(k,k),y!==2&&y!==4&&le(k,k,U);for(y=0;y<16;++y)b[y]=k[y]}function te(b){var U,k,y=1;for(U=0;U<16;++U)k=b[U]+y+65535,y=Math.floor(k/65536),b[U]=k-y*65536;b[0]+=y-1+37*(y-1)}function ue(b,U,k){for(var y,R=~(k-1),H=0;H<16;++H)y=R&(b[H]^U[H]),b[H]^=y,U[H]^=y}function X(b){var U,k=new Float64Array(16);if(b)for(U=0;U<b.length;++U)k[U]=b[U];return k}function re(b,U,k){for(var y=0;y<16;++y)b[y]=U[y]+k[y]}function W(b,U,k){for(var y=0;y<16;++y)b[y]=U[y]-k[y]}function pe(b,U){le(b,U,U)}function le(b,U,k){var y,R,H=0,F=0,J=0,ie=0,ce=0,Q=0,se=0,he=0,ve=0,ye=0,we=0,Re=0,_e=0,Te=0,be=0,Be=0,Ne=0,je=0,Ze=0,nt=0,at=0,lt=0,pt=0,vt=0,wt=0,Ut=0,Gt=0,ar=0,yr=0,br=0,Gr=0,Ue=k[0],De=k[1],Pe=k[2],Oe=k[3],Ke=k[4],Ve=k[5],Fe=k[6],Me=k[7],He=k[8],qe=k[9],Ge=k[10],$e=k[11],Ae=k[12],Le=k[13],ze=k[14],Ye=k[15];y=U[0],H+=y*Ue,F+=y*De,J+=y*Pe,ie+=y*Oe,ce+=y*Ke,Q+=y*Ve,se+=y*Fe,he+=y*Me,ve+=y*He,ye+=y*qe,we+=y*Ge,Re+=y*$e,_e+=y*Ae,Te+=y*Le,be+=y*ze,Be+=y*Ye,y=U[1],F+=y*Ue,J+=y*De,ie+=y*Pe,ce+=y*Oe,Q+=y*Ke,se+=y*Ve,he+=y*Fe,ve+=y*Me,ye+=y*He,we+=y*qe,Re+=y*Ge,_e+=y*$e,Te+=y*Ae,be+=y*Le,Be+=y*ze,Ne+=y*Ye,y=U[2],J+=y*Ue,ie+=y*De,ce+=y*Pe,Q+=y*Oe,se+=y*Ke,he+=y*Ve,ve+=y*Fe,ye+=y*Me,we+=y*He,Re+=y*qe,_e+=y*Ge,Te+=y*$e,be+=y*Ae,Be+=y*Le,Ne+=y*ze,je+=y*Ye,y=U[3],ie+=y*Ue,ce+=y*De,Q+=y*Pe,se+=y*Oe,he+=y*Ke,ve+=y*Ve,ye+=y*Fe,we+=y*Me,Re+=y*He,_e+=y*qe,Te+=y*Ge,be+=y*$e,Be+=y*Ae,Ne+=y*Le,je+=y*ze,Ze+=y*Ye,y=U[4],ce+=y*Ue,Q+=y*De,se+=y*Pe,he+=y*Oe,ve+=y*Ke,ye+=y*Ve,we+=y*Fe,Re+=y*Me,_e+=y*He,Te+=y*qe,be+=y*Ge,Be+=y*$e,Ne+=y*Ae,je+=y*Le,Ze+=y*ze,nt+=y*Ye,y=U[5],Q+=y*Ue,se+=y*De,he+=y*Pe,ve+=y*Oe,ye+=y*Ke,we+=y*Ve,Re+=y*Fe,_e+=y*Me,Te+=y*He,be+=y*qe,Be+=y*Ge,Ne+=y*$e,je+=y*Ae,Ze+=y*Le,nt+=y*ze,at+=y*Ye,y=U[6],se+=y*Ue,he+=y*De,ve+=y*Pe,ye+=y*Oe,we+=y*Ke,Re+=y*Ve,_e+=y*Fe,Te+=y*Me,be+=y*He,Be+=y*qe,Ne+=y*Ge,je+=y*$e,Ze+=y*Ae,nt+=y*Le,at+=y*ze,lt+=y*Ye,y=U[7],he+=y*Ue,ve+=y*De,ye+=y*Pe,we+=y*Oe,Re+=y*Ke,_e+=y*Ve,Te+=y*Fe,be+=y*Me,Be+=y*He,Ne+=y*qe,je+=y*Ge,Ze+=y*$e,nt+=y*Ae,at+=y*Le,lt+=y*ze,pt+=y*Ye,y=U[8],ve+=y*Ue,ye+=y*De,we+=y*Pe,Re+=y*Oe,_e+=y*Ke,Te+=y*Ve,be+=y*Fe,Be+=y*Me,Ne+=y*He,je+=y*qe,Ze+=y*Ge,nt+=y*$e,at+=y*Ae,lt+=y*Le,pt+=y*ze,vt+=y*Ye,y=U[9],ye+=y*Ue,we+=y*De,Re+=y*Pe,_e+=y*Oe,Te+=y*Ke,be+=y*Ve,Be+=y*Fe,Ne+=y*Me,je+=y*He,Ze+=y*qe,nt+=y*Ge,at+=y*$e,lt+=y*Ae,pt+=y*Le,vt+=y*ze,wt+=y*Ye,y=U[10],we+=y*Ue,Re+=y*De,_e+=y*Pe,Te+=y*Oe,be+=y*Ke,Be+=y*Ve,Ne+=y*Fe,je+=y*Me,Ze+=y*He,nt+=y*qe,at+=y*Ge,lt+=y*$e,pt+=y*Ae,vt+=y*Le,wt+=y*ze,Ut+=y*Ye,y=U[11],Re+=y*Ue,_e+=y*De,Te+=y*Pe,be+=y*Oe,Be+=y*Ke,Ne+=y*Ve,je+=y*Fe,Ze+=y*Me,nt+=y*He,at+=y*qe,lt+=y*Ge,pt+=y*$e,vt+=y*Ae,wt+=y*Le,Ut+=y*ze,Gt+=y*Ye,y=U[12],_e+=y*Ue,Te+=y*De,be+=y*Pe,Be+=y*Oe,Ne+=y*Ke,je+=y*Ve,Ze+=y*Fe,nt+=y*Me,at+=y*He,lt+=y*qe,pt+=y*Ge,vt+=y*$e,wt+=y*Ae,Ut+=y*Le,Gt+=y*ze,ar+=y*Ye,y=U[13],Te+=y*Ue,be+=y*De,Be+=y*Pe,Ne+=y*Oe,je+=y*Ke,Ze+=y*Ve,nt+=y*Fe,at+=y*Me,lt+=y*He,pt+=y*qe,vt+=y*Ge,wt+=y*$e,Ut+=y*Ae,Gt+=y*Le,ar+=y*ze,yr+=y*Ye,y=U[14],be+=y*Ue,Be+=y*De,Ne+=y*Pe,je+=y*Oe,Ze+=y*Ke,nt+=y*Ve,at+=y*Fe,lt+=y*Me,pt+=y*He,vt+=y*qe,wt+=y*Ge,Ut+=y*$e,Gt+=y*Ae,ar+=y*Le,yr+=y*ze,br+=y*Ye,y=U[15],Be+=y*Ue,Ne+=y*De,je+=y*Pe,Ze+=y*Oe,nt+=y*Ke,at+=y*Ve,lt+=y*Fe,pt+=y*Me,vt+=y*He,wt+=y*qe,Ut+=y*Ge,Gt+=y*$e,ar+=y*Ae,yr+=y*Le,br+=y*ze,Gr+=y*Ye,H+=38*Ne,F+=38*je,J+=38*Ze,ie+=38*nt,ce+=38*at,Q+=38*lt,se+=38*pt,he+=38*vt,ve+=38*wt,ye+=38*Ut,we+=38*Gt,Re+=38*ar,_e+=38*yr,Te+=38*br,be+=38*Gr,R=1,y=H+R+65535,R=Math.floor(y/65536),H=y-R*65536,y=F+R+65535,R=Math.floor(y/65536),F=y-R*65536,y=J+R+65535,R=Math.floor(y/65536),J=y-R*65536,y=ie+R+65535,R=Math.floor(y/65536),ie=y-R*65536,y=ce+R+65535,R=Math.floor(y/65536),ce=y-R*65536,y=Q+R+65535,R=Math.floor(y/65536),Q=y-R*65536,y=se+R+65535,R=Math.floor(y/65536),se=y-R*65536,y=he+R+65535,R=Math.floor(y/65536),he=y-R*65536,y=ve+R+65535,R=Math.floor(y/65536),ve=y-R*65536,y=ye+R+65535,R=Math.floor(y/65536),ye=y-R*65536,y=we+R+65535,R=Math.floor(y/65536),we=y-R*65536,y=Re+R+65535,R=Math.floor(y/65536),Re=y-R*65536,y=_e+R+65535,R=Math.floor(y/65536),_e=y-R*65536,y=Te+R+65535,R=Math.floor(y/65536),Te=y-R*65536,y=be+R+65535,R=Math.floor(y/65536),be=y-R*65536,y=Be+R+65535,R=Math.floor(y/65536),Be=y-R*65536,H+=R-1+37*(R-1),R=1,y=H+R+65535,R=Math.floor(y/65536),H=y-R*65536,y=F+R+65535,R=Math.floor(y/65536),F=y-R*65536,y=J+R+65535,R=Math.floor(y/65536),J=y-R*65536,y=ie+R+65535,R=Math.floor(y/65536),ie=y-R*65536,y=ce+R+65535,R=Math.floor(y/65536),ce=y-R*65536,y=Q+R+65535,R=Math.floor(y/65536),Q=y-R*65536,y=se+R+65535,R=Math.floor(y/65536),se=y-R*65536,y=he+R+65535,R=Math.floor(y/65536),he=y-R*65536,y=ve+R+65535,R=Math.floor(y/65536),ve=y-R*65536,y=ye+R+65535,R=Math.floor(y/65536),ye=y-R*65536,y=we+R+65535,R=Math.floor(y/65536),we=y-R*65536,y=Re+R+65535,R=Math.floor(y/65536),Re=y-R*65536,y=_e+R+65535,R=Math.floor(y/65536),_e=y-R*65536,y=Te+R+65535,R=Math.floor(y/65536),Te=y-R*65536,y=be+R+65535,R=Math.floor(y/65536),be=y-R*65536,y=Be+R+65535,R=Math.floor(y/65536),Be=y-R*65536,H+=R-1+37*(R-1),b[0]=H,b[1]=F,b[2]=J,b[3]=ie,b[4]=ce,b[5]=Q,b[6]=se,b[7]=he,b[8]=ve,b[9]=ye,b[10]=we,b[11]=Re,b[12]=_e,b[13]=Te,b[14]=be,b[15]=Be}return pa}var ya,is;function Ru(){if(is)return ya;is=1;var t=ge();Ee(),Bt(),bn(),ya=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(a,c){c=c||{};var o=c.prng||t.random,i={};return i.encrypt=function(n,u){var h=Math.ceil(n.n.bitLength()/8),m;do m=new e(t.util.bytesToHex(o.getBytesSync(h)),16).mod(n.n);while(m.compareTo(e.ONE)<=0);m=t.util.hexToBytes(m.toString(16));var B=h-m.length;B>0&&(m=t.util.fillString("\0",B)+m);var v=n.encrypt(m,"NONE"),d=a.generate(m,u);return{encapsulation:v,key:d}},i.decrypt=function(n,u,h){var m=n.decrypt(u,"NONE");return a.generate(m,h)},i},t.kem.kdf1=function(a,c){r(this,a,0,c||a.digestLength)},t.kem.kdf2=function(a,c){r(this,a,1,c||a.digestLength)};function r(a,c,o,i){a.generate=function(n,u){for(var h=new t.util.ByteBuffer,m=Math.ceil(u/i)+o,B=new t.util.ByteBuffer,v=o;v<m;++v){B.putInt32(v),c.start(),c.update(n+B.getBytes());var d=c.digest();h.putBytes(d.getBytes(i))}return h.truncate(h.length()-u),h.getBytes()}}return ya}var ga,ss;function Nu(){if(ss)return ga;ss=1;var t=ge();Ee(),ga=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},r=[],a=null;t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8;for(var c=0;c<t.log.levels.length;++c){var o=t.log.levels[c];e[o]={index:c,name:o.toUpperCase()}}t.log.logMessage=function(v){for(var d=e[v.level].index,p=0;p<r.length;++p){var C=r[p];if(C.flags&t.log.NO_LEVEL_CHECK)C.f(v);else{var S=e[C.level].index;d<=S&&C.f(C,v)}}},t.log.prepareStandard=function(v){"standard"in v||(v.standard=e[v.level].name+" ["+v.category+"] "+v.message)},t.log.prepareFull=function(v){if(!("full"in v)){var d=[v.message];d=d.concat([]),v.full=t.util.format.apply(this,d)}},t.log.prepareStandardFull=function(v){"standardFull"in v||(t.log.prepareStandard(v),v.standardFull=v.standard)};for(var i=["error","warning","info","debug","verbose"],c=0;c<i.length;++c)(function(d){t.log[d]=function(p,C){var S=Array.prototype.slice.call(arguments).slice(2),f={timestamp:new Date,level:d,category:p,message:C,arguments:S};t.log.logMessage(f)}})(i[c]);if(t.log.makeLogger=function(v){var d={flags:0,f:v};return t.log.setLevel(d,"none"),d},t.log.setLevel=function(v,d){var p=!1;if(v&&!(v.flags&t.log.LEVEL_LOCKED))for(var C=0;C<t.log.levels.length;++C){var S=t.log.levels[C];if(d==S){v.level=d,p=!0;break}}return p},t.log.lock=function(v,d){typeof d>"u"||d?v.flags|=t.log.LEVEL_LOCKED:v.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(v){r.push(v)},typeof console<"u"&&"log"in console){var n;if(console.error&&console.warn&&console.info&&console.debug){var u={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},h=function(v,d){t.log.prepareStandard(d);var p=u[d.level],C=[d.standard];C=C.concat(d.arguments.slice()),p.apply(console,C)};n=t.log.makeLogger(h)}else{var h=function(d,p){t.log.prepareStandardFull(p),console.log(p.standardFull)};n=t.log.makeLogger(h)}t.log.setLevel(n,"debug"),t.log.addLogger(n),a=n}else console={log:function(){}};if(a!==null&&typeof window<"u"&&window.location){var m=new URL(window.location.href).searchParams;if(m.has("console.level")&&t.log.setLevel(a,m.get("console.level").slice(-1)[0]),m.has("console.lock")){var B=m.get("console.lock").slice(-1)[0];B=="true"&&t.log.lock(a)}}return t.log.consoleLogger=a,ga}var va,os;function Lu(){return os||(os=1,va=qt(),za(),qr(),bo(),Uo()),va}var ma={exports:{}},fs;function ku(){if(fs)return ma.exports;fs=1;var t=ge();hr(),kt(),Cn(),dr(),Cr(),_o(),Bt(),Ee(),ja();var e=t.asn1,r=ma.exports=t.pkcs7=t.pkcs7||{};r.messageFromPem=function(d){var p=t.pem.decode(d)[0];if(p.type!=="PKCS7"){var C=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw C.headerType=p.type,C}if(p.procType&&p.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var S=e.fromDer(p.body);return r.messageFromAsn1(S)},r.messageToPem=function(d,p){var C={type:"PKCS7",body:e.toDer(d.toAsn1()).getBytes()};return t.pem.encode(C,{maxline:p})},r.messageFromAsn1=function(d){var p={},C=[];if(!e.validate(d,r.asn1.contentInfoValidator,p,C)){var S=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw S.errors=C,S}var f=e.derToOid(p.contentType),g;switch(f){case t.pki.oids.envelopedData:g=r.createEnvelopedData();break;case t.pki.oids.encryptedData:g=r.createEncryptedData();break;case t.pki.oids.signedData:g=r.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+f+" is not (yet) supported.")}return g.fromAsn1(p.content.value[0]),g},r.createSignedData=function(){var d=null;return d={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(S){if(B(d,S,r.asn1.signedDataValidator),d.certificates=[],d.crls=[],d.digestAlgorithmIdentifiers=[],d.contentInfo=null,d.signerInfos=[],d.rawCapture.certificates)for(var f=d.rawCapture.certificates.value,g=0;g<f.length;++g)d.certificates.push(t.pki.certificateFromAsn1(f[g]))},toAsn1:function(){d.contentInfo||d.sign();for(var S=[],f=0;f<d.certificates.length;++f)S.push(t.pki.certificateToAsn1(d.certificates[f]));var g=[],E=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d.digestAlgorithmIdentifiers),d.contentInfo])]);return S.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,S)),g.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,g)),E.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),E])},addSigner:function(S){var f=S.issuer,g=S.serialNumber;if(S.certificate){var E=S.certificate;typeof E=="string"&&(E=t.pki.certificateFromPem(E)),f=E.issuer.attributes,g=E.serialNumber}var T=S.key;if(!T)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof T=="string"&&(T=t.pki.privateKeyFromPem(T));var I=S.digestAlgorithm||t.pki.oids.sha1;switch(I){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+I)}var x=S.authenticatedAttributes||[];if(x.length>0){for(var l=!1,s=!1,w=0;w<x.length;++w){var N=x[w];if(!l&&N.type===t.pki.oids.contentType){if(l=!0,s)break;continue}if(!s&&N.type===t.pki.oids.messageDigest){if(s=!0,l)break;continue}}if(!l||!s)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}d.signers.push({key:T,version:1,issuer:f,serialNumber:g,digestAlgorithm:I,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:x,unauthenticatedAttributes:[]})},sign:function(S){if(S=S||{},(typeof d.content!="object"||d.contentInfo===null)&&(d.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in d)){var f;d.content instanceof t.util.ByteBuffer?f=d.content.bytes():typeof d.content=="string"&&(f=t.util.encodeUtf8(d.content)),S.detached?d.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f):d.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f)]))}if(d.signers.length!==0){var g=p();C(g)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(S){typeof S=="string"&&(S=t.pki.certificateFromPem(S)),d.certificates.push(S)},addCertificateRevokationList:function(S){throw new Error("PKCS#7 CRL support not yet implemented.")}},d;function p(){for(var S={},f=0;f<d.signers.length;++f){var g=d.signers[f],E=g.digestAlgorithm;E in S||(S[E]=t.md[t.pki.oids[E]].create()),g.authenticatedAttributes.length===0?g.md=S[E]:g.md=t.md[t.pki.oids[E]].create()}d.digestAlgorithmIdentifiers=[];for(var E in S)d.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(E).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return S}function C(S){var f;if(d.detachedContent?f=d.detachedContent:(f=d.contentInfo.value[1],f=f.value[0]),!f)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var g=e.derToOid(d.contentInfo.value[0].value),E=e.toDer(f);E.getByte(),e.getBerValueLength(E),E=E.getBytes();for(var T in S)S[T].start().update(E);for(var I=new Date,x=0;x<d.signers.length;++x){var l=d.signers[x];if(l.authenticatedAttributes.length===0){if(g!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var s=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),w=0;w<l.authenticatedAttributes.length;++w){var N=l.authenticatedAttributes[w];N.type===t.pki.oids.messageDigest?N.value=S[l.digestAlgorithm].digest():N.type===t.pki.oids.signingTime&&(N.value||(N.value=I)),s.value.push(h(N)),l.authenticatedAttributesAsn1.value.push(h(N))}E=e.toDer(s).getBytes(),l.md.start().update(E)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}d.signerInfos=u(d.signers)}},r.createEncryptedData=function(){var d=null;return d={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(p){B(d,p,r.asn1.encryptedDataValidator)},decrypt:function(p){p!==void 0&&(d.encryptedContent.key=p),v(d)}},d},r.createEnvelopedData=function(){var d=null;return d={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(p){var C=B(d,p,r.asn1.envelopedDataValidator);d.recipients=o(C.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,i(d.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,m(d.encryptedContent))])])])},findRecipient:function(p){for(var C=p.issuer.attributes,S=0;S<d.recipients.length;++S){var f=d.recipients[S],g=f.issuer;if(f.serialNumber===p.serialNumber&&g.length===C.length){for(var E=!0,T=0;T<C.length;++T)if(g[T].type!==C[T].type||g[T].value!==C[T].value){E=!1;break}if(E)return f}}return null},decrypt:function(p,C){if(d.encryptedContent.key===void 0&&p!==void 0&&C!==void 0)switch(p.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var S=C.decrypt(p.encryptedContent.content);d.encryptedContent.key=t.util.createBuffer(S);break;default:throw new Error("Unsupported asymmetric cipher, OID "+p.encryptedContent.algorithm)}v(d)},addRecipient:function(p){d.recipients.push({version:0,issuer:p.issuer.attributes,serialNumber:p.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:p.publicKey}})},encrypt:function(p,C){if(d.encryptedContent.content===void 0){C=C||d.encryptedContent.algorithm,p=p||d.encryptedContent.key;var S,f,g;switch(C){case t.pki.oids["aes128-CBC"]:S=16,f=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:S=24,f=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:S=32,f=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:S=24,f=8,g=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+C)}if(p===void 0)p=t.util.createBuffer(t.random.getBytes(S));else if(p.length()!=S)throw new Error("Symmetric key has wrong length; got "+p.length()+" bytes, expected "+S+".");d.encryptedContent.algorithm=C,d.encryptedContent.key=p,d.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(f));var E=g(p);if(E.start(d.encryptedContent.parameter.copy()),E.update(d.content),!E.finish())throw new Error("Symmetric encryption failed.");d.encryptedContent.content=E.output}for(var T=0;T<d.recipients.length;++T){var I=d.recipients[T];if(I.encryptedContent.content===void 0)switch(I.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:I.encryptedContent.content=I.encryptedContent.key.encrypt(d.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+I.encryptedContent.algorithm)}}}},d};function a(d){var p={},C=[];if(!e.validate(d,r.asn1.recipientInfoValidator,p,C)){var S=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw S.errors=C,S}return{version:p.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(p.issuer),serialNumber:t.util.createBuffer(p.serial).toHex(),encryptedContent:{algorithm:e.derToOid(p.encAlgorithm),parameter:p.encParameter?p.encParameter.value:void 0,content:p.encKey}}}function c(d){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:d.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(d.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.encryptedContent.content)])}function o(d){for(var p=[],C=0;C<d.length;++C)p.push(a(d[C]));return p}function i(d){for(var p=[],C=0;C<d.length;++C)p.push(c(d[C]));return p}function n(d){var p=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:d.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(d.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(d.authenticatedAttributesAsn1&&p.value.push(d.authenticatedAttributesAsn1),p.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),p.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.signature)),d.unauthenticatedAttributes.length>0){for(var C=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),S=0;S<d.unauthenticatedAttributes.length;++S){var f=d.unauthenticatedAttributes[S];C.values.push(h(f))}p.value.push(C)}return p}function u(d){for(var p=[],C=0;C<d.length;++C)p.push(n(d[C]));return p}function h(d){var p;if(d.type===t.pki.oids.contentType)p=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.value).getBytes());else if(d.type===t.pki.oids.messageDigest)p=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.value.bytes());else if(d.type===t.pki.oids.signingTime){var C=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z"),f=d.value;if(typeof f=="string"){var g=Date.parse(f);isNaN(g)?f.length===13?f=e.utcTimeToDate(f):f=e.generalizedTimeToDate(f):f=new Date(g)}f>=C&&f<S?p=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(f)):p=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(f))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[p])])}function m(d){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.algorithm).getBytes()),d.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.content.getBytes())])]}function B(d,p,C){var S={},f=[];if(!e.validate(p,C,S,f)){var g=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw g.errors=g,g}var E=e.derToOid(S.contentType);if(E!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(S.encryptedContent){var T="";if(t.util.isArray(S.encryptedContent))for(var I=0;I<S.encryptedContent.length;++I){if(S.encryptedContent[I].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");T+=S.encryptedContent[I].value}else T=S.encryptedContent;d.encryptedContent={algorithm:e.derToOid(S.encAlgorithm),parameter:t.util.createBuffer(S.encParameter.value),content:t.util.createBuffer(T)}}if(S.content){var T="";if(t.util.isArray(S.content))for(var I=0;I<S.content.length;++I){if(S.content[I].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");T+=S.content[I].value}else T=S.content;d.content=t.util.createBuffer(T)}return d.version=S.version.charCodeAt(0),d.rawCapture=S,S}function v(d){if(d.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(d.content===void 0){var p;switch(d.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:p=t.aes.createDecryptionCipher(d.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:p=t.des.createDecryptionCipher(d.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+d.encryptedContent.algorithm)}if(p.start(d.encryptedContent.parameter),p.update(d.encryptedContent.content),!p.finish())throw new Error("Symmetric decryption failed.");d.content=p.output}}return ma.exports}var Ea={exports:{}},cs;function Uu(){if(cs)return Ea.exports;cs=1;var t=ge();hr(),Hr(),za(),qr(),Ee();var e=Ea.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(o,i,n){n=n||"",i=i||"";var u="ssh-rsa",h=i===""?"none":"aes256-cbc",m="PuTTY-User-Key-File-2: "+u+`\r
`;m+="Encryption: "+h+`\r
`,m+="Comment: "+n+`\r
`;var B=t.util.createBuffer();a(B,u),r(B,o.e),r(B,o.n);var v=t.util.encode64(B.bytes(),64),d=Math.floor(v.length/66)+1;m+="Public-Lines: "+d+`\r
`,m+=v;var p=t.util.createBuffer();r(p,o.d),r(p,o.p),r(p,o.q),r(p,o.qInv);var C;if(!i)C=t.util.encode64(p.bytes(),64);else{var S=p.length()+16-1;S-=S%16;var f=c(p.bytes());f.truncate(f.length()-S+p.length()),p.putBuffer(f);var g=t.util.createBuffer();g.putBuffer(c("\0\0\0\0",i)),g.putBuffer(c("\0\0\0",i));var E=t.aes.createEncryptionCipher(g.truncate(8),"CBC");E.start(t.util.createBuffer().fillWithByte(0,16)),E.update(p.copy()),E.finish();var T=E.output;T.truncate(16),C=t.util.encode64(T.bytes(),64)}d=Math.floor(C.length/66)+1,m+=`\r
Private-Lines: `+d+`\r
`,m+=C;var I=c("putty-private-key-file-mac-key",i),x=t.util.createBuffer();a(x,u),a(x,h),a(x,n),x.putInt32(B.length()),x.putBuffer(B),x.putInt32(p.length()),x.putBuffer(p);var l=t.hmac.create();return l.start("sha1",I),l.update(x.bytes()),m+=`\r
Private-MAC: `+l.digest().toHex()+`\r
`,m},e.publicKeyToOpenSSH=function(o,i){var n="ssh-rsa";i=i||"";var u=t.util.createBuffer();return a(u,n),r(u,o.e),r(u,o.n),n+" "+t.util.encode64(u.bytes())+" "+i},e.privateKeyToOpenSSH=function(o,i){return i?t.pki.encryptRsaPrivateKey(o,i,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(o)},e.getPublicKeyFingerprint=function(o,i){i=i||{};var n=i.md||t.md.md5.create(),u="ssh-rsa",h=t.util.createBuffer();a(h,u),r(h,o.e),r(h,o.n),n.start(),n.update(h.getBytes());var m=n.digest();if(i.encoding==="hex"){var B=m.toHex();return i.delimiter?B.match(/.{2}/g).join(i.delimiter):B}else{if(i.encoding==="binary")return m.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".')}return m};function r(o,i){var n=i.toString(16);n[0]>="8"&&(n="00"+n);var u=t.util.hexToBytes(n);o.putInt32(u.length),o.putBytes(u)}function a(o,i){o.putInt32(i.length),o.putString(i)}function c(){for(var o=t.md.sha1.create(),i=arguments.length,n=0;n<i;++n)o.update(arguments[n]);return o.digest()}return Ea.exports}var xa,us;function Du(){return us||(us=1,xa=ge(),hr(),Au(),kt(),$a(),Cn(),_u(),Hr(),Ru(),Nu(),Lu(),Ro(),Qa(),Cr(),To(),No(),ku(),Lo(),Ao(),Bo(),Xa(),Bt(),wo(),Uu(),ko(),Ee()),xa}var Pu=Du();const st=Cu(Pu),_r=2048,ls=4096;function Za(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}function Ou(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function Do(t){let e="";for(let r=0;r<t.length;r++){const a=t.charCodeAt(r);e+=a.toString(16).padStart(2,"0")}return e}function Po(t){const e=t.replace(/\s+/g,"");if(e.length%2!==0)throw new Error("Invalid hex string: length must be even");let r="";for(let a=0;a<e.length;a+=2){const c=Number.parseInt(e.substring(a,a+2),16);if(Number.isNaN(c))throw new Error(`Invalid hex string: invalid character at position ${a}`);r+=String.fromCharCode(c)}return r}function Ku(t=_r){if(t!==_r&&t!==ls)throw new Error(`Invalid key size: expected ${_r} or ${ls}, got ${t}`);const e=st.pki.rsa.generateKeyPair(t);return{publicKey:st.pki.publicKeyToPem(e.publicKey),privateKey:st.pki.privateKeyToPem(e.privateKey)}}function Vu(t,e){try{const r=st.pki.publicKeyFromPem(e),a=Za(t),c=r.encrypt(a,"RSA-OAEP");return{ciphertext:Do(c)}}catch(r){throw new Error(`RSA encryption failed: ${r instanceof Error?r.message:String(r)}`)}}function Fu(t,e){try{const r=st.pki.privateKeyFromPem(e),a=Po(t),c=r.decrypt(a,"RSA-OAEP");return Ou(c)}catch(r){throw new Error(`RSA decryption failed: ${r instanceof Error?r.message:String(r)}`)}}function Mu(t,e,r="SHA-256"){try{const a=st.pki.privateKeyFromPem(e),c=Za(t),o=r.toLowerCase().replace("-","");let i;if(o==="sha256")i=st.md.sha256.create();else if(o==="sha384")i=st.md.sha384.create();else if(o==="sha512")i=st.md.sha512.create();else if(o==="sha1")i=st.md.sha1.create();else throw new Error(`Unsupported hash algorithm: ${r}`);i.update(c,"raw");const n=a.sign(i);return{signature:Do(n)}}catch(a){throw new Error(`RSA signing failed: ${a instanceof Error?a.message:String(a)}`)}}function Hu(t,e,r,a="SHA-256"){try{const c=st.pki.publicKeyFromPem(r),o=Za(t),i=a.toLowerCase().replace("-","");let n;if(i==="sha256")n=st.md.sha256.create();else if(i==="sha384")n=st.md.sha384.create();else if(i==="sha512")n=st.md.sha512.create();else if(i==="sha1")n=st.md.sha1.create();else throw new Error(`Unsupported hash algorithm: ${a}`);n.update(o,"raw");const u=Po(e);return c.verify(n.digest().bytes(),u)}catch(c){if(c instanceof Error&&(c.message.includes("Encryption block is invalid")||c.message.includes("Encrypted message is invalid")))return!1;throw new Error(`RSA verification failed: ${c instanceof Error?c.message:String(c)}`)}}function qu(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ra(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Sa(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Ie(t,e,r=""){const a=qu(t),c=t?.length,o=e!==void 0;if(!a||o&&c!==e){const i=r&&`"${r}" `,n=o?` of length ${e}`:"",u=a?`length=${c}`:`type=${typeof t}`;throw new Error(i+"expected Uint8Array"+n+", got "+u)}return t}function Er(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Wa(t,e){Ie(t,void 0,"output");const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Gu(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function et(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ot(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function wn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const $u=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function zu(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Oo(t,e){if(t.length!==e.length)return!1;let r=0;for(let a=0;a<t.length;a++)r|=t[a]^e[a];return r===0}const Ko=(t,e)=>{function r(a,...c){if(Ie(a,void 0,"key"),!$u)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const m=c[0];Ie(m,t.varSizeNonce?void 0:t.nonceLength,"nonce")}const o=t.tagLength;o&&c[1]!==void 0&&Ie(c[1],void 0,"AAD");const i=e(a,...c),n=(m,B)=>{if(B!==void 0){if(m!==2)throw new Error("cipher output not supported");Ie(B,void 0,"output")}};let u=!1;return{encrypt(m,B){if(u)throw new Error("cannot encrypt() twice with same key + nonce");return u=!0,Ie(m),n(i.encrypt.length,B),i.encrypt(m,B)},decrypt(m,B){if(Ie(m),o&&m.length<o)throw new Error('"ciphertext" expected length bigger than tagLength='+o);return n(i.decrypt.length,B),i.decrypt(m,B)}}}return Object.assign(r,t),r};function Na(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error('"output" expected Uint8Array of length '+t+", got: "+e.length);if(r&&!ln(e))throw new Error("invalid output, must be aligned");return e}function Vo(t,e,r){Ra(r);const a=new Uint8Array(16),c=wn(a);return c.setBigUint64(0,BigInt(e),r),c.setBigUint64(8,BigInt(t),r),a}function ln(t){return t.byteOffset%4===0}function bt(t){return Uint8Array.from(t)}function pr(t=32){const e=typeof globalThis=="object"?globalThis.crypto:null;if(typeof e?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return e.getRandomValues(new Uint8Array(t))}const Ft=16,Ja=new Uint8Array(16),It=et(Ja),Yu=225,Qu=(t,e,r,a)=>{const c=a&1;return{s3:r<<31|a>>>1,s2:e<<31|r>>>1,s1:t<<31|e>>>1,s0:t>>>1^Yu<<24&-(c&1)}},gt=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255|0;function Xu(t){t.reverse();const e=t[15]&1;let r=0;for(let a=0;a<t.length;a++){const c=t[a];t[a]=c>>>1|r,r=(c&1)<<7}return t[0]^=-e&225,t}const ju=t=>t>64*1024?8:t>1024?4:2;class Fo{blockLen=Ft;outputLen=Ft;s0=0;s1=0;s2=0;s3=0;finished=!1;t;W;windowSize;constructor(e,r){Ie(e,16,"key"),e=bt(e);const a=wn(e);let c=a.getUint32(0,!1),o=a.getUint32(4,!1),i=a.getUint32(8,!1),n=a.getUint32(12,!1);const u=[];for(let p=0;p<128;p++)u.push({s0:gt(c),s1:gt(o),s2:gt(i),s3:gt(n)}),{s0:c,s1:o,s2:i,s3:n}=Qu(c,o,i,n);const h=ju(r||1024);if(![1,2,4,8].includes(h))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=h;const B=128/h,v=this.windowSize=2**h,d=[];for(let p=0;p<B;p++)for(let C=0;C<v;C++){let S=0,f=0,g=0,E=0;for(let T=0;T<h;T++){if(!(C>>>h-T-1&1))continue;const{s0:x,s1:l,s2:s,s3:w}=u[h*p+T];S^=x,f^=l,g^=s,E^=w}d.push({s0:S,s1:f,s2:g,s3:E})}this.t=d}_updateBlock(e,r,a,c){e^=this.s0,r^=this.s1,a^=this.s2,c^=this.s3;const{W:o,t:i,windowSize:n}=this;let u=0,h=0,m=0,B=0;const v=(1<<o)-1;let d=0;for(const p of[e,r,a,c])for(let C=0;C<4;C++){const S=p>>>8*C&255;for(let f=8/o-1;f>=0;f--){const g=S>>>o*f&v,{s0:E,s1:T,s2:I,s3:x}=i[d*n+g];u^=E,h^=T,m^=I,B^=x,d+=1}}this.s0=u,this.s1=h,this.s2=m,this.s3=B}update(e){Er(this),Ie(e),e=bt(e);const r=et(e),a=Math.floor(e.length/Ft),c=e.length%Ft;for(let o=0;o<a;o++)this._updateBlock(r[o*4+0],r[o*4+1],r[o*4+2],r[o*4+3]);return c&&(Ja.set(e.subarray(a*Ft)),this._updateBlock(It[0],It[1],It[2],It[3]),ot(It)),this}destroy(){const{t:e}=this;for(const r of e)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(e){Er(this),Wa(e,this),this.finished=!0;const{s0:r,s1:a,s2:c,s3:o}=this,i=et(e);return i[0]=r,i[1]=a,i[2]=c,i[3]=o,e}digest(){const e=new Uint8Array(Ft);return this.digestInto(e),this.destroy(),e}}class Zu extends Fo{constructor(e,r){Ie(e);const a=Xu(bt(e));super(a,r),ot(a)}update(e){Er(this),Ie(e),e=bt(e);const r=et(e),a=e.length%Ft,c=Math.floor(e.length/Ft);for(let o=0;o<c;o++)this._updateBlock(gt(r[o*4+3]),gt(r[o*4+2]),gt(r[o*4+1]),gt(r[o*4+0]));return a&&(Ja.set(e.subarray(c*Ft)),this._updateBlock(gt(It[3]),gt(It[2]),gt(It[1]),gt(It[0])),ot(It)),this}digestInto(e){Er(this),Wa(e,this),this.finished=!0;const{s0:r,s1:a,s2:c,s3:o}=this,i=et(e);return i[0]=r,i[1]=a,i[2]=c,i[3]=o,e.reverse()}}function Mo(t){const e=(a,c)=>t(c,a.length).update(a).digest(),r=t(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(a,c)=>t(a,c),e}const hs=Mo((t,e)=>new Fo(t,e));Mo((t,e)=>new Zu(t,e));const La=16,Wu=4,Jr=new Uint8Array(La),Ju=283;function e0(t){if(![16,24,32].includes(t.length))throw new Error('"aes key" expected Uint8Array of length 16/24/32, got length='+t.length)}function ei(t){return t<<1^Ju&-(t>>7)}function ds(t,e){let r=0;for(;e>0;e>>=1)r^=t&-(e&1),t=ei(t);return r}const t0=(()=>{const t=new Uint8Array(256);for(let r=0,a=1;r<256;r++,a^=ei(a))t[r]=a;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let a=t[255-r];a|=a<<8,e[t[r]]=(a^a>>4^a>>5^a>>6^a>>7^99)&255}return ot(t),e})(),r0=t=>t<<24|t>>>8,Ca=t=>t<<8|t>>>24;function n0(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const r=new Uint32Array(256).map((h,m)=>e(t[m])),a=r.map(Ca),c=a.map(Ca),o=c.map(Ca),i=new Uint32Array(256*256),n=new Uint32Array(256*256),u=new Uint16Array(256*256);for(let h=0;h<256;h++)for(let m=0;m<256;m++){const B=h*256+m;i[B]=r[h]^a[m],n[B]=c[h]^o[m],u[B]=t[h]<<8|t[m]}return{sbox:t,sbox2:u,T0:r,T1:a,T2:c,T3:o,T01:i,T23:n}}const Ho=n0(t0,t=>ds(t,3)<<24|t<<16|t<<8|ds(t,2)),a0=(()=>{const t=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=ei(r))t[e]=r;return t})();function i0(t){Ie(t);const e=t.length;e0(t);const{sbox2:r}=Ho,a=[];ln(t)||a.push(t=bt(t));const c=et(t),o=c.length,i=u=>Ar(r,u,u,u,u),n=new Uint32Array(e+28);n.set(c);for(let u=o;u<n.length;u++){let h=n[u-1];u%o===0?h=i(r0(h))^a0[u/o-1]:o>6&&u%o===4&&(h=i(h)),n[u]=n[u-o]^h}return ot(...a),n}function en(t,e,r,a,c,o){return t[r<<8&65280|a>>>8&255]^e[c>>>8&65280|o>>>24&255]}function Ar(t,e,r,a,c){return t[e&255|r&65280]|t[a>>>16&255|c>>>16&65280]<<16}function ps(t,e,r,a,c){const{sbox2:o,T01:i,T23:n}=Ho;let u=0;e^=t[u++],r^=t[u++],a^=t[u++],c^=t[u++];const h=t.length/4-2;for(let p=0;p<h;p++){const C=t[u++]^en(i,n,e,r,a,c),S=t[u++]^en(i,n,r,a,c,e),f=t[u++]^en(i,n,a,c,e,r),g=t[u++]^en(i,n,c,e,r,a);e=C,r=S,a=f,c=g}const m=t[u++]^Ar(o,e,r,a,c),B=t[u++]^Ar(o,r,a,c,e),v=t[u++]^Ar(o,a,c,e,r),d=t[u++]^Ar(o,c,e,r,a);return{s0:m,s1:B,s2:v,s3:d}}function tn(t,e,r,a,c){Ie(r,La,"nonce"),Ie(a),c=Na(a.length,c);const o=r,i=et(o),n=wn(o),u=et(a),h=et(c),m=e?0:12,B=a.length;let v=n.getUint32(m,e),{s0:d,s1:p,s2:C,s3:S}=ps(t,i[0],i[1],i[2],i[3]);for(let g=0;g+4<=u.length;g+=4)h[g+0]=u[g+0]^d,h[g+1]=u[g+1]^p,h[g+2]=u[g+2]^C,h[g+3]=u[g+3]^S,v=v+1>>>0,n.setUint32(m,v,e),{s0:d,s1:p,s2:C,s3:S}=ps(t,i[0],i[1],i[2],i[3]);const f=La*Math.floor(u.length/Wu);if(f<B){const g=new Uint32Array([d,p,C,S]),E=Gu(g);for(let T=f,I=0;T<B;T++,I++)c[T]=a[T]^E[I];ot(g)}return c}function s0(t,e,r,a,c){const o=c?c.length:0,i=t.create(r,a.length+o);c&&i.update(c);const n=Vo(8*a.length,8*o,e);i.update(a),i.update(n);const u=i.digest();return ot(n),u}const qo=Ko({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,r,a){if(r.length<8)throw new Error("aes/gcm: invalid nonce length");const c=16;function o(n,u,h){const m=s0(hs,!1,n,h,a);for(let B=0;B<u.length;B++)m[B]^=u[B];return m}function i(){const n=i0(e),u=Jr.slice(),h=Jr.slice();if(tn(n,!1,h,h,u),r.length===12)h.set(r);else{const B=Jr.slice();wn(B).setBigUint64(8,BigInt(r.length*8),!1);const d=hs.create(u).update(r).update(B);d.digestInto(h),d.destroy()}const m=tn(n,!1,h,Jr);return{xk:n,authKey:u,counter:h,tagMask:m}}return{encrypt(n){const{xk:u,authKey:h,counter:m,tagMask:B}=i(),v=new Uint8Array(n.length+c),d=[u,h,m,B];ln(n)||d.push(n=bt(n)),tn(u,!1,m,n,v.subarray(0,n.length));const p=o(h,B,v.subarray(0,v.length-c));return d.push(p),v.set(p,n.length),ot(...d),v},decrypt(n){const{xk:u,authKey:h,counter:m,tagMask:B}=i(),v=[u,h,B,m];ln(n)||v.push(n=bt(n));const d=n.subarray(0,-c),p=n.subarray(-c),C=o(h,B,d);if(v.push(C),!Oo(C,p))throw new Error("aes/gcm: invalid ghash tag");const S=tn(u,!1,m,d);return ot(...v),S}}}),xr=256,Rr=12,hn=16;function Go(t,e,r){if(e.length!==xr/8)throw new Error(`Invalid key length: expected ${xr/8} bytes, got ${e.length}`);const a=r??pr(Rr);if(a.length!==Rr)throw new Error(`Invalid IV length: expected ${Rr} bytes, got ${a.length}`);const o=qo(e,a).encrypt(t),i=o.subarray(0,o.length-hn),n=o.subarray(o.length-hn);return{ciphertext:i,authTag:n,iv:a}}function $o(t,e,r,a){if(e.length!==xr/8)throw new Error(`Invalid key length: expected ${xr/8} bytes, got ${e.length}`);if(r.length!==Rr)throw new Error(`Invalid IV length: expected ${Rr} bytes, got ${r.length}`);if(a.length!==hn)throw new Error(`Invalid auth tag length: expected ${hn} bytes, got ${a.length}`);const c=qo(e,r),o=new Uint8Array(t.length+a.length);o.set(t),o.set(a,t.length);try{return c.decrypt(o)}catch{throw new Error("Authentication failed: data may have been tampered with")}}function zo(){return pr(xr/8)}const Yo=t=>Uint8Array.from(t.split(""),e=>e.charCodeAt(0)),o0=Yo("expand 16-byte k"),f0=Yo("expand 32-byte k"),c0=et(o0),u0=et(f0);function fe(t,e){return t<<e|t>>>32-e}function ka(t){return t.byteOffset%4===0}const rn=64,l0=16,Qo=2**32-1,ys=Uint32Array.of();function h0(t,e,r,a,c,o,i,n){const u=c.length,h=new Uint8Array(rn),m=et(h),B=ka(c)&&ka(o),v=B?et(c):ys,d=B?et(o):ys;for(let p=0;p<u;i++){if(t(e,r,a,m,i,n),i>=Qo)throw new Error("arx: counter overflow");const C=Math.min(rn,u-p);if(B&&C===rn){const S=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let f=0,g;f<l0;f++)g=S+f,d[g]=v[g]^m[f];p+=rn;continue}for(let S=0,f;S<C;S++)f=p+S,o[f]=c[f]^h[S];p+=C}}function d0(t,e){const{allowShortKeys:r,extendNonceFn:a,counterLength:c,counterRight:o,rounds:i}=zu({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Sa(c),Sa(i),Ra(o),Ra(r),(n,u,h,m,B=0)=>{Ie(n,void 0,"key"),Ie(u,void 0,"nonce"),Ie(h,void 0,"data");const v=h.length;if(m===void 0&&(m=new Uint8Array(v)),Ie(m,void 0,"output"),Sa(B),B<0||B>=Qo)throw new Error("arx: counter overflow");if(m.length<v)throw new Error(`arx: output (${m.length}) is shorter than data (${v})`);const d=[];let p=n.length,C,S;if(p===32)d.push(C=bt(n)),S=u0;else if(p===16&&r)C=new Uint8Array(32),C.set(n),C.set(n,16),S=c0,d.push(C);else throw Ie(n,32,"arx key"),new Error("invalid key size");ka(u)||d.push(u=bt(u));const f=et(C);if(a){if(u.length!==24)throw new Error("arx: extended nonce must be 24 bytes");a(S,f,et(u.subarray(0,16)),f),u=u.subarray(16)}const g=16-c;if(g!==u.length)throw new Error(`arx: nonce must be ${g} or 16 bytes`);if(g!==12){const T=new Uint8Array(12);T.set(u,o?0:12-u.length),u=T,d.push(u)}const E=et(u);return h0(t,S,f,E,h,m,B,i),ot(...d),m}}function We(t,e){return t[e++]&255|(t[e++]&255)<<8}class p0{blockLen=16;outputLen=16;buffer=new Uint8Array(16);r=new Uint16Array(10);h=new Uint16Array(10);pad=new Uint16Array(8);pos=0;finished=!1;constructor(e){e=bt(Ie(e,32,"key"));const r=We(e,0),a=We(e,2),c=We(e,4),o=We(e,6),i=We(e,8),n=We(e,10),u=We(e,12),h=We(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|a<<3)&8191,this.r[2]=(a>>>10|c<<6)&7939,this.r[3]=(c>>>7|o<<9)&8191,this.r[4]=(o>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|n<<2)&8191,this.r[7]=(n>>>11|u<<5)&8065,this.r[8]=(u>>>8|h<<8)&8191,this.r[9]=h>>>5&127;for(let m=0;m<8;m++)this.pad[m]=We(e,16+2*m)}process(e,r,a=!1){const c=a?0:2048,{h:o,r:i}=this,n=i[0],u=i[1],h=i[2],m=i[3],B=i[4],v=i[5],d=i[6],p=i[7],C=i[8],S=i[9],f=We(e,r+0),g=We(e,r+2),E=We(e,r+4),T=We(e,r+6),I=We(e,r+8),x=We(e,r+10),l=We(e,r+12),s=We(e,r+14);let w=o[0]+(f&8191),N=o[1]+((f>>>13|g<<3)&8191),O=o[2]+((g>>>10|E<<6)&8191),_=o[3]+((E>>>7|T<<9)&8191),D=o[4]+((T>>>4|I<<12)&8191),V=o[5]+(I>>>1&8191),P=o[6]+((I>>>14|x<<2)&8191),M=o[7]+((x>>>11|l<<5)&8191),q=o[8]+((l>>>8|s<<8)&8191),z=o[9]+(s>>>5|c),G=0,Y=G+w*n+N*(5*S)+O*(5*C)+_*(5*p)+D*(5*d);G=Y>>>13,Y&=8191,Y+=V*(5*v)+P*(5*B)+M*(5*m)+q*(5*h)+z*(5*u),G+=Y>>>13,Y&=8191;let j=G+w*u+N*n+O*(5*S)+_*(5*C)+D*(5*p);G=j>>>13,j&=8191,j+=V*(5*d)+P*(5*v)+M*(5*B)+q*(5*m)+z*(5*h),G+=j>>>13,j&=8191;let te=G+w*h+N*u+O*n+_*(5*S)+D*(5*C);G=te>>>13,te&=8191,te+=V*(5*p)+P*(5*d)+M*(5*v)+q*(5*B)+z*(5*m),G+=te>>>13,te&=8191;let ue=G+w*m+N*h+O*u+_*n+D*(5*S);G=ue>>>13,ue&=8191,ue+=V*(5*C)+P*(5*p)+M*(5*d)+q*(5*v)+z*(5*B),G+=ue>>>13,ue&=8191;let X=G+w*B+N*m+O*h+_*u+D*n;G=X>>>13,X&=8191,X+=V*(5*S)+P*(5*C)+M*(5*p)+q*(5*d)+z*(5*v),G+=X>>>13,X&=8191;let re=G+w*v+N*B+O*m+_*h+D*u;G=re>>>13,re&=8191,re+=V*n+P*(5*S)+M*(5*C)+q*(5*p)+z*(5*d),G+=re>>>13,re&=8191;let W=G+w*d+N*v+O*B+_*m+D*h;G=W>>>13,W&=8191,W+=V*u+P*n+M*(5*S)+q*(5*C)+z*(5*p),G+=W>>>13,W&=8191;let pe=G+w*p+N*d+O*v+_*B+D*m;G=pe>>>13,pe&=8191,pe+=V*h+P*u+M*n+q*(5*S)+z*(5*C),G+=pe>>>13,pe&=8191;let le=G+w*C+N*p+O*d+_*v+D*B;G=le>>>13,le&=8191,le+=V*m+P*h+M*u+q*n+z*(5*S),G+=le>>>13,le&=8191;let b=G+w*S+N*C+O*p+_*d+D*v;G=b>>>13,b&=8191,b+=V*B+P*m+M*h+q*u+z*n,G+=b>>>13,b&=8191,G=(G<<2)+G|0,G=G+Y|0,Y=G&8191,G=G>>>13,j+=G,o[0]=Y,o[1]=j,o[2]=te,o[3]=ue,o[4]=X,o[5]=re,o[6]=W,o[7]=pe,o[8]=le,o[9]=b}finalize(){const{h:e,pad:r}=this,a=new Uint16Array(10);let c=e[1]>>>13;e[1]&=8191;for(let n=2;n<10;n++)e[n]+=c,c=e[n]>>>13,e[n]&=8191;e[0]+=c*5,c=e[0]>>>13,e[0]&=8191,e[1]+=c,c=e[1]>>>13,e[1]&=8191,e[2]+=c,a[0]=e[0]+5,c=a[0]>>>13,a[0]&=8191;for(let n=1;n<10;n++)a[n]=e[n]+c,c=a[n]>>>13,a[n]&=8191;a[9]-=8192;let o=(c^1)-1;for(let n=0;n<10;n++)a[n]&=o;o=~o;for(let n=0;n<10;n++)e[n]=e[n]&o|a[n];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let i=e[0]+r[0];e[0]=i&65535;for(let n=1;n<8;n++)i=(e[n]+r[n]|0)+(i>>>16)|0,e[n]=i&65535;ot(a)}update(e){Er(this),Ie(e),e=bt(e);const{buffer:r,blockLen:a}=this,c=e.length;for(let o=0;o<c;){const i=Math.min(a-this.pos,c-o);if(i===a){for(;a<=c-o;o+=a)this.process(e,o);continue}r.set(e.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===a&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){ot(this.h,this.r,this.buffer,this.pad)}digestInto(e){Er(this),Wa(e,this),this.finished=!0;const{buffer:r,h:a}=this;let{pos:c}=this;if(c){for(r[c++]=1;c<16;c++)r[c]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let i=0;i<8;i++)e[o++]=a[i]>>>0,e[o++]=a[i]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}}function y0(t){const e=(a,c)=>t(c).update(a).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=a=>t(a),e}const Xo=y0(t=>new p0(t));function g0(t,e,r,a,c,o=20){let i=t[0],n=t[1],u=t[2],h=t[3],m=e[0],B=e[1],v=e[2],d=e[3],p=e[4],C=e[5],S=e[6],f=e[7],g=c,E=r[0],T=r[1],I=r[2],x=i,l=n,s=u,w=h,N=m,O=B,_=v,D=d,V=p,P=C,M=S,q=f,z=g,G=E,Y=T,j=I;for(let ue=0;ue<o;ue+=2)x=x+N|0,z=fe(z^x,16),V=V+z|0,N=fe(N^V,12),x=x+N|0,z=fe(z^x,8),V=V+z|0,N=fe(N^V,7),l=l+O|0,G=fe(G^l,16),P=P+G|0,O=fe(O^P,12),l=l+O|0,G=fe(G^l,8),P=P+G|0,O=fe(O^P,7),s=s+_|0,Y=fe(Y^s,16),M=M+Y|0,_=fe(_^M,12),s=s+_|0,Y=fe(Y^s,8),M=M+Y|0,_=fe(_^M,7),w=w+D|0,j=fe(j^w,16),q=q+j|0,D=fe(D^q,12),w=w+D|0,j=fe(j^w,8),q=q+j|0,D=fe(D^q,7),x=x+O|0,j=fe(j^x,16),M=M+j|0,O=fe(O^M,12),x=x+O|0,j=fe(j^x,8),M=M+j|0,O=fe(O^M,7),l=l+_|0,z=fe(z^l,16),q=q+z|0,_=fe(_^q,12),l=l+_|0,z=fe(z^l,8),q=q+z|0,_=fe(_^q,7),s=s+D|0,G=fe(G^s,16),V=V+G|0,D=fe(D^V,12),s=s+D|0,G=fe(G^s,8),V=V+G|0,D=fe(D^V,7),w=w+N|0,Y=fe(Y^w,16),P=P+Y|0,N=fe(N^P,12),w=w+N|0,Y=fe(Y^w,8),P=P+Y|0,N=fe(N^P,7);let te=0;a[te++]=i+x|0,a[te++]=n+l|0,a[te++]=u+s|0,a[te++]=h+w|0,a[te++]=m+N|0,a[te++]=B+O|0,a[te++]=v+_|0,a[te++]=d+D|0,a[te++]=p+V|0,a[te++]=C+P|0,a[te++]=S+M|0,a[te++]=f+q|0,a[te++]=g+z|0,a[te++]=E+G|0,a[te++]=T+Y|0,a[te++]=I+j|0}function v0(t,e,r,a){let c=t[0],o=t[1],i=t[2],n=t[3],u=e[0],h=e[1],m=e[2],B=e[3],v=e[4],d=e[5],p=e[6],C=e[7],S=r[0],f=r[1],g=r[2],E=r[3];for(let I=0;I<20;I+=2)c=c+u|0,S=fe(S^c,16),v=v+S|0,u=fe(u^v,12),c=c+u|0,S=fe(S^c,8),v=v+S|0,u=fe(u^v,7),o=o+h|0,f=fe(f^o,16),d=d+f|0,h=fe(h^d,12),o=o+h|0,f=fe(f^o,8),d=d+f|0,h=fe(h^d,7),i=i+m|0,g=fe(g^i,16),p=p+g|0,m=fe(m^p,12),i=i+m|0,g=fe(g^i,8),p=p+g|0,m=fe(m^p,7),n=n+B|0,E=fe(E^n,16),C=C+E|0,B=fe(B^C,12),n=n+B|0,E=fe(E^n,8),C=C+E|0,B=fe(B^C,7),c=c+h|0,E=fe(E^c,16),p=p+E|0,h=fe(h^p,12),c=c+h|0,E=fe(E^c,8),p=p+E|0,h=fe(h^p,7),o=o+m|0,S=fe(S^o,16),C=C+S|0,m=fe(m^C,12),o=o+m|0,S=fe(S^o,8),C=C+S|0,m=fe(m^C,7),i=i+B|0,f=fe(f^i,16),v=v+f|0,B=fe(B^v,12),i=i+B|0,f=fe(f^i,8),v=v+f|0,B=fe(B^v,7),n=n+u|0,g=fe(g^n,16),d=d+g|0,u=fe(u^d,12),n=n+u|0,g=fe(g^n,8),d=d+g|0,u=fe(u^d,7);let T=0;a[T++]=c,a[T++]=o,a[T++]=i,a[T++]=n,a[T++]=S,a[T++]=f,a[T++]=g,a[T++]=E}const m0=d0(g0,{counterRight:!1,counterLength:8,extendNonceFn:v0,allowShortKeys:!1}),E0=new Uint8Array(16),gs=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(E0.subarray(r))},x0=new Uint8Array(32);function vs(t,e,r,a,c){c!==void 0&&Ie(c,void 0,"AAD");const o=t(e,r,x0),i=Vo(a.length,c?c.length:0,!0),n=Xo.create(o);c&&gs(n,c),gs(n,a),n.update(i);const u=n.digest();return ot(o,i),u}const S0=t=>(e,r,a)=>({encrypt(o,i){const n=o.length;i=Na(n+16,i,!1),i.set(o);const u=i.subarray(0,-16);t(e,r,u,u,1);const h=vs(t,e,r,u,a);return i.set(h,n),ot(h),i},decrypt(o,i){i=Na(o.length-16,i,!1);const n=o.subarray(0,-16),u=o.subarray(-16),h=vs(t,e,r,n,a);if(!Oo(u,h))throw new Error("invalid tag");return i.set(o.subarray(0,-16)),t(e,r,i,i,1),ot(h),i}}),jo=Ko({blockSize:64,nonceLength:24,tagLength:16},S0(m0)),Dr=256,Nr=24,dn=16;function C0(t,e,r){if(e.length!==Dr/8)throw new Error(`Invalid key length: expected ${Dr/8} bytes, got ${e.length}`);const a=pr(Nr);if(a.length!==Nr)throw new Error(`Invalid nonce length: expected ${Nr} bytes, got ${a.length}`);const o=jo(e,a).encrypt(t),i=o.subarray(0,o.length-dn),n=o.subarray(o.length-dn);return{ciphertext:i,authTag:n,nonce:a}}function b0(t,e,r,a){if(e.length!==Dr/8)throw new Error(`Invalid key length: expected ${Dr/8} bytes, got ${e.length}`);if(r.length!==Nr)throw new Error(`Invalid nonce length: expected ${Nr} bytes, got ${r.length}`);if(a.length!==dn)throw new Error(`Invalid auth tag length: expected ${dn} bytes, got ${a.length}`);const c=jo(e,r),o=new Uint8Array(t.length+a.length);o.set(t),o.set(a,t.length);try{return c.decrypt(o)}catch{throw new Error("Authentication failed: data may have been tampered with")}}function B0(){return pr(Dr/8)}const Pr=32,ms=16;function Zo(t,e){if(e.length!==Pr)throw new Error(`Invalid key length: expected ${Pr} bytes, got ${e.length}`);const r=Xo.create(e);return r.update(t),r.digest()}function w0(t,e,r){if(e.length!==Pr)throw new Error(`Invalid key length: expected ${Pr} bytes, got ${e.length}`);if(r.length!==ms)throw new Error(`Invalid tag length: expected ${ms} bytes, got ${r.length}`);const a=Zo(t,e);return T0(a,r)}function T0(t,e){if(t.length!==e.length)return!1;let r=0;for(let a=0;a<t.length;a++)r|=t[a]^e[a];return r===0}function A0(){return pr(Pr)}async function Ua(t){const e=await crypto.subtle.digest("SHA-256",t);return new Uint8Array(e)}async function Es(t){const e=await crypto.subtle.digest("SHA-512",t);return new Uint8Array(e)}async function xs(t){return Promise.resolve(zf(t))}const I0=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);function jt(t,e,r,a,c){return t=t+e+c|0,a=ft(a^t,16),r=r+a|0,e=ft(e^r,12),{a:t,b:e,c:r,d:a}}function Zt(t,e,r,a,c){return t=t+e+c|0,a=ft(a^t,8),r=r+a|0,e=ft(e^r,7),{a:t,b:e,c:r,d:a}}const ke=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ae=new Uint32Array(32);function Wt(t,e,r,a,c,o){const i=c[o],n=c[o+1];let u=ae[2*t],h=ae[2*t+1],m=ae[2*e],B=ae[2*e+1],v=ae[2*r],d=ae[2*r+1],p=ae[2*a],C=ae[2*a+1],S=Pa(u,m,i);h=Oa(S,h,B,n),u=S|0,{Dh:C,Dl:p}={Dh:C^h,Dl:p^u},{Dh:C,Dl:p}={Dh:Bf(C,p),Dl:wf(C)},{h:d,l:v}=St(d,v,C,p),{Bh:B,Bl:m}={Bh:B^d,Bl:m^v},{Bh:B,Bl:m}={Bh:er(B,m,24),Bl:tr(B,m,24)},ae[2*t]=u,ae[2*t+1]=h,ae[2*e]=m,ae[2*e+1]=B,ae[2*r]=v,ae[2*r+1]=d,ae[2*a]=p,ae[2*a+1]=C}function Jt(t,e,r,a,c,o){const i=c[o],n=c[o+1];let u=ae[2*t],h=ae[2*t+1],m=ae[2*e],B=ae[2*e+1],v=ae[2*r],d=ae[2*r+1],p=ae[2*a],C=ae[2*a+1],S=Pa(u,m,i);h=Oa(S,h,B,n),u=S|0,{Dh:C,Dl:p}={Dh:C^h,Dl:p^u},{Dh:C,Dl:p}={Dh:er(C,p,16),Dl:tr(C,p,16)},{h:d,l:v}=St(d,v,C,p),{Bh:B,Bl:m}={Bh:B^d,Bl:m^v},{Bh:B,Bl:m}={Bh:wr(B,m,63),Bl:Tr(B,m,63)},ae[2*t]=u,ae[2*t+1]=h,ae[2*e]=m,ae[2*e+1]=B,ae[2*r]=v,ae[2*r+1]=d,ae[2*a]=p,ae[2*a+1]=C}function _0(t,e={},r,a,c){if(dt(r),t<0||t>r)throw new Error("outputLen bigger than keyLen");const{key:o,salt:i,personalization:n}=e;if(o!==void 0&&(o.length<1||o.length>r))throw new Error('"key" expected to be undefined or of length=1..'+r);i!==void 0&&de(i,a,"salt"),n!==void 0&&de(n,c,"personalization")}class Wo{buffer;buffer32;finished=!1;destroyed=!1;length=0;pos=0;blockLen;outputLen;constructor(e,r){dt(e),dt(r),this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=cr(this.buffer)}update(e){Ht(this),de(e);const{blockLen:r,buffer:a,buffer32:c}=this,o=e.length,i=e.byteOffset,n=e.buffer;for(let u=0;u<o;){this.pos===r&&(it(c),this.compress(c,0,!1),it(c),this.pos=0);const h=Math.min(r-this.pos,o-u),m=i+u;if(h===r&&!(m%4)&&u+h<o){const B=new Uint32Array(n,m,Math.floor((o-u)/4));it(B);for(let v=0;u+r<o;v+=c.length,u+=r)this.length+=r,this.compress(B,v,!1);it(B);continue}a.set(e.subarray(u,u+h),this.pos),this.pos+=h,this.length+=h,u+=h}return this}digestInto(e){Ht(this),yn(e,this);const{pos:r,buffer32:a}=this;this.finished=!0,ut(this.buffer.subarray(r)),it(a),this.compress(a,0,!0),it(a);const c=cr(e);this.get().forEach((o,i)=>c[i]=Kt(o))}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}_cloneInto(e){const{buffer:r,length:a,finished:c,destroyed:o,outputLen:i,pos:n}=this;return e||=new this.constructor({dkLen:i}),e.set(...this.get()),e.buffer.set(r),e.destroyed=o,e.finished=c,e.length=a,e.pos=n,e.outputLen=i,e}clone(){return this._cloneInto()}}class R0 extends Wo{v0l=ke[0]|0;v0h=ke[1]|0;v1l=ke[2]|0;v1h=ke[3]|0;v2l=ke[4]|0;v2h=ke[5]|0;v3l=ke[6]|0;v3h=ke[7]|0;v4l=ke[8]|0;v4h=ke[9]|0;v5l=ke[10]|0;v5h=ke[11]|0;v6l=ke[12]|0;v6h=ke[13]|0;v7l=ke[14]|0;v7h=ke[15]|0;constructor(e={}){const r=e.dkLen===void 0?64:e.dkLen;super(128,r),_0(r,e,64,16,16);let{key:a,personalization:c,salt:o}=e,i=0;if(a!==void 0&&(de(a,void 0,"key"),i=a.length),this.v0l^=this.outputLen|i<<8|65536|1<<24,o!==void 0){de(o,void 0,"salt");const n=cr(o);this.v4l^=Kt(n[0]),this.v4h^=Kt(n[1]),this.v5l^=Kt(n[2]),this.v5h^=Kt(n[3])}if(c!==void 0){de(c,void 0,"personalization");const n=cr(c);this.v6l^=Kt(n[0]),this.v6h^=Kt(n[1]),this.v7l^=Kt(n[2]),this.v7h^=Kt(n[3])}if(a!==void 0){const n=new Uint8Array(this.blockLen);n.set(a),this.update(n)}}get(){let{v0l:e,v0h:r,v1l:a,v1h:c,v2l:o,v2h:i,v3l:n,v3h:u,v4l:h,v4h:m,v5l:B,v5h:v,v6l:d,v6h:p,v7l:C,v7h:S}=this;return[e,r,a,c,o,i,n,u,h,m,B,v,d,p,C,S]}set(e,r,a,c,o,i,n,u,h,m,B,v,d,p,C,S){this.v0l=e|0,this.v0h=r|0,this.v1l=a|0,this.v1h=c|0,this.v2l=o|0,this.v2h=i|0,this.v3l=n|0,this.v3h=u|0,this.v4l=h|0,this.v4h=m|0,this.v5l=B|0,this.v5h=v|0,this.v6l=d|0,this.v6h=p|0,this.v7l=C|0,this.v7h=S|0}compress(e,r,a){this.get().forEach((u,h)=>ae[h]=u),ae.set(ke,16);let{h:c,l:o}=fn(BigInt(this.length));ae[24]=ke[8]^o,ae[25]=ke[9]^c,a&&(ae[28]=~ae[28],ae[29]=~ae[29]);let i=0;const n=I0;for(let u=0;u<12;u++)Wt(0,4,8,12,e,r+2*n[i++]),Jt(0,4,8,12,e,r+2*n[i++]),Wt(1,5,9,13,e,r+2*n[i++]),Jt(1,5,9,13,e,r+2*n[i++]),Wt(2,6,10,14,e,r+2*n[i++]),Jt(2,6,10,14,e,r+2*n[i++]),Wt(3,7,11,15,e,r+2*n[i++]),Jt(3,7,11,15,e,r+2*n[i++]),Wt(0,5,10,15,e,r+2*n[i++]),Jt(0,5,10,15,e,r+2*n[i++]),Wt(1,6,11,12,e,r+2*n[i++]),Jt(1,6,11,12,e,r+2*n[i++]),Wt(2,7,8,13,e,r+2*n[i++]),Jt(2,7,8,13,e,r+2*n[i++]),Wt(3,4,9,14,e,r+2*n[i++]),Jt(3,4,9,14,e,r+2*n[i++]);this.v0l^=ae[0]^ae[16],this.v0h^=ae[1]^ae[17],this.v1l^=ae[2]^ae[18],this.v1h^=ae[3]^ae[19],this.v2l^=ae[4]^ae[20],this.v2h^=ae[5]^ae[21],this.v3l^=ae[6]^ae[22],this.v3h^=ae[7]^ae[23],this.v4l^=ae[8]^ae[24],this.v4h^=ae[9]^ae[25],this.v5l^=ae[10]^ae[26],this.v5h^=ae[11]^ae[27],this.v6l^=ae[12]^ae[28],this.v6h^=ae[13]^ae[29],this.v7l^=ae[14]^ae[30],this.v7h^=ae[15]^ae[31],ut(ae)}destroy(){this.destroyed=!0,ut(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const N0=nr(t=>new R0(t));function Ss(t,e,r,a,c,o,i,n,u,h,m,B,v,d,p,C,S,f,g,E){let T=0;for(let I=0;I<a;I++)({a:c,b:u,c:v,d:S}=jt(c,u,v,S,r[e+t[T++]])),{a:c,b:u,c:v,d:S}=Zt(c,u,v,S,r[e+t[T++]]),{a:o,b:h,c:d,d:f}=jt(o,h,d,f,r[e+t[T++]]),{a:o,b:h,c:d,d:f}=Zt(o,h,d,f,r[e+t[T++]]),{a:i,b:m,c:p,d:g}=jt(i,m,p,g,r[e+t[T++]]),{a:i,b:m,c:p,d:g}=Zt(i,m,p,g,r[e+t[T++]]),{a:n,b:B,c:C,d:E}=jt(n,B,C,E,r[e+t[T++]]),{a:n,b:B,c:C,d:E}=Zt(n,B,C,E,r[e+t[T++]]),{a:c,b:h,c:p,d:E}=jt(c,h,p,E,r[e+t[T++]]),{a:c,b:h,c:p,d:E}=Zt(c,h,p,E,r[e+t[T++]]),{a:o,b:m,c:C,d:S}=jt(o,m,C,S,r[e+t[T++]]),{a:o,b:m,c:C,d:S}=Zt(o,m,C,S,r[e+t[T++]]),{a:i,b:B,c:v,d:f}=jt(i,B,v,f,r[e+t[T++]]),{a:i,b:B,c:v,d:f}=Zt(i,B,v,f,r[e+t[T++]]),{a:n,b:u,c:d,d:g}=jt(n,u,d,g,r[e+t[T++]]),{a:n,b:u,c:d,d:g}=Zt(n,u,d,g,r[e+t[T++]]);return{v0:c,v1:o,v2:i,v3:n,v4:u,v5:h,v6:m,v7:B,v8:v,v9:d,v10:p,v11:C,v12:S,v13:f,v14:g,v15:E}}async function Cs(t){return Promise.resolve(N0(t))}const Tt={CHUNK_START:1,CHUNK_END:2,PARENT:4,ROOT:8,KEYED_HASH:16,DERIVE_KEY_CONTEXT:32,DERIVE_KEY_MATERIAL:64},Ot=Vt.slice(),bs=(()=>{const t=Array.from({length:16},(a,c)=>c),e=a=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(c=>a[c]),r=[];for(let a=0,c=t;a<7;a++,c=e(c))r.push(...c);return Uint8Array.from(r)})();class ti extends Wo{chunkPos=0;chunksDone=0;flags=0;IV;state;stack=[];posOut=0;bufferOut32=new Uint32Array(16);bufferOut;chunkOut=0;enableXOF=!0;constructor(e={},r=0){super(64,e.dkLen===void 0?32:e.dkLen);const{key:a,context:c}=e,o=c!==void 0;if(a!==void 0){if(o)throw new Error('Only "key" or "context" can be specified at same time');de(a,32,"key");const i=a.slice();this.IV=cr(i),it(this.IV),this.flags=r|Tt.KEYED_HASH}else if(o){de(c,void 0,"context");const i=c,n=new ti({dkLen:32},Tt.DERIVE_KEY_CONTEXT).update(i).digest();this.IV=cr(n),it(this.IV),this.flags=r|Tt.DERIVE_KEY_MATERIAL}else this.IV=Ot.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=Uf(this.bufferOut32)}get(){return[]}set(){}b2Compress(e,r,a,c=0){const{state:o,pos:i}=this,{h:n,l:u}=fn(BigInt(e),!0),{v0:h,v1:m,v2:B,v3:v,v4:d,v5:p,v6:C,v7:S,v8:f,v9:g,v10:E,v11:T,v12:I,v13:x,v14:l,v15:s}=Ss(bs,c,a,7,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],Ot[0],Ot[1],Ot[2],Ot[3],n,u,i,r);o[0]=h^f,o[1]=m^g,o[2]=B^E,o[3]=v^T,o[4]=d^I,o[5]=p^x,o[6]=C^l,o[7]=S^s}compress(e,r=0,a=!1){let c=this.flags;if(this.chunkPos||(c|=Tt.CHUNK_START),(this.chunkPos===15||a)&&(c|=Tt.CHUNK_END),a||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,c,e,r),this.chunkPos+=1,this.chunkPos===16||a){let o=this.state;this.state=this.IV.slice();for(let i,n=this.chunksDone+1;(a||!(n&1))&&(i=this.stack.pop());n>>=1)this.buffer32.set(i,0),this.buffer32.set(o,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|Tt.PARENT,this.buffer32,0),o=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(o)}this.pos=0}_cloneInto(e){e=super._cloneInto(e);const{IV:r,flags:a,state:c,chunkPos:o,posOut:i,chunkOut:n,stack:u,chunksDone:h}=this;return e.state.set(c.slice()),e.stack=u.map(m=>Uint32Array.from(m)),e.IV.set(r),e.flags=a,e.chunkPos=o,e.chunksDone=h,e.posOut=i,e.chunkOut=n,e.enableXOF=this.enableXOF,e.bufferOut32.set(this.bufferOut32),e}destroy(){this.destroyed=!0,ut(this.state,this.buffer32,this.IV,this.bufferOut32),ut(...this.stack)}b2CompressOut(){const{state:e,pos:r,flags:a,buffer32:c,bufferOut32:o}=this,{h:i,l:n}=fn(BigInt(this.chunkOut++));it(c);const{v0:u,v1:h,v2:m,v3:B,v4:v,v5:d,v6:p,v7:C,v8:S,v9:f,v10:g,v11:E,v12:T,v13:I,v14:x,v15:l}=Ss(bs,0,c,7,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],Ot[0],Ot[1],Ot[2],Ot[3],n,i,r,a);o[0]=u^S,o[1]=h^f,o[2]=m^g,o[3]=B^E,o[4]=v^T,o[5]=d^I,o[6]=p^x,o[7]=C^l,o[8]=e[0]^S,o[9]=e[1]^f,o[10]=e[2]^g,o[11]=e[3]^E,o[12]=e[4]^T,o[13]=e[5]^I,o[14]=e[6]^x,o[15]=e[7]^l,it(c),it(o),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,ut(this.buffer.subarray(this.pos));let e=this.flags|Tt.ROOT;this.stack.length?(e|=Tt.PARENT,it(this.buffer32),this.compress(this.buffer32,0,!0),it(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):e|=(this.chunkPos?0:Tt.CHUNK_START)|Tt.CHUNK_END,this.flags=e,this.b2CompressOut()}writeInto(e){Ht(this,!1),de(e),this.finish();const{blockLen:r,bufferOut:a}=this;for(let c=0,o=e.length;c<o;){this.posOut>=r&&this.b2CompressOut();const i=Math.min(r-this.posOut,o-c);e.set(a.subarray(this.posOut,this.posOut+i),c),this.posOut+=i,c+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(e)}xof(e){return dt(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(yn(e,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}}const L0=nr((t={})=>new ti(t));async function Bs(t){return Promise.resolve(L0(t))}var ba={exports:{}},Ba,ws;function k0(){if(ws)return Ba;ws=1;var t=(function(){function e(v,d){var p=v.l+d.l,C={h:v.h+d.h+(p/2>>>31)>>>0,l:p>>>0};v.h=C.h,v.l=C.l}function r(v,d){v.h^=d.h,v.h>>>=0,v.l^=d.l,v.l>>>=0}function a(v,d){var p={h:v.h<<d|v.l>>>32-d,l:v.l<<d|v.h>>>32-d};v.h=p.h,v.l=p.l}function c(v){var d=v.l;v.l=v.h,v.h=d}function o(v,d,p,C){e(v,d),e(p,C),a(d,13),a(C,16),r(d,v),r(C,p),c(v),e(p,d),e(v,C),a(d,17),a(C,21),r(d,p),r(C,v),c(p)}function i(v,d){return v[d+3]<<24|v[d+2]<<16|v[d+1]<<8|v[d]}function n(v,d){typeof d=="string"&&(d=m(d));var p={h:v[1]>>>0,l:v[0]>>>0},C={h:v[3]>>>0,l:v[2]>>>0},S={h:p.h,l:p.l},f=p,g={h:C.h,l:C.l},E=C,T=d.length,I=T-7,x=new Uint8Array(new ArrayBuffer(8));r(S,{h:1936682341,l:1886610805}),r(g,{h:1685025377,l:1852075885}),r(f,{h:1819895653,l:1852142177}),r(E,{h:1952801890,l:2037671283});for(var l=0;l<I;){var s={h:i(d,l+4),l:i(d,l)};r(E,s),o(S,g,f,E),o(S,g,f,E),r(S,s),l+=8}x[7]=T;for(var w=0;l<T;)x[w++]=d[l++];for(;w<7;)x[w++]=0;var N={h:x[7]<<24|x[6]<<16|x[5]<<8|x[4],l:x[3]<<24|x[2]<<16|x[1]<<8|x[0]};r(E,N),o(S,g,f,E),o(S,g,f,E),r(S,N),r(f,{h:0,l:255}),o(S,g,f,E),o(S,g,f,E),o(S,g,f,E),o(S,g,f,E);var O=S;return r(O,g),r(O,f),r(O,E),O}function u(v,d){var p=n(v,d);return("0000000"+p.h.toString(16)).substr(-8)+("0000000"+p.l.toString(16)).substr(-8)}function h(v,d){var p=n(v,d);return(p.h&2097151)*4294967296+p.l}function m(v){if(typeof TextEncoder=="function")return new TextEncoder().encode(v);v=unescape(encodeURIComponent(v));for(var d=new Uint8Array(v.length),p=0,C=v.length;p<C;p++)d[p]=v.charCodeAt(p);return d}function B(v){var d=m(v);if(d.length!==16)throw Error("Key length must be 16 bytes");var p=new Uint32Array(4);return p[0]=i(d,0),p[1]=i(d,4),p[2]=i(d,8),p[3]=i(d,12),p}return{hash:n,hash_hex:u,hash_uint:h,string16_to_key:B,string_to_u8:m}})();return Ba=t,Ba}var Ts;function U0(){return Ts||(Ts=1,(function(t,e){t.exports=k0()})(ba)),ba.exports}var D0=U0();const Da=128;async function As(t,e){if(e.length!==Da/8)throw new Error(`Invalid key length: expected ${Da/8} bytes, got ${e.length}`);const r=new Uint32Array(4),a=new DataView(e.buffer,e.byteOffset,e.byteLength);for(let n=0;n<4;n++)r[n]=a.getUint32(n*4,!0);const c=D0.hash(r,t),o=new Uint8Array(8),i=new DataView(o.buffer);return i.setUint32(0,c.l,!0),i.setUint32(4,c.h,!0),Promise.resolve(o)}function P0(){return pr(Da/8)}let nn=null,Rt=null,Is=!1;async function Tn(){if(!(Is&&nn))try{const t=(await Ce(async()=>{const{default:r}=await import("./kyber_wasm-DMbO7f7O.js");return{default:r}},[],import.meta.url)).default;let e;if(typeof process<"u"&&process.versions?.node){const{readFileSync:r}=await Ce(async()=>{const{readFileSync:h}=await Promise.resolve().then(()=>_t);return{readFileSync:h}},void 0,import.meta.url),{fileURLToPath:a}=await Ce(async()=>{const{fileURLToPath:h}=await Promise.resolve().then(()=>_t);return{fileURLToPath:h}},void 0,import.meta.url),{dirname:c,join:o}=await Ce(async()=>{const{dirname:h,join:m}=await Promise.resolve().then(()=>_t);return{dirname:h,join:m}},void 0,import.meta.url),i=c(a(import.meta.url)),n=o(i,"../../wasm-src/kyber-wasm/pkg/kyber_wasm_bg.wasm"),u=r(n);nn=await t(u)}else e=new URL(""+new URL("kyber_wasm_bg-9RDN9wMl.wasm",import.meta.url).href,import.meta.url).href,nn=await t({module:e});nn.init(),Rt=await Ce(()=>import("./kyber_wasm-DMbO7f7O.js"),[],import.meta.url),Is=!0}catch(t){throw new Error(`Failed to initialize Kyber WebAssembly module: ${t}`)}}async function O0(){if(await Tn(),!Rt||!Rt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=Rt.generate_keypair();if(!t)throw new Error("Failed to generate Kyber key pair: null result");return K0(t)}function K0(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function V0(t){if(await Tn(),!Rt||!Rt.encapsulate)throw new Error("encapsulate function not found in wasm exports");const e=Rt.encapsulate(t);if(!e)throw new Error("Failed to encapsulate");try{return{ciphertext:new Uint8Array(e.ciphertext),sharedSecret:new Uint8Array(e.shared_secret)}}finally{typeof e.free=="function"&&e.free()}}async function F0(t,e,r){if(await Tn(),!Rt||!Rt.decapsulate)throw new Error("decapsulate function not found in wasm exports");const a=Rt.decapsulate(t,e,r);if(!a)throw new Error("Failed to decapsulate");return new Uint8Array(a)}let an=null,Nt=null,_s=!1;async function An(){if(!(_s&&an))try{const t=(await Ce(async()=>{const{default:e}=await import("./dilithium_wasm-C55ki1z2.js");return{default:e}},[],import.meta.url)).default;if(typeof process<"u"&&process.versions?.node){const{readFileSync:e}=await Ce(async()=>{const{readFileSync:u}=await Promise.resolve().then(()=>_t);return{readFileSync:u}},void 0,import.meta.url),{fileURLToPath:r}=await Ce(async()=>{const{fileURLToPath:u}=await Promise.resolve().then(()=>_t);return{fileURLToPath:u}},void 0,import.meta.url),{dirname:a,join:c}=await Ce(async()=>{const{dirname:u,join:h}=await Promise.resolve().then(()=>_t);return{dirname:u,join:h}},void 0,import.meta.url),o=a(r(import.meta.url)),i=c(o,"../../wasm-src/dilithium-wasm/pkg/dilithium_wasm_bg.wasm"),n=e(i);an=await t(n)}else{const e=new URL(""+new URL("dilithium_wasm_bg-CuMJEY0E.wasm",import.meta.url).href,import.meta.url).href;an=await t({module:e})}an.init(),Nt=await Ce(()=>import("./dilithium_wasm-C55ki1z2.js"),[],import.meta.url),_s=!0}catch(t){throw new Error(`Failed to initialize Dilithium WebAssembly module: ${t}`)}}async function M0(){if(await An(),!Nt||!Nt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=Nt.generate_keypair();if(!t)throw new Error("Failed to generate Dilithium key pair: null result");return H0(t)}function H0(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function q0(t,e){if(await An(),!Nt||!Nt.sign)throw new Error("sign function not found in wasm exports");const r=Nt.sign(t,e);if(!r)throw new Error("Failed to sign");return new Uint8Array(r)}async function G0(t,e,r){if(await An(),!Nt||!Nt.verify)throw new Error("verify function not found in wasm exports");return Nt.verify(t,e,r)}let sn=null,Lt=null,Rs=!1;async function In(){if(!(Rs&&sn))try{const t=(await Ce(async()=>{const{default:e}=await import("./falcon_rust_wasm-WhH7d1pS.js");return{default:e}},[],import.meta.url)).default;if(typeof process<"u"&&process.versions?.node){const{readFileSync:e}=await Ce(async()=>{const{readFileSync:u}=await Promise.resolve().then(()=>_t);return{readFileSync:u}},void 0,import.meta.url),{fileURLToPath:r}=await Ce(async()=>{const{fileURLToPath:u}=await Promise.resolve().then(()=>_t);return{fileURLToPath:u}},void 0,import.meta.url),{dirname:a,join:c}=await Ce(async()=>{const{dirname:u,join:h}=await Promise.resolve().then(()=>_t);return{dirname:u,join:h}},void 0,import.meta.url),o=a(r(import.meta.url)),i=c(o,"../../wasm-src/falcon-rust-wasm/pkg/falcon_rust_wasm_bg.wasm"),n=e(i);sn=await t(n)}else{const e=new URL(""+new URL("falcon_rust_wasm_bg-B2h8gh_x.wasm",import.meta.url).href,import.meta.url).href;sn=await t({module:e})}sn.init(),Lt=await Ce(()=>import("./falcon_rust_wasm-WhH7d1pS.js"),[],import.meta.url),Rs=!0}catch(t){throw new Error(`Failed to initialize FALCON WebAssembly module: ${t}`)}}async function $0(){if(await In(),!Lt||!Lt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=Lt.generate_keypair();if(!t)throw new Error("Failed to generate FALCON key pair: null result");return z0(t)}function z0(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function Y0(t,e){if(await In(),!Lt||!Lt.sign_message)throw new Error("sign_message function not found in wasm exports");const r=Lt.sign_message(t,e);if(!r)throw new Error("Failed to sign");return new Uint8Array(r)}async function Q0(t,e,r){if(await In(),!Lt||!Lt.verify_signature)throw new Error("verify_signature function not found in wasm exports");return Lt.verify_signature(t,e,r)}const Sr=xr/8,Ns=32;async function X0(t,e){const r=await crypto.subtle.importKey("raw",t,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),a=await crypto.subtle.sign("HMAC",r,e);return new Uint8Array(a)}async function Jo(t,e){const r=new TextEncoder().encode(e);return X0(t,r)}async function ef(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),Ua(r)}function j0(){return zo()}async function Z0(t,e,r,a){if(t.length!==Sr)throw new Error(`Invalid master key length: expected ${Sr} bytes, got ${t.length}`);const c=await ef(t,e),o=Go(r,c),i=await Promise.all(a.map(n=>Jo(t,n)));return{ciphertext:o.ciphertext,authTag:o.authTag,iv:o.iv,keywordTags:i}}async function W0(t,e,r){if(t.length!==Sr)throw new Error(`Invalid master key length: expected ${Sr} bytes, got ${t.length}`);const a=await ef(t,e);return $o(r.ciphertext,a,r.iv,r.authTag)}async function J0(t,e){if(t.length!==Sr)throw new Error(`Invalid master key length: expected ${Sr} bytes, got ${t.length}`);return Jo(t,e)}function el(t,e){if(t.length!==Ns)throw new Error(`Invalid search tag length: expected ${Ns} bytes, got ${t.length}`);return{documents:e.filter(a=>a.keywordTags.some(c=>{if(c.length!==t.length)return!1;for(let o=0;o<c.length;o++)if(c[o]!==t[o])return!1;return!0})),searchTag:t}}function tl(t=16){return pr(t)}function rl(){return{selectedCrypto:"",aesState:{key:null,plaintext:"",plaintextBytes:null,ciphertext:null,iv:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},chacha20State:{key:null,plaintext:"",plaintextBytes:null,ciphertext:null,nonce:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},poly1305State:{key:null,message:"",messageBytes:null,tag:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,mac:!0,verification:!0}},rsaState:{keyPair:null,keySize:_r,mode:"encryption",plaintext:"",plaintextBytes:null,ciphertext:"",decrypted:"",decryptedBytes:null,signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0,signing:!0,verification:!0}},eccState:{keyPair:null,curve:"secp256k1",mode:"signature",signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,ecdhPrivateKey:"",ecdhPublicKey:"",sharedSecret:"",error:"",showDetails:{keyGeneration:!0,signing:!0,verification:!0,ecdh:!0}},ibeState:{initialized:!1,masterKey:null,publicParams:null,identity:"",privateKey:null,plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},abeState:{initialized:!1,masterKey:null,publicParams:null,attributes:[],attributeInput:"",privateKey:null,policy:"",plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,decryptionSucceeded:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},hashState:{selectedAlgorithm:"sha256",inputText:"",inputBytes:null,hash:null,processingTime:0,error:"",siphashKey:null,showDetails:{input:!0,processing:!0,output:!0},comparisonMode:!1,comparisonResults:{}},kyberState:{initialized:!1,publicKey:null,privateKey:null,ciphertext:null,sharedSecret:null,decapsulatedSecret:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,encapsulation:!0,decapsulation:!0}},dilithiumState:{initialized:!1,publicKey:null,privateKey:null,message:"",messageBytes:null,signature:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,signing:!0,verification:!0}},falconState:{initialized:!1,publicKey:null,privateKey:null,message:"",messageBytes:null,signature:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,signing:!0,verification:!0}},sseState:{masterKey:null,documents:[],documentId:null,plaintext:"",plaintextBytes:null,keywords:[],keywordInput:"",encryptedDocument:null,searchKeyword:"",searchTag:null,searchResults:[],selectedDocumentId:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,search:!0,decryption:!0}},resetState(){this.aesState={key:null,plaintext:"",plaintextBytes:null,ciphertext:null,iv:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},this.chacha20State={key:null,plaintext:"",plaintextBytes:null,ciphertext:null,nonce:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},this.poly1305State={key:null,message:"",messageBytes:null,tag:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,mac:!0,verification:!0}},this.rsaState={keyPair:null,keySize:_r,mode:"encryption",plaintext:"",plaintextBytes:null,ciphertext:"",decrypted:"",decryptedBytes:null,signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0,signing:!0,verification:!0}},this.eccState={keyPair:null,curve:"secp256k1",mode:"signature",signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,ecdhPrivateKey:"",ecdhPublicKey:"",sharedSecret:"",error:"",showDetails:{keyGeneration:!0,signing:!0,verification:!0,ecdh:!0}},this.ibeState={initialized:!1,masterKey:null,publicParams:null,identity:"",privateKey:null,plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},this.abeState={initialized:!1,masterKey:null,publicParams:null,attributes:[],attributeInput:"",privateKey:null,policy:"",plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,decryptionSucceeded:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}};let t="sha256",e=!1;this.selectedCrypto==="hash-sha256"?t="sha256":this.selectedCrypto==="hash-sha512"?t="sha512":this.selectedCrypto==="hash-sha3-256"?t="sha3-256":this.selectedCrypto==="hash-blake2b"?t="blake2b":this.selectedCrypto==="hash-blake3"?t="blake3":this.selectedCrypto==="hash-compare"?e=!0:this.selectedCrypto==="siphash"&&(t="siphash"),this.hashState={selectedAlgorithm:t,inputText:"",inputBytes:null,hash:null,processingTime:0,error:"",siphashKey:null,showDetails:{input:!0,processing:!0,output:!0},comparisonMode:e,comparisonResults:{}},this.kyberState={initialized:!1,publicKey:null,privateKey:null,ciphertext:null,sharedSecret:null,decapsulatedSecret:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,encapsulation:!0,decapsulation:!0}},this.sseState={masterKey:null,documents:[],documentId:null,plaintext:"",plaintextBytes:null,keywords:[],keywordInput:"",encryptedDocument:null,searchKeyword:"",searchTag:null,searchResults:[],selectedDocumentId:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,search:!0,decryption:!0}}},formatBytes(t){return t?At(t):""},formatBytesReadable(t){if(!t)return"";const e=At(t);return e.match(/.{1,2}/g)?.join(" ")||e},formatBytesAsASCII(t){return t?Array.from(t).map(e=>e>=32&&e<=126?String.fromCharCode(e):".").join(""):""},getBytesInfo(t){return t?{hex:At(t),hexFormatted:this.formatBytesReadable(t),decimal:Array.from(t).join(", "),ascii:this.formatBytesAsASCII(t),length:t.length}:{hex:"",hexFormatted:"",decimal:"",ascii:"",length:0}},stringToBytes(t){return new TextEncoder().encode(t)},bytesToString(t){return new TextDecoder().decode(t)},hexToBytes(t){const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=Number.parseInt(t.substr(r,2),16);return e},generateAESKey(){try{this.aesState.key=zo(),this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptAES(){if(!(!this.aesState.key||!this.aesState.plaintext))try{const t=this.stringToBytes(this.aesState.plaintext);this.aesState.plaintextBytes=t;const e=Go(t,this.aesState.key);this.aesState.ciphertext=e.ciphertext,this.aesState.iv=e.iv,this.aesState.authTag=e.authTag,this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptAES(){if(!(!this.aesState.ciphertext||!this.aesState.key||!this.aesState.iv||!this.aesState.authTag))try{const t=$o(this.aesState.ciphertext,this.aesState.key,this.aesState.iv,this.aesState.authTag);this.aesState.decryptedBytes=t,this.aesState.decrypted=this.bytesToString(t),this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`,this.aesState.decrypted="",this.aesState.decryptedBytes=null}},generateChaCha20Key(){try{this.chacha20State.key=B0(),this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptChaCha20(){if(!(!this.chacha20State.key||!this.chacha20State.plaintext))try{const t=this.stringToBytes(this.chacha20State.plaintext);this.chacha20State.plaintextBytes=t;const e=C0(t,this.chacha20State.key);this.chacha20State.ciphertext=e.ciphertext,this.chacha20State.nonce=e.nonce,this.chacha20State.authTag=e.authTag,this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptChaCha20(){if(!(!this.chacha20State.ciphertext||!this.chacha20State.key||!this.chacha20State.nonce||!this.chacha20State.authTag))try{const t=b0(this.chacha20State.ciphertext,this.chacha20State.key,this.chacha20State.nonce,this.chacha20State.authTag);this.chacha20State.decryptedBytes=t,this.chacha20State.decrypted=this.bytesToString(t),this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`,this.chacha20State.decrypted="",this.chacha20State.decryptedBytes=null}},generatePoly1305Key(){try{this.poly1305State.key=A0(),this.poly1305State.error=""}catch(t){this.poly1305State.error=`: ${t instanceof Error?t.message:String(t)}`}},computePoly1305MAC(){if(!(!this.poly1305State.key||!this.poly1305State.message))try{const t=this.stringToBytes(this.poly1305State.message);this.poly1305State.messageBytes=t,this.poly1305State.tag=Zo(t,this.poly1305State.key),this.poly1305State.error=""}catch(t){this.poly1305State.error=`MAC: ${t instanceof Error?t.message:String(t)}`}},verifyPoly1305MAC(){if(!(!this.poly1305State.key||!this.poly1305State.tag||!this.poly1305State.verificationMessage))try{const t=this.stringToBytes(this.poly1305State.verificationMessage);this.poly1305State.verificationMessageBytes=t,this.poly1305State.verified=w0(t,this.poly1305State.key,this.poly1305State.tag),this.poly1305State.error=""}catch(t){this.poly1305State.error=`MAC: ${t instanceof Error?t.message:String(t)}`,this.poly1305State.verified=!1}},generateRsaKeyPair(){try{const t=Number(this.rsaState.keySize);this.rsaState.keyPair=Ku(t),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.plaintext))try{const t=this.stringToBytes(this.rsaState.plaintext);this.rsaState.plaintextBytes=t;const e=Vu(t,this.rsaState.keyPair.publicKey);this.rsaState.ciphertext=e.ciphertext,this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.ciphertext))try{const t=Fu(this.rsaState.ciphertext,this.rsaState.keyPair.privateKey);this.rsaState.decryptedBytes=t,this.rsaState.decrypted=this.bytesToString(t),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`,this.rsaState.decrypted="",this.rsaState.decryptedBytes=null}},signRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.signatureMessage))try{const t=this.stringToBytes(this.rsaState.signatureMessage);this.rsaState.signatureMessageBytes=t;const e=Mu(t,this.rsaState.keyPair.privateKey);this.rsaState.signature=e.signature,this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},verifyRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.signature||!this.rsaState.verificationMessage))try{const t=this.stringToBytes(this.rsaState.verificationMessage);this.rsaState.verificationMessageBytes=t,this.rsaState.verified=Hu(t,this.rsaState.signature,this.rsaState.keyPair.publicKey),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`,this.rsaState.verified=!1}},generateEccKeyPair(){try{this.eccState.keyPair=du(this.eccState.curve),this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`}},signECC(){if(!(!this.eccState.keyPair||!this.eccState.signatureMessage))try{const t=this.stringToBytes(this.eccState.signatureMessage);this.eccState.signatureMessageBytes=t;const e=this.eccState.keyPair.curve,r=e==="ed25519"||e==="ed448"?yu(t,this.eccState.keyPair.privateKey,e):xo(t,this.eccState.keyPair.privateKey,e);this.eccState.signature=r.signature,this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`}},verifyECC(){if(!(!this.eccState.keyPair||!this.eccState.signature||!this.eccState.verificationMessage))try{const t=this.stringToBytes(this.eccState.verificationMessage);this.eccState.verificationMessageBytes=t;const e=this.eccState.keyPair.curve;this.eccState.verified=e==="ed25519"||e==="ed448"?gu(t,this.eccState.signature,this.eccState.keyPair.publicKey,e):So(t,this.eccState.signature,this.eccState.keyPair.publicKey,e),this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`,this.eccState.verified=!1}},async initializeIBE(){try{this.ibeState.error="",await Mr(),this.ibeState.initialized=!0}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.initialized=!1}},async generateIBEKeyPair(){this.ibeState.initialized||await this.initializeIBE();try{const t=await vu();this.ibeState.masterKey=t.masterKey,this.ibeState.publicParams=t.publicParams,this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`}},async extractIBEKey(){if(!this.ibeState.masterKey||!this.ibeState.identity){this.ibeState.error="";return}try{this.ibeState.privateKey=await mu(this.ibeState.masterKey,this.ibeState.identity),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.privateKey=null}},async encryptIBE(){if(!(!this.ibeState.publicParams||!this.ibeState.identity||!this.ibeState.plaintext))try{const t=this.stringToBytes(this.ibeState.plaintext);this.ibeState.plaintextBytes=t,this.ibeState.ciphertext=await Eu(this.ibeState.publicParams,this.ibeState.identity,t),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.ciphertext=null}},async decryptIBE(){if(!(!this.ibeState.privateKey||!this.ibeState.ciphertext))try{const t=await xu(this.ibeState.privateKey,this.ibeState.ciphertext);this.ibeState.decryptedBytes=t,this.ibeState.decrypted=this.bytesToString(t),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.decrypted="",this.ibeState.decryptedBytes=null}},async initializeABE(){if(!this.abeState.initialized)try{this.abeState.error="",await Or(),this.abeState.initialized=!0}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.initialized=!1}},async generateABEKeyPair(){this.abeState.initialized||await this.initializeABE();try{const t=await xf();this.abeState.masterKey=t.masterKey,this.abeState.publicParams=t.publicParams,this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`}},async extractABEKey(){if(!this.abeState.masterKey||!this.abeState.attributes.length){this.abeState.error="";return}try{this.abeState.privateKey=await Sf(this.abeState.masterKey,this.abeState.attributes),this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.privateKey=null}},addAttribute(){const t=this.abeState.attributeInput.trim();if(!t)return;const e=t.split(",").map(r=>r.trim()).filter(r=>r.length>0);for(const r of e)this.abeState.attributes.includes(r)||this.abeState.attributes.push(r);this.abeState.attributeInput=""},removeAttribute(t){this.abeState.attributes.splice(t,1)},async encryptABE(){if(!(!this.abeState.publicParams||!this.abeState.policy||!this.abeState.plaintext))try{const t=this.stringToBytes(this.abeState.plaintext);this.abeState.plaintextBytes=t,this.abeState.ciphertext=await Cf(this.abeState.publicParams,this.abeState.policy,t),this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.ciphertext=null}},async decryptABE(){if(!(!this.abeState.privateKey||!this.abeState.ciphertext))try{const t=await bf(this.abeState.privateKey,this.abeState.ciphertext);this.abeState.decryptedBytes=t,this.abeState.decrypted=this.bytesToString(t),this.abeState.decryptionSucceeded=!0,this.abeState.error=""}catch(t){const e=t instanceof Error?t.message:String(t);e.includes("Attribute mismatch")||e.includes("")?(this.abeState.decryptionSucceeded=!1,this.abeState.error=""):(this.abeState.error=`: ${e}`,this.abeState.decryptionSucceeded=null),this.abeState.decrypted="",this.abeState.decryptedBytes=null}},computeECDH(){if(!(!this.eccState.ecdhPrivateKey||!this.eccState.ecdhPublicKey))try{const t=this.eccState.curve;if(t==="ed25519"||t==="ed448"){this.eccState.error=`ECDH${t}`;return}const e=pu(this.eccState.ecdhPrivateKey,this.eccState.ecdhPublicKey,t);this.eccState.sharedSecret=e.sharedSecret,this.eccState.error=""}catch(t){this.eccState.error=`ECDH: ${t instanceof Error?t.message:String(t)}`}},generateSipHashKey(){try{this.hashState.siphashKey=P0(),this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async computeHash(){if(!this.hashState.inputText){this.hashState.error="";return}try{const t=performance.now(),e=new TextEncoder().encode(this.hashState.inputText);this.hashState.inputBytes=e;let r;switch(this.hashState.selectedAlgorithm){case"sha256":r=await Ua(e);break;case"sha512":r=await Es(e);break;case"sha3-256":r=await xs(e);break;case"blake2b":r=await Cs(e);break;case"blake3":r=await Bs(e);break;case"siphash":if(!this.hashState.siphashKey){this.hashState.error="SipHash";return}r=await As(e,this.hashState.siphashKey);break;default:this.hashState.error="";return}this.hashState.hash=r,this.hashState.processingTime=performance.now()-t,this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async compareAllHashes(){if(!this.hashState.inputText){this.hashState.error="";return}try{const t=new TextEncoder().encode(this.hashState.inputText);this.hashState.inputBytes=t,this.hashState.comparisonResults={};const e=[{name:"SHA-256",fn:Ua},{name:"SHA-512",fn:Es},{name:"SHA-3-256",fn:xs},{name:"BLAKE2b",fn:Cs},{name:"BLAKE3",fn:Bs}];for(const r of e){const a=performance.now(),c=await r.fn(t),o=performance.now()-a;this.hashState.comparisonResults[r.name]={hash:At(c),time:o}}if(this.hashState.siphashKey){const r=performance.now(),a=await As(t,this.hashState.siphashKey),c=performance.now()-r;this.hashState.comparisonResults["SipHash-2-4"]={hash:At(a),time:c}}this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initKyber(){try{this.kyberState.error="",await Tn(),this.kyberState.initialized=!0}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`,this.kyberState.initialized=!1}},async generateKyberKeyPair(){this.kyberState.initialized||await this.initKyber();try{this.kyberState.error="";const t=await O0();this.kyberState.publicKey=t.publicKey,this.kyberState.privateKey=t.privateKey}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async encapsulateKyber(){if(!this.kyberState.publicKey){this.kyberState.error="";return}try{this.kyberState.error="";const t=await V0(this.kyberState.publicKey);this.kyberState.ciphertext=t.ciphertext,this.kyberState.sharedSecret=t.sharedSecret}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async decapsulateKyber(){if(!this.kyberState.ciphertext||!this.kyberState.privateKey||!this.kyberState.publicKey){this.kyberState.error="";return}try{this.kyberState.error="";const t=await F0(this.kyberState.ciphertext,this.kyberState.privateKey,this.kyberState.publicKey);this.kyberState.decapsulatedSecret=t}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initDilithium(){try{this.dilithiumState.error="",await An(),this.dilithiumState.initialized=!0}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`,this.dilithiumState.initialized=!1}},async generateDilithiumKeyPair(){this.dilithiumState.initialized||await this.initDilithium();try{this.dilithiumState.error="";const t=await M0();this.dilithiumState.publicKey=t.publicKey,this.dilithiumState.privateKey=t.privateKey}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async signDilithium(){if(!this.dilithiumState.privateKey){this.dilithiumState.error="";return}if(!this.dilithiumState.message){this.dilithiumState.error="";return}try{this.dilithiumState.error="";const t=new TextEncoder().encode(this.dilithiumState.message);this.dilithiumState.messageBytes=t;const e=await q0(t,this.dilithiumState.privateKey);this.dilithiumState.signature=e}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async verifyDilithium(){if(!this.dilithiumState.signature||!this.dilithiumState.publicKey){this.dilithiumState.error="";return}if(!this.dilithiumState.verificationMessage){this.dilithiumState.error="";return}try{this.dilithiumState.error="";const t=new TextEncoder().encode(this.dilithiumState.verificationMessage);this.dilithiumState.verificationMessageBytes=t;const e=await G0(t,this.dilithiumState.signature,this.dilithiumState.publicKey);this.dilithiumState.verified=e}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initFalcon(){try{this.falconState.error="",await In(),this.falconState.initialized=!0}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`,this.falconState.initialized=!1}},async generateFalconKeyPair(){this.falconState.initialized||await this.initFalcon();try{this.falconState.error="";const t=await $0();this.falconState.publicKey=t.publicKey,this.falconState.privateKey=t.privateKey}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}},async signFalcon(){if(!this.falconState.privateKey){this.falconState.error="";return}if(!this.falconState.message){this.falconState.error="";return}try{this.falconState.error="";const t=new TextEncoder().encode(this.falconState.message);this.falconState.messageBytes=t;const e=await Y0(t,this.falconState.privateKey);this.falconState.signature=e}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}},async verifyFalcon(){if(!this.falconState.signature||!this.falconState.publicKey){this.falconState.error="";return}if(!this.falconState.verificationMessage){this.falconState.error="";return}try{this.falconState.error="";const t=new TextEncoder().encode(this.falconState.verificationMessage);this.falconState.verificationMessageBytes=t;const e=await Q0(t,this.falconState.signature,this.falconState.publicKey);this.falconState.verified=e}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}},generateSSEKey(){try{this.sseState.masterKey=j0(),this.sseState.error=""}catch(t){this.sseState.error=`: ${t instanceof Error?t.message:String(t)}`}},addKeyword(){if(!this.sseState.keywordInput.trim())return;const t=this.sseState.keywordInput.trim();this.sseState.keywords.includes(t)||this.sseState.keywords.push(t),this.sseState.keywordInput=""},removeKeyword(t){this.sseState.keywords.splice(t,1)},async encryptSSE(){if(!this.sseState.masterKey){this.sseState.error="";return}if(!this.sseState.plaintext){this.sseState.error="";return}if(this.sseState.keywords.length===0){this.sseState.error="1";return}try{this.sseState.error="";const t=this.stringToBytes(this.sseState.plaintext);this.sseState.plaintextBytes=t;const e=tl();this.sseState.documentId=e;const r=await Z0(this.sseState.masterKey,e,t,this.sseState.keywords);this.sseState.encryptedDocument=r,this.sseState.documents.push({id:e,document:r}),this.sseState.plaintext="",this.sseState.plaintextBytes=null,this.sseState.keywords=[],this.sseState.keywordInput=""}catch(t){this.sseState.error=`: ${t instanceof Error?t.message:String(t)}`}},async searchSSE(){if(!this.sseState.masterKey){this.sseState.error="";return}if(!this.sseState.searchKeyword.trim()){this.sseState.error="";return}if(this.sseState.documents.length===0){this.sseState.error="";return}try{this.sseState.error="";const t=await J0(this.sseState.masterKey,this.sseState.searchKeyword.trim());this.sseState.searchTag=t;const e=this.sseState.documents.map(a=>a.document),r=el(t,e);this.sseState.searchResults=this.sseState.documents.filter(a=>r.documents.includes(a.document)),this.sseState.searchResults.length===1?this.sseState.selectedDocumentId=this.sseState.searchResults[0].id:this.sseState.selectedDocumentId=null}catch(t){this.sseState.error=`: ${t instanceof Error?t.message:String(t)}`}},async decryptSSE(){if(!this.sseState.masterKey){this.sseState.error="";return}if(!this.sseState.selectedDocumentId){this.sseState.error="";return}const t=this.sseState.documents.find(e=>{if(e.id.length!==this.sseState.selectedDocumentId.length)return!1;for(let r=0;r<e.id.length;r++)if(e.id[r]!==this.sseState.selectedDocumentId[r])return!1;return!0});if(!t){this.sseState.error="";return}try{this.sseState.error="";const e=await W0(this.sseState.masterKey,t.id,t.document);this.sseState.decryptedBytes=e,this.sseState.decrypted=this.bytesToString(e)}catch(e){this.sseState.error=`: ${e instanceof Error?e.message:String(e)}`}},selectDocument(t){this.sseState.selectedDocumentId=t,this.sseState.error=""}}}typeof window<"u"&&(window.cryptoApp=rl);
