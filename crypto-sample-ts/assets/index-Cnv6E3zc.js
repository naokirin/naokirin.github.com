(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?o.credentials="include":c.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(c){if(c.ep)return;c.ep=!0;const o=r(c);fetch(c.href,o)}})();const lf="modulepreload",hf=function(t){return"/"+t},ei={},Ce=function(e,r,a){let c=Promise.resolve();if(r&&r.length>0){let u=function(l){return Promise.all(l.map(m=>Promise.resolve(m).then(B=>({status:"fulfilled",value:B}),B=>({status:"rejected",reason:B}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),n=i?.nonce||i?.getAttribute("nonce");c=u(r.map(l=>{if(l=hf(l),l in ei)return;ei[l]=!0;const m=l.endsWith(".css"),B=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${B}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":lf,m||(v.as="script"),v.crossOrigin="",v.href=l,n&&v.setAttribute("nonce",n),document.head.appendChild(v),m)return new Promise((d,y)=>{v.addEventListener("load",d),v.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(i){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=i,window.dispatchEvent(n),!n.defaultPrevented)throw i}return c.then(i=>{for(const n of i||[])n.status==="rejected"&&o(n.reason);return e().catch(o)})};let or=null,ti=!1;async function Pr(){if(!(ti&&or))try{const t=(await Ce(async()=>{const{default:e}=await import("./abe_wasm-DvaMSN-T.js");return{default:e}},[])).default;or=await t({module_or_path:new URL("/assets/abe_wasm_bg-BOfsLHu7.wasm",import.meta.url).href}),or.init(),ti=!0}catch(t){throw new Error(`Failed to initialize ABE WebAssembly module: ${t}`)}}async function df(){if(await Pr(),!or)throw new Error("ABE module not initialized");const{ABE:t}=await Ce(async()=>{const{ABE:o}=await import("./abe_wasm-DvaMSN-T.js");return{ABE:o}},[]),r=new t().setup();if(!r||typeof r!="object")throw new Error("Failed to generate ABE key pair");const a=r.master_key,c=r.public_params;return{masterKey:a,publicParams:c}}async function pf(t,e){if(await Pr(),!or)throw new Error("ABE module not initialized");const{ABE:r}=await Ce(async()=>{const{ABE:o}=await import("./abe_wasm-DvaMSN-T.js");return{ABE:o}},[]),c=new r().key_gen(t,e);if(!c)throw new Error("Failed to extract ABE private key");return c}async function yf(t,e,r){if(await Pr(),!or)throw new Error("ABE module not initialized");const{ABE:a}=await Ce(async()=>{const{ABE:o}=await import("./abe_wasm-DvaMSN-T.js");return{ABE:o}},[]),c=new a;try{return c.encrypt(t,e,r)}catch(o){throw new Error(`ABE encrypt failed: ${o}`)}}async function gf(t,e){if(await Pr(),!or)throw new Error("ABE module not initialized");const{ABE:r}=await Ce(async()=>{const{ABE:c}=await import("./abe_wasm-DvaMSN-T.js");return{ABE:c}},[]),a=new r;try{return a.decrypt(t,e)}catch(c){throw new Error(`ABE decrypt failed: ${c}`)}}const $r=BigInt(2**32-1),ri=BigInt(32);function on(t,e=!1){return e?{h:Number(t&$r),l:Number(t>>ri&$r)}:{h:Number(t>>ri&$r)|0,l:Number(t&$r)|0}}function Rs(t,e=!1){const r=t.length;let a=new Uint32Array(r),c=new Uint32Array(r);for(let o=0;o<r;o++){const{h:i,l:n}=on(t[o],e);[a[o],c[o]]=[i,n]}return[a,c]}const ni=(t,e,r)=>t>>>r,ai=(t,e,r)=>t<<32-r|e>>>r,er=(t,e,r)=>t>>>r|e<<32-r,tr=(t,e,r)=>t<<32-r|e>>>r,br=(t,e,r)=>t<<64-r|e>>>r-32,Br=(t,e,r)=>t>>>r-32|e<<64-r,vf=(t,e)=>e,mf=(t,e)=>t,Ef=(t,e,r)=>t<<r|e>>>32-r,xf=(t,e,r)=>e<<r|t>>>32-r,Sf=(t,e,r)=>e<<r-32|t>>>64-r,Cf=(t,e,r)=>t<<r-32|e>>>64-r;function St(t,e,r,a){const c=(e>>>0)+(a>>>0);return{h:t+r+(c/2**32|0)|0,l:c|0}}const Ua=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Da=(t,e,r,a)=>e+r+a+(t/2**32|0)|0,bf=(t,e,r,a)=>(t>>>0)+(e>>>0)+(r>>>0)+(a>>>0),Bf=(t,e,r,a,c)=>e+r+a+c+(t/2**32|0)|0,Tf=(t,e,r,a,c)=>(t>>>0)+(e>>>0)+(r>>>0)+(a>>>0)+(c>>>0),wf=(t,e,r,a,c,o)=>e+r+a+c+o+(t/2**32|0)|0;function dn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function dt(t,e=""){if(!Number.isSafeInteger(t)||t<0){const r=e&&`"${e}" `;throw new Error(`${r}expected integer >= 0, got ${t}`)}}function de(t,e,r=""){const a=dn(t),c=t?.length,o=e!==void 0;if(!a||o&&c!==e){const i=r&&`"${r}" `,n=o?` of length ${e}`:"",u=a?`length=${c}`:`type=${typeof t}`;throw new Error(i+"expected Uint8Array"+n+", got "+u)}return t}function Ns(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash must wrapped by utils.createHasher");dt(t.outputLen),dt(t.blockLen)}function Ht(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function pn(t,e){de(t,void 0,"digestInto() output");const r=e.outputLen;if(t.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function Af(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function cr(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ut(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function _n(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ft(t,e){return t<<32-e|t>>>e}const Ls=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ks(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Kt=Ls?t=>t:t=>ks(t);function If(t){for(let e=0;e<t.length;e++)t[e]=ks(t[e]);return t}const it=Ls?t=>t:If,Us=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",_f=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Or(t){if(de(t),Us)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=_f[t[r]];return e}const Pt={_0:48,_9:57,A:65,F:70,a:97,f:102};function ii(t){if(t>=Pt._0&&t<=Pt._9)return t-Pt._0;if(t>=Pt.A&&t<=Pt.F)return t-(Pt.A-10);if(t>=Pt.a&&t<=Pt.f)return t-(Pt.a-10)}function Rr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(Us)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const a=new Uint8Array(r);for(let c=0,o=0;c<r;c++,o+=2){const i=ii(t.charCodeAt(o)),n=ii(t.charCodeAt(o+1));if(i===void 0||n===void 0){const u=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+o)}a[c]=i*16+n}return a}function Ct(...t){let e=0;for(let a=0;a<t.length;a++){const c=t[a];de(c),e+=c.length}const r=new Uint8Array(e);for(let a=0,c=0;a<t.length;a++){const o=t[a];r.set(o,c),c+=o.length}return r}function nr(t,e={}){const r=(c,o)=>t(o).update(c).digest(),a=t(void 0);return r.outputLen=a.outputLen,r.blockLen=a.blockLen,r.create=c=>t(c),Object.assign(r,e),Object.freeze(r)}function Pa(t=32){const e=typeof globalThis=="object"?globalThis.crypto:null;if(typeof e?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return e.getRandomValues(new Uint8Array(t))}const Kr=t=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,t])}),Rf=BigInt(0),Cr=BigInt(1),Nf=BigInt(2),Lf=BigInt(7),kf=BigInt(256),Uf=BigInt(113),Ds=[],Ps=[],Os=[];for(let t=0,e=Cr,r=1,a=0;t<24;t++){[r,a]=[a,(2*r+3*a)%5],Ds.push(2*(5*a+r)),Ps.push((t+1)*(t+2)/2%64);let c=Rf;for(let o=0;o<7;o++)e=(e<<Cr^(e>>Lf)*Uf)%kf,e&Nf&&(c^=Cr<<(Cr<<BigInt(o))-Cr);Os.push(c)}const Ks=Rs(Os,!0),Df=Ks[0],Pf=Ks[1],si=(t,e,r)=>r>32?Sf(t,e,r):Ef(t,e,r),oi=(t,e,r)=>r>32?Cf(t,e,r):xf(t,e,r);function Of(t,e=24){const r=new Uint32Array(10);for(let a=24-e;a<24;a++){for(let i=0;i<10;i++)r[i]=t[i]^t[i+10]^t[i+20]^t[i+30]^t[i+40];for(let i=0;i<10;i+=2){const n=(i+8)%10,u=(i+2)%10,l=r[u],m=r[u+1],B=si(l,m,1)^r[n],v=oi(l,m,1)^r[n+1];for(let d=0;d<50;d+=10)t[i+d]^=B,t[i+d+1]^=v}let c=t[2],o=t[3];for(let i=0;i<24;i++){const n=Ps[i],u=si(c,o,n),l=oi(c,o,n),m=Ds[i];c=t[m],o=t[m+1],t[m]=u,t[m+1]=l}for(let i=0;i<50;i+=10){for(let n=0;n<10;n++)r[n]=t[i+n];for(let n=0;n<10;n++)t[i+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=Df[a],t[1]^=Pf[a]}ut(r)}class yn{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(e,r,a,c=!1,o=24){if(this.blockLen=e,this.suffix=r,this.outputLen=a,this.enableXOF=c,this.rounds=o,dt(a,"outputLen"),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=cr(this.state)}clone(){return this._cloneInto()}keccak(){it(this.state32),Of(this.state32,this.rounds),it(this.state32),this.posOut=0,this.pos=0}update(e){Ht(this),de(e);const{blockLen:r,state:a}=this,c=e.length;for(let o=0;o<c;){const i=Math.min(r-this.pos,c-o);for(let n=0;n<i;n++)a[this.pos++]^=e[o++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:a,blockLen:c}=this;e[a]^=r,(r&128)!==0&&a===c-1&&this.keccak(),e[c-1]^=128,this.keccak()}writeInto(e){Ht(this,!1),de(e),this.finish();const r=this.state,{blockLen:a}=this;for(let c=0,o=e.length;c<o;){this.posOut>=a&&this.keccak();const i=Math.min(a-this.posOut,o-c);e.set(r.subarray(this.posOut,this.posOut+i),c),this.posOut+=i,c+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return dt(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(pn(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ut(this.state)}_cloneInto(e){const{blockLen:r,suffix:a,outputLen:c,rounds:o,enableXOF:i}=this;return e||=new yn(r,a,c,i,o),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=a,e.outputLen=c,e.enableXOF=i,e.destroyed=this.destroyed,e}}const Kf=(t,e,r,a={})=>nr(()=>new yn(e,t,r),a),Vf=Kf(6,136,32,Kr(8)),Ff=(t,e,r,a={})=>nr((c={})=>new yn(e,t,c.dkLen===void 0?r:c.dkLen,!0),a),Mf=Ff(31,136,32,Kr(12));const Oa=BigInt(0),Ba=BigInt(1);function ur(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}" `;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function Vs(t){if(typeof t=="bigint"){if(!sn(t))throw new Error("positive bigint expected, got "+t)}else dt(t);return t}function Yr(t){const e=Vs(t).toString(16);return e.length&1?"0"+e:e}function Fs(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Oa:BigInt("0x"+t)}function gn(t){return Fs(Or(t))}function Nr(t){return Fs(Or(Ta(de(t)).reverse()))}function Ka(t,e){dt(e),t=Vs(t);const r=Rr(t.toString(16).padStart(e*2,"0"));if(r.length!==e)throw new Error("number too large");return r}function Ms(t,e){return Ka(t,e).reverse()}function Ta(t){return Uint8Array.from(t)}function Hf(t){return Uint8Array.from(t,(e,r)=>{const a=e.charCodeAt(0);if(e.length!==1||a>127)throw new Error(`string contains non-ASCII character "${t[r]}" with code ${a} at position ${r}`);return a})}const sn=t=>typeof t=="bigint"&&Oa<=t;function qf(t,e,r){return sn(t)&&sn(e)&&sn(r)&&e<=t&&t<r}function wa(t,e,r,a){if(!qf(e,r,a))throw new Error("expected valid "+t+": "+r+" <= n < "+a+", got "+e)}function Gf(t){let e;for(e=0;t>Oa;t>>=Ba,e+=1);return e}const Va=t=>(Ba<<BigInt(t))-Ba;function zf(t,e,r){if(dt(t,"hashLen"),dt(e,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");const a=S=>new Uint8Array(S),c=Uint8Array.of(),o=Uint8Array.of(0),i=Uint8Array.of(1),n=1e3;let u=a(t),l=a(t),m=0;const B=()=>{u.fill(1),l.fill(0),m=0},v=(...S)=>r(l,Ct(u,...S)),d=(S=c)=>{l=v(o,S),u=v(),S.length!==0&&(l=v(i,S),u=v())},y=()=>{if(m++>=n)throw new Error("drbg: tried max amount of iterations");let S=0;const f=[];for(;S<e;){u=v();const g=u.slice();f.push(g),S+=u.length}return Ct(...f)};return(S,f)=>{B(),d(S);let g;for(;!(g=f(y()));)d();return B(),g}}function Vr(t,e={},r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function a(o,i,n){const u=t[o];if(n&&u===void 0)return;const l=typeof u;if(l!==i||u===null)throw new Error(`param "${o}" is invalid: expected ${i}, got ${l}`)}const c=(o,i)=>Object.entries(o).forEach(([n,u])=>a(n,u,i));c(e,!1),c(r,!0)}function fn(t){const e=new WeakMap;return(r,...a)=>{const c=e.get(r);if(c!==void 0)return c;const o=t(r,...a);return e.set(r,o),o}}const ct=BigInt(0),Je=BigInt(1),ir=BigInt(2),Hs=BigInt(3),qs=BigInt(4),Gs=BigInt(5),$f=BigInt(7),zs=BigInt(8),Yf=BigInt(9),$s=BigInt(16);function Se(t,e){const r=t%e;return r>=ct?r:e+r}function me(t,e,r){let a=t;for(;e-- >ct;)a*=a,a%=r;return a}function fi(t,e){if(t===ct)throw new Error("invert: expected non-zero number");if(e<=ct)throw new Error("invert: expected positive modulus, got "+e);let r=Se(t,e),a=e,c=ct,o=Je;for(;r!==ct;){const n=a/r,u=a%r,l=c-o*n;a=r,r=u,c=o,o=l}if(a!==Je)throw new Error("invert: does not exist");return Se(c,e)}function Fa(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function Ys(t,e){const r=(t.ORDER+Je)/qs,a=t.pow(e,r);return Fa(t,a,e),a}function Qf(t,e){const r=(t.ORDER-Gs)/zs,a=t.mul(e,ir),c=t.pow(a,r),o=t.mul(e,c),i=t.mul(t.mul(o,ir),c),n=t.mul(o,t.sub(i,t.ONE));return Fa(t,n,e),n}function Xf(t){const e=lr(t),r=Qs(t),a=r(e,e.neg(e.ONE)),c=r(e,a),o=r(e,e.neg(a)),i=(t+$f)/$s;return(n,u)=>{let l=n.pow(u,i),m=n.mul(l,a);const B=n.mul(l,c),v=n.mul(l,o),d=n.eql(n.sqr(m),u),y=n.eql(n.sqr(B),u);l=n.cmov(l,m,d),m=n.cmov(v,B,y);const b=n.eql(n.sqr(m),u),S=n.cmov(l,m,b);return Fa(n,S,u),S}}function Qs(t){if(t<Hs)throw new Error("sqrt is not defined for small field");let e=t-Je,r=0;for(;e%ir===ct;)e/=ir,r++;let a=ir;const c=lr(t);for(;ci(c,a)===1;)if(a++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Ys;let o=c.pow(a,e);const i=(e+Je)/ir;return function(u,l){if(u.is0(l))return l;if(ci(u,l)!==1)throw new Error("Cannot find square root");let m=r,B=u.mul(u.ONE,o),v=u.pow(l,e),d=u.pow(l,i);for(;!u.eql(v,u.ONE);){if(u.is0(v))return u.ZERO;let y=1,b=u.sqr(v);for(;!u.eql(b,u.ONE);)if(y++,b=u.sqr(b),y===m)throw new Error("Cannot find square root");const S=Je<<BigInt(m-y-1),f=u.pow(B,S);m=y,B=u.sqr(f),v=u.mul(v,B),d=u.mul(d,f)}return d}}function jf(t){return t%qs===Hs?Ys:t%zs===Gs?Qf:t%$s===Yf?Xf(t):Qs(t)}const Zf=(t,e)=>(Se(t,e)&Je)===Je,Wf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Jf(t){const e={ORDER:"bigint",BYTES:"number",BITS:"number"},r=Wf.reduce((a,c)=>(a[c]="function",a),e);return Vr(t,r),t}function ec(t,e,r){if(r<ct)throw new Error("invalid exponent, negatives unsupported");if(r===ct)return t.ONE;if(r===Je)return e;let a=t.ONE,c=e;for(;r>ct;)r&Je&&(a=t.mul(a,c)),c=t.sqr(c),r>>=Je;return a}function Xs(t,e,r=!1){const a=new Array(e.length).fill(r?t.ZERO:void 0),c=e.reduce((i,n,u)=>t.is0(n)?i:(a[u]=i,t.mul(i,n)),t.ONE),o=t.inv(c);return e.reduceRight((i,n,u)=>t.is0(n)?i:(a[u]=t.mul(i,a[u]),t.mul(i,n)),o),a}function ci(t,e){const r=(t.ORDER-Je)/ir,a=t.pow(e,r),c=t.eql(a,t.ONE),o=t.eql(a,t.ZERO),i=t.eql(a,t.neg(t.ONE));if(!c&&!o&&!i)throw new Error("invalid Legendre symbol result");return c?1:o?0:-1}function tc(t,e){e!==void 0&&dt(e);const r=e!==void 0?e:t.toString(2).length,a=Math.ceil(r/8);return{nBitLength:r,nByteLength:a}}class rc{ORDER;BITS;BYTES;isLE;ZERO=ct;ONE=Je;_lengths;_sqrt;_mod;constructor(e,r={}){if(e<=ct)throw new Error("invalid field: expected ORDER > 0, got "+e);let a;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(a=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));const{nBitLength:c,nByteLength:o}=tc(e,a);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=e,this.BITS=c,this.BYTES=o,this._sqrt=void 0,Object.preventExtensions(this)}create(e){return Se(e,this.ORDER)}isValid(e){if(typeof e!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof e);return ct<=e&&e<this.ORDER}is0(e){return e===ct}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}isOdd(e){return(e&Je)===Je}neg(e){return Se(-e,this.ORDER)}eql(e,r){return e===r}sqr(e){return Se(e*e,this.ORDER)}add(e,r){return Se(e+r,this.ORDER)}sub(e,r){return Se(e-r,this.ORDER)}mul(e,r){return Se(e*r,this.ORDER)}pow(e,r){return ec(this,e,r)}div(e,r){return Se(e*fi(r,this.ORDER),this.ORDER)}sqrN(e){return e*e}addN(e,r){return e+r}subN(e,r){return e-r}mulN(e,r){return e*r}inv(e){return fi(e,this.ORDER)}sqrt(e){return this._sqrt||(this._sqrt=jf(this.ORDER)),this._sqrt(this,e)}toBytes(e){return this.isLE?Ms(e,this.BYTES):Ka(e,this.BYTES)}fromBytes(e,r=!1){de(e);const{_lengths:a,BYTES:c,isLE:o,ORDER:i,_mod:n}=this;if(a){if(!a.includes(e.length)||e.length>c)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);const l=new Uint8Array(c);l.set(e,o?0:l.length-e.length),e=l}if(e.length!==c)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+e.length);let u=o?Nr(e):gn(e);if(n&&(u=Se(u,i)),!r&&!this.isValid(u))throw new Error("invalid field element: outside of range 0..ORDER");return u}invertBatch(e){return Xs(this,e)}cmov(e,r,a){return a?r:e}}function lr(t,e={}){return new rc(t,e)}function js(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Zs(t){const e=js(t);return e+Math.ceil(e/2)}function nc(t,e,r=!1){de(t);const a=t.length,c=js(e),o=Zs(e);if(a<16||a<o||a>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+a);const i=r?Nr(t):gn(t),n=Se(i,e-Je)+Je;return r?Ms(n,c):Ka(n,c)}const vr=BigInt(0),sr=BigInt(1);function cn(t,e){const r=e.negate();return t?r:e}function wr(t,e){const r=Xs(t.Fp,e.map(a=>a.Z));return e.map((a,c)=>t.fromAffine(a.toAffine(r[c])))}function Ws(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Rn(t,e){Ws(t,e);const r=Math.ceil(e/t)+1,a=2**(t-1),c=2**t,o=Va(t),i=BigInt(t);return{windows:r,windowSize:a,mask:o,maxNumber:c,shiftBy:i}}function ui(t,e,r){const{windowSize:a,mask:c,maxNumber:o,shiftBy:i}=r;let n=Number(t&c),u=t>>i;n>a&&(n-=o,u+=sr);const l=e*a,m=l+Math.abs(n)-1,B=n===0,v=n<0,d=e%2!==0;return{nextN:u,offset:m,isZero:B,isNeg:v,isNegF:d,offsetF:l}}const Nn=new WeakMap,Js=new WeakMap;function Ln(t){return Js.get(t)||1}function li(t){if(t!==vr)throw new Error("invalid wNAF")}class eo{BASE;ZERO;Fn;bits;constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,a=this.ZERO){let c=e;for(;r>vr;)r&sr&&(a=a.add(c)),c=c.double(),r>>=sr;return a}precomputeWindow(e,r){const{windows:a,windowSize:c}=Rn(r,this.bits),o=[];let i=e,n=i;for(let u=0;u<a;u++){n=i,o.push(n);for(let l=1;l<c;l++)n=n.add(i),o.push(n);i=n.double()}return o}wNAF(e,r,a){if(!this.Fn.isValid(a))throw new Error("invalid scalar");let c=this.ZERO,o=this.BASE;const i=Rn(e,this.bits);for(let n=0;n<i.windows;n++){const{nextN:u,offset:l,isZero:m,isNeg:B,isNegF:v,offsetF:d}=ui(a,n,i);a=u,m?o=o.add(cn(v,r[d])):c=c.add(cn(B,r[l]))}return li(a),{p:c,f:o}}wNAFUnsafe(e,r,a,c=this.ZERO){const o=Rn(e,this.bits);for(let i=0;i<o.windows&&a!==vr;i++){const{nextN:n,offset:u,isZero:l,isNeg:m}=ui(a,i,o);if(a=n,!l){const B=r[u];c=c.add(m?B.negate():B)}}return li(a),c}getPrecomputes(e,r,a){let c=Nn.get(r);return c||(c=this.precomputeWindow(r,e),e!==1&&(typeof a=="function"&&(c=a(c)),Nn.set(r,c))),c}cached(e,r,a){const c=Ln(e);return this.wNAF(c,this.getPrecomputes(c,e,a),r)}unsafe(e,r,a,c){const o=Ln(e);return o===1?this._unsafeLadder(e,r,c):this.wNAFUnsafe(o,this.getPrecomputes(o,e,a),r,c)}createCache(e,r){Ws(r,this.bits),Js.set(e,r),Nn.delete(e)}hasCache(e){return Ln(e)!==1}}function ac(t,e,r,a){let c=e,o=t.ZERO,i=t.ZERO;for(;r>vr||a>vr;)r&sr&&(o=o.add(c)),a&sr&&(i=i.add(c)),c=c.double(),r>>=sr,a>>=sr;return{p1:o,p2:i}}function hi(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Jf(e),e}else return lr(t,{isLE:r})}function to(t,e,r={},a){if(a===void 0&&(a=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const u of["p","n","h"]){const l=e[u];if(!(typeof l=="bigint"&&l>vr))throw new Error(`CURVE.${u} must be positive bigint`)}const c=hi(e.p,r.Fp,a),o=hi(e.n,r.Fn,a),n=["Gx","Gy","a",t==="weierstrass"?"b":"d"];for(const u of n)if(!c.isValid(e[u]))throw new Error(`CURVE.${u} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:c,Fn:o}}function ro(t,e){return function(a){const c=t(a);return{secretKey:c,publicKey:e(c)}}}const $t=BigInt(0),Xe=BigInt(1),kn=BigInt(2),ic=BigInt(8);function sc(t,e,r,a){const c=t.sqr(r),o=t.sqr(a),i=t.add(t.mul(e.a,c),o),n=t.add(t.ONE,t.mul(e.d,t.mul(c,o)));return t.eql(i,n)}function no(t,e={}){const r=to("edwards",t,e,e.FpFnLE),{Fp:a,Fn:c}=r;let o=r.CURVE;const{h:i}=o;Vr(e,{},{uvRatio:"function"});const n=kn<<BigInt(c.BYTES*8)-Xe,u=S=>a.create(S),l=e.uvRatio||((S,f)=>{try{return{isValid:!0,value:a.sqrt(a.div(S,f))}}catch{return{isValid:!1,value:$t}}});if(!sc(a,o,o.Gx,o.Gy))throw new Error("bad curve params: generator point");function m(S,f,g=!1){const E=g?Xe:$t;return wa("coordinate "+S,f,E,n),f}function B(S){if(!(S instanceof y))throw new Error("EdwardsPoint expected")}const v=fn((S,f)=>{const{X:g,Y:E,Z:w}=S,I=S.is0();f==null&&(f=I?ic:a.inv(w));const x=u(g*f),h=u(E*f),s=a.mul(w,f);if(I)return{x:$t,y:Xe};if(s!==Xe)throw new Error("invZ was invalid");return{x,y:h}}),d=fn(S=>{const{a:f,d:g}=o;if(S.is0())throw new Error("bad point: ZERO");const{X:E,Y:w,Z:I,T:x}=S,h=u(E*E),s=u(w*w),T=u(I*I),N=u(T*T),O=u(h*f),_=u(T*u(O+s)),D=u(N+u(g*u(h*s)));if(_!==D)throw new Error("bad point: equation left != right (1)");const V=u(E*w),P=u(I*x);if(V!==P)throw new Error("bad point: equation left != right (2)");return!0});class y{static BASE=new y(o.Gx,o.Gy,Xe,u(o.Gx*o.Gy));static ZERO=new y($t,Xe,Xe,$t);static Fp=a;static Fn=c;X;Y;Z;T;constructor(f,g,E,w){this.X=m("x",f),this.Y=m("y",g),this.Z=m("z",E,!0),this.T=m("t",w),Object.freeze(this)}static CURVE(){return o}static fromAffine(f){if(f instanceof y)throw new Error("extended point not allowed");const{x:g,y:E}=f||{};return m("x",g),m("y",E),new y(g,E,Xe,u(g*E))}static fromBytes(f,g=!1){const E=a.BYTES,{a:w,d:I}=o;f=Ta(de(f,E,"point")),ur(g,"zip215");const x=Ta(f),h=f[E-1];x[E-1]=h&-129;const s=Nr(x),T=g?n:a.ORDER;wa("point.y",s,$t,T);const N=u(s*s),O=u(N-Xe),_=u(I*N-w);let{isValid:D,value:V}=l(O,_);if(!D)throw new Error("bad point: invalid y coordinate");const P=(V&Xe)===Xe,M=(h&128)!==0;if(!g&&V===$t&&M)throw new Error("bad point: x=0 and x_0=1");return M!==P&&(V=u(-V)),y.fromAffine({x:V,y:s})}static fromHex(f,g=!1){return y.fromBytes(Rr(f),g)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(f=8,g=!0){return b.createCache(this,f),g||this.multiply(kn),this}assertValidity(){d(this)}equals(f){B(f);const{X:g,Y:E,Z:w}=this,{X:I,Y:x,Z:h}=f,s=u(g*h),T=u(I*w),N=u(E*h),O=u(x*w);return s===T&&N===O}is0(){return this.equals(y.ZERO)}negate(){return new y(u(-this.X),this.Y,this.Z,u(-this.T))}double(){const{a:f}=o,{X:g,Y:E,Z:w}=this,I=u(g*g),x=u(E*E),h=u(kn*u(w*w)),s=u(f*I),T=g+E,N=u(u(T*T)-I-x),O=s+x,_=O-h,D=s-x,V=u(N*_),P=u(O*D),M=u(N*D),q=u(_*O);return new y(V,P,q,M)}add(f){B(f);const{a:g,d:E}=o,{X:w,Y:I,Z:x,T:h}=this,{X:s,Y:T,Z:N,T:O}=f,_=u(w*s),D=u(I*T),V=u(h*E*O),P=u(x*N),M=u((w+I)*(s+T)-_-D),q=P-V,$=P+V,G=u(D-g*_),Y=u(M*q),j=u($*G),te=u(M*G),ue=u(q*$);return new y(Y,j,ue,te)}subtract(f){return this.add(f.negate())}multiply(f){if(!c.isValidNot0(f))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:g,f:E}=b.cached(this,f,w=>wr(y,w));return wr(y,[g,E])[0]}multiplyUnsafe(f,g=y.ZERO){if(!c.isValid(f))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return f===$t?y.ZERO:this.is0()||f===Xe?this:b.unsafe(this,f,E=>wr(y,E),g)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return b.unsafe(this,o.n).is0()}toAffine(f){return v(this,f)}clearCofactor(){return i===Xe?this:this.multiplyUnsafe(i)}toBytes(){const{x:f,y:g}=this.toAffine(),E=a.toBytes(g);return E[E.length-1]|=f&Xe?128:0,E}toHex(){return Or(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const b=new eo(y,c.BITS);return y.BASE.precompute(8),y}function ao(t,e,r={}){if(typeof e!="function")throw new Error('"hash" function param is required');Vr(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:a}=r,{BASE:c,Fp:o,Fn:i}=t,n=r.randomBytes||Pa,u=r.adjustScalarBytes||(s=>s),l=r.domain||((s,T,N)=>{if(ur(N,"phflag"),T.length||N)throw new Error("Contexts/pre-hash are not supported");return s});function m(s){return i.create(Nr(s))}function B(s){const T=E.secretKey;de(s,E.secretKey,"secretKey");const N=de(e(s),2*T,"hashedSecretKey"),O=u(N.slice(0,T)),_=N.slice(T,2*T),D=m(O);return{head:O,prefix:_,scalar:D}}function v(s){const{head:T,prefix:N,scalar:O}=B(s),_=c.multiply(O),D=_.toBytes();return{head:T,prefix:N,scalar:O,point:_,pointBytes:D}}function d(s){return v(s).pointBytes}function y(s=Uint8Array.of(),...T){const N=Ct(...T);return m(e(l(N,de(s,void 0,"context"),!!a)))}function b(s,T,N={}){s=de(s,void 0,"message"),a&&(s=a(s));const{prefix:O,scalar:_,pointBytes:D}=v(T),V=y(N.context,O,s),P=c.multiply(V).toBytes(),M=y(N.context,P,D,s),q=i.create(V+M*_);if(!i.isValid(q))throw new Error("sign failed: invalid s");const $=Ct(P,i.toBytes(q));return de($,E.signature,"result")}const S={zip215:!0};function f(s,T,N,O=S){const{context:_,zip215:D}=O,V=E.signature;s=de(s,V,"signature"),T=de(T,void 0,"message"),N=de(N,E.publicKey,"publicKey"),D!==void 0&&ur(D,"zip215"),a&&(T=a(T));const P=V/2,M=s.subarray(0,P),q=Nr(s.subarray(P,V));let $,G,Y;try{$=t.fromBytes(N,D),G=t.fromBytes(M,D),Y=c.multiplyUnsafe(q)}catch{return!1}if(!D&&$.isSmallOrder())return!1;const j=y(_,G.toBytes(),$.toBytes(),T);return G.add($.multiplyUnsafe(j)).subtract(Y).clearCofactor().is0()}const g=o.BYTES,E={secretKey:g,publicKey:g,signature:2*g,seed:g};function w(s=n(E.seed)){return de(s,E.seed,"seed")}function I(s){return dn(s)&&s.length===i.BYTES}function x(s,T){try{return!!t.fromBytes(s,T)}catch{return!1}}const h={getExtendedPublicKey:v,randomSecretKey:w,isValidSecretKey:I,isValidPublicKey:x,toMontgomery(s){const{y:T}=t.fromBytes(s),N=E.publicKey,O=N===32;if(!O&&N!==57)throw new Error("only defined for 25519 and 448");const _=O?o.div(Xe+T,Xe-T):o.div(T-Xe,T+Xe);return o.toBytes(_)},toMontgomerySecret(s){const T=E.secretKey;de(s,T);const N=e(s.subarray(0,T));return u(N).subarray(0,T)}};return Object.freeze({keygen:ro(w,d),getPublicKey:d,sign:b,verify:f,utils:h,Point:t,lengths:E})}const vn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),io={p:vn,n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},oc=nr(()=>Mf.create({dkLen:114})),fc=BigInt(1),di=BigInt(2),pi=BigInt(3),cc=BigInt(11),uc=BigInt(22),yi=BigInt(44),lc=BigInt(88),hc=BigInt(223);function dc(t){const e=vn,r=t*t*t%e,a=r*r*t%e,c=me(a,pi,e)*a%e,o=me(c,pi,e)*a%e,i=me(o,di,e)*r%e,n=me(i,cc,e)*i%e,u=me(n,uc,e)*n%e,l=me(u,yi,e)*u%e,m=me(l,lc,e)*l%e,B=me(m,yi,e)*u%e,v=me(B,di,e)*r%e,d=me(v,fc,e)*t%e;return me(d,hc,e)*v%e}function pc(t){return t[0]&=252,t[55]|=128,t[56]=0,t}function yc(t,e){const r=vn,a=Se(t*t*e,r),c=Se(a*t,r),o=Se(c*a*e,r),i=dc(o),n=Se(c*i,r),u=Se(n*n,r);return{isValid:Se(u*e,r)===t,value:n}}const gc=lr(vn,{BITS:456,isLE:!0}),vc=lr(io.n,{BITS:456,isLE:!0});function mc(t,e,r){if(e.length>255)throw new Error("context must be smaller than 255, got: "+e.length);return Ct(Hf("SigEd448"),new Uint8Array([r?1:0,e.length]),e,t)}const Ec=no(io,{Fp:gc,Fn:vc,uvRatio:yc});function xc(t){return ao(Ec,oc,Object.assign({adjustScalarBytes:pc,domain:mc},t))}const Sc=xc({});function Cc(t,e,r){return t&e^~t&r}function bc(t,e,r){return t&e^t&r^e&r}class so{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(e,r,a,c){this.blockLen=e,this.outputLen=r,this.padOffset=a,this.isLE=c,this.buffer=new Uint8Array(e),this.view=_n(this.buffer)}update(e){Ht(this),de(e);const{view:r,buffer:a,blockLen:c}=this,o=e.length;for(let i=0;i<o;){const n=Math.min(c-this.pos,o-i);if(n===c){const u=_n(e);for(;c<=o-i;i+=c)this.process(u,i);continue}a.set(e.subarray(i,i+n),this.pos),this.pos+=n,i+=n,this.pos===c&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ht(this),pn(e,this),this.finished=!0;const{buffer:r,view:a,blockLen:c,isLE:o}=this;let{pos:i}=this;r[i++]=128,ut(this.buffer.subarray(i)),this.padOffset>c-i&&(this.process(a,0),i=0);for(let B=i;B<c;B++)r[B]=0;a.setBigUint64(c-8,BigInt(this.length*8),o),this.process(a,0);const n=_n(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const l=u/4,m=this.get();if(l>m.length)throw new Error("_sha2: outputLen bigger than state");for(let B=0;B<l;B++)n.setUint32(4*B,m[B],o)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}_cloneInto(e){e||=new this.constructor,e.set(...this.get());const{blockLen:r,buffer:a,length:c,finished:o,destroyed:i,pos:n}=this;return e.destroyed=i,e.finished=o,e.length=c,e.pos=n,c%r&&e.buffer.set(a),e}clone(){return this._cloneInto()}}const Vt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),rt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Bc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Yt=new Uint32Array(64);class Tc extends so{constructor(e){super(64,e,8,!1)}get(){const{A:e,B:r,C:a,D:c,E:o,F:i,G:n,H:u}=this;return[e,r,a,c,o,i,n,u]}set(e,r,a,c,o,i,n,u){this.A=e|0,this.B=r|0,this.C=a|0,this.D=c|0,this.E=o|0,this.F=i|0,this.G=n|0,this.H=u|0}process(e,r){for(let B=0;B<16;B++,r+=4)Yt[B]=e.getUint32(r,!1);for(let B=16;B<64;B++){const v=Yt[B-15],d=Yt[B-2],y=ft(v,7)^ft(v,18)^v>>>3,b=ft(d,17)^ft(d,19)^d>>>10;Yt[B]=b+Yt[B-7]+y+Yt[B-16]|0}let{A:a,B:c,C:o,D:i,E:n,F:u,G:l,H:m}=this;for(let B=0;B<64;B++){const v=ft(n,6)^ft(n,11)^ft(n,25),d=m+v+Cc(n,u,l)+Bc[B]+Yt[B]|0,b=(ft(a,2)^ft(a,13)^ft(a,22))+bc(a,c,o)|0;m=l,l=u,u=n,n=i+d|0,i=o,o=c,c=a,a=d+b|0}a=a+this.A|0,c=c+this.B|0,o=o+this.C|0,i=i+this.D|0,n=n+this.E|0,u=u+this.F|0,l=l+this.G|0,m=m+this.H|0,this.set(a,c,o,i,n,u,l,m)}roundClean(){ut(Yt)}destroy(){this.set(0,0,0,0,0,0,0,0),ut(this.buffer)}}class wc extends Tc{A=Vt[0]|0;B=Vt[1]|0;C=Vt[2]|0;D=Vt[3]|0;E=Vt[4]|0;F=Vt[5]|0;G=Vt[6]|0;H=Vt[7]|0;constructor(){super(32)}}const oo=Rs(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Ac=oo[0],Ic=oo[1],Qt=new Uint32Array(80),Xt=new Uint32Array(80);class fo extends so{constructor(e){super(128,e,16,!1)}get(){const{Ah:e,Al:r,Bh:a,Bl:c,Ch:o,Cl:i,Dh:n,Dl:u,Eh:l,El:m,Fh:B,Fl:v,Gh:d,Gl:y,Hh:b,Hl:S}=this;return[e,r,a,c,o,i,n,u,l,m,B,v,d,y,b,S]}set(e,r,a,c,o,i,n,u,l,m,B,v,d,y,b,S){this.Ah=e|0,this.Al=r|0,this.Bh=a|0,this.Bl=c|0,this.Ch=o|0,this.Cl=i|0,this.Dh=n|0,this.Dl=u|0,this.Eh=l|0,this.El=m|0,this.Fh=B|0,this.Fl=v|0,this.Gh=d|0,this.Gl=y|0,this.Hh=b|0,this.Hl=S|0}process(e,r){for(let E=0;E<16;E++,r+=4)Qt[E]=e.getUint32(r),Xt[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const w=Qt[E-15]|0,I=Xt[E-15]|0,x=er(w,I,1)^er(w,I,8)^ni(w,I,7),h=tr(w,I,1)^tr(w,I,8)^ai(w,I,7),s=Qt[E-2]|0,T=Xt[E-2]|0,N=er(s,T,19)^br(s,T,61)^ni(s,T,6),O=tr(s,T,19)^Br(s,T,61)^ai(s,T,6),_=bf(h,O,Xt[E-7],Xt[E-16]),D=Bf(_,x,N,Qt[E-7],Qt[E-16]);Qt[E]=D|0,Xt[E]=_|0}let{Ah:a,Al:c,Bh:o,Bl:i,Ch:n,Cl:u,Dh:l,Dl:m,Eh:B,El:v,Fh:d,Fl:y,Gh:b,Gl:S,Hh:f,Hl:g}=this;for(let E=0;E<80;E++){const w=er(B,v,14)^er(B,v,18)^br(B,v,41),I=tr(B,v,14)^tr(B,v,18)^Br(B,v,41),x=B&d^~B&b,h=v&y^~v&S,s=Tf(g,I,h,Ic[E],Xt[E]),T=wf(s,f,w,x,Ac[E],Qt[E]),N=s|0,O=er(a,c,28)^br(a,c,34)^br(a,c,39),_=tr(a,c,28)^Br(a,c,34)^Br(a,c,39),D=a&o^a&n^o&n,V=c&i^c&u^i&u;f=b|0,g=S|0,b=d|0,S=y|0,d=B|0,y=v|0,{h:B,l:v}=St(l|0,m|0,T|0,N|0),l=n|0,m=u|0,n=o|0,u=i|0,o=a|0,i=c|0;const P=Ua(N,_,V);a=Da(P,T,O,D),c=P|0}({h:a,l:c}=St(this.Ah|0,this.Al|0,a|0,c|0)),{h:o,l:i}=St(this.Bh|0,this.Bl|0,o|0,i|0),{h:n,l:u}=St(this.Ch|0,this.Cl|0,n|0,u|0),{h:l,l:m}=St(this.Dh|0,this.Dl|0,l|0,m|0),{h:B,l:v}=St(this.Eh|0,this.El|0,B|0,v|0),{h:d,l:y}=St(this.Fh|0,this.Fl|0,d|0,y|0),{h:b,l:S}=St(this.Gh|0,this.Gl|0,b|0,S|0),{h:f,l:g}=St(this.Hh|0,this.Hl|0,f|0,g|0),this.set(a,c,o,i,n,u,l,m,B,v,d,y,b,S,f,g)}roundClean(){ut(Qt,Xt)}destroy(){ut(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class _c extends fo{Ah=rt[0]|0;Al=rt[1]|0;Bh=rt[2]|0;Bl=rt[3]|0;Ch=rt[4]|0;Cl=rt[5]|0;Dh=rt[6]|0;Dl=rt[7]|0;Eh=rt[8]|0;El=rt[9]|0;Fh=rt[10]|0;Fl=rt[11]|0;Gh=rt[12]|0;Gl=rt[13]|0;Hh=rt[14]|0;Hl=rt[15]|0;constructor(){super(64)}}class Rc extends fo{Ah=tt[0]|0;Al=tt[1]|0;Bh=tt[2]|0;Bl=tt[3]|0;Ch=tt[4]|0;Cl=tt[5]|0;Dh=tt[6]|0;Dl=tt[7]|0;Eh=tt[8]|0;El=tt[9]|0;Fh=tt[10]|0;Fl=tt[11]|0;Gh=tt[12]|0;Gl=tt[13]|0;Hh=tt[14]|0;Hl=tt[15]|0;constructor(){super(48)}}const co=nr(()=>new wc,Kr(1)),uo=nr(()=>new _c,Kr(3)),Nc=nr(()=>new Rc,Kr(2));const Lc=BigInt(1),gi=BigInt(2),kc=BigInt(5),Uc=BigInt(8),Ma=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Dc={p:Ma,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Uc,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Pc(t){const e=BigInt(10),r=BigInt(20),a=BigInt(40),c=BigInt(80),o=Ma,n=t*t%o*t%o,u=me(n,gi,o)*n%o,l=me(u,Lc,o)*t%o,m=me(l,kc,o)*l%o,B=me(m,e,o)*m%o,v=me(B,r,o)*B%o,d=me(v,a,o)*v%o,y=me(d,c,o)*d%o,b=me(y,c,o)*d%o,S=me(b,e,o)*m%o;return{pow_p_5_8:me(S,gi,o)*t%o,b2:n}}function Oc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const vi=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Kc(t,e){const r=Ma,a=Se(e*e*e,r),c=Se(a*a*e,r),o=Pc(t*c).pow_p_5_8;let i=Se(t*a*o,r);const n=Se(e*i*i,r),u=i,l=Se(i*vi,r),m=n===t,B=n===Se(-t,r),v=n===Se(-t*vi,r);return m&&(i=u),(B||v)&&(i=l),Zf(i,r)&&(i=Se(-i,r)),{isValid:m||B,value:i}}const Vc=no(Dc,{uvRatio:Kc});function Fc(t){return ao(Vc,uo,Object.assign({adjustScalarBytes:Oc},t))}const Mc=Fc({});class lo{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(e,r){if(Ns(e),de(r,void 0,"key"),this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,c=new Uint8Array(a);c.set(r.length>a?e.create().update(r).digest():r);for(let o=0;o<c.length;o++)c[o]^=54;this.iHash.update(c),this.oHash=e.create();for(let o=0;o<c.length;o++)c[o]^=106;this.oHash.update(c),ut(c)}update(e){return Ht(this),this.iHash.update(e),this}digestInto(e){Ht(this),de(e,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:a,finished:c,destroyed:o,blockLen:i,outputLen:n}=this;return e=e,e.finished=c,e.destroyed=o,e.blockLen=i,e.outputLen=n,e.oHash=r._cloneInto(e.oHash),e.iHash=a._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ho=(t,e,r)=>new lo(t,e).update(r).digest();ho.create=(t,e)=>new lo(t,e);const mi=(t,e)=>(t+(t>=0?e:-e)/po)/e;function Hc(t,e,r){const[[a,c],[o,i]]=e,n=mi(i*t,r),u=mi(-c*t,r);let l=t-n*a-u*o,m=-n*c-u*i;const B=l<Mt,v=m<Mt;B&&(l=-l),v&&(m=-m);const d=Va(Math.ceil(Gf(r)/2))+gr;if(l<Mt||l>=d||m<Mt||m>=d)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:B,k1:l,k2neg:v,k2:m}}function Aa(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Un(t,e){const r={};for(let a of Object.keys(e))r[a]=t[a]===void 0?e[a]:t[a];return ur(r.lowS,"lowS"),ur(r.prehash,"prehash"),r.format!==void 0&&Aa(r.format),r}class qc extends Error{constructor(e=""){super(e)}}const rr={Err:qc,_tlv:{encode:(t,e)=>{const{Err:r}=rr;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const a=e.length/2,c=Yr(a);if(c.length/2&128)throw new r("tlv.encode: long form length too big");const o=a>127?Yr(c.length/2|128):"";return Yr(t)+o+c+e},decode(t,e){const{Err:r}=rr;let a=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[a++]!==t)throw new r("tlv.decode: wrong tlv");const c=e[a++],o=!!(c&128);let i=0;if(!o)i=c;else{const u=c&127;if(!u)throw new r("tlv.decode(long): indefinite length not supported");if(u>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(a,a+u);if(l.length!==u)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const m of l)i=i<<8|m;if(a+=u,i<128)throw new r("tlv.decode(long): not minimal encoding")}const n=e.subarray(a,a+i);if(n.length!==i)throw new r("tlv.decode: wrong value length");return{v:n,l:e.subarray(a+i)}}},_int:{encode(t){const{Err:e}=rr;if(t<Mt)throw new e("integer: negative integers are not allowed");let r=Yr(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=rr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return gn(t)}},toSig(t){const{Err:e,_int:r,_tlv:a}=rr,c=de(t,void 0,"signature"),{v:o,l:i}=a.decode(48,c);if(i.length)throw new e("invalid signature: left bytes after parsing");const{v:n,l:u}=a.decode(2,o),{v:l,l:m}=a.decode(2,u);if(m.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(n),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=rr,a=e.encode(2,r.encode(t.r)),c=e.encode(2,r.encode(t.s)),o=a+c;return e.encode(48,o)}},Mt=BigInt(0),gr=BigInt(1),po=BigInt(2),Qr=BigInt(3),Gc=BigInt(4);function mn(t,e={}){const r=to("weierstrass",t,e),{Fp:a,Fn:c}=r;let o=r.CURVE;const{h:i,n}=o;Vr(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});const{endo:u}=e;if(u&&(!a.is0(o.a)||typeof u.beta!="bigint"||!Array.isArray(u.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=go(a,c);function m(){if(!a.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function B(_,D,V){const{x:P,y:M}=D.toAffine(),q=a.toBytes(P);if(ur(V,"isCompressed"),V){m();const $=!a.isOdd(M);return Ct(yo($),q)}else return Ct(Uint8Array.of(4),q,a.toBytes(M))}function v(_){de(_,void 0,"Point");const{publicKey:D,publicKeyUncompressed:V}=l,P=_.length,M=_[0],q=_.subarray(1);if(P===D&&(M===2||M===3)){const $=a.fromBytes(q);if(!a.isValid($))throw new Error("bad point: is not on curve, wrong x");const G=b($);let Y;try{Y=a.sqrt(G)}catch(ue){const X=ue instanceof Error?": "+ue.message:"";throw new Error("bad point: is not on curve, sqrt error"+X)}m();const j=a.isOdd(Y);return(M&1)===1!==j&&(Y=a.neg(Y)),{x:$,y:Y}}else if(P===V&&M===4){const $=a.BYTES,G=a.fromBytes(q.subarray(0,$)),Y=a.fromBytes(q.subarray($,$*2));if(!S(G,Y))throw new Error("bad point: is not on curve");return{x:G,y:Y}}else throw new Error(`bad point: got length ${P}, expected compressed=${D} or uncompressed=${V}`)}const d=e.toBytes||B,y=e.fromBytes||v;function b(_){const D=a.sqr(_),V=a.mul(D,_);return a.add(a.add(V,a.mul(_,o.a)),o.b)}function S(_,D){const V=a.sqr(D),P=b(_);return a.eql(V,P)}if(!S(o.Gx,o.Gy))throw new Error("bad curve params: generator point");const f=a.mul(a.pow(o.a,Qr),Gc),g=a.mul(a.sqr(o.b),BigInt(27));if(a.is0(a.add(f,g)))throw new Error("bad curve params: a or b");function E(_,D,V=!1){if(!a.isValid(D)||V&&a.is0(D))throw new Error(`bad point coordinate ${_}`);return D}function w(_){if(!(_ instanceof T))throw new Error("Weierstrass Point expected")}function I(_){if(!u||!u.basises)throw new Error("no endo");return Hc(_,u.basises,c.ORDER)}const x=fn((_,D)=>{const{X:V,Y:P,Z:M}=_;if(a.eql(M,a.ONE))return{x:V,y:P};const q=_.is0();D==null&&(D=q?a.ONE:a.inv(M));const $=a.mul(V,D),G=a.mul(P,D),Y=a.mul(M,D);if(q)return{x:a.ZERO,y:a.ZERO};if(!a.eql(Y,a.ONE))throw new Error("invZ was invalid");return{x:$,y:G}}),h=fn(_=>{if(_.is0()){if(e.allowInfinityPoint&&!a.is0(_.Y))return;throw new Error("bad point: ZERO")}const{x:D,y:V}=_.toAffine();if(!a.isValid(D)||!a.isValid(V))throw new Error("bad point: x or y not field elements");if(!S(D,V))throw new Error("bad point: equation left != right");if(!_.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function s(_,D,V,P,M){return V=new T(a.mul(V.X,_),V.Y,V.Z),D=cn(P,D),V=cn(M,V),D.add(V)}class T{static BASE=new T(o.Gx,o.Gy,a.ONE);static ZERO=new T(a.ZERO,a.ONE,a.ZERO);static Fp=a;static Fn=c;X;Y;Z;constructor(D,V,P){this.X=E("x",D),this.Y=E("y",V,!0),this.Z=E("z",P),Object.freeze(this)}static CURVE(){return o}static fromAffine(D){const{x:V,y:P}=D||{};if(!D||!a.isValid(V)||!a.isValid(P))throw new Error("invalid affine point");if(D instanceof T)throw new Error("projective point not allowed");return a.is0(V)&&a.is0(P)?T.ZERO:new T(V,P,a.ONE)}static fromBytes(D){const V=T.fromAffine(y(de(D,void 0,"point")));return V.assertValidity(),V}static fromHex(D){return T.fromBytes(Rr(D))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(D=8,V=!0){return O.createCache(this,D),V||this.multiply(Qr),this}assertValidity(){h(this)}hasEvenY(){const{y:D}=this.toAffine();if(!a.isOdd)throw new Error("Field doesn't support isOdd");return!a.isOdd(D)}equals(D){w(D);const{X:V,Y:P,Z:M}=this,{X:q,Y:$,Z:G}=D,Y=a.eql(a.mul(V,G),a.mul(q,M)),j=a.eql(a.mul(P,G),a.mul($,M));return Y&&j}negate(){return new T(this.X,a.neg(this.Y),this.Z)}double(){const{a:D,b:V}=o,P=a.mul(V,Qr),{X:M,Y:q,Z:$}=this;let G=a.ZERO,Y=a.ZERO,j=a.ZERO,te=a.mul(M,M),ue=a.mul(q,q),X=a.mul($,$),re=a.mul(M,q);return re=a.add(re,re),j=a.mul(M,$),j=a.add(j,j),G=a.mul(D,j),Y=a.mul(P,X),Y=a.add(G,Y),G=a.sub(ue,Y),Y=a.add(ue,Y),Y=a.mul(G,Y),G=a.mul(re,G),j=a.mul(P,j),X=a.mul(D,X),re=a.sub(te,X),re=a.mul(D,re),re=a.add(re,j),j=a.add(te,te),te=a.add(j,te),te=a.add(te,X),te=a.mul(te,re),Y=a.add(Y,te),X=a.mul(q,$),X=a.add(X,X),te=a.mul(X,re),G=a.sub(G,te),j=a.mul(X,ue),j=a.add(j,j),j=a.add(j,j),new T(G,Y,j)}add(D){w(D);const{X:V,Y:P,Z:M}=this,{X:q,Y:$,Z:G}=D;let Y=a.ZERO,j=a.ZERO,te=a.ZERO;const ue=o.a,X=a.mul(o.b,Qr);let re=a.mul(V,q),W=a.mul(P,$),pe=a.mul(M,G),le=a.add(V,P),C=a.add(q,$);le=a.mul(le,C),C=a.add(re,W),le=a.sub(le,C),C=a.add(V,M);let U=a.add(q,G);return C=a.mul(C,U),U=a.add(re,pe),C=a.sub(C,U),U=a.add(P,M),Y=a.add($,G),U=a.mul(U,Y),Y=a.add(W,pe),U=a.sub(U,Y),te=a.mul(ue,C),Y=a.mul(X,pe),te=a.add(Y,te),Y=a.sub(W,te),te=a.add(W,te),j=a.mul(Y,te),W=a.add(re,re),W=a.add(W,re),pe=a.mul(ue,pe),C=a.mul(X,C),W=a.add(W,pe),pe=a.sub(re,pe),pe=a.mul(ue,pe),C=a.add(C,pe),re=a.mul(W,C),j=a.add(j,re),re=a.mul(U,C),Y=a.mul(le,Y),Y=a.sub(Y,re),re=a.mul(le,W),te=a.mul(U,te),te=a.add(te,re),new T(Y,j,te)}subtract(D){return this.add(D.negate())}is0(){return this.equals(T.ZERO)}multiply(D){const{endo:V}=e;if(!c.isValidNot0(D))throw new Error("invalid scalar: out of range");let P,M;const q=$=>O.cached(this,$,G=>wr(T,G));if(V){const{k1neg:$,k1:G,k2neg:Y,k2:j}=I(D),{p:te,f:ue}=q(G),{p:X,f:re}=q(j);M=ue.add(re),P=s(V.beta,te,X,$,Y)}else{const{p:$,f:G}=q(D);P=$,M=G}return wr(T,[P,M])[0]}multiplyUnsafe(D){const{endo:V}=e,P=this;if(!c.isValid(D))throw new Error("invalid scalar: out of range");if(D===Mt||P.is0())return T.ZERO;if(D===gr)return P;if(O.hasCache(this))return this.multiply(D);if(V){const{k1neg:M,k1:q,k2neg:$,k2:G}=I(D),{p1:Y,p2:j}=ac(T,P,q,G);return s(V.beta,Y,j,M,$)}else return O.unsafe(P,D)}toAffine(D){return x(this,D)}isTorsionFree(){const{isTorsionFree:D}=e;return i===gr?!0:D?D(T,this):O.unsafe(this,n).is0()}clearCofactor(){const{clearCofactor:D}=e;return i===gr?this:D?D(T,this):this.multiplyUnsafe(i)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}toBytes(D=!0){return ur(D,"isCompressed"),this.assertValidity(),d(T,this,D)}toHex(D=!0){return Or(this.toBytes(D))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const N=c.BITS,O=new eo(T,e.endo?Math.ceil(N/2):N);return T.BASE.precompute(8),T}function yo(t){return Uint8Array.of(t?2:3)}function go(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function zc(t,e={}){const{Fn:r}=t,a=e.randomBytes||Pa,c=Object.assign(go(t.Fp,r),{seed:Zs(r.ORDER)});function o(d){try{const y=r.fromBytes(d);return r.isValidNot0(y)}catch{return!1}}function i(d,y){const{publicKey:b,publicKeyUncompressed:S}=c;try{const f=d.length;return y===!0&&f!==b||y===!1&&f!==S?!1:!!t.fromBytes(d)}catch{return!1}}function n(d=a(c.seed)){return nc(de(d,c.seed,"seed"),r.ORDER)}function u(d,y=!0){return t.BASE.multiply(r.fromBytes(d)).toBytes(y)}function l(d){const{secretKey:y,publicKey:b,publicKeyUncompressed:S}=c;if(!dn(d)||"_lengths"in r&&r._lengths||y===b)return;const f=de(d,void 0,"key").length;return f===b||f===S}function m(d,y,b=!0){if(l(d)===!0)throw new Error("first arg must be private key");if(l(y)===!1)throw new Error("second arg must be public key");const S=r.fromBytes(d);return t.fromBytes(y).multiply(S).toBytes(b)}const B={isValidSecretKey:o,isValidPublicKey:i,randomSecretKey:n},v=ro(n,u);return Object.freeze({getPublicKey:u,getSharedSecret:m,keygen:v,Point:t,utils:B,lengths:c})}function En(t,e,r={}){Ns(e),Vr(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);const a=r.randomBytes||Pa,c=r.hmac||((V,P)=>ho(e,V,P)),{Fp:o,Fn:i}=t,{ORDER:n,BITS:u}=i,{keygen:l,getPublicKey:m,getSharedSecret:B,utils:v,lengths:d}=zc(t,r),y={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},b=n*po<o.ORDER;function S(V){const P=n>>gr;return V>P}function f(V,P){if(!i.isValidNot0(P))throw new Error(`invalid signature ${V}: out of range 1..Point.Fn.ORDER`);return P}function g(){if(b)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function E(V,P){Aa(P);const M=d.signature,q=P==="compact"?M:P==="recovered"?M+1:void 0;return de(V,q)}class w{r;s;recovery;constructor(P,M,q){if(this.r=f("r",P),this.s=f("s",M),q!=null){if(g(),![0,1,2,3].includes(q))throw new Error("invalid recovery id");this.recovery=q}Object.freeze(this)}static fromBytes(P,M=y.format){E(P,M);let q;if(M==="der"){const{r:j,s:te}=rr.toSig(de(P));return new w(j,te)}M==="recovered"&&(q=P[0],M="compact",P=P.subarray(1));const $=d.signature/2,G=P.subarray(0,$),Y=P.subarray($,$*2);return new w(i.fromBytes(G),i.fromBytes(Y),q)}static fromHex(P,M){return this.fromBytes(Rr(P),M)}assertRecovery(){const{recovery:P}=this;if(P==null)throw new Error("invalid recovery id: must be present");return P}addRecoveryBit(P){return new w(this.r,this.s,P)}recoverPublicKey(P){const{r:M,s:q}=this,$=this.assertRecovery(),G=$===2||$===3?M+n:M;if(!o.isValid(G))throw new Error("invalid recovery id: sig.r+curve.n != R.x");const Y=o.toBytes(G),j=t.fromBytes(Ct(yo(($&1)===0),Y)),te=i.inv(G),ue=x(de(P,void 0,"msgHash")),X=i.create(-ue*te),re=i.create(q*te),W=t.BASE.multiplyUnsafe(X).add(j.multiplyUnsafe(re));if(W.is0())throw new Error("invalid recovery: point at infinify");return W.assertValidity(),W}hasHighS(){return S(this.s)}toBytes(P=y.format){if(Aa(P),P==="der")return Rr(rr.hexFromSig(this));const{r:M,s:q}=this,$=i.toBytes(M),G=i.toBytes(q);return P==="recovered"?(g(),Ct(Uint8Array.of(this.assertRecovery()),$,G)):Ct($,G)}toHex(P){return Or(this.toBytes(P))}}const I=r.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const M=gn(P),q=P.length*8-u;return q>0?M>>BigInt(q):M},x=r.bits2int_modN||function(P){return i.create(I(P))},h=Va(u);function s(V){return wa("num < 2^"+u,V,Mt,h),i.toBytes(V)}function T(V,P){return de(V,void 0,"message"),P?de(e(V),void 0,"prehashed message"):V}function N(V,P,M){const{lowS:q,prehash:$,extraEntropy:G}=Un(M,y);V=T(V,$);const Y=x(V),j=i.fromBytes(P);if(!i.isValidNot0(j))throw new Error("invalid private key");const te=[s(j),s(Y)];if(G!=null&&G!==!1){const W=G===!0?a(d.secretKey):G;te.push(de(W,void 0,"extraEntropy"))}const ue=Ct(...te),X=Y;function re(W){const pe=I(W);if(!i.isValidNot0(pe))return;const le=i.inv(pe),C=t.BASE.multiply(pe).toAffine(),U=i.create(C.x);if(U===Mt)return;const k=i.create(le*i.create(X+U*j));if(k===Mt)return;let p=(C.x===U?0:2)|Number(C.y&gr),R=k;return q&&S(k)&&(R=i.neg(k),p^=1),new w(U,R,b?void 0:p)}return{seed:ue,k2sig:re}}function O(V,P,M={}){const{seed:q,k2sig:$}=N(V,P,M);return zf(e.outputLen,i.BYTES,c)(q,$).toBytes(M.format)}function _(V,P,M,q={}){const{lowS:$,prehash:G,format:Y}=Un(q,y);if(M=de(M,void 0,"publicKey"),P=T(P,G),!dn(V)){const j=V instanceof w?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+j)}E(V,Y);try{const j=w.fromBytes(V,Y),te=t.fromBytes(M);if($&&j.hasHighS())return!1;const{r:ue,s:X}=j,re=x(P),W=i.inv(X),pe=i.create(re*W),le=i.create(ue*W),C=t.BASE.multiplyUnsafe(pe).add(te.multiplyUnsafe(le));return C.is0()?!1:i.create(C.x)===ue}catch{return!1}}function D(V,P,M={}){const{prehash:q}=Un(M,y);return P=T(P,q),w.fromBytes(V,"recovered").recoverPublicKey(P).toBytes()}return Object.freeze({keygen:l,getPublicKey:m,getSharedSecret:B,utils:v,lengths:d,Point:t,sign:O,verify:_,recoverPublicKey:D,Signature:w,hash:e})}const $c={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Yc={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},vo={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Qc=mn($c),Xc=En(Qc,co),jc=mn(Yc),Zc=En(jc,Nc),Wc=lr(vo.n,{allowedLengths:[65,66]}),Jc=mn(vo,{Fn:Wc}),e0=En(Jc,uo);const Ha={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},t0={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Ei=BigInt(2);function r0(t){const e=Ha.p,r=BigInt(3),a=BigInt(6),c=BigInt(11),o=BigInt(22),i=BigInt(23),n=BigInt(44),u=BigInt(88),l=t*t*t%e,m=l*l*t%e,B=me(m,r,e)*m%e,v=me(B,r,e)*m%e,d=me(v,Ei,e)*l%e,y=me(d,c,e)*d%e,b=me(y,o,e)*y%e,S=me(b,n,e)*b%e,f=me(S,u,e)*S%e,g=me(f,n,e)*b%e,E=me(g,r,e)*m%e,w=me(E,i,e)*y%e,I=me(w,a,e)*l%e,x=me(I,Ei,e);if(!Ia.eql(Ia.sqr(x),t))throw new Error("Cannot find square root");return x}const Ia=lr(Ha.p,{sqrt:r0}),n0=mn(Ha,{Fp:Ia,endo:t0}),a0=En(n0,co);function At(t){return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}function Lr(t){const e=t.replace(/\s+/g,"");if(e.length%2!==0)throw new Error("Invalid hex string: length must be even");const r=new Uint8Array(e.length/2);for(let a=0;a<e.length;a+=2){const c=Number.parseInt(e.substring(a,a+2),16);if(Number.isNaN(c))throw new Error(`Invalid hex string: invalid character at position ${a}`);r[a/2]=c}return r}function i0(t){return t==="secp256k1"||t==="p256"||t==="p384"||t==="p521"}function xn(t){switch(t){case"secp256k1":return a0;case"p256":return Xc;case"p384":return Zc;case"p521":return e0;case"ed25519":return Mc;case"ed448":return Sc;default:throw new Error(`Unsupported curve: ${t}`)}}function s0(t="secp256k1"){const e=xn(t),r=e.utils.randomSecretKey(),a=e.getPublicKey(r);return{privateKey:At(r),publicKey:At(a),curve:t}}function mo(t,e,r="secp256k1"){try{const a=xn(r),c=Lr(e);if(r==="ed25519"||r==="ed448"){const u=a.sign(t,c),l=u instanceof Uint8Array?u:new Uint8Array(u);return{signature:At(l)}}const o=a.sign(t,c),i=o instanceof Uint8Array?o:new Uint8Array(o),n=At(i);return r==="secp256k1"&&typeof o=="object"&&"recovery"in o?{signature:n,recoveryId:o.recovery}:{signature:n}}catch(a){throw new Error(`ECDSA signing failed: ${a instanceof Error?a.message:String(a)}`)}}function Eo(t,e,r,a="secp256k1"){try{const c=xn(a),o=Lr(r),i=Lr(e);return c.verify(i,t,o)}catch(c){if(c instanceof Error&&c.message.includes("Invalid signature"))return!1;throw new Error(`ECDSA verification failed: ${c instanceof Error?c.message:String(c)}`)}}function o0(t,e,r="secp256k1"){try{const a=xn(r),c=Lr(t),o=Lr(e);if(!i0(r))throw new Error(`ECDH is not supported for ${r}`);const n=a.getSharedSecret(c,o);return{sharedSecret:At(n)}}catch(a){throw new Error(`ECDH computation failed: ${a instanceof Error?a.message:String(a)}`)}}function f0(t,e,r="ed25519"){return mo(t,e,r)}function c0(t,e,r,a="ed25519"){return Eo(t,e,r,a)}let fr=null,xi=!1;async function Fr(){if(!(xi&&fr))try{const t=(await Ce(async()=>{const{default:e}=await import("./ibe_wasm-PZD9s5Wd.js");return{default:e}},[])).default;fr=await t({module_or_path:new URL("/assets/ibe_wasm_bg-C_JPAl-h.wasm",import.meta.url).href}),fr.init(),xi=!0}catch(t){throw new Error(`Failed to initialize IBE WebAssembly module: ${t}`)}}async function u0(){if(await Fr(),!fr)throw new Error("IBE module not initialized");const{IBE:t}=await Ce(async()=>{const{IBE:r}=await import("./ibe_wasm-PZD9s5Wd.js");return{IBE:r}},[]),e=new t;try{const r=e.setup();if(r instanceof Error)throw r;const a=r.master_key,c=r.public_params;if(!a||!c)throw new Error("Failed to get master_key or public_params from setup result");return{masterKey:a,publicParams:c}}catch(r){throw new Error(`IBE setup failed: ${r}`)}}async function l0(t,e){if(await Fr(),!fr)throw new Error("IBE module not initialized");const{IBE:r}=await Ce(async()=>{const{IBE:c}=await import("./ibe_wasm-PZD9s5Wd.js");return{IBE:c}},[]),a=new r;try{return a.extract(t,e)}catch(c){throw new Error(`IBE extract failed: ${c}`)}}async function h0(t,e,r){if(await Fr(),!fr)throw new Error("IBE module not initialized");const{IBE:a}=await Ce(async()=>{const{IBE:o}=await import("./ibe_wasm-PZD9s5Wd.js");return{IBE:o}},[]),c=new a;try{return c.encrypt(t,e,r)}catch(o){throw new Error(`IBE encrypt failed: ${o}`)}}async function d0(t,e){if(await Fr(),!fr)throw new Error("IBE module not initialized");const{IBE:r}=await Ce(async()=>{const{IBE:c}=await import("./ibe_wasm-PZD9s5Wd.js");return{IBE:c}},[]),a=new r;try{return a.decrypt(t,e)}catch(c){throw new Error(`IBE decrypt failed: ${c}`)}}var p0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function y0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function g0(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var c=!1;try{c=this instanceof a}catch{}return c?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var c=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,c.get?c:{enumerable:!0,get:function(){return t[a]}})}),r}var Dn,Si;function ge(){return Si||(Si=1,Dn={options:{usePureJavaScript:!1}}),Dn}var Pn={exports:{}},On,Ci;function v0(){if(Ci)return On;Ci=1;var t={};On=t;var e={};t.encode=function(a,c,o){if(typeof c!="string")throw new TypeError('"alphabet" must be a string.');if(o!==void 0&&typeof o!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(a instanceof Uint8Array))i=r(a,c);else{var n=0,u=c.length,l=c.charAt(0),m=[0];for(n=0;n<a.length;++n){for(var B=0,v=a[n];B<m.length;++B)v+=m[B]<<8,m[B]=v%u,v=v/u|0;for(;v>0;)m.push(v%u),v=v/u|0}for(n=0;a[n]===0&&n<a.length-1;++n)i+=l;for(n=m.length-1;n>=0;--n)i+=c[m[n]]}if(o){var d=new RegExp(".{1,"+o+"}","g");i=i.match(d).join(`\r
`)}return i},t.decode=function(a,c){if(typeof a!="string")throw new TypeError('"input" must be a string.');if(typeof c!="string")throw new TypeError('"alphabet" must be a string.');var o=e[c];if(!o){o=e[c]=[];for(var i=0;i<c.length;++i)o[c.charCodeAt(i)]=i}a=a.replace(/\s/g,"");for(var n=c.length,u=c.charAt(0),l=[0],i=0;i<a.length;i++){var m=o[a.charCodeAt(i)];if(m===void 0)return;for(var B=0,v=m;B<l.length;++B)v+=l[B]*n,l[B]=v&255,v>>=8;for(;v>0;)l.push(v&255),v>>=8}for(var d=0;a[d]===u&&d<a.length-1;++d)l.push(0);return typeof Buffer<"u"?Buffer.from(l.reverse()):new Uint8Array(l.reverse())};function r(a,c){var o=0,i=c.length,n=c.charAt(0),u=[0];for(o=0;o<a.length();++o){for(var l=0,m=a.at(o);l<u.length;++l)m+=u[l]<<8,u[l]=m%i,m=m/i|0;for(;m>0;)u.push(m%i),m=m/i|0}var B="";for(o=0;a.at(o)===0&&o<a.length()-1;++o)B+=n;for(o=u.length-1;o>=0;--o)B+=c[u[o]];return B}return On}var bi;function Ee(){if(bi)return Pn.exports;bi=1;var t=ge(),e=v0(),r=Pn.exports=t.util=t.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){r.nextTick=process.nextTick,typeof setImmediate=="function"?r.setImmediate=setImmediate:r.setImmediate=r.nextTick;return}if(typeof setImmediate=="function"){r.setImmediate=function(){return setImmediate.apply(void 0,arguments)},r.nextTick=function(h){return setImmediate(h)};return}if(r.setImmediate=function(h){setTimeout(h,0)},typeof window<"u"&&typeof window.postMessage=="function"){let h=function(s){if(s.source===window&&s.data===f){s.stopPropagation();var T=g.slice();g.length=0,T.forEach(function(N){N()})}};var f="forge.setImmediate",g=[];r.setImmediate=function(s){g.push(s),g.length===1&&window.postMessage(f,"*")},window.addEventListener("message",h,!0)}if(typeof MutationObserver<"u"){var E=Date.now(),w=!0,I=document.createElement("div"),g=[];new MutationObserver(function(){var s=g.slice();g.length=0,s.forEach(function(T){T()})}).observe(I,{attributes:!0});var x=r.setImmediate;r.setImmediate=function(s){Date.now()-E>15?(E=Date.now(),x(s)):(g.push(s),g.length===1&&I.setAttribute("a",w=!w))}}r.nextTick=r.setImmediate})(),r.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,r.globalScope=(function(){return r.isNodejs?p0:typeof self>"u"?window:self})(),r.isArray=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"},r.isArrayBuffer=function(f){return typeof ArrayBuffer<"u"&&f instanceof ArrayBuffer},r.isArrayBufferView=function(f){return f&&r.isArrayBuffer(f.buffer)&&f.byteLength!==void 0};function a(f){if(!(f===8||f===16||f===24||f===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+f)}r.ByteBuffer=c;function c(f){if(this.data="",this.read=0,typeof f=="string")this.data=f;else if(r.isArrayBuffer(f)||r.isArrayBufferView(f))if(typeof Buffer<"u"&&f instanceof Buffer)this.data=f.toString("binary");else{var g=new Uint8Array(f);try{this.data=String.fromCharCode.apply(null,g)}catch{for(var E=0;E<g.length;++E)this.putByte(g[E])}}else(f instanceof c||typeof f=="object"&&typeof f.data=="string"&&typeof f.read=="number")&&(this.data=f.data,this.read=f.read);this._constructedStringLength=0}r.ByteStringBuffer=c;var o=4096;r.ByteStringBuffer.prototype._optimizeConstructedString=function(f){this._constructedStringLength+=f,this._constructedStringLength>o&&(this.data.substr(0,1),this._constructedStringLength=0)},r.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},r.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},r.ByteStringBuffer.prototype.putByte=function(f){return this.putBytes(String.fromCharCode(f))},r.ByteStringBuffer.prototype.fillWithByte=function(f,g){f=String.fromCharCode(f);for(var E=this.data;g>0;)g&1&&(E+=f),g>>>=1,g>0&&(f+=f);return this.data=E,this._optimizeConstructedString(g),this},r.ByteStringBuffer.prototype.putBytes=function(f){return this.data+=f,this._optimizeConstructedString(f.length),this},r.ByteStringBuffer.prototype.putString=function(f){return this.putBytes(r.encodeUtf8(f))},r.ByteStringBuffer.prototype.putInt16=function(f){return this.putBytes(String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},r.ByteStringBuffer.prototype.putInt24=function(f){return this.putBytes(String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},r.ByteStringBuffer.prototype.putInt32=function(f){return this.putBytes(String.fromCharCode(f>>24&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255))},r.ByteStringBuffer.prototype.putInt16Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255))},r.ByteStringBuffer.prototype.putInt24Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f>>16&255))},r.ByteStringBuffer.prototype.putInt32Le=function(f){return this.putBytes(String.fromCharCode(f&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>24&255))},r.ByteStringBuffer.prototype.putInt=function(f,g){a(g);var E="";do g-=8,E+=String.fromCharCode(f>>g&255);while(g>0);return this.putBytes(E)},r.ByteStringBuffer.prototype.putSignedInt=function(f,g){return f<0&&(f+=2<<g-1),this.putInt(f,g)},r.ByteStringBuffer.prototype.putBuffer=function(f){return this.putBytes(f.getBytes())},r.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},r.ByteStringBuffer.prototype.getInt16=function(){var f=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,f},r.ByteStringBuffer.prototype.getInt24=function(){var f=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,f},r.ByteStringBuffer.prototype.getInt32=function(){var f=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,f},r.ByteStringBuffer.prototype.getInt16Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,f},r.ByteStringBuffer.prototype.getInt24Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,f},r.ByteStringBuffer.prototype.getInt32Le=function(){var f=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,f},r.ByteStringBuffer.prototype.getInt=function(f){a(f);var g=0;do g=(g<<8)+this.data.charCodeAt(this.read++),f-=8;while(f>0);return g},r.ByteStringBuffer.prototype.getSignedInt=function(f){var g=this.getInt(f),E=2<<f-2;return g>=E&&(g-=E<<1),g},r.ByteStringBuffer.prototype.getBytes=function(f){var g;return f?(f=Math.min(this.length(),f),g=this.data.slice(this.read,this.read+f),this.read+=f):f===0?g="":(g=this.read===0?this.data:this.data.slice(this.read),this.clear()),g},r.ByteStringBuffer.prototype.bytes=function(f){return typeof f>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+f)},r.ByteStringBuffer.prototype.at=function(f){return this.data.charCodeAt(this.read+f)},r.ByteStringBuffer.prototype.setAt=function(f,g){return this.data=this.data.substr(0,this.read+f)+String.fromCharCode(g)+this.data.substr(this.read+f+1),this},r.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},r.ByteStringBuffer.prototype.copy=function(){var f=r.createBuffer(this.data);return f.read=this.read,f},r.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},r.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},r.ByteStringBuffer.prototype.truncate=function(f){var g=Math.max(0,this.length()-f);return this.data=this.data.substr(this.read,g),this.read=0,this},r.ByteStringBuffer.prototype.toHex=function(){for(var f="",g=this.read;g<this.data.length;++g){var E=this.data.charCodeAt(g);E<16&&(f+="0"),f+=E.toString(16)}return f},r.ByteStringBuffer.prototype.toString=function(){return r.decodeUtf8(this.bytes())};function i(f,g){g=g||{},this.read=g.readOffset||0,this.growSize=g.growSize||1024;var E=r.isArrayBuffer(f),w=r.isArrayBufferView(f);if(E||w){E?this.data=new DataView(f):this.data=new DataView(f.buffer,f.byteOffset,f.byteLength),this.write="writeOffset"in g?g.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,f!=null&&this.putBytes(f),"writeOffset"in g&&(this.write=g.writeOffset)}r.DataBuffer=i,r.DataBuffer.prototype.length=function(){return this.write-this.read},r.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},r.DataBuffer.prototype.accommodate=function(f,g){if(this.length()>=f)return this;g=Math.max(g||this.growSize,f);var E=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),w=new Uint8Array(this.length()+g);return w.set(E),this.data=new DataView(w.buffer),this},r.DataBuffer.prototype.putByte=function(f){return this.accommodate(1),this.data.setUint8(this.write++,f),this},r.DataBuffer.prototype.fillWithByte=function(f,g){this.accommodate(g);for(var E=0;E<g;++E)this.data.setUint8(f);return this},r.DataBuffer.prototype.putBytes=function(f,g){if(r.isArrayBufferView(f)){var E=new Uint8Array(f.buffer,f.byteOffset,f.byteLength),w=E.byteLength-E.byteOffset;this.accommodate(w);var I=new Uint8Array(this.data.buffer,this.write);return I.set(E),this.write+=w,this}if(r.isArrayBuffer(f)){var E=new Uint8Array(f);this.accommodate(E.byteLength);var I=new Uint8Array(this.data.buffer);return I.set(E,this.write),this.write+=E.byteLength,this}if(f instanceof r.DataBuffer||typeof f=="object"&&typeof f.read=="number"&&typeof f.write=="number"&&r.isArrayBufferView(f.data)){var E=new Uint8Array(f.data.byteLength,f.read,f.length());this.accommodate(E.byteLength);var I=new Uint8Array(f.data.byteLength,this.write);return I.set(E),this.write+=E.byteLength,this}if(f instanceof r.ByteStringBuffer&&(f=f.data,g="binary"),g=g||"binary",typeof f=="string"){var x;if(g==="hex")return this.accommodate(Math.ceil(f.length/2)),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.hex.decode(f,x,this.write),this;if(g==="base64")return this.accommodate(Math.ceil(f.length/4)*3),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.base64.decode(f,x,this.write),this;if(g==="utf8"&&(f=r.encodeUtf8(f),g="binary"),g==="binary"||g==="raw")return this.accommodate(f.length),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.raw.decode(x),this;if(g==="utf16")return this.accommodate(f.length*2),x=new Uint16Array(this.data.buffer,this.write),this.write+=r.text.utf16.encode(x),this;throw new Error("Invalid encoding: "+g)}throw Error("Invalid parameter: "+f)},r.DataBuffer.prototype.putBuffer=function(f){return this.putBytes(f),f.clear(),this},r.DataBuffer.prototype.putString=function(f){return this.putBytes(f,"utf16")},r.DataBuffer.prototype.putInt16=function(f){return this.accommodate(2),this.data.setInt16(this.write,f),this.write+=2,this},r.DataBuffer.prototype.putInt24=function(f){return this.accommodate(3),this.data.setInt16(this.write,f>>8&65535),this.data.setInt8(this.write,f>>16&255),this.write+=3,this},r.DataBuffer.prototype.putInt32=function(f){return this.accommodate(4),this.data.setInt32(this.write,f),this.write+=4,this},r.DataBuffer.prototype.putInt16Le=function(f){return this.accommodate(2),this.data.setInt16(this.write,f,!0),this.write+=2,this},r.DataBuffer.prototype.putInt24Le=function(f){return this.accommodate(3),this.data.setInt8(this.write,f>>16&255),this.data.setInt16(this.write,f>>8&65535,!0),this.write+=3,this},r.DataBuffer.prototype.putInt32Le=function(f){return this.accommodate(4),this.data.setInt32(this.write,f,!0),this.write+=4,this},r.DataBuffer.prototype.putInt=function(f,g){a(g),this.accommodate(g/8);do g-=8,this.data.setInt8(this.write++,f>>g&255);while(g>0);return this},r.DataBuffer.prototype.putSignedInt=function(f,g){return a(g),this.accommodate(g/8),f<0&&(f+=2<<g-1),this.putInt(f,g)},r.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},r.DataBuffer.prototype.getInt16=function(){var f=this.data.getInt16(this.read);return this.read+=2,f},r.DataBuffer.prototype.getInt24=function(){var f=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,f},r.DataBuffer.prototype.getInt32=function(){var f=this.data.getInt32(this.read);return this.read+=4,f},r.DataBuffer.prototype.getInt16Le=function(){var f=this.data.getInt16(this.read,!0);return this.read+=2,f},r.DataBuffer.prototype.getInt24Le=function(){var f=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,f},r.DataBuffer.prototype.getInt32Le=function(){var f=this.data.getInt32(this.read,!0);return this.read+=4,f},r.DataBuffer.prototype.getInt=function(f){a(f);var g=0;do g=(g<<8)+this.data.getInt8(this.read++),f-=8;while(f>0);return g},r.DataBuffer.prototype.getSignedInt=function(f){var g=this.getInt(f),E=2<<f-2;return g>=E&&(g-=E<<1),g},r.DataBuffer.prototype.getBytes=function(f){var g;return f?(f=Math.min(this.length(),f),g=this.data.slice(this.read,this.read+f),this.read+=f):f===0?g="":(g=this.read===0?this.data:this.data.slice(this.read),this.clear()),g},r.DataBuffer.prototype.bytes=function(f){return typeof f>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+f)},r.DataBuffer.prototype.at=function(f){return this.data.getUint8(this.read+f)},r.DataBuffer.prototype.setAt=function(f,g){return this.data.setUint8(f,g),this},r.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},r.DataBuffer.prototype.copy=function(){return new r.DataBuffer(this)},r.DataBuffer.prototype.compact=function(){if(this.read>0){var f=new Uint8Array(this.data.buffer,this.read),g=new Uint8Array(f.byteLength);g.set(f),this.data=new DataView(g),this.write-=this.read,this.read=0}return this},r.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},r.DataBuffer.prototype.truncate=function(f){return this.write=Math.max(0,this.length()-f),this.read=Math.min(this.read,this.write),this},r.DataBuffer.prototype.toHex=function(){for(var f="",g=this.read;g<this.data.byteLength;++g){var E=this.data.getUint8(g);E<16&&(f+="0"),f+=E.toString(16)}return f},r.DataBuffer.prototype.toString=function(f){var g=new Uint8Array(this.data,this.read,this.length());if(f=f||"utf8",f==="binary"||f==="raw")return r.binary.raw.encode(g);if(f==="hex")return r.binary.hex.encode(g);if(f==="base64")return r.binary.base64.encode(g);if(f==="utf8")return r.text.utf8.decode(g);if(f==="utf16")return r.text.utf16.decode(g);throw new Error("Invalid encoding: "+f)},r.createBuffer=function(f,g){return g=g||"raw",f!==void 0&&g==="utf8"&&(f=r.encodeUtf8(f)),new r.ByteBuffer(f)},r.fillString=function(f,g){for(var E="";g>0;)g&1&&(E+=f),g>>>=1,g>0&&(f+=f);return E},r.xorBytes=function(f,g,E){for(var w="",I="",x="",h=0,s=0;E>0;--E,++h)I=f.charCodeAt(h)^g.charCodeAt(h),s>=10&&(w+=x,x="",s=0),x+=String.fromCharCode(I),++s;return w+=x,w},r.hexToBytes=function(f){var g="",E=0;for(f.length&!0&&(E=1,g+=String.fromCharCode(parseInt(f[0],16)));E<f.length;E+=2)g+=String.fromCharCode(parseInt(f.substr(E,2),16));return g},r.bytesToHex=function(f){return r.createBuffer(f).toHex()},r.int32ToBytes=function(f){return String.fromCharCode(f>>24&255)+String.fromCharCode(f>>16&255)+String.fromCharCode(f>>8&255)+String.fromCharCode(f&255)};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";r.encode64=function(f,g){for(var E="",w="",I,x,h,s=0;s<f.length;)I=f.charCodeAt(s++),x=f.charCodeAt(s++),h=f.charCodeAt(s++),E+=n.charAt(I>>2),E+=n.charAt((I&3)<<4|x>>4),isNaN(x)?E+="==":(E+=n.charAt((x&15)<<2|h>>6),E+=isNaN(h)?"=":n.charAt(h&63)),g&&E.length>g&&(w+=E.substr(0,g)+`\r
`,E=E.substr(g));return w+=E,w},r.decode64=function(f){f=f.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var g="",E,w,I,x,h=0;h<f.length;)E=u[f.charCodeAt(h++)-43],w=u[f.charCodeAt(h++)-43],I=u[f.charCodeAt(h++)-43],x=u[f.charCodeAt(h++)-43],g+=String.fromCharCode(E<<2|w>>4),I!==64&&(g+=String.fromCharCode((w&15)<<4|I>>2),x!==64&&(g+=String.fromCharCode((I&3)<<6|x)));return g},r.encodeUtf8=function(f){return unescape(encodeURIComponent(f))},r.decodeUtf8=function(f){return decodeURIComponent(escape(f))},r.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},r.binary.raw.encode=function(f){return String.fromCharCode.apply(null,f)},r.binary.raw.decode=function(f,g,E){var w=g;w||(w=new Uint8Array(f.length)),E=E||0;for(var I=E,x=0;x<f.length;++x)w[I++]=f.charCodeAt(x);return g?I-E:w},r.binary.hex.encode=r.bytesToHex,r.binary.hex.decode=function(f,g,E){var w=g;w||(w=new Uint8Array(Math.ceil(f.length/2))),E=E||0;var I=0,x=E;for(f.length&1&&(I=1,w[x++]=parseInt(f[0],16));I<f.length;I+=2)w[x++]=parseInt(f.substr(I,2),16);return g?x-E:w},r.binary.base64.encode=function(f,g){for(var E="",w="",I,x,h,s=0;s<f.byteLength;)I=f[s++],x=f[s++],h=f[s++],E+=n.charAt(I>>2),E+=n.charAt((I&3)<<4|x>>4),isNaN(x)?E+="==":(E+=n.charAt((x&15)<<2|h>>6),E+=isNaN(h)?"=":n.charAt(h&63)),g&&E.length>g&&(w+=E.substr(0,g)+`\r
`,E=E.substr(g));return w+=E,w},r.binary.base64.decode=function(f,g,E){var w=g;w||(w=new Uint8Array(Math.ceil(f.length/4)*3)),f=f.replace(/[^A-Za-z0-9\+\/\=]/g,""),E=E||0;for(var I,x,h,s,T=0,N=E;T<f.length;)I=u[f.charCodeAt(T++)-43],x=u[f.charCodeAt(T++)-43],h=u[f.charCodeAt(T++)-43],s=u[f.charCodeAt(T++)-43],w[N++]=I<<2|x>>4,h!==64&&(w[N++]=(x&15)<<4|h>>2,s!==64&&(w[N++]=(h&3)<<6|s));return g?N-E:w.subarray(0,N)},r.binary.base58.encode=function(f,g){return r.binary.baseN.encode(f,l,g)},r.binary.base58.decode=function(f,g){return r.binary.baseN.decode(f,l,g)},r.text={utf8:{},utf16:{}},r.text.utf8.encode=function(f,g,E){f=r.encodeUtf8(f);var w=g;w||(w=new Uint8Array(f.length)),E=E||0;for(var I=E,x=0;x<f.length;++x)w[I++]=f.charCodeAt(x);return g?I-E:w},r.text.utf8.decode=function(f){return r.decodeUtf8(String.fromCharCode.apply(null,f))},r.text.utf16.encode=function(f,g,E){var w=g;w||(w=new Uint8Array(f.length*2));var I=new Uint16Array(w.buffer);E=E||0;for(var x=E,h=E,s=0;s<f.length;++s)I[h++]=f.charCodeAt(s),x+=2;return g?x-E:w},r.text.utf16.decode=function(f){return String.fromCharCode.apply(null,new Uint16Array(f.buffer))},r.deflate=function(f,g,E){if(g=r.decode64(f.deflate(r.encode64(g)).rval),E){var w=2,I=g.charCodeAt(1);I&32&&(w=6),g=g.substring(w,g.length-4)}return g},r.inflate=function(f,g,E){var w=f.inflate(r.encode64(g)).rval;return w===null?null:r.decode64(w)};var m=function(f,g,E){if(!f)throw new Error("WebStorage not available.");var w;if(E===null?w=f.removeItem(g):(E=r.encode64(JSON.stringify(E)),w=f.setItem(g,E)),typeof w<"u"&&w.rval!==!0){var I=new Error(w.error.message);throw I.id=w.error.id,I.name=w.error.name,I}},B=function(f,g){if(!f)throw new Error("WebStorage not available.");var E=f.getItem(g);if(f.init)if(E.rval===null){if(E.error){var w=new Error(E.error.message);throw w.id=E.error.id,w.name=E.error.name,w}E=null}else E=E.rval;return E!==null&&(E=JSON.parse(r.decode64(E))),E},v=function(f,g,E,w){var I=B(f,g);I===null&&(I={}),I[E]=w,m(f,g,I)},d=function(f,g,E){var w=B(f,g);return w!==null&&(w=E in w?w[E]:null),w},y=function(f,g,E){var w=B(f,g);if(w!==null&&E in w){delete w[E];var I=!0;for(var x in w){I=!1;break}I&&(w=null),m(f,g,w)}},b=function(f,g){m(f,g,null)},S=function(f,g,E){var w=null;typeof E>"u"&&(E=["web","flash"]);var I,x=!1,h=null;for(var s in E){I=E[s];try{if(I==="flash"||I==="both"){if(g[0]===null)throw new Error("Flash local storage not available.");w=f.apply(this,g),x=I==="flash"}(I==="web"||I==="both")&&(g[0]=localStorage,w=f.apply(this,g),x=!0)}catch(T){h=T}if(x)break}if(!x)throw h;return w};return r.setItem=function(f,g,E,w,I){S(v,arguments,I)},r.getItem=function(f,g,E,w){return S(d,arguments,w)},r.removeItem=function(f,g,E,w){S(y,arguments,w)},r.clearItems=function(f,g,E){S(b,arguments,E)},r.isEmpty=function(f){for(var g in f)if(f.hasOwnProperty(g))return!1;return!0},r.format=function(f){for(var g=/%./g,E,w,I=0,x=[],h=0;E=g.exec(f);){w=f.substring(h,g.lastIndex-2),w.length>0&&x.push(w),h=g.lastIndex;var s=E[0][1];switch(s){case"s":case"o":I<arguments.length?x.push(arguments[I+++1]):x.push("<?>");break;case"%":x.push("%");break;default:x.push("<%"+s+"?>")}}return x.push(f.substring(h)),x.join("")},r.formatNumber=function(f,g,E,w){var I=f,x=isNaN(g=Math.abs(g))?2:g,h=E===void 0?",":E,s=w===void 0?".":w,T=I<0?"-":"",N=parseInt(I=Math.abs(+I||0).toFixed(x),10)+"",O=N.length>3?N.length%3:0;return T+(O?N.substr(0,O)+s:"")+N.substr(O).replace(/(\d{3})(?=\d)/g,"$1"+s)+(x?h+Math.abs(I-N).toFixed(x).slice(2):"")},r.formatSize=function(f){return f>=1073741824?f=r.formatNumber(f/1073741824,2,".","")+" GiB":f>=1048576?f=r.formatNumber(f/1048576,2,".","")+" MiB":f>=1024?f=r.formatNumber(f/1024,0)+" KiB":f=r.formatNumber(f,0)+" bytes",f},r.bytesFromIP=function(f){return f.indexOf(".")!==-1?r.bytesFromIPv4(f):f.indexOf(":")!==-1?r.bytesFromIPv6(f):null},r.bytesFromIPv4=function(f){if(f=f.split("."),f.length!==4)return null;for(var g=r.createBuffer(),E=0;E<f.length;++E){var w=parseInt(f[E],10);if(isNaN(w))return null;g.putByte(w)}return g.getBytes()},r.bytesFromIPv6=function(f){var g=0;f=f.split(":").filter(function(h){return h.length===0&&++g,!0});for(var E=(8-f.length+g)*2,w=r.createBuffer(),I=0;I<8;++I){if(!f[I]||f[I].length===0){w.fillWithByte(0,E),E=0;continue}var x=r.hexToBytes(f[I]);x.length<2&&w.putByte(0),w.putBytes(x)}return w.getBytes()},r.bytesToIP=function(f){return f.length===4?r.bytesToIPv4(f):f.length===16?r.bytesToIPv6(f):null},r.bytesToIPv4=function(f){if(f.length!==4)return null;for(var g=[],E=0;E<f.length;++E)g.push(f.charCodeAt(E));return g.join(".")},r.bytesToIPv6=function(f){if(f.length!==16)return null;for(var g=[],E=[],w=0,I=0;I<f.length;I+=2){for(var x=r.bytesToHex(f[I]+f[I+1]);x[0]==="0"&&x!=="0";)x=x.substr(1);if(x==="0"){var h=E[E.length-1],s=g.length;!h||s!==h.end+1?E.push({start:s,end:s}):(h.end=s,h.end-h.start>E[w].end-E[w].start&&(w=E.length-1))}g.push(x)}if(E.length>0){var T=E[w];T.end-T.start>0&&(g.splice(T.start,T.end-T.start+1,""),T.start===0&&g.unshift(""),T.end===7&&g.push(""))}return g.join(":")},r.estimateCores=function(f,g){if(typeof f=="function"&&(g=f,f={}),f=f||{},"cores"in r&&!f.update)return g(null,r.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return r.cores=navigator.hardwareConcurrency,g(null,r.cores);if(typeof Worker>"u")return r.cores=1,g(null,r.cores);if(typeof Blob>"u")return r.cores=2,g(null,r.cores);var E=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(h){var s=Date.now(),T=s+4;self.postMessage({st:s,et:T})})}).toString(),")()"],{type:"application/javascript"}));w([],5,16);function w(h,s,T){if(s===0){var N=Math.floor(h.reduce(function(O,_){return O+_},0)/h.length);return r.cores=Math.max(1,N),URL.revokeObjectURL(E),g(null,r.cores)}I(T,function(O,_){h.push(x(T,_)),w(h,s-1,T)})}function I(h,s){for(var T=[],N=[],O=0;O<h;++O){var _=new Worker(E);_.addEventListener("message",function(D){if(N.push(D.data),N.length===h){for(var V=0;V<h;++V)T[V].terminate();s(null,N)}}),T.push(_)}for(var O=0;O<h;++O)T[O].postMessage(O)}function x(h,s){for(var T=[],N=0;N<h;++N)for(var O=s[N],_=T[N]=[],D=0;D<h;++D)if(N!==D){var V=s[D];(O.st>V.st&&O.st<V.et||V.st>O.st&&V.st<O.et)&&_.push(D)}return T.reduce(function(P,M){return Math.max(P,M.length)},0)}},Pn.exports}var Kn,Bi;function qa(){if(Bi)return Kn;Bi=1;var t=ge();Ee(),Kn=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(r,a){var c=r;if(typeof c=="string"&&(c=t.cipher.getAlgorithm(c),c&&(c=c())),!c)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:c,key:a,decrypt:!1})},t.cipher.createDecipher=function(r,a){var c=r;if(typeof c=="string"&&(c=t.cipher.getAlgorithm(c),c&&(c=c())),!c)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:c,key:a,decrypt:!0})},t.cipher.registerAlgorithm=function(r,a){r=r.toUpperCase(),t.cipher.algorithms[r]=a},t.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in t.cipher.algorithms?t.cipher.algorithms[r]:null};var e=t.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};return e.prototype.start=function(r){r=r||{};var a={};for(var c in r)a[c]=r[c];a.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=r.output||t.util.createBuffer(),this.mode.start(a)},e.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(c){return r(this.blockSize,c,!1)},this.mode.unpad=function(c){return r(this.blockSize,c,!0)});var a={};return a.decrypt=this._decrypt,a.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,a)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,a))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,a))},Kn}var Vn={exports:{}},Ti;function xo(){if(Ti)return Vn.exports;Ti=1;var t=ge();Ee(),t.cipher=t.cipher||{};var e=Vn.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(o){o=o||{},this.name="ECB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(o){},e.ecb.prototype.encrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u])},e.ecb.prototype.decrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u])},e.ecb.prototype.pad=function(o,i){var n=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();return o.fillWithByte(n,n),!0},e.ecb.prototype.unpad=function(o,i){if(i.overflow>0)return!1;var n=o.length(),u=o.at(n-1);return u>this.blockSize<<2?!1:(o.truncate(u),!0)},e.cbc=function(o){o=o||{},this.name="CBC",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(o){if(o.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in o)this._iv=r(o.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=this._prev[u]^o.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._prev[u]^this._outBlock[u]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(o,i){var n=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();return o.fillWithByte(n,n),!0},e.cbc.prototype.unpad=function(o,i){if(i.overflow>0)return!1;var n=o.length(),u=o.at(n-1);return u>this.blockSize<<2?!1:(o.truncate(u),!0)},e.cfb=function(o){o=o||{},this.name="CFB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var l=0;l<this._ints;++l)this._inBlock[l]=o.getInt32()^this._outBlock[l],i.putInt32(this._inBlock[l]);return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialBlock[l]=o.getInt32()^this._outBlock[l],this._partialOutput.putInt32(this._partialBlock[l]);if(m>0)o.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._partialBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var l=0;l<this._ints;++l)this._inBlock[l]=o.getInt32(),i.putInt32(this._inBlock[l]^this._outBlock[l]);return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialBlock[l]=o.getInt32(),this._partialOutput.putInt32(this._partialBlock[l]^this._outBlock[l]);if(m>0)o.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._partialBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.ofb=function(o){o=o||{},this.name="OFB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(o,i,n){var u=o.length();if(o.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var l=0;l<this._ints;++l)i.putInt32(o.getInt32()^this._outBlock[l]),this._inBlock[l]=this._outBlock[l];return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(o.getInt32()^this._outBlock[l]);if(m>0)o.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._outBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(o){o=o||{},this.name="CTR",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize)for(var l=0;l<this._ints;++l)i.putInt32(o.getInt32()^this._outBlock[l]);else{var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(o.getInt32()^this._outBlock[l]);if(m>0&&(o.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0}a(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(o){o=o||{},this.name="GCM",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");var i=t.util.createBuffer(o.iv);this._cipherLength=0;var n;if("additionalData"in o?n=t.util.createBuffer(o.additionalData):n=t.util.createBuffer(),"tagLength"in o?this._tagLength=o.tagLength:this._tagLength=128,this._tag=null,o.decrypt&&(this._tag=t.util.createBuffer(o.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var u=i.length();if(u===12)this._j0=[i.getInt32(),i.getInt32(),i.getInt32(),1];else{for(this._j0=[0,0,0,0];i.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[i.getInt32(),i.getInt32(),i.getInt32(),i.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(c(u*8)))}this._inBlock=this._j0.slice(0),a(this._inBlock),this._partialBytes=0,n=t.util.createBuffer(n),this._aDataLength=c(n.length()*8);var l=n.length()%this.blockSize;for(l&&n.fillWithByte(0,this.blockSize-l),this._s=[0,0,0,0];n.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()])},e.gcm.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var l=0;l<this._ints;++l)i.putInt32(this._outBlock[l]^=o.getInt32());this._cipherLength+=this.blockSize}else{var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(o.getInt32()^this._outBlock[l]);if(m<=0||n){if(n){var B=u%this.blockSize;this._cipherLength+=B,this._partialOutput.truncate(this.blockSize-B)}else this._cipherLength+=this.blockSize;for(var l=0;l<this._ints;++l)this._outBlock[l]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return o.read-=this.blockSize,i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),a(this._inBlock)},e.gcm.prototype.decrypt=function(o,i,n){var u=o.length();if(u<this.blockSize&&!(n&&u>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),a(this._inBlock),this._hashBlock[0]=o.getInt32(),this._hashBlock[1]=o.getInt32(),this._hashBlock[2]=o.getInt32(),this._hashBlock[3]=o.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var l=0;l<this._ints;++l)i.putInt32(this._outBlock[l]^this._hashBlock[l]);u<this.blockSize?this._cipherLength+=u%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(o,i){var n=!0;i.decrypt&&i.overflow&&o.truncate(this.blockSize-i.overflow),this.tag=t.util.createBuffer();var u=this._aDataLength.concat(c(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,u);var l=[];this.cipher.encrypt(this._j0,l);for(var m=0;m<this._ints;++m)this.tag.putInt32(this._s[m]^l[m]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),i.decrypt&&this.tag.bytes()!==this._tag&&(n=!1),n},e.gcm.prototype.multiply=function(o,i){for(var n=[0,0,0,0],u=i.slice(0),l=0;l<128;++l){var m=o[l/32|0]&1<<31-l%32;m&&(n[0]^=u[0],n[1]^=u[1],n[2]^=u[2],n[3]^=u[3]),this.pow(u,u)}return n},e.gcm.prototype.pow=function(o,i){for(var n=o[3]&1,u=3;u>0;--u)i[u]=o[u]>>>1|(o[u-1]&1)<<31;i[0]=o[0]>>>1,n&&(i[0]^=this._R)},e.gcm.prototype.tableMultiply=function(o){for(var i=[0,0,0,0],n=0;n<32;++n){var u=n/8|0,l=o[u]>>>(7-n%8)*4&15,m=this._m[n][l];i[0]^=m[0],i[1]^=m[1],i[2]^=m[2],i[3]^=m[3]}return i},e.gcm.prototype.ghash=function(o,i,n){return i[0]^=n[0],i[1]^=n[1],i[2]^=n[2],i[3]^=n[3],this.tableMultiply(i)},e.gcm.prototype.generateHashTable=function(o,i){for(var n=8/i,u=4*n,l=16*n,m=new Array(l),B=0;B<l;++B){var v=[0,0,0,0],d=B/u|0,y=(u-1-B%u)*i;v[d]=1<<i-1<<y,m[B]=this.generateSubHashTable(this.multiply(v,o),i)}return m},e.gcm.prototype.generateSubHashTable=function(o,i){var n=1<<i,u=n>>>1,l=new Array(n);l[u]=o.slice(0);for(var m=u>>>1;m>0;)this.pow(l[2*m],l[m]=[]),m>>=1;for(m=2;m<u;){for(var B=1;B<m;++B){var v=l[m],d=l[B];l[m+B]=[v[0]^d[0],v[1]^d[1],v[2]^d[2],v[3]^d[3]]}m*=2}for(l[0]=[0,0,0,0],m=u+1;m<n;++m){var y=l[m^u];l[m]=[o[0]^y[0],o[1]^y[1],o[2]^y[2],o[3]^y[3]]}return l};function r(o,i){if(typeof o=="string"&&(o=t.util.createBuffer(o)),t.util.isArray(o)&&o.length>4){var n=o;o=t.util.createBuffer();for(var u=0;u<n.length;++u)o.putByte(n[u])}if(o.length()<i)throw new Error("Invalid IV length; got "+o.length()+" bytes and expected "+i+" bytes.");if(!t.util.isArray(o)){for(var l=[],m=i/4,u=0;u<m;++u)l.push(o.getInt32());o=l}return o}function a(o){o[o.length-1]=o[o.length-1]+1&4294967295}function c(o){return[o/4294967296|0,o&4294967295]}return Vn.exports}var Fn,wi;function hr(){if(wi)return Fn;wi=1;var t=ge();qa(),xo(),Ee(),Fn=t.aes=t.aes||{},t.aes.startEncrypting=function(d,y,b,S){var f=v({key:d,output:b,decrypt:!1,mode:S});return f.start(y),f},t.aes.createEncryptionCipher=function(d,y){return v({key:d,output:null,decrypt:!1,mode:y})},t.aes.startDecrypting=function(d,y,b,S){var f=v({key:d,output:b,decrypt:!0,mode:S});return f.start(y),f},t.aes.createDecryptionCipher=function(d,y){return v({key:d,output:null,decrypt:!0,mode:y})},t.aes.Algorithm=function(d,y){r||l();var b=this;b.name=d,b.mode=new y({blockSize:16,cipher:{encrypt:function(S,f){return B(b._w,S,f,!1)},decrypt:function(S,f){return B(b._w,S,f,!0)}}}),b._init=!1},t.aes.Algorithm.prototype.initialize=function(d){if(!this._init){var y=d.key,b;if(typeof y=="string"&&(y.length===16||y.length===24||y.length===32))y=t.util.createBuffer(y);else if(t.util.isArray(y)&&(y.length===16||y.length===24||y.length===32)){b=y,y=t.util.createBuffer();for(var S=0;S<b.length;++S)y.putByte(b[S])}if(!t.util.isArray(y)){b=y,y=[];var f=b.length();if(f===16||f===24||f===32){f=f>>>2;for(var S=0;S<f;++S)y.push(b.getInt32())}}if(!t.util.isArray(y)||!(y.length===4||y.length===6||y.length===8))throw new Error("Invalid key parameter.");var g=this.mode.name,E=["CFB","OFB","CTR","GCM"].indexOf(g)!==-1;this._w=m(y,d.decrypt&&!E),this._init=!0}},t.aes._expandKey=function(d,y){return r||l(),m(d,y)},t.aes._updateBlock=B,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(d,y){var b=function(){return new t.aes.Algorithm(d,y)};t.cipher.registerAlgorithm(d,b)}var r=!1,a=4,c,o,i,n,u;function l(){r=!0,i=[0,1,2,4,8,16,32,64,128,27,54];for(var d=new Array(256),y=0;y<128;++y)d[y]=y<<1,d[y+128]=y+128<<1^283;c=new Array(256),o=new Array(256),n=new Array(4),u=new Array(4);for(var y=0;y<4;++y)n[y]=new Array(256),u[y]=new Array(256);for(var b=0,S=0,f,g,E,w,I,x,h,y=0;y<256;++y){w=S^S<<1^S<<2^S<<3^S<<4,w=w>>8^w&255^99,c[b]=w,o[w]=b,I=d[w],f=d[b],g=d[f],E=d[g],x=I<<24^w<<16^w<<8^(w^I),h=(f^g^E)<<24^(b^E)<<16^(b^g^E)<<8^(b^f^E);for(var s=0;s<4;++s)n[s][b]=x,u[s][w]=h,x=x<<24|x>>>8,h=h<<24|h>>>8;b===0?b=S=1:(b=f^d[d[d[f^E]]],S^=d[d[S]])}}function m(d,y){for(var b=d.slice(0),S,f=1,g=b.length,E=g+6+1,w=a*E,I=g;I<w;++I)S=b[I-1],I%g===0?(S=c[S>>>16&255]<<24^c[S>>>8&255]<<16^c[S&255]<<8^c[S>>>24]^i[f]<<24,f++):g>6&&I%g===4&&(S=c[S>>>24]<<24^c[S>>>16&255]<<16^c[S>>>8&255]<<8^c[S&255]),b[I]=b[I-g]^S;if(y){var x,h=u[0],s=u[1],T=u[2],N=u[3],O=b.slice(0);w=b.length;for(var I=0,_=w-a;I<w;I+=a,_-=a)if(I===0||I===w-a)O[I]=b[_],O[I+1]=b[_+3],O[I+2]=b[_+2],O[I+3]=b[_+1];else for(var D=0;D<a;++D)x=b[_+D],O[I+(3&-D)]=h[c[x>>>24]]^s[c[x>>>16&255]]^T[c[x>>>8&255]]^N[c[x&255]];b=O}return b}function B(d,y,b,S){var f=d.length/4-1,g,E,w,I,x;S?(g=u[0],E=u[1],w=u[2],I=u[3],x=o):(g=n[0],E=n[1],w=n[2],I=n[3],x=c);var h,s,T,N,O,_,D;h=y[0]^d[0],s=y[S?3:1]^d[1],T=y[2]^d[2],N=y[S?1:3]^d[3];for(var V=3,P=1;P<f;++P)O=g[h>>>24]^E[s>>>16&255]^w[T>>>8&255]^I[N&255]^d[++V],_=g[s>>>24]^E[T>>>16&255]^w[N>>>8&255]^I[h&255]^d[++V],D=g[T>>>24]^E[N>>>16&255]^w[h>>>8&255]^I[s&255]^d[++V],N=g[N>>>24]^E[h>>>16&255]^w[s>>>8&255]^I[T&255]^d[++V],h=O,s=_,T=D;b[0]=x[h>>>24]<<24^x[s>>>16&255]<<16^x[T>>>8&255]<<8^x[N&255]^d[++V],b[S?3:1]=x[s>>>24]<<24^x[T>>>16&255]<<16^x[N>>>8&255]<<8^x[h&255]^d[++V],b[2]=x[T>>>24]<<24^x[N>>>16&255]<<16^x[h>>>8&255]<<8^x[s&255]^d[++V],b[S?1:3]=x[N>>>24]<<24^x[h>>>16&255]<<16^x[s>>>8&255]<<8^x[T&255]^d[++V]}function v(d){d=d||{};var y=(d.mode||"CBC").toUpperCase(),b="AES-"+y,S;d.decrypt?S=t.cipher.createDecipher(b,d.key):S=t.cipher.createCipher(b,d.key);var f=S.start;return S.start=function(g,E){var w=null;E instanceof t.util.ByteBuffer&&(w=E,E={}),E=E||{},E.output=w,E.iv=g,f.call(S,E)},S}return Fn}var Mn={exports:{}},Hn={exports:{}},qn={exports:{}},Ai;function dr(){if(Ai)return qn.exports;Ai=1;var t=ge();t.pki=t.pki||{};var e=qn.exports=t.pki.oids=t.oids=t.oids||{};function r(c,o){e[c]=o,e[o]=c}function a(c,o){e[c]=o}return r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("1.3.14.3.2.29","sha1WithRSASignature"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("2.16.840.1.101.3.4.2.4","sha224"),r("2.16.840.1.101.3.4.2.5","sha512-224"),r("2.16.840.1.101.3.4.2.6","sha512-256"),r("1.2.840.113549.2.2","md2"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.4","surname"),r("2.5.4.5","serialNumber"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.12","title"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("2.5.4.42","givenName"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),a("2.5.29.1","authorityKeyIdentifier"),a("2.5.29.2","keyAttributes"),a("2.5.29.3","certificatePolicies"),a("2.5.29.4","keyUsageRestriction"),a("2.5.29.5","policyMapping"),a("2.5.29.6","subtreesConstraint"),a("2.5.29.7","subjectAltName"),a("2.5.29.8","issuerAltName"),a("2.5.29.9","subjectDirectoryAttributes"),a("2.5.29.10","basicConstraints"),a("2.5.29.11","nameConstraints"),a("2.5.29.12","policyConstraints"),a("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),a("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),a("2.5.29.20","cRLNumber"),a("2.5.29.21","cRLReason"),a("2.5.29.22","expirationDate"),a("2.5.29.23","instructionCode"),a("2.5.29.24","invalidityDate"),a("2.5.29.25","cRLDistributionPoints"),a("2.5.29.26","issuingDistributionPoint"),a("2.5.29.27","deltaCRLIndicator"),a("2.5.29.28","issuingDistributionPoint"),a("2.5.29.29","certificateIssuer"),a("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),a("2.5.29.33","policyMappings"),a("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),a("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),a("2.5.29.46","freshestCRL"),a("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping"),qn.exports}var Ii;function kt(){if(Ii)return Hn.exports;Ii=1;var t=ge();Ee(),dr();var e=Hn.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(i,n,u,l,m){if(t.util.isArray(l)){for(var B=[],v=0;v<l.length;++v)l[v]!==void 0&&B.push(l[v]);l=B}var d={tagClass:i,type:n,constructed:u,composed:u||t.util.isArray(l),value:l};return m&&"bitStringContents"in m&&(d.bitStringContents=m.bitStringContents,d.original=e.copy(d)),d},e.copy=function(i,n){var u;if(t.util.isArray(i)){u=[];for(var l=0;l<i.length;++l)u.push(e.copy(i[l],n));return u}return typeof i=="string"?i:(u={tagClass:i.tagClass,type:i.type,constructed:i.constructed,composed:i.composed,value:e.copy(i.value,n)},n&&!n.excludeBitStringContents&&(u.bitStringContents=i.bitStringContents),u)},e.equals=function(i,n,u){if(t.util.isArray(i)){if(!t.util.isArray(n)||i.length!==n.length)return!1;for(var l=0;l<i.length;++l)if(!e.equals(i[l],n[l]))return!1;return!0}if(typeof i!=typeof n)return!1;if(typeof i=="string")return i===n;var m=i.tagClass===n.tagClass&&i.type===n.type&&i.constructed===n.constructed&&i.composed===n.composed&&e.equals(i.value,n.value);return u&&u.includeBitStringContents&&(m=m&&i.bitStringContents===n.bitStringContents),m},e.getBerValueLength=function(i){var n=i.getByte();if(n!==128){var u,l=n&128;return l?u=i.getInt((n&127)<<3):u=n,u}};function r(i,n,u){if(u>n){var l=new Error("Too few bytes to parse DER.");throw l.available=i.length(),l.remaining=n,l.requested=u,l}}var a=function(i,n){var u=i.getByte();if(n--,u!==128){var l,m=u&128;if(!m)l=u;else{var B=u&127;r(i,n,B),l=i.getInt(B<<3)}if(l<0)throw new Error("Negative length: "+l);return l}};e.fromDer=function(i,n){n===void 0&&(n={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof n=="boolean"&&(n={strict:n,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in n||(n.strict=!0),"parseAllBytes"in n||(n.parseAllBytes=!0),"decodeBitStrings"in n||(n.decodeBitStrings=!0),typeof i=="string"&&(i=t.util.createBuffer(i));var u=i.length(),l=c(i,i.length(),0,n);if(n.parseAllBytes&&i.length()!==0){var m=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw m.byteCount=u,m.remaining=i.length(),m}return l};function c(i,n,u,l){var m;r(i,n,2);var B=i.getByte();n--;var v=B&192,d=B&31;m=i.length();var y=a(i,n);if(n-=m-i.length(),y!==void 0&&y>n){if(l.strict){var b=new Error("Too few bytes to read ASN.1 value.");throw b.available=i.length(),b.remaining=n,b.requested=y,b}y=n}var S,f,g=(B&32)===32;if(g)if(S=[],y===void 0)for(;;){if(r(i,n,2),i.bytes(2)==="\0\0"){i.getBytes(2),n-=2;break}m=i.length(),S.push(c(i,n,u+1,l)),n-=m-i.length()}else for(;y>0;)m=i.length(),S.push(c(i,y,u+1,l)),n-=m-i.length(),y-=m-i.length();if(S===void 0&&v===e.Class.UNIVERSAL&&d===e.Type.BITSTRING&&(f=i.bytes(y)),S===void 0&&l.decodeBitStrings&&v===e.Class.UNIVERSAL&&d===e.Type.BITSTRING&&y>1){var E=i.read,w=n,I=0;if(d===e.Type.BITSTRING&&(r(i,n,1),I=i.getByte(),n--),I===0)try{m=i.length();var x={strict:!0,decodeBitStrings:!0},h=c(i,n,u+1,x),s=m-i.length();n-=s,d==e.Type.BITSTRING&&s++;var T=h.tagClass;s===y&&(T===e.Class.UNIVERSAL||T===e.Class.CONTEXT_SPECIFIC)&&(S=[h])}catch{}S===void 0&&(i.read=E,n=w)}if(S===void 0){if(y===void 0){if(l.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");y=n}if(d===e.Type.BMPSTRING)for(S="";y>0;y-=2)r(i,n,2),S+=String.fromCharCode(i.getInt16()),n-=2;else S=i.getBytes(y),n-=y}var N=f===void 0?null:{bitStringContents:f};return e.create(v,d,g,S,N)}e.toDer=function(i){var n=t.util.createBuffer(),u=i.tagClass|i.type,l=t.util.createBuffer(),m=!1;if("bitStringContents"in i&&(m=!0,i.original&&(m=e.equals(i,i.original))),m)l.putBytes(i.bitStringContents);else if(i.composed){i.constructed?u|=32:l.putByte(0);for(var B=0;B<i.value.length;++B)i.value[B]!==void 0&&l.putBuffer(e.toDer(i.value[B]))}else if(i.type===e.Type.BMPSTRING)for(var B=0;B<i.value.length;++B)l.putInt16(i.value.charCodeAt(B));else i.type===e.Type.INTEGER&&i.value.length>1&&(i.value.charCodeAt(0)===0&&(i.value.charCodeAt(1)&128)===0||i.value.charCodeAt(0)===255&&(i.value.charCodeAt(1)&128)===128)?l.putBytes(i.value.substr(1)):l.putBytes(i.value);if(n.putByte(u),l.length()<=127)n.putByte(l.length()&127);else{var v=l.length(),d="";do d+=String.fromCharCode(v&255),v=v>>>8;while(v>0);n.putByte(d.length|128);for(var B=d.length-1;B>=0;--B)n.putByte(d.charCodeAt(B))}return n.putBuffer(l),n},e.oidToDer=function(i){var n=i.split("."),u=t.util.createBuffer();u.putByte(40*parseInt(n[0],10)+parseInt(n[1],10));for(var l,m,B,v,d=2;d<n.length;++d){l=!0,m=[],B=parseInt(n[d],10);do v=B&127,B=B>>>7,l||(v|=128),m.push(v),l=!1;while(B>0);for(var y=m.length-1;y>=0;--y)u.putByte(m[y])}return u},e.derToOid=function(i){var n;typeof i=="string"&&(i=t.util.createBuffer(i));var u=i.getByte();n=Math.floor(u/40)+"."+u%40;for(var l=0;i.length()>0;)u=i.getByte(),l=l<<7,u&128?l+=u&127:(n+="."+(l+u),l=0);return n},e.utcTimeToDate=function(i){var n=new Date,u=parseInt(i.substr(0,2),10);u=u>=50?1900+u:2e3+u;var l=parseInt(i.substr(2,2),10)-1,m=parseInt(i.substr(4,2),10),B=parseInt(i.substr(6,2),10),v=parseInt(i.substr(8,2),10),d=0;if(i.length>11){var y=i.charAt(10),b=10;y!=="+"&&y!=="-"&&(d=parseInt(i.substr(10,2),10),b+=2)}if(n.setUTCFullYear(u,l,m),n.setUTCHours(B,v,d,0),b&&(y=i.charAt(b),y==="+"||y==="-")){var S=parseInt(i.substr(b+1,2),10),f=parseInt(i.substr(b+4,2),10),g=S*60+f;g*=6e4,y==="+"?n.setTime(+n-g):n.setTime(+n+g)}return n},e.generalizedTimeToDate=function(i){var n=new Date,u=parseInt(i.substr(0,4),10),l=parseInt(i.substr(4,2),10)-1,m=parseInt(i.substr(6,2),10),B=parseInt(i.substr(8,2),10),v=parseInt(i.substr(10,2),10),d=parseInt(i.substr(12,2),10),y=0,b=0,S=!1;i.charAt(i.length-1)==="Z"&&(S=!0);var f=i.length-5,g=i.charAt(f);if(g==="+"||g==="-"){var E=parseInt(i.substr(f+1,2),10),w=parseInt(i.substr(f+4,2),10);b=E*60+w,b*=6e4,g==="+"&&(b*=-1),S=!0}return i.charAt(14)==="."&&(y=parseFloat(i.substr(14),10)*1e3),S?(n.setUTCFullYear(u,l,m),n.setUTCHours(B,v,d,y),n.setTime(+n+b)):(n.setFullYear(u,l,m),n.setHours(B,v,d,y)),n},e.dateToUtcTime=function(i){if(typeof i=="string")return i;var n="",u=[];u.push((""+i.getUTCFullYear()).substr(2)),u.push(""+(i.getUTCMonth()+1)),u.push(""+i.getUTCDate()),u.push(""+i.getUTCHours()),u.push(""+i.getUTCMinutes()),u.push(""+i.getUTCSeconds());for(var l=0;l<u.length;++l)u[l].length<2&&(n+="0"),n+=u[l];return n+="Z",n},e.dateToGeneralizedTime=function(i){if(typeof i=="string")return i;var n="",u=[];u.push(""+i.getUTCFullYear()),u.push(""+(i.getUTCMonth()+1)),u.push(""+i.getUTCDate()),u.push(""+i.getUTCHours()),u.push(""+i.getUTCMinutes()),u.push(""+i.getUTCSeconds());for(var l=0;l<u.length;++l)u[l].length<2&&(n+="0"),n+=u[l];return n+="Z",n},e.integerToDer=function(i){var n=t.util.createBuffer();if(i>=-128&&i<128)return n.putSignedInt(i,8);if(i>=-32768&&i<32768)return n.putSignedInt(i,16);if(i>=-8388608&&i<8388608)return n.putSignedInt(i,24);if(i>=-2147483648&&i<2147483648)return n.putSignedInt(i,32);var u=new Error("Integer too large; max is 32-bits.");throw u.integer=i,u},e.derToInteger=function(i){typeof i=="string"&&(i=t.util.createBuffer(i));var n=i.length()*8;if(n>32)throw new Error("Integer too large; max is 32-bits.");return i.getSignedInt(n)},e.validate=function(i,n,u,l){var m=!1;if((i.tagClass===n.tagClass||typeof n.tagClass>"u")&&(i.type===n.type||typeof n.type>"u"))if(i.constructed===n.constructed||typeof n.constructed>"u"){if(m=!0,n.value&&t.util.isArray(n.value))for(var B=0,v=0;m&&v<n.value.length;++v)m=n.value[v].optional||!1,i.value[B]&&(m=e.validate(i.value[B],n.value[v],u,l),m?++B:n.value[v].optional&&(m=!0)),!m&&l&&l.push("["+n.name+'] Tag class "'+n.tagClass+'", type "'+n.type+'" expected value length "'+n.value.length+'", got "'+i.value.length+'"');if(m&&u&&(n.capture&&(u[n.capture]=i.value),n.captureAsn1&&(u[n.captureAsn1]=i),n.captureBitStringContents&&"bitStringContents"in i&&(u[n.captureBitStringContents]=i.bitStringContents),n.captureBitStringValue&&"bitStringContents"in i))if(i.bitStringContents.length<2)u[n.captureBitStringValue]="";else{var d=i.bitStringContents.charCodeAt(0);if(d!==0)throw new Error("captureBitStringValue only supported for zero unused bits");u[n.captureBitStringValue]=i.bitStringContents.slice(1)}}else l&&l.push("["+n.name+'] Expected constructed "'+n.constructed+'", got "'+i.constructed+'"');else l&&(i.tagClass!==n.tagClass&&l.push("["+n.name+'] Expected tag class "'+n.tagClass+'", got "'+i.tagClass+'"'),i.type!==n.type&&l.push("["+n.name+'] Expected type "'+n.type+'", got "'+i.type+'"'));return m};var o=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(i,n,u){var l="";n=n||0,u=u||2,n>0&&(l+=`
`);for(var m="",B=0;B<n*u;++B)m+=" ";switch(l+=m+"Tag: ",i.tagClass){case e.Class.UNIVERSAL:l+="Universal:";break;case e.Class.APPLICATION:l+="Application:";break;case e.Class.CONTEXT_SPECIFIC:l+="Context-Specific:";break;case e.Class.PRIVATE:l+="Private:";break}if(i.tagClass===e.Class.UNIVERSAL)switch(l+=i.type,i.type){case e.Type.NONE:l+=" (None)";break;case e.Type.BOOLEAN:l+=" (Boolean)";break;case e.Type.INTEGER:l+=" (Integer)";break;case e.Type.BITSTRING:l+=" (Bit string)";break;case e.Type.OCTETSTRING:l+=" (Octet string)";break;case e.Type.NULL:l+=" (Null)";break;case e.Type.OID:l+=" (Object Identifier)";break;case e.Type.ODESC:l+=" (Object Descriptor)";break;case e.Type.EXTERNAL:l+=" (External or Instance of)";break;case e.Type.REAL:l+=" (Real)";break;case e.Type.ENUMERATED:l+=" (Enumerated)";break;case e.Type.EMBEDDED:l+=" (Embedded PDV)";break;case e.Type.UTF8:l+=" (UTF8)";break;case e.Type.ROID:l+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:l+=" (Sequence)";break;case e.Type.SET:l+=" (Set)";break;case e.Type.PRINTABLESTRING:l+=" (Printable String)";break;case e.Type.IA5String:l+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:l+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:l+=" (Generalized time)";break;case e.Type.BMPSTRING:l+=" (BMP String)";break}else l+=i.type;if(l+=`
`,l+=m+"Constructed: "+i.constructed+`
`,i.composed){for(var v=0,d="",B=0;B<i.value.length;++B)i.value[B]!==void 0&&(v+=1,d+=e.prettyPrint(i.value[B],n+1,u),B+1<i.value.length&&(d+=","));l+=m+"Sub values: "+v+d}else{if(l+=m+"Value: ",i.type===e.Type.OID){var y=e.derToOid(i.value);l+=y,t.pki&&t.pki.oids&&y in t.pki.oids&&(l+=" ("+t.pki.oids[y]+") ")}if(i.type===e.Type.INTEGER)try{l+=e.derToInteger(i.value)}catch{l+="0x"+t.util.bytesToHex(i.value)}else if(i.type===e.Type.BITSTRING){if(i.value.length>1?l+="0x"+t.util.bytesToHex(i.value.slice(1)):l+="(none)",i.value.length>0){var b=i.value.charCodeAt(0);b==1?l+=" (1 unused bit shown)":b>1&&(l+=" ("+b+" unused bits shown)")}}else if(i.type===e.Type.OCTETSTRING)o.test(i.value)||(l+="("+i.value+") "),l+="0x"+t.util.bytesToHex(i.value);else if(i.type===e.Type.UTF8)try{l+=t.util.decodeUtf8(i.value)}catch(S){if(S.message==="URI malformed")l+="0x"+t.util.bytesToHex(i.value)+" (malformed UTF8)";else throw S}else i.type===e.Type.PRINTABLESTRING||i.type===e.Type.IA5String?l+=i.value:o.test(i.value)?l+="0x"+t.util.bytesToHex(i.value):i.value.length===0?l+="[null]":l+=i.value}return l},Hn.exports}var Gn={exports:{}},zn,_i;function qt(){if(_i)return zn;_i=1;var t=ge();return zn=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},zn}var Ri;function Mr(){if(Ri)return Gn.exports;Ri=1;var t=ge();qt(),Ee();var e=Gn.exports=t.hmac=t.hmac||{};return e.create=function(){var r=null,a=null,c=null,o=null,i={};return i.start=function(n,u){if(n!==null)if(typeof n=="string")if(n=n.toLowerCase(),n in t.md.algorithms)a=t.md.algorithms[n].create();else throw new Error('Unknown hash algorithm "'+n+'"');else a=n;if(u===null)u=r;else{if(typeof u=="string")u=t.util.createBuffer(u);else if(t.util.isArray(u)){var l=u;u=t.util.createBuffer();for(var m=0;m<l.length;++m)u.putByte(l[m])}var B=u.length();B>a.blockLength&&(a.start(),a.update(u.bytes()),u=a.digest()),c=t.util.createBuffer(),o=t.util.createBuffer(),B=u.length();for(var m=0;m<B;++m){var l=u.at(m);c.putByte(54^l),o.putByte(92^l)}if(B<a.blockLength)for(var l=a.blockLength-B,m=0;m<l;++m)c.putByte(54),o.putByte(92);r=u,c=c.bytes(),o=o.bytes()}a.start(),a.update(c)},i.update=function(n){a.update(n)},i.getMac=function(){var n=a.digest().bytes();return a.start(),a.update(o),a.update(n),a.digest()},i.digest=i.getMac,i},Gn.exports}var $n={exports:{}},Ni;function Ga(){if(Ni)return $n.exports;Ni=1;var t=ge();qt(),Ee();var e=$n.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){i||n();var l=null,m=t.util.createBuffer(),B=new Array(16),v={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return v.start=function(){v.messageLength=0,v.fullMessageLength=v.messageLength64=[];for(var d=v.messageLengthSize/4,y=0;y<d;++y)v.fullMessageLength.push(0);return m=t.util.createBuffer(),l={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},v},v.start(),v.update=function(d,y){y==="utf8"&&(d=t.util.encodeUtf8(d));var b=d.length;v.messageLength+=b,b=[b/4294967296>>>0,b>>>0];for(var S=v.fullMessageLength.length-1;S>=0;--S)v.fullMessageLength[S]+=b[1],b[1]=b[0]+(v.fullMessageLength[S]/4294967296>>>0),v.fullMessageLength[S]=v.fullMessageLength[S]>>>0,b[0]=b[1]/4294967296>>>0;return m.putBytes(d),u(l,B,m),(m.read>2048||m.length()===0)&&m.compact(),v},v.digest=function(){var d=t.util.createBuffer();d.putBytes(m.bytes());var y=v.fullMessageLength[v.fullMessageLength.length-1]+v.messageLengthSize,b=y&v.blockLength-1;d.putBytes(r.substr(0,v.blockLength-b));for(var S,f=0,g=v.fullMessageLength.length-1;g>=0;--g)S=v.fullMessageLength[g]*8+f,f=S/4294967296>>>0,d.putInt32Le(S>>>0);var E={h0:l.h0,h1:l.h1,h2:l.h2,h3:l.h3};u(E,B,d);var w=t.util.createBuffer();return w.putInt32Le(E.h0),w.putInt32Le(E.h1),w.putInt32Le(E.h2),w.putInt32Le(E.h3),w},v};var r=null,a=null,c=null,o=null,i=!1;function n(){r="",r+=t.util.fillString("\0",64),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],c=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],o=new Array(64);for(var l=0;l<64;++l)o[l]=Math.floor(Math.abs(Math.sin(l+1))*4294967296);i=!0}function u(l,m,B){for(var v,d,y,b,S,f,g,E,w=B.length();w>=64;){for(d=l.h0,y=l.h1,b=l.h2,S=l.h3,E=0;E<16;++E)m[E]=B.getInt32Le(),f=S^y&(b^S),v=d+f+o[E]+m[E],g=c[E],d=S,S=b,b=y,y+=v<<g|v>>>32-g;for(;E<32;++E)f=b^S&(y^b),v=d+f+o[E]+m[a[E]],g=c[E],d=S,S=b,b=y,y+=v<<g|v>>>32-g;for(;E<48;++E)f=y^b^S,v=d+f+o[E]+m[a[E]],g=c[E],d=S,S=b,b=y,y+=v<<g|v>>>32-g;for(;E<64;++E)f=b^(y|~S),v=d+f+o[E]+m[a[E]],g=c[E],d=S,S=b,b=y,y+=v<<g|v>>>32-g;l.h0=l.h0+d|0,l.h1=l.h1+y|0,l.h2=l.h2+b|0,l.h3=l.h3+S|0,w-=64}}return $n.exports}var Yn={exports:{}},Li;function Er(){if(Li)return Yn.exports;Li=1;var t=ge();Ee();var e=Yn.exports=t.pem=t.pem||{};e.encode=function(c,o){o=o||{};var i="-----BEGIN "+c.type+`-----\r
`,n;if(c.procType&&(n={name:"Proc-Type",values:[String(c.procType.version),c.procType.type]},i+=r(n)),c.contentDomain&&(n={name:"Content-Domain",values:[c.contentDomain]},i+=r(n)),c.dekInfo&&(n={name:"DEK-Info",values:[c.dekInfo.algorithm]},c.dekInfo.parameters&&n.values.push(c.dekInfo.parameters),i+=r(n)),c.headers)for(var u=0;u<c.headers.length;++u)i+=r(c.headers[u]);return c.procType&&(i+=`\r
`),i+=t.util.encode64(c.body,o.maxline||64)+`\r
`,i+="-----END "+c.type+`-----\r
`,i},e.decode=function(c){for(var o=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,u=/\r?\n/,l;l=i.exec(c),!!l;){var m=l[1];m==="NEW CERTIFICATE REQUEST"&&(m="CERTIFICATE REQUEST");var B={type:m,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(l[3])};if(o.push(B),!!l[2]){for(var v=l[2].split(u),d=0;l&&d<v.length;){for(var y=v[d].replace(/\s+$/,""),b=d+1;b<v.length;++b){var S=v[b];if(!/\s/.test(S[0]))break;y+=S,d=b}if(l=y.match(n),l){for(var f={name:l[1],values:[]},g=l[2].split(","),E=0;E<g.length;++E)f.values.push(a(g[E]));if(B.procType)if(!B.contentDomain&&f.name==="Content-Domain")B.contentDomain=g[0]||"";else if(!B.dekInfo&&f.name==="DEK-Info"){if(f.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');B.dekInfo={algorithm:g[0],parameters:g[1]||null}}else B.headers.push(f);else{if(f.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(f.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');B.procType={version:g[0],type:g[1]}}}++d}if(B.procType==="ENCRYPTED"&&!B.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(o.length===0)throw new Error("Invalid PEM formatted message.");return o};function r(c){for(var o=c.name+": ",i=[],n=function(v,d){return" "+d},u=0;u<c.values.length;++u)i.push(c.values[u].replace(/^(\S+\r\n)/,n));o+=i.join(",")+`\r
`;for(var l=0,m=-1,u=0;u<o.length;++u,++l)if(l>65&&m!==-1){var B=o[m];B===","?(++m,o=o.substr(0,m)+`\r
 `+o.substr(m)):o=o.substr(0,m)+`\r
`+B+o.substr(m+1),l=u-m-1,m=-1,++u}else(o[u]===" "||o[u]==="	"||o[u]===",")&&(m=u);return o}function a(c){return c.replace(/^\s+/,"")}return Yn.exports}var Qn={exports:{}},Xn,ki;function Sn(){if(ki)return Xn;ki=1;var t=ge();qa(),xo(),Ee(),Xn=t.des=t.des||{},t.des.startEncrypting=function(d,y,b,S){var f=v({key:d,output:b,decrypt:!1,mode:S||(y===null?"ECB":"CBC")});return f.start(y),f},t.des.createEncryptionCipher=function(d,y){return v({key:d,output:null,decrypt:!1,mode:y})},t.des.startDecrypting=function(d,y,b,S){var f=v({key:d,output:b,decrypt:!0,mode:S||(y===null?"ECB":"CBC")});return f.start(y),f},t.des.createDecryptionCipher=function(d,y){return v({key:d,output:null,decrypt:!0,mode:y})},t.des.Algorithm=function(d,y){var b=this;b.name=d,b.mode=new y({blockSize:8,cipher:{encrypt:function(S,f){return B(b._keys,S,f,!1)},decrypt:function(S,f){return B(b._keys,S,f,!0)}}}),b._init=!1},t.des.Algorithm.prototype.initialize=function(d){if(!this._init){var y=t.util.createBuffer(d.key);if(this.name.indexOf("3DES")===0&&y.length()!==24)throw new Error("Invalid Triple-DES key size: "+y.length()*8);this._keys=m(y),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(d,y){var b=function(){return new t.des.Algorithm(d,y)};t.cipher.registerAlgorithm(d,b)}var r=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],a=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],o=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],i=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],n=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],u=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],l=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function m(d){for(var y=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],b=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],S=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],f=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],g=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],E=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],w=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],I=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],x=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],s=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],T=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],N=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],O=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],_=d.length()>8?3:1,D=[],V=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],P=0,M,q=0;q<_;q++){var $=d.getInt32(),G=d.getInt32();M=($>>>4^G)&252645135,G^=M,$^=M<<4,M=(G>>>-16^$)&65535,$^=M,G^=M<<-16,M=($>>>2^G)&858993459,G^=M,$^=M<<2,M=(G>>>-16^$)&65535,$^=M,G^=M<<-16,M=($>>>1^G)&1431655765,G^=M,$^=M<<1,M=(G>>>8^$)&16711935,$^=M,G^=M<<8,M=($>>>1^G)&1431655765,G^=M,$^=M<<1,M=$<<8|G>>>20&240,$=G<<24|G<<8&16711680|G>>>8&65280|G>>>24&240,G=M;for(var Y=0;Y<V.length;++Y){V[Y]?($=$<<2|$>>>26,G=G<<2|G>>>26):($=$<<1|$>>>27,G=G<<1|G>>>27),$&=-15,G&=-15;var j=y[$>>>28]|b[$>>>24&15]|S[$>>>20&15]|f[$>>>16&15]|g[$>>>12&15]|E[$>>>8&15]|w[$>>>4&15],te=I[G>>>28]|x[G>>>24&15]|h[G>>>20&15]|s[G>>>16&15]|T[G>>>12&15]|N[G>>>8&15]|O[G>>>4&15];M=(te>>>16^j)&65535,D[P++]=j^M,D[P++]=te^M<<16}}return D}function B(d,y,b,S){var f=d.length===32?3:9,g;f===3?g=S?[30,-2,-2]:[0,32,2]:g=S?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var E,w=y[0],I=y[1];E=(w>>>4^I)&252645135,I^=E,w^=E<<4,E=(w>>>16^I)&65535,I^=E,w^=E<<16,E=(I>>>2^w)&858993459,w^=E,I^=E<<2,E=(I>>>8^w)&16711935,w^=E,I^=E<<8,E=(w>>>1^I)&1431655765,I^=E,w^=E<<1,w=w<<1|w>>>31,I=I<<1|I>>>31;for(var x=0;x<f;x+=3){for(var h=g[x+1],s=g[x+2],T=g[x];T!=h;T+=s){var N=I^d[T],O=(I>>>4|I<<28)^d[T+1];E=w,w=I,I=E^(a[N>>>24&63]|o[N>>>16&63]|n[N>>>8&63]|l[N&63]|r[O>>>24&63]|c[O>>>16&63]|i[O>>>8&63]|u[O&63])}E=w,w=I,I=E}w=w>>>1|w<<31,I=I>>>1|I<<31,E=(w>>>1^I)&1431655765,I^=E,w^=E<<1,E=(I>>>8^w)&16711935,w^=E,I^=E<<8,E=(I>>>2^w)&858993459,w^=E,I^=E<<2,E=(w>>>16^I)&65535,I^=E,w^=E<<16,E=(w>>>4^I)&252645135,I^=E,w^=E<<4,b[0]=w,b[1]=I}function v(d){d=d||{};var y=(d.mode||"CBC").toUpperCase(),b="DES-"+y,S;d.decrypt?S=t.cipher.createDecipher(b,d.key):S=t.cipher.createCipher(b,d.key);var f=S.start;return S.start=function(g,E){var w=null;E instanceof t.util.ByteBuffer&&(w=E,E={}),E=E||{},E.output=w,E.iv=g,f.call(S,E)},S}return Xn}const m0={},_t=Object.freeze(Object.defineProperty({__proto__:null,default:m0},Symbol.toStringTag,{value:"Module"})),za=g0(_t);var jn,Ui;function $a(){if(Ui)return jn;Ui=1;var t=ge();Mr(),qt(),Ee();var e=t.pkcs5=t.pkcs5||{},r;return t.util.isNodejs&&!t.options.usePureJavaScript&&(r=za),jn=t.pbkdf2=e.pbkdf2=function(a,c,o,i,n,u){if(typeof n=="function"&&(u=n,n=null),t.util.isNodejs&&!t.options.usePureJavaScript&&r.pbkdf2&&(n===null||typeof n!="object")&&(r.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),a=Buffer.from(a,"binary"),c=Buffer.from(c,"binary"),u?r.pbkdf2Sync.length===4?r.pbkdf2(a,c,o,i,function(x,h){if(x)return u(x);u(null,h.toString("binary"))}):r.pbkdf2(a,c,o,i,n,function(x,h){if(x)return u(x);u(null,h.toString("binary"))}):r.pbkdf2Sync.length===4?r.pbkdf2Sync(a,c,o,i).toString("binary"):r.pbkdf2Sync(a,c,o,i,n).toString("binary");if((typeof n>"u"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in t.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=t.md[n].create()}var l=n.digestLength;if(i>4294967295*l){var m=new Error("Derived key is too long.");if(u)return u(m);throw m}var B=Math.ceil(i/l),v=i-(B-1)*l,d=t.hmac.create();d.start(n,a);var y="",b,S,f;if(!u){for(var g=1;g<=B;++g){d.start(null,null),d.update(c),d.update(t.util.int32ToBytes(g)),b=f=d.digest().getBytes();for(var E=2;E<=o;++E)d.start(null,null),d.update(f),S=d.digest().getBytes(),b=t.util.xorBytes(b,S,l),f=S;y+=g<B?b:b.substr(0,v)}return y}var g=1,E;function w(){if(g>B)return u(null,y);d.start(null,null),d.update(c),d.update(t.util.int32ToBytes(g)),b=f=d.digest().getBytes(),E=2,I()}function I(){if(E<=o)return d.start(null,null),d.update(f),S=d.digest().getBytes(),b=t.util.xorBytes(b,S,l),f=S,++E,t.util.setImmediate(I);y+=g<B?b:b.substr(0,v),++g,w()}w()},jn}var Xr={exports:{}},Zn={exports:{}},Di;function So(){if(Di)return Zn.exports;Di=1;var t=ge();qt(),Ee();var e=Zn.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){a||o();var n=null,u=t.util.createBuffer(),l=new Array(64),m={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return m.start=function(){m.messageLength=0,m.fullMessageLength=m.messageLength64=[];for(var B=m.messageLengthSize/4,v=0;v<B;++v)m.fullMessageLength.push(0);return u=t.util.createBuffer(),n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},m},m.start(),m.update=function(B,v){v==="utf8"&&(B=t.util.encodeUtf8(B));var d=B.length;m.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var y=m.fullMessageLength.length-1;y>=0;--y)m.fullMessageLength[y]+=d[1],d[1]=d[0]+(m.fullMessageLength[y]/4294967296>>>0),m.fullMessageLength[y]=m.fullMessageLength[y]>>>0,d[0]=d[1]/4294967296>>>0;return u.putBytes(B),i(n,l,u),(u.read>2048||u.length()===0)&&u.compact(),m},m.digest=function(){var B=t.util.createBuffer();B.putBytes(u.bytes());var v=m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize,d=v&m.blockLength-1;B.putBytes(r.substr(0,m.blockLength-d));for(var y,b,S=m.fullMessageLength[0]*8,f=0;f<m.fullMessageLength.length-1;++f)y=m.fullMessageLength[f+1]*8,b=y/4294967296>>>0,S+=b,B.putInt32(S>>>0),S=y>>>0;B.putInt32(S);var g={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};i(g,l,B);var E=t.util.createBuffer();return E.putInt32(g.h0),E.putInt32(g.h1),E.putInt32(g.h2),E.putInt32(g.h3),E.putInt32(g.h4),E.putInt32(g.h5),E.putInt32(g.h6),E.putInt32(g.h7),E},m};var r=null,a=!1,c=null;function o(){r="",r+=t.util.fillString("\0",64),c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=!0}function i(n,u,l){for(var m,B,v,d,y,b,S,f,g,E,w,I,x,h,s,T=l.length();T>=64;){for(S=0;S<16;++S)u[S]=l.getInt32();for(;S<64;++S)m=u[S-2],m=(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10,B=u[S-15],B=(B>>>7|B<<25)^(B>>>18|B<<14)^B>>>3,u[S]=m+u[S-7]+B+u[S-16]|0;for(f=n.h0,g=n.h1,E=n.h2,w=n.h3,I=n.h4,x=n.h5,h=n.h6,s=n.h7,S=0;S<64;++S)d=(I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7),y=h^I&(x^h),v=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),b=f&g|E&(f^g),m=s+d+y+c[S]+u[S],B=v+b,s=h,h=x,x=I,I=w+m>>>0,w=E,E=g,g=f,f=m+B>>>0;n.h0=n.h0+f|0,n.h1=n.h1+g|0,n.h2=n.h2+E|0,n.h3=n.h3+w|0,n.h4=n.h4+I|0,n.h5=n.h5+x|0,n.h6=n.h6+h|0,n.h7=n.h7+s|0,T-=64}}return Zn.exports}var Wn={exports:{}},Pi;function Co(){if(Pi)return Wn.exports;Pi=1;var t=ge();Ee();var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=za);var r=Wn.exports=t.prng=t.prng||{};return r.create=function(a){for(var c={plugin:a,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},o=a.md,i=new Array(32),n=0;n<32;++n)i[n]=o.create();c.pools=i,c.pool=0,c.generate=function(v,d){if(!d)return c.generateSync(v);var y=c.plugin.cipher,b=c.plugin.increment,S=c.plugin.formatKey,f=c.plugin.formatSeed,g=t.util.createBuffer();c.key=null,E();function E(w){if(w)return d(w);if(g.length()>=v)return d(null,g.getBytes(v));if(c.generated>1048575&&(c.key=null),c.key===null)return t.util.nextTick(function(){u(E)});var I=y(c.key,c.seed);c.generated+=I.length,g.putBytes(I),c.key=S(y(c.key,b(c.seed))),c.seed=f(y(c.key,c.seed)),t.util.setImmediate(E)}},c.generateSync=function(v){var d=c.plugin.cipher,y=c.plugin.increment,b=c.plugin.formatKey,S=c.plugin.formatSeed;c.key=null;for(var f=t.util.createBuffer();f.length()<v;){c.generated>1048575&&(c.key=null),c.key===null&&l();var g=d(c.key,c.seed);c.generated+=g.length,f.putBytes(g),c.key=b(d(c.key,y(c.seed))),c.seed=S(d(c.key,c.seed))}return f.getBytes(v)};function u(v){if(c.pools[0].messageLength>=32)return m(),v();var d=32-c.pools[0].messageLength<<5;c.seedFile(d,function(y,b){if(y)return v(y);c.collect(b),m(),v()})}function l(){if(c.pools[0].messageLength>=32)return m();var v=32-c.pools[0].messageLength<<5;c.collect(c.seedFileSync(v)),m()}function m(){c.reseeds=c.reseeds===4294967295?0:c.reseeds+1;var v=c.plugin.md.create();v.update(c.keyBytes);for(var d=1,y=0;y<32;++y)c.reseeds%d===0&&(v.update(c.pools[y].digest().getBytes()),c.pools[y].start()),d=d<<1;c.keyBytes=v.digest().getBytes(),v.start(),v.update(c.keyBytes);var b=v.digest().getBytes();c.key=c.plugin.formatKey(c.keyBytes),c.seed=c.plugin.formatSeed(b),c.generated=0}function B(v){var d=null,y=t.util.globalScope,b=y.crypto||y.msCrypto;b&&b.getRandomValues&&(d=function(s){return b.getRandomValues(s)});var S=t.util.createBuffer();if(d)for(;S.length()<v;){var f=Math.max(1,Math.min(v-S.length(),65536)/4),g=new Uint32Array(Math.floor(f));try{d(g);for(var E=0;E<g.length;++E)S.putInt32(g[E])}catch(s){if(!(typeof QuotaExceededError<"u"&&s instanceof QuotaExceededError))throw s}}if(S.length()<v)for(var w,I,x,h=Math.floor(Math.random()*65536);S.length()<v;){I=16807*(h&65535),w=16807*(h>>16),I+=(w&32767)<<16,I+=w>>15,I=(I&2147483647)+(I>>31),h=I&4294967295;for(var E=0;E<3;++E)x=h>>>(E<<3),x^=Math.floor(Math.random()*256),S.putByte(x&255)}return S.getBytes(v)}return e?(c.seedFile=function(v,d){e.randomBytes(v,function(y,b){if(y)return d(y);d(null,b.toString())})},c.seedFileSync=function(v){return e.randomBytes(v).toString()}):(c.seedFile=function(v,d){try{d(null,B(v))}catch(y){d(y)}},c.seedFileSync=B),c.collect=function(v){for(var d=v.length,y=0;y<d;++y)c.pools[c.pool].update(v.substr(y,1)),c.pool=c.pool===31?0:c.pool+1},c.collectInt=function(v,d){for(var y="",b=0;b<d;b+=8)y+=String.fromCharCode(v>>b&255);c.collect(y)},c.registerWorker=function(v){if(v===self)c.seedFile=function(y,b){function S(f){var g=f.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",S),b(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",S),self.postMessage({forge:{prng:{needed:y}}})};else{var d=function(y){var b=y.data;b.forge&&b.forge.prng&&c.seedFile(b.forge.prng.needed,function(S,f){v.postMessage({forge:{prng:{err:S,bytes:f}}})})};v.addEventListener("message",d)}},c},Wn.exports}var Oi;function Bt(){if(Oi)return Xr.exports;Oi=1;var t=ge();return hr(),So(),Co(),Ee(),(function(){if(t.random&&t.random.getBytes){Xr.exports=t.random;return}(function(e){var r={},a=new Array(4),c=t.util.createBuffer();r.formatKey=function(v){var d=t.util.createBuffer(v);return v=new Array(4),v[0]=d.getInt32(),v[1]=d.getInt32(),v[2]=d.getInt32(),v[3]=d.getInt32(),t.aes._expandKey(v,!1)},r.formatSeed=function(v){var d=t.util.createBuffer(v);return v=new Array(4),v[0]=d.getInt32(),v[1]=d.getInt32(),v[2]=d.getInt32(),v[3]=d.getInt32(),v},r.cipher=function(v,d){return t.aes._updateBlock(v,d,a,!1),c.putInt32(a[0]),c.putInt32(a[1]),c.putInt32(a[2]),c.putInt32(a[3]),c.getBytes()},r.increment=function(v){return++v[3],v},r.md=t.md.sha256;function o(){var v=t.prng.create(r);return v.getBytes=function(d,y){return v.generate(d,y)},v.getBytesSync=function(d){return v.generate(d)},v}var i=o(),n=null,u=t.util.globalScope,l=u.crypto||u.msCrypto;if(l&&l.getRandomValues&&(n=function(v){return l.getRandomValues(v)}),t.options.usePureJavaScript||!t.util.isNodejs&&!n){if(i.collectInt(+new Date,32),typeof navigator<"u"){var m="";for(var B in navigator)try{typeof navigator[B]=="string"&&(m+=navigator[B])}catch{}i.collect(m),m=null}e&&(e().mousemove(function(v){i.collectInt(v.clientX,16),i.collectInt(v.clientY,16)}),e().keypress(function(v){i.collectInt(v.charCode,8)}))}if(!t.random)t.random=i;else for(var B in i)t.random[B]=i[B];t.random.createInstance=o,Xr.exports=t.random})(typeof jQuery<"u"?jQuery:null)})(),Xr.exports}var Jn,Ki;function bo(){if(Ki)return Jn;Ki=1;var t=ge();Ee();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],a=function(i,n){return i<<n&65535|(i&65535)>>16-n},c=function(i,n){return(i&65535)>>n|i<<16-n&65535};Jn=t.rc2=t.rc2||{},t.rc2.expandKey=function(i,n){typeof i=="string"&&(i=t.util.createBuffer(i)),n=n||128;var u=i,l=i.length(),m=n,B=Math.ceil(m/8),v=255>>(m&7),d;for(d=l;d<128;d++)u.putByte(e[u.at(d-1)+u.at(d-l)&255]);for(u.setAt(128-B,e[u.at(128-B)&v]),d=127-B;d>=0;d--)u.setAt(d,e[u.at(d+1)^u.at(d+B)]);return u};var o=function(i,n,u){var l=!1,m=null,B=null,v=null,d,y,b,S,f=[];for(i=t.rc2.expandKey(i,n),b=0;b<64;b++)f.push(i.getInt16Le());u?(d=function(w){for(b=0;b<4;b++)w[b]+=f[S]+(w[(b+3)%4]&w[(b+2)%4])+(~w[(b+3)%4]&w[(b+1)%4]),w[b]=a(w[b],r[b]),S++},y=function(w){for(b=0;b<4;b++)w[b]+=f[w[(b+3)%4]&63]}):(d=function(w){for(b=3;b>=0;b--)w[b]=c(w[b],r[b]),w[b]-=f[S]+(w[(b+3)%4]&w[(b+2)%4])+(~w[(b+3)%4]&w[(b+1)%4]),S--},y=function(w){for(b=3;b>=0;b--)w[b]-=f[w[(b+3)%4]&63]});var g=function(w){var I=[];for(b=0;b<4;b++){var x=m.getInt16Le();v!==null&&(u?x^=v.getInt16Le():v.putInt16Le(x)),I.push(x&65535)}S=u?0:63;for(var h=0;h<w.length;h++)for(var s=0;s<w[h][0];s++)w[h][1](I);for(b=0;b<4;b++)v!==null&&(u?v.putInt16Le(I[b]):I[b]^=v.getInt16Le()),B.putInt16Le(I[b])},E=null;return E={start:function(w,I){w&&typeof w=="string"&&(w=t.util.createBuffer(w)),l=!1,m=t.util.createBuffer(),B=I||new t.util.createBuffer,v=w,E.output=B},update:function(w){for(l||m.putBuffer(w);m.length()>=8;)g([[5,d],[1,y],[6,d],[1,y],[5,d]])},finish:function(w){var I=!0;if(u)if(w)I=w(8,m,!u);else{var x=m.length()===8?8:8-m.length();m.fillWithByte(x,x)}if(I&&(l=!0,E.update()),!u&&(I=m.length()===0,I))if(w)I=w(8,B,!u);else{var h=B.length(),s=B.at(h-1);s>h?I=!1:B.truncate(s)}return I}},E};return t.rc2.startEncrypting=function(i,n,u){var l=t.rc2.createEncryptionCipher(i,128);return l.start(n,u),l},t.rc2.createEncryptionCipher=function(i,n){return o(i,n,!0)},t.rc2.startDecrypting=function(i,n,u){var l=t.rc2.createDecryptionCipher(i,128);return l.start(n,u),l},t.rc2.createDecryptionCipher=function(i,n){return o(i,n,!1)},Jn}var ea,Vi;function Cn(){if(Vi)return ea;Vi=1;var t=ge();ea=t.jsbn=t.jsbn||{};var e;function r(A,L,K){this.data=[],A!=null&&(typeof A=="number"?this.fromNumber(A,L,K):L==null&&typeof A!="string"?this.fromString(A,256):this.fromString(A,L))}t.jsbn.BigInteger=r;function a(){return new r(null)}function c(A,L,K,z,Z,ee){for(;--ee>=0;){var oe=L*this.data[A++]+K.data[z]+Z;Z=Math.floor(oe/67108864),K.data[z++]=oe&67108863}return Z}function o(A,L,K,z,Z,ee){for(var oe=L&32767,ne=L>>15;--ee>=0;){var xe=this.data[A]&32767,Qe=this.data[A++]>>15,yt=ne*xe+Qe*oe;xe=oe*xe+((yt&32767)<<15)+K.data[z]+(Z&1073741823),Z=(xe>>>30)+(yt>>>15)+ne*Qe+(Z>>>30),K.data[z++]=xe&1073741823}return Z}function i(A,L,K,z,Z,ee){for(var oe=L&16383,ne=L>>14;--ee>=0;){var xe=this.data[A]&16383,Qe=this.data[A++]>>14,yt=ne*xe+Qe*oe;xe=oe*xe+((yt&16383)<<14)+K.data[z]+Z,Z=(xe>>28)+(yt>>14)+ne*Qe,K.data[z++]=xe&268435455}return Z}typeof navigator>"u"?(r.prototype.am=i,e=28):navigator.appName=="Microsoft Internet Explorer"?(r.prototype.am=o,e=30):navigator.appName!="Netscape"?(r.prototype.am=c,e=26):(r.prototype.am=i,e=28),r.prototype.DB=e,r.prototype.DM=(1<<e)-1,r.prototype.DV=1<<e;var n=52;r.prototype.FV=Math.pow(2,n),r.prototype.F1=n-e,r.prototype.F2=2*e-n;var u="0123456789abcdefghijklmnopqrstuvwxyz",l=new Array,m,B;for(m=48,B=0;B<=9;++B)l[m++]=B;for(m=97,B=10;B<36;++B)l[m++]=B;for(m=65,B=10;B<36;++B)l[m++]=B;function v(A){return u.charAt(A)}function d(A,L){var K=l[A.charCodeAt(L)];return K??-1}function y(A){for(var L=this.t-1;L>=0;--L)A.data[L]=this.data[L];A.t=this.t,A.s=this.s}function b(A){this.t=1,this.s=A<0?-1:0,A>0?this.data[0]=A:A<-1?this.data[0]=A+this.DV:this.t=0}function S(A){var L=a();return L.fromInt(A),L}function f(A,L){var K;if(L==16)K=4;else if(L==8)K=3;else if(L==256)K=8;else if(L==2)K=1;else if(L==32)K=5;else if(L==4)K=2;else{this.fromRadix(A,L);return}this.t=0,this.s=0;for(var z=A.length,Z=!1,ee=0;--z>=0;){var oe=K==8?A[z]&255:d(A,z);if(oe<0){A.charAt(z)=="-"&&(Z=!0);continue}Z=!1,ee==0?this.data[this.t++]=oe:ee+K>this.DB?(this.data[this.t-1]|=(oe&(1<<this.DB-ee)-1)<<ee,this.data[this.t++]=oe>>this.DB-ee):this.data[this.t-1]|=oe<<ee,ee+=K,ee>=this.DB&&(ee-=this.DB)}K==8&&(A[0]&128)!=0&&(this.s=-1,ee>0&&(this.data[this.t-1]|=(1<<this.DB-ee)-1<<ee)),this.clamp(),Z&&r.ZERO.subTo(this,this)}function g(){for(var A=this.s&this.DM;this.t>0&&this.data[this.t-1]==A;)--this.t}function E(A){if(this.s<0)return"-"+this.negate().toString(A);var L;if(A==16)L=4;else if(A==8)L=3;else if(A==2)L=1;else if(A==32)L=5;else if(A==4)L=2;else return this.toRadix(A);var K=(1<<L)-1,z,Z=!1,ee="",oe=this.t,ne=this.DB-oe*this.DB%L;if(oe-- >0)for(ne<this.DB&&(z=this.data[oe]>>ne)>0&&(Z=!0,ee=v(z));oe>=0;)ne<L?(z=(this.data[oe]&(1<<ne)-1)<<L-ne,z|=this.data[--oe]>>(ne+=this.DB-L)):(z=this.data[oe]>>(ne-=L)&K,ne<=0&&(ne+=this.DB,--oe)),z>0&&(Z=!0),Z&&(ee+=v(z));return Z?ee:"0"}function w(){var A=a();return r.ZERO.subTo(this,A),A}function I(){return this.s<0?this.negate():this}function x(A){var L=this.s-A.s;if(L!=0)return L;var K=this.t;if(L=K-A.t,L!=0)return this.s<0?-L:L;for(;--K>=0;)if((L=this.data[K]-A.data[K])!=0)return L;return 0}function h(A){var L=1,K;return(K=A>>>16)!=0&&(A=K,L+=16),(K=A>>8)!=0&&(A=K,L+=8),(K=A>>4)!=0&&(A=K,L+=4),(K=A>>2)!=0&&(A=K,L+=2),(K=A>>1)!=0&&(A=K,L+=1),L}function s(){return this.t<=0?0:this.DB*(this.t-1)+h(this.data[this.t-1]^this.s&this.DM)}function T(A,L){var K;for(K=this.t-1;K>=0;--K)L.data[K+A]=this.data[K];for(K=A-1;K>=0;--K)L.data[K]=0;L.t=this.t+A,L.s=this.s}function N(A,L){for(var K=A;K<this.t;++K)L.data[K-A]=this.data[K];L.t=Math.max(this.t-A,0),L.s=this.s}function O(A,L){var K=A%this.DB,z=this.DB-K,Z=(1<<z)-1,ee=Math.floor(A/this.DB),oe=this.s<<K&this.DM,ne;for(ne=this.t-1;ne>=0;--ne)L.data[ne+ee+1]=this.data[ne]>>z|oe,oe=(this.data[ne]&Z)<<K;for(ne=ee-1;ne>=0;--ne)L.data[ne]=0;L.data[ee]=oe,L.t=this.t+ee+1,L.s=this.s,L.clamp()}function _(A,L){L.s=this.s;var K=Math.floor(A/this.DB);if(K>=this.t){L.t=0;return}var z=A%this.DB,Z=this.DB-z,ee=(1<<z)-1;L.data[0]=this.data[K]>>z;for(var oe=K+1;oe<this.t;++oe)L.data[oe-K-1]|=(this.data[oe]&ee)<<Z,L.data[oe-K]=this.data[oe]>>z;z>0&&(L.data[this.t-K-1]|=(this.s&ee)<<Z),L.t=this.t-K,L.clamp()}function D(A,L){for(var K=0,z=0,Z=Math.min(A.t,this.t);K<Z;)z+=this.data[K]-A.data[K],L.data[K++]=z&this.DM,z>>=this.DB;if(A.t<this.t){for(z-=A.s;K<this.t;)z+=this.data[K],L.data[K++]=z&this.DM,z>>=this.DB;z+=this.s}else{for(z+=this.s;K<A.t;)z-=A.data[K],L.data[K++]=z&this.DM,z>>=this.DB;z-=A.s}L.s=z<0?-1:0,z<-1?L.data[K++]=this.DV+z:z>0&&(L.data[K++]=z),L.t=K,L.clamp()}function V(A,L){var K=this.abs(),z=A.abs(),Z=K.t;for(L.t=Z+z.t;--Z>=0;)L.data[Z]=0;for(Z=0;Z<z.t;++Z)L.data[Z+K.t]=K.am(0,z.data[Z],L,Z,0,K.t);L.s=0,L.clamp(),this.s!=A.s&&r.ZERO.subTo(L,L)}function P(A){for(var L=this.abs(),K=A.t=2*L.t;--K>=0;)A.data[K]=0;for(K=0;K<L.t-1;++K){var z=L.am(K,L.data[K],A,2*K,0,1);(A.data[K+L.t]+=L.am(K+1,2*L.data[K],A,2*K+1,z,L.t-K-1))>=L.DV&&(A.data[K+L.t]-=L.DV,A.data[K+L.t+1]=1)}A.t>0&&(A.data[A.t-1]+=L.am(K,L.data[K],A,2*K,0,1)),A.s=0,A.clamp()}function M(A,L,K){var z=A.abs();if(!(z.t<=0)){var Z=this.abs();if(Z.t<z.t){L?.fromInt(0),K!=null&&this.copyTo(K);return}K==null&&(K=a());var ee=a(),oe=this.s,ne=A.s,xe=this.DB-h(z.data[z.t-1]);xe>0?(z.lShiftTo(xe,ee),Z.lShiftTo(xe,K)):(z.copyTo(ee),Z.copyTo(K));var Qe=ee.t,yt=ee.data[Qe-1];if(yt!=0){var ht=yt*(1<<this.F1)+(Qe>1?ee.data[Qe-2]>>this.F2:0),Dt=this.FV/ht,Gr=(1<<this.F1)/ht,Et=1<<this.F2,xt=K.t,zr=xt-Qe,zt=L??a();for(ee.dlShiftTo(zr,zt),K.compareTo(zt)>=0&&(K.data[K.t++]=1,K.subTo(zt,K)),r.ONE.dlShiftTo(Qe,zt),zt.subTo(ee,ee);ee.t<Qe;)ee.data[ee.t++]=0;for(;--zr>=0;){var In=K.data[--xt]==yt?this.DM:Math.floor(K.data[xt]*Dt+(K.data[xt-1]+Et)*Gr);if((K.data[xt]+=ee.am(0,In,K,zr,0,Qe))<In)for(ee.dlShiftTo(zr,zt),K.subTo(zt,K);K.data[xt]<--In;)K.subTo(zt,K)}L!=null&&(K.drShiftTo(Qe,L),oe!=ne&&r.ZERO.subTo(L,L)),K.t=Qe,K.clamp(),xe>0&&K.rShiftTo(xe,K),oe<0&&r.ZERO.subTo(K,K)}}}function q(A){var L=a();return this.abs().divRemTo(A,null,L),this.s<0&&L.compareTo(r.ZERO)>0&&A.subTo(L,L),L}function $(A){this.m=A}function G(A){return A.s<0||A.compareTo(this.m)>=0?A.mod(this.m):A}function Y(A){return A}function j(A){A.divRemTo(this.m,null,A)}function te(A,L,K){A.multiplyTo(L,K),this.reduce(K)}function ue(A,L){A.squareTo(L),this.reduce(L)}$.prototype.convert=G,$.prototype.revert=Y,$.prototype.reduce=j,$.prototype.mulTo=te,$.prototype.sqrTo=ue;function X(){if(this.t<1)return 0;var A=this.data[0];if((A&1)==0)return 0;var L=A&3;return L=L*(2-(A&15)*L)&15,L=L*(2-(A&255)*L)&255,L=L*(2-((A&65535)*L&65535))&65535,L=L*(2-A*L%this.DV)%this.DV,L>0?this.DV-L:-L}function re(A){this.m=A,this.mp=A.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<A.DB-15)-1,this.mt2=2*A.t}function W(A){var L=a();return A.abs().dlShiftTo(this.m.t,L),L.divRemTo(this.m,null,L),A.s<0&&L.compareTo(r.ZERO)>0&&this.m.subTo(L,L),L}function pe(A){var L=a();return A.copyTo(L),this.reduce(L),L}function le(A){for(;A.t<=this.mt2;)A.data[A.t++]=0;for(var L=0;L<this.m.t;++L){var K=A.data[L]&32767,z=K*this.mpl+((K*this.mph+(A.data[L]>>15)*this.mpl&this.um)<<15)&A.DM;for(K=L+this.m.t,A.data[K]+=this.m.am(0,z,A,L,0,this.m.t);A.data[K]>=A.DV;)A.data[K]-=A.DV,A.data[++K]++}A.clamp(),A.drShiftTo(this.m.t,A),A.compareTo(this.m)>=0&&A.subTo(this.m,A)}function C(A,L){A.squareTo(L),this.reduce(L)}function U(A,L,K){A.multiplyTo(L,K),this.reduce(K)}re.prototype.convert=W,re.prototype.revert=pe,re.prototype.reduce=le,re.prototype.mulTo=U,re.prototype.sqrTo=C;function k(){return(this.t>0?this.data[0]&1:this.s)==0}function p(A,L){if(A>4294967295||A<1)return r.ONE;var K=a(),z=a(),Z=L.convert(this),ee=h(A)-1;for(Z.copyTo(K);--ee>=0;)if(L.sqrTo(K,z),(A&1<<ee)>0)L.mulTo(z,Z,K);else{var oe=K;K=z,z=oe}return L.revert(K)}function R(A,L){var K;return A<256||L.isEven()?K=new $(L):K=new re(L),this.exp(A,K)}r.prototype.copyTo=y,r.prototype.fromInt=b,r.prototype.fromString=f,r.prototype.clamp=g,r.prototype.dlShiftTo=T,r.prototype.drShiftTo=N,r.prototype.lShiftTo=O,r.prototype.rShiftTo=_,r.prototype.subTo=D,r.prototype.multiplyTo=V,r.prototype.squareTo=P,r.prototype.divRemTo=M,r.prototype.invDigit=X,r.prototype.isEven=k,r.prototype.exp=p,r.prototype.toString=E,r.prototype.negate=w,r.prototype.abs=I,r.prototype.compareTo=x,r.prototype.bitLength=s,r.prototype.mod=q,r.prototype.modPowInt=R,r.ZERO=S(0),r.ONE=S(1);function H(){var A=a();return this.copyTo(A),A}function F(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function J(){return this.t==0?this.s:this.data[0]<<24>>24}function ie(){return this.t==0?this.s:this.data[0]<<16>>16}function ce(A){return Math.floor(Math.LN2*this.DB/Math.log(A))}function Q(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function se(A){if(A==null&&(A=10),this.signum()==0||A<2||A>36)return"0";var L=this.chunkSize(A),K=Math.pow(A,L),z=S(K),Z=a(),ee=a(),oe="";for(this.divRemTo(z,Z,ee);Z.signum()>0;)oe=(K+ee.intValue()).toString(A).substr(1)+oe,Z.divRemTo(z,Z,ee);return ee.intValue().toString(A)+oe}function he(A,L){this.fromInt(0),L==null&&(L=10);for(var K=this.chunkSize(L),z=Math.pow(L,K),Z=!1,ee=0,oe=0,ne=0;ne<A.length;++ne){var xe=d(A,ne);if(xe<0){A.charAt(ne)=="-"&&this.signum()==0&&(Z=!0);continue}oe=L*oe+xe,++ee>=K&&(this.dMultiply(z),this.dAddOffset(oe,0),ee=0,oe=0)}ee>0&&(this.dMultiply(Math.pow(L,ee)),this.dAddOffset(oe,0)),Z&&r.ZERO.subTo(this,this)}function ve(A,L,K){if(typeof L=="number")if(A<2)this.fromInt(1);else for(this.fromNumber(A,K),this.testBit(A-1)||this.bitwiseTo(r.ONE.shiftLeft(A-1),Ne,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(L);)this.dAddOffset(2,0),this.bitLength()>A&&this.subTo(r.ONE.shiftLeft(A-1),this);else{var z=new Array,Z=A&7;z.length=(A>>3)+1,L.nextBytes(z),Z>0?z[0]&=(1<<Z)-1:z[0]=0,this.fromString(z,256)}}function ye(){var A=this.t,L=new Array;L[0]=this.s;var K=this.DB-A*this.DB%8,z,Z=0;if(A-- >0)for(K<this.DB&&(z=this.data[A]>>K)!=(this.s&this.DM)>>K&&(L[Z++]=z|this.s<<this.DB-K);A>=0;)K<8?(z=(this.data[A]&(1<<K)-1)<<8-K,z|=this.data[--A]>>(K+=this.DB-8)):(z=this.data[A]>>(K-=8)&255,K<=0&&(K+=this.DB,--A)),(z&128)!=0&&(z|=-256),Z==0&&(this.s&128)!=(z&128)&&++Z,(Z>0||z!=this.s)&&(L[Z++]=z);return L}function Te(A){return this.compareTo(A)==0}function Re(A){return this.compareTo(A)<0?this:A}function _e(A){return this.compareTo(A)>0?this:A}function we(A,L,K){var z,Z,ee=Math.min(A.t,this.t);for(z=0;z<ee;++z)K.data[z]=L(this.data[z],A.data[z]);if(A.t<this.t){for(Z=A.s&this.DM,z=ee;z<this.t;++z)K.data[z]=L(this.data[z],Z);K.t=this.t}else{for(Z=this.s&this.DM,z=ee;z<A.t;++z)K.data[z]=L(Z,A.data[z]);K.t=A.t}K.s=L(this.s,A.s),K.clamp()}function be(A,L){return A&L}function Be(A){var L=a();return this.bitwiseTo(A,be,L),L}function Ne(A,L){return A|L}function je(A){var L=a();return this.bitwiseTo(A,Ne,L),L}function Ze(A,L){return A^L}function nt(A){var L=a();return this.bitwiseTo(A,Ze,L),L}function at(A,L){return A&~L}function lt(A){var L=a();return this.bitwiseTo(A,at,L),L}function pt(){for(var A=a(),L=0;L<this.t;++L)A.data[L]=this.DM&~this.data[L];return A.t=this.t,A.s=~this.s,A}function vt(A){var L=a();return A<0?this.rShiftTo(-A,L):this.lShiftTo(A,L),L}function Tt(A){var L=a();return A<0?this.lShiftTo(-A,L):this.rShiftTo(A,L),L}function Ut(A){if(A==0)return-1;var L=0;return(A&65535)==0&&(A>>=16,L+=16),(A&255)==0&&(A>>=8,L+=8),(A&15)==0&&(A>>=4,L+=4),(A&3)==0&&(A>>=2,L+=2),(A&1)==0&&++L,L}function Gt(){for(var A=0;A<this.t;++A)if(this.data[A]!=0)return A*this.DB+Ut(this.data[A]);return this.s<0?this.t*this.DB:-1}function ar(A){for(var L=0;A!=0;)A&=A-1,++L;return L}function pr(){for(var A=0,L=this.s&this.DM,K=0;K<this.t;++K)A+=ar(this.data[K]^L);return A}function Sr(A){var L=Math.floor(A/this.DB);return L>=this.t?this.s!=0:(this.data[L]&1<<A%this.DB)!=0}function qr(A,L){var K=r.ONE.shiftLeft(A);return this.bitwiseTo(K,L,K),K}function Ue(A){return this.changeBit(A,Ne)}function De(A){return this.changeBit(A,at)}function Pe(A){return this.changeBit(A,Ze)}function Oe(A,L){for(var K=0,z=0,Z=Math.min(A.t,this.t);K<Z;)z+=this.data[K]+A.data[K],L.data[K++]=z&this.DM,z>>=this.DB;if(A.t<this.t){for(z+=A.s;K<this.t;)z+=this.data[K],L.data[K++]=z&this.DM,z>>=this.DB;z+=this.s}else{for(z+=this.s;K<A.t;)z+=A.data[K],L.data[K++]=z&this.DM,z>>=this.DB;z+=A.s}L.s=z<0?-1:0,z>0?L.data[K++]=z:z<-1&&(L.data[K++]=this.DV+z),L.t=K,L.clamp()}function Ke(A){var L=a();return this.addTo(A,L),L}function Ve(A){var L=a();return this.subTo(A,L),L}function Fe(A){var L=a();return this.multiplyTo(A,L),L}function Me(A){var L=a();return this.divRemTo(A,L,null),L}function He(A){var L=a();return this.divRemTo(A,null,L),L}function qe(A){var L=a(),K=a();return this.divRemTo(A,L,K),new Array(L,K)}function Ge(A){this.data[this.t]=this.am(0,A-1,this,0,0,this.t),++this.t,this.clamp()}function ze(A,L){if(A!=0){for(;this.t<=L;)this.data[this.t++]=0;for(this.data[L]+=A;this.data[L]>=this.DV;)this.data[L]-=this.DV,++L>=this.t&&(this.data[this.t++]=0),++this.data[L]}}function Ae(){}function Le(A){return A}function $e(A,L,K){A.multiplyTo(L,K)}function Ye(A,L){A.squareTo(L)}Ae.prototype.convert=Le,Ae.prototype.revert=Le,Ae.prototype.mulTo=$e,Ae.prototype.sqrTo=Ye;function Qo(A){return this.exp(A,new Ae)}function Xo(A,L,K){var z=Math.min(this.t+A.t,L);for(K.s=0,K.t=z;z>0;)K.data[--z]=0;var Z;for(Z=K.t-this.t;z<Z;++z)K.data[z+this.t]=this.am(0,A.data[z],K,z,0,this.t);for(Z=Math.min(A.t,L);z<Z;++z)this.am(0,A.data[z],K,z,0,L-z);K.clamp()}function jo(A,L,K){--L;var z=K.t=this.t+A.t-L;for(K.s=0;--z>=0;)K.data[z]=0;for(z=Math.max(L-this.t,0);z<A.t;++z)K.data[this.t+z-L]=this.am(L-z,A.data[z],K,0,0,this.t+z-L);K.clamp(),K.drShiftTo(1,K)}function yr(A){this.r2=a(),this.q3=a(),r.ONE.dlShiftTo(2*A.t,this.r2),this.mu=this.r2.divide(A),this.m=A}function Zo(A){if(A.s<0||A.t>2*this.m.t)return A.mod(this.m);if(A.compareTo(this.m)<0)return A;var L=a();return A.copyTo(L),this.reduce(L),L}function Wo(A){return A}function Jo(A){for(A.drShiftTo(this.m.t-1,this.r2),A.t>this.m.t+1&&(A.t=this.m.t+1,A.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);A.compareTo(this.r2)<0;)A.dAddOffset(1,this.m.t+1);for(A.subTo(this.r2,A);A.compareTo(this.m)>=0;)A.subTo(this.m,A)}function ef(A,L){A.squareTo(L),this.reduce(L)}function tf(A,L,K){A.multiplyTo(L,K),this.reduce(K)}yr.prototype.convert=Zo,yr.prototype.revert=Wo,yr.prototype.reduce=Jo,yr.prototype.mulTo=tf,yr.prototype.sqrTo=ef;function rf(A,L){var K=A.bitLength(),z,Z=S(1),ee;if(K<=0)return Z;K<18?z=1:K<48?z=3:K<144?z=4:K<768?z=5:z=6,K<8?ee=new $(L):L.isEven()?ee=new yr(L):ee=new re(L);var oe=new Array,ne=3,xe=z-1,Qe=(1<<z)-1;if(oe[1]=ee.convert(this),z>1){var yt=a();for(ee.sqrTo(oe[1],yt);ne<=Qe;)oe[ne]=a(),ee.mulTo(yt,oe[ne-2],oe[ne]),ne+=2}var ht=A.t-1,Dt,Gr=!0,Et=a(),xt;for(K=h(A.data[ht])-1;ht>=0;){for(K>=xe?Dt=A.data[ht]>>K-xe&Qe:(Dt=(A.data[ht]&(1<<K+1)-1)<<xe-K,ht>0&&(Dt|=A.data[ht-1]>>this.DB+K-xe)),ne=z;(Dt&1)==0;)Dt>>=1,--ne;if((K-=ne)<0&&(K+=this.DB,--ht),Gr)oe[Dt].copyTo(Z),Gr=!1;else{for(;ne>1;)ee.sqrTo(Z,Et),ee.sqrTo(Et,Z),ne-=2;ne>0?ee.sqrTo(Z,Et):(xt=Z,Z=Et,Et=xt),ee.mulTo(Et,oe[Dt],Z)}for(;ht>=0&&(A.data[ht]&1<<K)==0;)ee.sqrTo(Z,Et),xt=Z,Z=Et,Et=xt,--K<0&&(K=this.DB-1,--ht)}return ee.revert(Z)}function nf(A){var L=this.s<0?this.negate():this.clone(),K=A.s<0?A.negate():A.clone();if(L.compareTo(K)<0){var z=L;L=K,K=z}var Z=L.getLowestSetBit(),ee=K.getLowestSetBit();if(ee<0)return L;for(Z<ee&&(ee=Z),ee>0&&(L.rShiftTo(ee,L),K.rShiftTo(ee,K));L.signum()>0;)(Z=L.getLowestSetBit())>0&&L.rShiftTo(Z,L),(Z=K.getLowestSetBit())>0&&K.rShiftTo(Z,K),L.compareTo(K)>=0?(L.subTo(K,L),L.rShiftTo(1,L)):(K.subTo(L,K),K.rShiftTo(1,K));return ee>0&&K.lShiftTo(ee,K),K}function af(A){if(A<=0)return 0;var L=this.DV%A,K=this.s<0?A-1:0;if(this.t>0)if(L==0)K=this.data[0]%A;else for(var z=this.t-1;z>=0;--z)K=(L*K+this.data[z])%A;return K}function sf(A){var L=A.isEven();if(this.isEven()&&L||A.signum()==0)return r.ZERO;for(var K=A.clone(),z=this.clone(),Z=S(1),ee=S(0),oe=S(0),ne=S(1);K.signum()!=0;){for(;K.isEven();)K.rShiftTo(1,K),L?((!Z.isEven()||!ee.isEven())&&(Z.addTo(this,Z),ee.subTo(A,ee)),Z.rShiftTo(1,Z)):ee.isEven()||ee.subTo(A,ee),ee.rShiftTo(1,ee);for(;z.isEven();)z.rShiftTo(1,z),L?((!oe.isEven()||!ne.isEven())&&(oe.addTo(this,oe),ne.subTo(A,ne)),oe.rShiftTo(1,oe)):ne.isEven()||ne.subTo(A,ne),ne.rShiftTo(1,ne);K.compareTo(z)>=0?(K.subTo(z,K),L&&Z.subTo(oe,Z),ee.subTo(ne,ee)):(z.subTo(K,z),L&&oe.subTo(Z,oe),ne.subTo(ee,ne))}if(z.compareTo(r.ONE)!=0)return r.ZERO;if(ne.compareTo(A)>=0)return ne.subtract(A);if(ne.signum()<0)ne.addTo(A,ne);else return ne;return ne.signum()<0?ne.add(A):ne}var mt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],of=(1<<26)/mt[mt.length-1];function ff(A){var L,K=this.abs();if(K.t==1&&K.data[0]<=mt[mt.length-1]){for(L=0;L<mt.length;++L)if(K.data[0]==mt[L])return!0;return!1}if(K.isEven())return!1;for(L=1;L<mt.length;){for(var z=mt[L],Z=L+1;Z<mt.length&&z<of;)z*=mt[Z++];for(z=K.modInt(z);L<Z;)if(z%mt[L++]==0)return!1}return K.millerRabin(A)}function cf(A){var L=this.subtract(r.ONE),K=L.getLowestSetBit();if(K<=0)return!1;for(var z=L.shiftRight(K),Z=uf(),ee,oe=0;oe<A;++oe){do ee=new r(this.bitLength(),Z);while(ee.compareTo(r.ONE)<=0||ee.compareTo(L)>=0);var ne=ee.modPow(z,this);if(ne.compareTo(r.ONE)!=0&&ne.compareTo(L)!=0){for(var xe=1;xe++<K&&ne.compareTo(L)!=0;)if(ne=ne.modPowInt(2,this),ne.compareTo(r.ONE)==0)return!1;if(ne.compareTo(L)!=0)return!1}}return!0}function uf(){return{nextBytes:function(A){for(var L=0;L<A.length;++L)A[L]=Math.floor(Math.random()*256)}}}return r.prototype.chunkSize=ce,r.prototype.toRadix=se,r.prototype.fromRadix=he,r.prototype.fromNumber=ve,r.prototype.bitwiseTo=we,r.prototype.changeBit=qr,r.prototype.addTo=Oe,r.prototype.dMultiply=Ge,r.prototype.dAddOffset=ze,r.prototype.multiplyLowerTo=Xo,r.prototype.multiplyUpperTo=jo,r.prototype.modInt=af,r.prototype.millerRabin=cf,r.prototype.clone=H,r.prototype.intValue=F,r.prototype.byteValue=J,r.prototype.shortValue=ie,r.prototype.signum=Q,r.prototype.toByteArray=ye,r.prototype.equals=Te,r.prototype.min=Re,r.prototype.max=_e,r.prototype.and=Be,r.prototype.or=je,r.prototype.xor=nt,r.prototype.andNot=lt,r.prototype.not=pt,r.prototype.shiftLeft=vt,r.prototype.shiftRight=Tt,r.prototype.getLowestSetBit=Gt,r.prototype.bitCount=pr,r.prototype.testBit=Sr,r.prototype.setBit=Ue,r.prototype.clearBit=De,r.prototype.flipBit=Pe,r.prototype.add=Ke,r.prototype.subtract=Ve,r.prototype.multiply=Fe,r.prototype.divide=Me,r.prototype.remainder=He,r.prototype.divideAndRemainder=qe,r.prototype.modPow=rf,r.prototype.modInverse=sf,r.prototype.pow=Qo,r.prototype.gcd=nf,r.prototype.isProbablePrime=ff,ea}var ta={exports:{}},ra={exports:{}},Fi;function Hr(){if(Fi)return ra.exports;Fi=1;var t=ge();qt(),Ee();var e=ra.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){a||c();var i=null,n=t.util.createBuffer(),u=new Array(80),l={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return l.start=function(){l.messageLength=0,l.fullMessageLength=l.messageLength64=[];for(var m=l.messageLengthSize/4,B=0;B<m;++B)l.fullMessageLength.push(0);return n=t.util.createBuffer(),i={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},l},l.start(),l.update=function(m,B){B==="utf8"&&(m=t.util.encodeUtf8(m));var v=m.length;l.messageLength+=v,v=[v/4294967296>>>0,v>>>0];for(var d=l.fullMessageLength.length-1;d>=0;--d)l.fullMessageLength[d]+=v[1],v[1]=v[0]+(l.fullMessageLength[d]/4294967296>>>0),l.fullMessageLength[d]=l.fullMessageLength[d]>>>0,v[0]=v[1]/4294967296>>>0;return n.putBytes(m),o(i,u,n),(n.read>2048||n.length()===0)&&n.compact(),l},l.digest=function(){var m=t.util.createBuffer();m.putBytes(n.bytes());var B=l.fullMessageLength[l.fullMessageLength.length-1]+l.messageLengthSize,v=B&l.blockLength-1;m.putBytes(r.substr(0,l.blockLength-v));for(var d,y,b=l.fullMessageLength[0]*8,S=0;S<l.fullMessageLength.length-1;++S)d=l.fullMessageLength[S+1]*8,y=d/4294967296>>>0,b+=y,m.putInt32(b>>>0),b=d>>>0;m.putInt32(b);var f={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3,h4:i.h4};o(f,u,m);var g=t.util.createBuffer();return g.putInt32(f.h0),g.putInt32(f.h1),g.putInt32(f.h2),g.putInt32(f.h3),g.putInt32(f.h4),g},l};var r=null,a=!1;function c(){r="",r+=t.util.fillString("\0",64),a=!0}function o(i,n,u){for(var l,m,B,v,d,y,b,S,f=u.length();f>=64;){for(m=i.h0,B=i.h1,v=i.h2,d=i.h3,y=i.h4,S=0;S<16;++S)l=u.getInt32(),n[S]=l,b=d^B&(v^d),l=(m<<5|m>>>27)+b+y+1518500249+l,y=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=l;for(;S<20;++S)l=n[S-3]^n[S-8]^n[S-14]^n[S-16],l=l<<1|l>>>31,n[S]=l,b=d^B&(v^d),l=(m<<5|m>>>27)+b+y+1518500249+l,y=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=l;for(;S<32;++S)l=n[S-3]^n[S-8]^n[S-14]^n[S-16],l=l<<1|l>>>31,n[S]=l,b=B^v^d,l=(m<<5|m>>>27)+b+y+1859775393+l,y=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=l;for(;S<40;++S)l=n[S-6]^n[S-16]^n[S-28]^n[S-32],l=l<<2|l>>>30,n[S]=l,b=B^v^d,l=(m<<5|m>>>27)+b+y+1859775393+l,y=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=l;for(;S<60;++S)l=n[S-6]^n[S-16]^n[S-28]^n[S-32],l=l<<2|l>>>30,n[S]=l,b=B&v|d&(B^v),l=(m<<5|m>>>27)+b+y+2400959708+l,y=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=l;for(;S<80;++S)l=n[S-6]^n[S-16]^n[S-28]^n[S-32],l=l<<2|l>>>30,n[S]=l,b=B^v^d,l=(m<<5|m>>>27)+b+y+3395469782+l,y=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=l;i.h0=i.h0+m|0,i.h1=i.h1+B|0,i.h2=i.h2+v|0,i.h3=i.h3+d|0,i.h4=i.h4+y|0,f-=64}}return ra.exports}var Mi;function Bo(){if(Mi)return ta.exports;Mi=1;var t=ge();Ee(),Bt(),Hr();var e=ta.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(a,c,o){var i,n,u,l;typeof o=="string"?(i=o,n=arguments[3]||void 0,u=arguments[4]||void 0):o&&(i=o.label||void 0,n=o.seed||void 0,u=o.md||void 0,o.mgf1&&o.mgf1.md&&(l=o.mgf1.md)),u?u.start():u=t.md.sha1.create(),l||(l=u);var m=Math.ceil(a.n.bitLength()/8),B=m-2*u.digestLength-2;if(c.length>B){var v=new Error("RSAES-OAEP input message length is too long.");throw v.length=c.length,v.maxLength=B,v}i||(i=""),u.update(i,"raw");for(var d=u.digest(),y="",b=B-c.length,S=0;S<b;S++)y+="\0";var f=d.getBytes()+y+""+c;if(!n)n=t.random.getBytes(u.digestLength);else if(n.length!==u.digestLength){var v=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw v.seedLength=n.length,v.digestLength=u.digestLength,v}var g=r(n,m-u.digestLength-1,l),E=t.util.xorBytes(f,g,f.length),w=r(E,u.digestLength,l),I=t.util.xorBytes(n,w,n.length);return"\0"+I+E},e.decode_rsa_oaep=function(a,c,o){var i,n,u;typeof o=="string"?(i=o,n=arguments[3]||void 0):o&&(i=o.label||void 0,n=o.md||void 0,o.mgf1&&o.mgf1.md&&(u=o.mgf1.md));var l=Math.ceil(a.n.bitLength()/8);if(c.length!==l){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=c.length,E.expectedLength=l,E}if(n===void 0?n=t.md.sha1.create():n.start(),u||(u=n),l<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var m=n.digest().getBytes(),B=c.charAt(0),v=c.substring(1,n.digestLength+1),d=c.substring(1+n.digestLength),y=r(d,n.digestLength,u),b=t.util.xorBytes(v,y,v.length),S=r(b,l-n.digestLength-1,u),f=t.util.xorBytes(d,S,d.length),g=f.substring(0,n.digestLength),E=B!=="\0",w=0;w<n.digestLength;++w)E|=m.charAt(w)!==g.charAt(w);for(var I=1,x=n.digestLength,h=n.digestLength;h<f.length;h++){var s=f.charCodeAt(h),T=s&1^1,N=I?65534:0;E|=s&N,I=I&T,x+=I}if(E||f.charCodeAt(x)!==1)throw new Error("Invalid RSAES-OAEP padding.");return f.substring(x+1)};function r(a,c,o){o||(o=t.md.sha1.create());for(var i="",n=Math.ceil(c/o.digestLength),u=0;u<n;++u){var l=String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255);o.start(),o.update(a+l),i+=o.digest().getBytes()}return i.substring(0,c)}return ta.exports}var jr={exports:{}},Hi;function To(){if(Hi)return jr.exports;Hi=1;var t=ge();return Ee(),Cn(),Bt(),(function(){if(t.prime){jr.exports=t.prime;return}var e=jr.exports=t.prime=t.prime||{},r=t.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],c=new r(null);c.fromInt(30);var o=function(v,d){return v|d};e.generateProbablePrime=function(v,d,y){typeof d=="function"&&(y=d,d={}),d=d||{};var b=d.algorithm||"PRIMEINC";typeof b=="string"&&(b={name:b}),b.options=b.options||{};var S=d.prng||t.random,f={nextBytes:function(g){for(var E=S.getBytesSync(g.length),w=0;w<g.length;++w)g[w]=E.charCodeAt(w)}};if(b.name==="PRIMEINC")return i(v,f,b.options,y);throw new Error("Invalid prime generation algorithm: "+b.name)};function i(v,d,y,b){return"workers"in y?l(v,d,y,b):n(v,d,y,b)}function n(v,d,y,b){var S=m(v,d),f=0,g=B(S.bitLength());"millerRabinTests"in y&&(g=y.millerRabinTests);var E=10;"maxBlockTime"in y&&(E=y.maxBlockTime),u(S,v,d,f,g,E,b)}function u(v,d,y,b,S,f,g){var E=+new Date;do{if(v.bitLength()>d&&(v=m(d,y)),v.isProbablePrime(S))return g(null,v);v.dAddOffset(a[b++%8],0)}while(f<0||+new Date-E<f);t.util.setImmediate(function(){u(v,d,y,b,S,f,g)})}function l(v,d,y,b){if(typeof Worker>"u")return n(v,d,y,b);var S=m(v,d),f=y.workers,g=y.workLoad||100,E=g*30/8,w=y.workerScript||"forge/prime.worker.js";if(f===-1)return t.util.estimateCores(function(x,h){x&&(h=2),f=h-1,I()});I();function I(){f=Math.max(1,f);for(var x=[],h=0;h<f;++h)x[h]=new Worker(w);for(var h=0;h<f;++h)x[h].addEventListener("message",T);var s=!1;function T(N){if(!s){var O=N.data;if(O.found){for(var _=0;_<x.length;++_)x[_].terminate();return s=!0,b(null,new r(O.prime,16))}S.bitLength()>v&&(S=m(v,d));var D=S.toString(16);N.target.postMessage({hex:D,workLoad:g}),S.dAddOffset(E,0)}}}}function m(v,d){var y=new r(v,d),b=v-1;return y.testBit(b)||y.bitwiseTo(r.ONE.shiftLeft(b),o,y),y.dAddOffset(31-y.mod(c).byteValue(),0),y}function B(v){return v<=100?27:v<=150?18:v<=200?15:v<=250?12:v<=300?9:v<=350?8:v<=400?7:v<=500?6:v<=600?5:v<=800?4:v<=1250?3:2}})(),jr.exports}var na,qi;function bn(){if(qi)return na;qi=1;var t=ge();if(kt(),Cn(),dr(),Bo(),To(),Bt(),Ee(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.util.isNodejs?za:null,a=t.asn1,c=t.util;t.pki=t.pki||{},na=t.pki.rsa=t.rsa=t.rsa||{};var o=t.pki,i=[6,4,2,4,2,4,6,2],n={name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},l={name:"RSAPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},m=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},B={name:"DigestInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},v=function(h){var s;if(h.algorithm in o.oids)s=o.oids[h.algorithm];else{var T=new Error("Unknown message digest algorithm.");throw T.algorithm=h.algorithm,T}var N=a.oidToDer(s).getBytes(),O=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]),_=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);_.value.push(a.create(a.Class.UNIVERSAL,a.Type.OID,!1,N)),_.value.push(a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,""));var D=a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,h.digest().getBytes());return O.value.push(_),O.value.push(D),a.toDer(O).getBytes()},d=function(h,s,T){if(T)return h.modPow(s.e,s.n);if(!s.p||!s.q)return h.modPow(s.d,s.n);s.dP||(s.dP=s.d.mod(s.p.subtract(e.ONE))),s.dQ||(s.dQ=s.d.mod(s.q.subtract(e.ONE))),s.qInv||(s.qInv=s.q.modInverse(s.p));var N;do N=new e(t.util.bytesToHex(t.random.getBytes(s.n.bitLength()/8)),16);while(N.compareTo(s.n)>=0||!N.gcd(s.n).equals(e.ONE));h=h.multiply(N.modPow(s.e,s.n)).mod(s.n);for(var O=h.mod(s.p).modPow(s.dP,s.p),_=h.mod(s.q).modPow(s.dQ,s.q);O.compareTo(_)<0;)O=O.add(s.p);var D=O.subtract(_).multiply(s.qInv).mod(s.p).multiply(s.q).add(_);return D=D.multiply(N.modInverse(s.n)).mod(s.n),D};o.rsa.encrypt=function(h,s,T){var N=T,O,_=Math.ceil(s.n.bitLength()/8);T!==!1&&T!==!0?(N=T===2,O=y(h,s,T)):(O=t.util.createBuffer(),O.putBytes(h));for(var D=new e(O.toHex(),16),V=d(D,s,N),P=V.toString(16),M=t.util.createBuffer(),q=_-Math.ceil(P.length/2);q>0;)M.putByte(0),--q;return M.putBytes(t.util.hexToBytes(P)),M.getBytes()},o.rsa.decrypt=function(h,s,T,N){var O=Math.ceil(s.n.bitLength()/8);if(h.length!==O){var _=new Error("Encrypted message length is invalid.");throw _.length=h.length,_.expected=O,_}var D=new e(t.util.createBuffer(h).toHex(),16);if(D.compareTo(s.n)>=0)throw new Error("Encrypted message is invalid.");for(var V=d(D,s,T),P=V.toString(16),M=t.util.createBuffer(),q=O-Math.ceil(P.length/2);q>0;)M.putByte(0),--q;return M.putBytes(t.util.hexToBytes(P)),N!==!1?b(M.getBytes(),s,T):M.getBytes()},o.rsa.createKeyPairGenerationState=function(h,s,T){typeof h=="string"&&(h=parseInt(h,10)),h=h||2048,T=T||{};var N=T.prng||t.random,O={nextBytes:function(V){for(var P=N.getBytesSync(V.length),M=0;M<V.length;++M)V[M]=P.charCodeAt(M)}},_=T.algorithm||"PRIMEINC",D;if(_==="PRIMEINC")D={algorithm:_,state:0,bits:h,rng:O,eInt:s||65537,e:new e(null),p:null,q:null,qBits:h>>1,pBits:h-(h>>1),pqState:0,num:null,keys:null},D.e.fromInt(D.eInt);else throw new Error("Invalid key generation algorithm: "+_);return D},o.rsa.stepKeyPairGenerationState=function(h,s){"algorithm"in h||(h.algorithm="PRIMEINC");var T=new e(null);T.fromInt(30);for(var N=0,O=function($,G){return $|G},_=+new Date,D,V=0;h.keys===null&&(s<=0||V<s);){if(h.state===0){var P=h.p===null?h.pBits:h.qBits,M=P-1;h.pqState===0?(h.num=new e(P,h.rng),h.num.testBit(M)||h.num.bitwiseTo(e.ONE.shiftLeft(M),O,h.num),h.num.dAddOffset(31-h.num.mod(T).byteValue(),0),N=0,++h.pqState):h.pqState===1?h.num.bitLength()>P?h.pqState=0:h.num.isProbablePrime(g(h.num.bitLength()))?++h.pqState:h.num.dAddOffset(i[N++%8],0):h.pqState===2?h.pqState=h.num.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)===0?3:0:h.pqState===3&&(h.pqState=0,h.p===null?h.p=h.num:h.q=h.num,h.p!==null&&h.q!==null&&++h.state,h.num=null)}else if(h.state===1)h.p.compareTo(h.q)<0&&(h.num=h.p,h.p=h.q,h.q=h.num),++h.state;else if(h.state===2)h.p1=h.p.subtract(e.ONE),h.q1=h.q.subtract(e.ONE),h.phi=h.p1.multiply(h.q1),++h.state;else if(h.state===3)h.phi.gcd(h.e).compareTo(e.ONE)===0?++h.state:(h.p=null,h.q=null,h.state=0);else if(h.state===4)h.n=h.p.multiply(h.q),h.n.bitLength()===h.bits?++h.state:(h.q=null,h.state=0);else if(h.state===5){var q=h.e.modInverse(h.phi);h.keys={privateKey:o.rsa.setPrivateKey(h.n,h.e,q,h.p,h.q,q.mod(h.p1),q.mod(h.q1),h.q.modInverse(h.p)),publicKey:o.rsa.setPublicKey(h.n,h.e)}}D=+new Date,V+=D-_,_=D}return h.keys!==null},o.rsa.generateKeyPair=function(h,s,T,N){if(arguments.length===1?typeof h=="object"?(T=h,h=void 0):typeof h=="function"&&(N=h,h=void 0):arguments.length===2?typeof h=="number"?typeof s=="function"?(N=s,s=void 0):typeof s!="number"&&(T=s,s=void 0):(T=h,N=s,h=void 0,s=void 0):arguments.length===3&&(typeof s=="number"?typeof T=="function"&&(N=T,T=void 0):(N=T,T=s,s=void 0)),T=T||{},h===void 0&&(h=T.bits||2048),s===void 0&&(s=T.e||65537),!t.options.usePureJavaScript&&!T.prng&&h>=256&&h<=16384&&(s===65537||s===3)){if(N){if(E("generateKeyPair"))return r.generateKeyPair("rsa",{modulusLength:h,publicExponent:s,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(V,P,M){if(V)return N(V);N(null,{privateKey:o.privateKeyFromPem(M),publicKey:o.publicKeyFromPem(P)})});if(w("generateKey")&&w("exportKey"))return c.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:h,publicExponent:x(s),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(V){return c.globalScope.crypto.subtle.exportKey("pkcs8",V.privateKey)}).then(void 0,function(V){N(V)}).then(function(V){if(V){var P=o.privateKeyFromAsn1(a.fromDer(t.util.createBuffer(V)));N(null,{privateKey:P,publicKey:o.setRsaPublicKey(P.n,P.e)})}});if(I("generateKey")&&I("exportKey")){var O=c.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:h,publicExponent:x(s),hash:{name:"SHA-256"}},!0,["sign","verify"]);O.oncomplete=function(V){var P=V.target.result,M=c.globalScope.msCrypto.subtle.exportKey("pkcs8",P.privateKey);M.oncomplete=function(q){var $=q.target.result,G=o.privateKeyFromAsn1(a.fromDer(t.util.createBuffer($)));N(null,{privateKey:G,publicKey:o.setRsaPublicKey(G.n,G.e)})},M.onerror=function(q){N(q)}},O.onerror=function(V){N(V)};return}}else if(E("generateKeyPairSync")){var _=r.generateKeyPairSync("rsa",{modulusLength:h,publicExponent:s,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:o.privateKeyFromPem(_.privateKey),publicKey:o.publicKeyFromPem(_.publicKey)}}}var D=o.rsa.createKeyPairGenerationState(h,s,T);if(!N)return o.rsa.stepKeyPairGenerationState(D,0),D.keys;S(D,T,N)},o.setRsaPublicKey=o.rsa.setPublicKey=function(h,s){var T={n:h,e:s};return T.encrypt=function(N,O,_){if(typeof O=="string"?O=O.toUpperCase():O===void 0&&(O="RSAES-PKCS1-V1_5"),O==="RSAES-PKCS1-V1_5")O={encode:function(V,P,M){return y(V,P,2).getBytes()}};else if(O==="RSA-OAEP"||O==="RSAES-OAEP")O={encode:function(V,P){return t.pkcs1.encode_rsa_oaep(P,V,_)}};else if(["RAW","NONE","NULL",null].indexOf(O)!==-1)O={encode:function(V){return V}};else if(typeof O=="string")throw new Error('Unsupported encryption scheme: "'+O+'".');var D=O.encode(N,T,!0);return o.rsa.encrypt(D,T,!0)},T.verify=function(N,O,_,D){typeof _=="string"?_=_.toUpperCase():_===void 0&&(_="RSASSA-PKCS1-V1_5"),D===void 0&&(D={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in D||(D._parseAllDigestBytes=!0),_==="RSASSA-PKCS1-V1_5"?_={verify:function(P,M){M=b(M,T,!0);var q=a.fromDer(M,{parseAllBytes:D._parseAllDigestBytes}),$={},G=[];if(!a.validate(q,B,$,G)){var Y=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw Y.errors=G,Y}var j=a.derToOid($.algorithmIdentifier);if(!(j===t.oids.md2||j===t.oids.md5||j===t.oids.sha1||j===t.oids.sha224||j===t.oids.sha256||j===t.oids.sha384||j===t.oids.sha512||j===t.oids["sha512-224"]||j===t.oids["sha512-256"])){var Y=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw Y.oid=j,Y}if((j===t.oids.md2||j===t.oids.md5)&&!("parameters"in $))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return P===$.digest}}:(_==="NONE"||_==="NULL"||_===null)&&(_={verify:function(P,M){return M=b(M,T,!0),P===M}});var V=o.rsa.decrypt(O,T,!0,!1);return _.verify(N,V,T.n.bitLength())},T},o.setRsaPrivateKey=o.rsa.setPrivateKey=function(h,s,T,N,O,_,D,V){var P={n:h,e:s,d:T,p:N,q:O,dP:_,dQ:D,qInv:V};return P.decrypt=function(M,q,$){typeof q=="string"?q=q.toUpperCase():q===void 0&&(q="RSAES-PKCS1-V1_5");var G=o.rsa.decrypt(M,P,!1,!1);if(q==="RSAES-PKCS1-V1_5")q={decode:b};else if(q==="RSA-OAEP"||q==="RSAES-OAEP")q={decode:function(Y,j){return t.pkcs1.decode_rsa_oaep(j,Y,$)}};else if(["RAW","NONE","NULL",null].indexOf(q)!==-1)q={decode:function(Y){return Y}};else throw new Error('Unsupported encryption scheme: "'+q+'".');return q.decode(G,P,!1)},P.sign=function(M,q){var $=!1;typeof q=="string"&&(q=q.toUpperCase()),q===void 0||q==="RSASSA-PKCS1-V1_5"?(q={encode:v},$=1):(q==="NONE"||q==="NULL"||q===null)&&(q={encode:function(){return M}},$=1);var G=q.encode(M,P.n.bitLength());return o.rsa.encrypt(G,P,$)},P},o.wrapRsaPrivateKey=function(h){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(0).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.oids.rsaEncryption).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(h).getBytes())])},o.privateKeyFromAsn1=function(h){var s={},T=[];if(a.validate(h,n,s,T)&&(h=a.fromDer(t.util.createBuffer(s.privateKey))),s={},T=[],!a.validate(h,u,s,T)){var N=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw N.errors=T,N}var O,_,D,V,P,M,q,$;return O=t.util.createBuffer(s.privateKeyModulus).toHex(),_=t.util.createBuffer(s.privateKeyPublicExponent).toHex(),D=t.util.createBuffer(s.privateKeyPrivateExponent).toHex(),V=t.util.createBuffer(s.privateKeyPrime1).toHex(),P=t.util.createBuffer(s.privateKeyPrime2).toHex(),M=t.util.createBuffer(s.privateKeyExponent1).toHex(),q=t.util.createBuffer(s.privateKeyExponent2).toHex(),$=t.util.createBuffer(s.privateKeyCoefficient).toHex(),o.setRsaPrivateKey(new e(O,16),new e(_,16),new e(D,16),new e(V,16),new e(P,16),new e(M,16),new e(q,16),new e($,16))},o.privateKeyToAsn1=o.privateKeyToRSAPrivateKey=function(h){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(0).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.n)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.e)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.d)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.p)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.q)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.dP)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.dQ)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.qInv))])},o.publicKeyFromAsn1=function(h){var s={},T=[];if(a.validate(h,m,s,T)){var N=a.derToOid(s.publicKeyOid);if(N!==o.oids.rsaEncryption){var O=new Error("Cannot read public key. Unknown OID.");throw O.oid=N,O}h=s.rsaPublicKey}if(T=[],!a.validate(h,l,s,T)){var O=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw O.errors=T,O}var _=t.util.createBuffer(s.publicKeyModulus).toHex(),D=t.util.createBuffer(s.publicKeyExponent).toHex();return o.setRsaPublicKey(new e(_,16),new e(D,16))},o.publicKeyToAsn1=o.publicKeyToSubjectPublicKeyInfo=function(h){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.oids.rsaEncryption).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,[o.publicKeyToRSAPublicKey(h)])])},o.publicKeyToRSAPublicKey=function(h){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.n)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f(h.e))])};function y(h,s,T){var N=t.util.createBuffer(),O=Math.ceil(s.n.bitLength()/8);if(h.length>O-11){var _=new Error("Message is too long for PKCS#1 v1.5 padding.");throw _.length=h.length,_.max=O-11,_}N.putByte(0),N.putByte(T);var D=O-3-h.length,V;if(T===0||T===1){V=T===0?0:255;for(var P=0;P<D;++P)N.putByte(V)}else for(;D>0;){for(var M=0,q=t.random.getBytes(D),P=0;P<D;++P)V=q.charCodeAt(P),V===0?++M:N.putByte(V);D=M}return N.putByte(0),N.putBytes(h),N}function b(h,s,T,N){var O=Math.ceil(s.n.bitLength()/8),_=t.util.createBuffer(h),D=_.getByte(),V=_.getByte();if(D!==0||T&&V!==0&&V!==1||!T&&V!=2||T&&V===0&&typeof N>"u")throw new Error("Encryption block is invalid.");var P=0;if(V===0){P=O-3-N;for(var M=0;M<P;++M)if(_.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(V===1)for(P=0;_.length()>1;){if(_.getByte()!==255){--_.read;break}++P}else if(V===2)for(P=0;_.length()>1;){if(_.getByte()===0){--_.read;break}++P}var q=_.getByte();if(q!==0||P!==O-3-_.length())throw new Error("Encryption block is invalid.");return _.getBytes()}function S(h,s,T){typeof s=="function"&&(T=s,s={}),s=s||{};var N={algorithm:{name:s.algorithm||"PRIMEINC",options:{workers:s.workers||2,workLoad:s.workLoad||100,workerScript:s.workerScript}}};"prng"in s&&(N.prng=s.prng),O();function O(){_(h.pBits,function(V,P){if(V)return T(V);if(h.p=P,h.q!==null)return D(V,h.q);_(h.qBits,D)})}function _(V,P){t.prime.generateProbablePrime(V,N,P)}function D(V,P){if(V)return T(V);if(h.q=P,h.p.compareTo(h.q)<0){var M=h.p;h.p=h.q,h.q=M}if(h.p.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)!==0){h.p=null,O();return}if(h.q.subtract(e.ONE).gcd(h.e).compareTo(e.ONE)!==0){h.q=null,_(h.qBits,D);return}if(h.p1=h.p.subtract(e.ONE),h.q1=h.q.subtract(e.ONE),h.phi=h.p1.multiply(h.q1),h.phi.gcd(h.e).compareTo(e.ONE)!==0){h.p=h.q=null,O();return}if(h.n=h.p.multiply(h.q),h.n.bitLength()!==h.bits){h.q=null,_(h.qBits,D);return}var q=h.e.modInverse(h.phi);h.keys={privateKey:o.rsa.setPrivateKey(h.n,h.e,q,h.p,h.q,q.mod(h.p1),q.mod(h.q1),h.q.modInverse(h.p)),publicKey:o.rsa.setPublicKey(h.n,h.e)},T(null,h.keys)}}function f(h){var s=h.toString(16);s[0]>="8"&&(s="00"+s);var T=t.util.hexToBytes(s);return T.length>1&&(T.charCodeAt(0)===0&&(T.charCodeAt(1)&128)===0||T.charCodeAt(0)===255&&(T.charCodeAt(1)&128)===128)?T.substr(1):T}function g(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}function E(h){return t.util.isNodejs&&typeof r[h]=="function"}function w(h){return typeof c.globalScope<"u"&&typeof c.globalScope.crypto=="object"&&typeof c.globalScope.crypto.subtle=="object"&&typeof c.globalScope.crypto.subtle[h]=="function"}function I(h){return typeof c.globalScope<"u"&&typeof c.globalScope.msCrypto=="object"&&typeof c.globalScope.msCrypto.subtle=="object"&&typeof c.globalScope.msCrypto.subtle[h]=="function"}function x(h){for(var s=t.util.hexToBytes(h.toString(16)),T=new Uint8Array(s.length),N=0;N<s.length;++N)T[N]=s.charCodeAt(N);return T}return na}var aa,Gi;function wo(){if(Gi)return aa;Gi=1;var t=ge();if(hr(),kt(),Sn(),qt(),dr(),$a(),Er(),Bt(),bo(),bn(),Ee(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.asn1,a=t.pki=t.pki||{};aa=a.pbe=t.pbe=t.pbe||{};var c=a.oids,o={name:"EncryptedPrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},i={name:"PBES2Algorithms",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},n={name:"pkcs-12PbeParams",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"iterations"}]};a.encryptPrivateKeyInfo=function(v,d,y){y=y||{},y.saltSize=y.saltSize||8,y.count=y.count||2048,y.algorithm=y.algorithm||"aes128",y.prfAlgorithm=y.prfAlgorithm||"sha1";var b=t.random.getBytesSync(y.saltSize),S=y.count,f=r.integerToDer(S),g,E,w;if(y.algorithm.indexOf("aes")===0||y.algorithm==="des"){var I,x,h;switch(y.algorithm){case"aes128":g=16,I=16,x=c["aes128-CBC"],h=t.aes.createEncryptionCipher;break;case"aes192":g=24,I=16,x=c["aes192-CBC"],h=t.aes.createEncryptionCipher;break;case"aes256":g=32,I=16,x=c["aes256-CBC"],h=t.aes.createEncryptionCipher;break;case"des":g=8,I=8,x=c.desCBC,h=t.des.createEncryptionCipher;break;default:var s=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=y.algorithm,s}var T="hmacWith"+y.prfAlgorithm.toUpperCase(),N=m(T),O=t.pkcs5.pbkdf2(d,b,S,g,N),_=t.random.getBytesSync(I),D=h(O);D.start(_),D.update(r.toDer(v)),D.finish(),w=D.output.getBytes();var V=B(b,f,g,T);E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(c.pkcs5PBES2).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(c.pkcs5PBKDF2).getBytes()),V]),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(x).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,_)])])])}else if(y.algorithm==="3des"){g=24;var P=new t.util.ByteBuffer(b),O=a.pbe.generatePkcs12Key(d,P,1,S,g),_=a.pbe.generatePkcs12Key(d,P,2,S,g),D=t.des.createEncryptionCipher(O);D.start(_),D.update(r.toDer(v)),D.finish(),w=D.output.getBytes(),E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(c["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,b),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,f.getBytes())])])}else{var s=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=y.algorithm,s}var M=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[E,r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,w)]);return M},a.decryptPrivateKeyInfo=function(v,d){var y=null,b={},S=[];if(!r.validate(v,o,b,S)){var f=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=S,f}var g=r.derToOid(b.encryptionOid),E=a.pbe.getCipher(g,b.encryptionParams,d),w=t.util.createBuffer(b.encryptedData);return E.update(w),E.finish()&&(y=r.fromDer(E.output)),y},a.encryptedPrivateKeyToPem=function(v,d){var y={type:"ENCRYPTED PRIVATE KEY",body:r.toDer(v).getBytes()};return t.pem.encode(y,{maxline:d})},a.encryptedPrivateKeyFromPem=function(v){var d=t.pem.decode(v)[0];if(d.type!=="ENCRYPTED PRIVATE KEY"){var y=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw y.headerType=d.type,y}if(d.procType&&d.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return r.fromDer(d.body)},a.encryptRsaPrivateKey=function(v,d,y){if(y=y||{},!y.legacy){var b=a.wrapRsaPrivateKey(a.privateKeyToAsn1(v));return b=a.encryptPrivateKeyInfo(b,d,y),a.encryptedPrivateKeyToPem(b)}var S,f,g,E;switch(y.algorithm){case"aes128":S="AES-128-CBC",g=16,f=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes192":S="AES-192-CBC",g=24,f=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes256":S="AES-256-CBC",g=32,f=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"3des":S="DES-EDE3-CBC",g=24,f=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;case"des":S="DES-CBC",g=8,f=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;default:var w=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+y.algorithm+'".');throw w.algorithm=y.algorithm,w}var I=t.pbe.opensslDeriveBytes(d,f.substr(0,8),g),x=E(I);x.start(f),x.update(r.toDer(a.privateKeyToAsn1(v))),x.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:S,parameters:t.util.bytesToHex(f).toUpperCase()},body:x.output.getBytes()};return t.pem.encode(h)},a.decryptRsaPrivateKey=function(v,d){var y=null,b=t.pem.decode(v)[0];if(b.type!=="ENCRYPTED PRIVATE KEY"&&b.type!=="PRIVATE KEY"&&b.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw S.headerType=S,S}if(b.procType&&b.procType.type==="ENCRYPTED"){var f,g;switch(b.dekInfo.algorithm){case"DES-CBC":f=8,g=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":f=24,g=t.des.createDecryptionCipher;break;case"AES-128-CBC":f=16,g=t.aes.createDecryptionCipher;break;case"AES-192-CBC":f=24,g=t.aes.createDecryptionCipher;break;case"AES-256-CBC":f=32,g=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":f=5,g=function(h){return t.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":f=8,g=function(h){return t.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":f=16,g=function(h){return t.rc2.createDecryptionCipher(h,128)};break;default:var S=new Error('Could not decrypt private key; unsupported encryption algorithm "'+b.dekInfo.algorithm+'".');throw S.algorithm=b.dekInfo.algorithm,S}var E=t.util.hexToBytes(b.dekInfo.parameters),w=t.pbe.opensslDeriveBytes(d,E.substr(0,8),f),I=g(w);if(I.start(E),I.update(t.util.createBuffer(b.body)),I.finish())y=I.output.getBytes();else return y}else y=b.body;return b.type==="ENCRYPTED PRIVATE KEY"?y=a.decryptPrivateKeyInfo(r.fromDer(y),d):y=r.fromDer(y),y!==null&&(y=a.privateKeyFromAsn1(y)),y},a.pbe.generatePkcs12Key=function(v,d,y,b,S,f){var g,E;if(typeof f>"u"||f===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');f=t.md.sha1.create()}var w=f.digestLength,I=f.blockLength,x=new t.util.ByteBuffer,h=new t.util.ByteBuffer;if(v!=null){for(E=0;E<v.length;E++)h.putInt16(v.charCodeAt(E));h.putInt16(0)}var s=h.length(),T=d.length(),N=new t.util.ByteBuffer;N.fillWithByte(y,I);var O=I*Math.ceil(T/I),_=new t.util.ByteBuffer;for(E=0;E<O;E++)_.putByte(d.at(E%T));var D=I*Math.ceil(s/I),V=new t.util.ByteBuffer;for(E=0;E<D;E++)V.putByte(h.at(E%s));var P=_;P.putBuffer(V);for(var M=Math.ceil(S/w),q=1;q<=M;q++){var $=new t.util.ByteBuffer;$.putBytes(N.bytes()),$.putBytes(P.bytes());for(var G=0;G<b;G++)f.start(),f.update($.getBytes()),$=f.digest();var Y=new t.util.ByteBuffer;for(E=0;E<I;E++)Y.putByte($.at(E%w));var j=Math.ceil(T/I)+Math.ceil(s/I),te=new t.util.ByteBuffer;for(g=0;g<j;g++){var ue=new t.util.ByteBuffer(P.getBytes(I)),X=511;for(E=Y.length()-1;E>=0;E--)X=X>>8,X+=Y.at(E)+ue.at(E),ue.setAt(E,X&255);te.putBuffer(ue)}P=te,x.putBuffer($)}return x.truncate(x.length()-S),x},a.pbe.getCipher=function(v,d,y){switch(v){case a.oids.pkcs5PBES2:return a.pbe.getCipherForPBES2(v,d,y);case a.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case a.oids["pbewithSHAAnd40BitRC2-CBC"]:return a.pbe.getCipherForPKCS12PBE(v,d,y);default:var b=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw b.oid=v,b.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],b}},a.pbe.getCipherForPBES2=function(v,d,y){var b={},S=[];if(!r.validate(d,i,b,S)){var f=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=S,f}if(v=r.derToOid(b.kdfOid),v!==a.oids.pkcs5PBKDF2){var f=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw f.oid=v,f.supportedOids=["pkcs5PBKDF2"],f}if(v=r.derToOid(b.encOid),v!==a.oids["aes128-CBC"]&&v!==a.oids["aes192-CBC"]&&v!==a.oids["aes256-CBC"]&&v!==a.oids["des-EDE3-CBC"]&&v!==a.oids.desCBC){var f=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw f.oid=v,f.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],f}var g=b.kdfSalt,E=t.util.createBuffer(b.kdfIterationCount);E=E.getInt(E.length()<<3);var w,I;switch(a.oids[v]){case"aes128-CBC":w=16,I=t.aes.createDecryptionCipher;break;case"aes192-CBC":w=24,I=t.aes.createDecryptionCipher;break;case"aes256-CBC":w=32,I=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":w=24,I=t.des.createDecryptionCipher;break;case"desCBC":w=8,I=t.des.createDecryptionCipher;break}var x=l(b.prfOid),h=t.pkcs5.pbkdf2(y,g,E,w,x),s=b.encIv,T=I(h);return T.start(s),T},a.pbe.getCipherForPKCS12PBE=function(v,d,y){var b={},S=[];if(!r.validate(d,n,b,S)){var f=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=S,f}var g=t.util.createBuffer(b.salt),E=t.util.createBuffer(b.iterations);E=E.getInt(E.length()<<3);var w,I,x;switch(v){case a.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:w=24,I=8,x=t.des.startDecrypting;break;case a.oids["pbewithSHAAnd40BitRC2-CBC"]:w=5,I=8,x=function(O,_){var D=t.rc2.createDecryptionCipher(O,40);return D.start(_,null),D};break;default:var f=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw f.oid=v,f}var h=l(b.prfOid),s=a.pbe.generatePkcs12Key(y,g,1,E,w,h);h.start();var T=a.pbe.generatePkcs12Key(y,g,2,E,I,h);return x(s,T)},a.pbe.opensslDeriveBytes=function(v,d,y,b){if(typeof b>"u"||b===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');b=t.md.md5.create()}d===null&&(d="");for(var S=[u(b,v+d)],f=16,g=1;f<y;++g,f+=16)S.push(u(b,S[g-1]+v+d));return S.join("").substr(0,y)};function u(v,d){return v.start().update(d).digest().getBytes()}function l(v){var d;if(!v)d="hmacWithSHA1";else if(d=a.oids[r.derToOid(v)],!d){var y=new Error("Unsupported PRF OID.");throw y.oid=v,y.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],y}return m(d)}function m(v){var d=t.md;switch(v){case"hmacWithSHA224":d=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":v=v.substr(8).toLowerCase();break;default:var y=new Error("Unsupported PRF algorithm.");throw y.algorithm=v,y.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],y}if(!d||!(v in d))throw new Error("Unknown hash algorithm: "+v);return d[v].create()}function B(v,d,y,b){var S=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,v),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,d.getBytes())]);return b!=="hmacWithSHA1"&&S.value.push(r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,t.util.hexToBytes(y.toString(16))),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(a.oids[b]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.NULL,!1,"")])),S}return aa}var ia={exports:{}},sa={exports:{}},zi;function Ao(){if(zi)return sa.exports;zi=1;var t=ge();kt(),Ee();var e=t.asn1,r=sa.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=r;var a={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=a;var c={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(c)},r.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(c)};var o={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return r.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},a,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[o]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},sa.exports}var oa={exports:{}},fa={exports:{}},$i;function Io(){if($i)return fa.exports;$i=1;var t=ge();Ee(),t.mgf=t.mgf||{};var e=fa.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};return e.create=function(r){var a={generate:function(c,o){for(var i=new t.util.ByteBuffer,n=Math.ceil(o/r.digestLength),u=0;u<n;u++){var l=new t.util.ByteBuffer;l.putInt32(u),r.start(),r.update(c+l.getBytes()),i.putBuffer(r.digest())}return i.truncate(i.length()-o),i.getBytes()}};return a},fa.exports}var ca,Yi;function E0(){if(Yi)return ca;Yi=1;var t=ge();return Io(),ca=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1,ca}var ua={exports:{}},Qi;function Ya(){if(Qi)return ua.exports;Qi=1;var t=ge();Bt(),Ee();var e=ua.exports=t.pss=t.pss||{};return e.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var a=r.md,c=r.mgf,o=a.digestLength,i=r.salt||null;typeof i=="string"&&(i=t.util.createBuffer(i));var n;if("saltLength"in r)n=r.saltLength;else if(i!==null)n=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==n)throw new Error("Given salt length does not match length of given salt.");var u=r.prng||t.random,l={};return l.encode=function(m,B){var v,d=B-1,y=Math.ceil(d/8),b=m.digest().getBytes();if(y<o+n+2)throw new Error("Message is too long to encrypt.");var S;i===null?S=u.getBytesSync(n):S=i.bytes();var f=new t.util.ByteBuffer;f.fillWithByte(0,8),f.putBytes(b),f.putBytes(S),a.start(),a.update(f.getBytes());var g=a.digest().getBytes(),E=new t.util.ByteBuffer;E.fillWithByte(0,y-n-o-2),E.putByte(1),E.putBytes(S);var w=E.getBytes(),I=y-o-1,x=c.generate(g,I),h="";for(v=0;v<I;v++)h+=String.fromCharCode(w.charCodeAt(v)^x.charCodeAt(v));var s=65280>>8*y-d&255;return h=String.fromCharCode(h.charCodeAt(0)&~s)+h.substr(1),h+g+""},l.verify=function(m,B,v){var d,y=v-1,b=Math.ceil(y/8);if(B=B.substr(-b),b<o+n+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(B.charCodeAt(b-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var S=b-o-1,f=B.substr(0,S),g=B.substr(S,o),E=65280>>8*b-y&255;if((f.charCodeAt(0)&E)!==0)throw new Error("Bits beyond keysize not zero as expected.");var w=c.generate(g,S),I="";for(d=0;d<S;d++)I+=String.fromCharCode(f.charCodeAt(d)^w.charCodeAt(d));I=String.fromCharCode(I.charCodeAt(0)&~E)+I.substr(1);var x=b-o-n-2;for(d=0;d<x;d++)if(I.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(I.charCodeAt(x)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var h=I.substr(-n),s=new t.util.ByteBuffer;s.fillWithByte(0,8),s.putBytes(m),s.putBytes(h),a.start(),a.update(s.getBytes());var T=a.digest().getBytes();return g===T},l},ua.exports}var Xi;function Qa(){if(Xi)return oa.exports;Xi=1;var t=ge();hr(),kt(),Sn(),qt(),E0(),dr(),Er(),Ya(),bn(),Ee();var e=t.asn1,r=oa.exports=t.pki=t.pki||{},a=r.oids,c={};c.CN=a.commonName,c.commonName="CN",c.C=a.countryName,c.countryName="C",c.L=a.localityName,c.localityName="L",c.ST=a.stateOrProvinceName,c.stateOrProvinceName="ST",c.O=a.organizationName,c.organizationName="O",c.OU=a.organizationalUnitName,c.organizationalUnitName="OU",c.E=a.emailAddress,c.emailAddress="E";var o=t.pki.rsa.publicKeyValidator,i={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},o,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},n={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},u={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},o,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},l={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[u,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};r.RDNAttributesAsArray=function(x,h){for(var s=[],T,N,O,_=0;_<x.value.length;++_){T=x.value[_];for(var D=0;D<T.value.length;++D)O={},N=T.value[D],O.type=e.derToOid(N.value[0].value),O.value=N.value[1].value,O.valueTagClass=N.value[1].type,O.type in a&&(O.name=a[O.type],O.name in c&&(O.shortName=c[O.name])),h&&(h.update(O.type),h.update(O.value)),s.push(O)}return s},r.CRIAttributesAsArray=function(x){for(var h=[],s=0;s<x.length;++s)for(var T=x[s],N=e.derToOid(T.value[0].value),O=T.value[1].value,_=0;_<O.length;++_){var D={};if(D.type=N,D.value=O[_].value,D.valueTagClass=O[_].type,D.type in a&&(D.name=a[D.type],D.name in c&&(D.shortName=c[D.name])),D.type===a.extensionRequest){D.extensions=[];for(var V=0;V<D.value.length;++V)D.extensions.push(r.certificateExtensionFromAsn1(D.value[V]))}h.push(D)}return h};function m(x,h){typeof h=="string"&&(h={shortName:h});for(var s=null,T,N=0;s===null&&N<x.attributes.length;++N)T=x.attributes[N],(h.type&&h.type===T.type||h.name&&h.name===T.name||h.shortName&&h.shortName===T.shortName)&&(s=T);return s}var B=function(x,h,s){var T={};if(x!==a["RSASSA-PSS"])return T;s&&(T={hash:{algorithmOid:a.sha1},mgf:{algorithmOid:a.mgf1,hash:{algorithmOid:a.sha1}},saltLength:20});var N={},O=[];if(!e.validate(h,n,N,O)){var _=new Error("Cannot read RSASSA-PSS parameter block.");throw _.errors=O,_}return N.hashOid!==void 0&&(T.hash=T.hash||{},T.hash.algorithmOid=e.derToOid(N.hashOid)),N.maskGenOid!==void 0&&(T.mgf=T.mgf||{},T.mgf.algorithmOid=e.derToOid(N.maskGenOid),T.mgf.hash=T.mgf.hash||{},T.mgf.hash.algorithmOid=e.derToOid(N.maskGenHashOid)),N.saltLength!==void 0&&(T.saltLength=N.saltLength.charCodeAt(0)),T},v=function(x){switch(a[x.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var h=new Error("Could not compute "+x.type+" digest. Unknown signature OID.");throw h.signatureOid=x.signatureOid,h}},d=function(x){var h=x.certificate,s;switch(h.signatureOid){case a.sha1WithRSAEncryption:case a.sha1WithRSASignature:break;case a["RSASSA-PSS"]:var T,N;if(T=a[h.signatureParameters.mgf.hash.algorithmOid],T===void 0||t.md[T]===void 0){var O=new Error("Unsupported MGF hash function.");throw O.oid=h.signatureParameters.mgf.hash.algorithmOid,O.name=T,O}if(N=a[h.signatureParameters.mgf.algorithmOid],N===void 0||t.mgf[N]===void 0){var O=new Error("Unsupported MGF function.");throw O.oid=h.signatureParameters.mgf.algorithmOid,O.name=N,O}if(N=t.mgf[N].create(t.md[T].create()),T=a[h.signatureParameters.hash.algorithmOid],T===void 0||t.md[T]===void 0){var O=new Error("Unsupported RSASSA-PSS hash function.");throw O.oid=h.signatureParameters.hash.algorithmOid,O.name=T,O}s=t.pss.create(t.md[T].create(),N,h.signatureParameters.saltLength);break}return h.publicKey.verify(x.md.digest().getBytes(),x.signature,s)};r.certificateFromPem=function(x,h,s){var T=t.pem.decode(x)[0];if(T.type!=="CERTIFICATE"&&T.type!=="X509 CERTIFICATE"&&T.type!=="TRUSTED CERTIFICATE"){var N=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw N.headerType=T.type,N}if(T.procType&&T.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var O=e.fromDer(T.body,s);return r.certificateFromAsn1(O,h)},r.certificateToPem=function(x,h){var s={type:"CERTIFICATE",body:e.toDer(r.certificateToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:h})},r.publicKeyFromPem=function(x){var h=t.pem.decode(x)[0];if(h.type!=="PUBLIC KEY"&&h.type!=="RSA PUBLIC KEY"){var s=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw s.headerType=h.type,s}if(h.procType&&h.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var T=e.fromDer(h.body);return r.publicKeyFromAsn1(T)},r.publicKeyToPem=function(x,h){var s={type:"PUBLIC KEY",body:e.toDer(r.publicKeyToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:h})},r.publicKeyToRSAPublicKeyPem=function(x,h){var s={type:"RSA PUBLIC KEY",body:e.toDer(r.publicKeyToRSAPublicKey(x)).getBytes()};return t.pem.encode(s,{maxline:h})},r.getPublicKeyFingerprint=function(x,h){h=h||{};var s=h.md||t.md.sha1.create(),T=h.type||"RSAPublicKey",N;switch(T){case"RSAPublicKey":N=e.toDer(r.publicKeyToRSAPublicKey(x)).getBytes();break;case"SubjectPublicKeyInfo":N=e.toDer(r.publicKeyToAsn1(x)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+h.type+'".')}s.start(),s.update(N);var O=s.digest();if(h.encoding==="hex"){var _=O.toHex();return h.delimiter?_.match(/.{2}/g).join(h.delimiter):_}else{if(h.encoding==="binary")return O.getBytes();if(h.encoding)throw new Error('Unknown encoding "'+h.encoding+'".')}return O},r.certificationRequestFromPem=function(x,h,s){var T=t.pem.decode(x)[0];if(T.type!=="CERTIFICATE REQUEST"){var N=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw N.headerType=T.type,N}if(T.procType&&T.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var O=e.fromDer(T.body,s);return r.certificationRequestFromAsn1(O,h)},r.certificationRequestToPem=function(x,h){var s={type:"CERTIFICATE REQUEST",body:e.toDer(r.certificationRequestToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:h})},r.createCertificate=function(){var x={};return x.version=2,x.serialNumber="00",x.signatureOid=null,x.signature=null,x.siginfo={},x.siginfo.algorithmOid=null,x.validity={},x.validity.notBefore=new Date,x.validity.notAfter=new Date,x.issuer={},x.issuer.getField=function(h){return m(x.issuer,h)},x.issuer.addField=function(h){b([h]),x.issuer.attributes.push(h)},x.issuer.attributes=[],x.issuer.hash=null,x.subject={},x.subject.getField=function(h){return m(x.subject,h)},x.subject.addField=function(h){b([h]),x.subject.attributes.push(h)},x.subject.attributes=[],x.subject.hash=null,x.extensions=[],x.publicKey=null,x.md=null,x.setSubject=function(h,s){b(h),x.subject.attributes=h,delete x.subject.uniqueId,s&&(x.subject.uniqueId=s),x.subject.hash=null},x.setIssuer=function(h,s){b(h),x.issuer.attributes=h,delete x.issuer.uniqueId,s&&(x.issuer.uniqueId=s),x.issuer.hash=null},x.setExtensions=function(h){for(var s=0;s<h.length;++s)S(h[s],{cert:x});x.extensions=h},x.getExtension=function(h){typeof h=="string"&&(h={name:h});for(var s=null,T,N=0;s===null&&N<x.extensions.length;++N)T=x.extensions[N],(h.id&&T.id===h.id||h.name&&T.name===h.name)&&(s=T);return s},x.sign=function(h,s){x.md=s||t.md.sha1.create();var T=a[x.md.algorithm+"WithRSAEncryption"];if(!T){var N=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw N.algorithm=x.md.algorithm,N}x.signatureOid=x.siginfo.algorithmOid=T,x.tbsCertificate=r.getTBSCertificate(x);var O=e.toDer(x.tbsCertificate);x.md.update(O.getBytes()),x.signature=h.sign(x.md)},x.verify=function(h){var s=!1;if(!x.issued(h)){var T=h.issuer,N=x.subject,O=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw O.expectedIssuer=N.attributes,O.actualIssuer=T.attributes,O}var _=h.md;if(_===null){_=v({signatureOid:h.signatureOid,type:"certificate"});var D=h.tbsCertificate||r.getTBSCertificate(h),V=e.toDer(D);_.update(V.getBytes())}return _!==null&&(s=d({certificate:x,md:_,signature:h.signature})),s},x.isIssuer=function(h){var s=!1,T=x.issuer,N=h.subject;if(T.hash&&N.hash)s=T.hash===N.hash;else if(T.attributes.length===N.attributes.length){s=!0;for(var O,_,D=0;s&&D<T.attributes.length;++D)O=T.attributes[D],_=N.attributes[D],(O.type!==_.type||O.value!==_.value)&&(s=!1)}return s},x.issued=function(h){return h.isIssuer(x)},x.generateSubjectKeyIdentifier=function(){return r.getPublicKeyFingerprint(x.publicKey,{type:"RSAPublicKey"})},x.verifySubjectKeyIdentifier=function(){for(var h=a.subjectKeyIdentifier,s=0;s<x.extensions.length;++s){var T=x.extensions[s];if(T.id===h){var N=x.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(T.subjectKeyIdentifier)===N}}return!1},x},r.certificateFromAsn1=function(x,h){var s={},T=[];if(!e.validate(x,i,s,T)){var N=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw N.errors=T,N}var O=e.derToOid(s.publicKeyOid);if(O!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var _=r.createCertificate();_.version=s.certVersion?s.certVersion.charCodeAt(0):0;var D=t.util.createBuffer(s.certSerialNumber);_.serialNumber=D.toHex(),_.signatureOid=t.asn1.derToOid(s.certSignatureOid),_.signatureParameters=B(_.signatureOid,s.certSignatureParams,!0),_.siginfo.algorithmOid=t.asn1.derToOid(s.certinfoSignatureOid),_.siginfo.parameters=B(_.siginfo.algorithmOid,s.certinfoSignatureParams,!1),_.signature=s.certSignature;var V=[];if(s.certValidity1UTCTime!==void 0&&V.push(e.utcTimeToDate(s.certValidity1UTCTime)),s.certValidity2GeneralizedTime!==void 0&&V.push(e.generalizedTimeToDate(s.certValidity2GeneralizedTime)),s.certValidity3UTCTime!==void 0&&V.push(e.utcTimeToDate(s.certValidity3UTCTime)),s.certValidity4GeneralizedTime!==void 0&&V.push(e.generalizedTimeToDate(s.certValidity4GeneralizedTime)),V.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(V.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(_.validity.notBefore=V[0],_.validity.notAfter=V[1],_.tbsCertificate=s.tbsCertificate,h){_.md=v({signatureOid:_.signatureOid,type:"certificate"});var P=e.toDer(_.tbsCertificate);_.md.update(P.getBytes())}var M=t.md.sha1.create(),q=e.toDer(s.certIssuer);M.update(q.getBytes()),_.issuer.getField=function(Y){return m(_.issuer,Y)},_.issuer.addField=function(Y){b([Y]),_.issuer.attributes.push(Y)},_.issuer.attributes=r.RDNAttributesAsArray(s.certIssuer),s.certIssuerUniqueId&&(_.issuer.uniqueId=s.certIssuerUniqueId),_.issuer.hash=M.digest().toHex();var $=t.md.sha1.create(),G=e.toDer(s.certSubject);return $.update(G.getBytes()),_.subject.getField=function(Y){return m(_.subject,Y)},_.subject.addField=function(Y){b([Y]),_.subject.attributes.push(Y)},_.subject.attributes=r.RDNAttributesAsArray(s.certSubject),s.certSubjectUniqueId&&(_.subject.uniqueId=s.certSubjectUniqueId),_.subject.hash=$.digest().toHex(),s.certExtensions?_.extensions=r.certificateExtensionsFromAsn1(s.certExtensions):_.extensions=[],_.publicKey=r.publicKeyFromAsn1(s.subjectPublicKeyInfo),_},r.certificateExtensionsFromAsn1=function(x){for(var h=[],s=0;s<x.value.length;++s)for(var T=x.value[s],N=0;N<T.value.length;++N)h.push(r.certificateExtensionFromAsn1(T.value[N]));return h},r.certificateExtensionFromAsn1=function(x){var h={};if(h.id=e.derToOid(x.value[0].value),h.critical=!1,x.value[1].type===e.Type.BOOLEAN?(h.critical=x.value[1].value.charCodeAt(0)!==0,h.value=x.value[2].value):h.value=x.value[1].value,h.id in a){if(h.name=a[h.id],h.name==="keyUsage"){var s=e.fromDer(h.value),T=0,N=0;s.value.length>1&&(T=s.value.charCodeAt(1),N=s.value.length>2?s.value.charCodeAt(2):0),h.digitalSignature=(T&128)===128,h.nonRepudiation=(T&64)===64,h.keyEncipherment=(T&32)===32,h.dataEncipherment=(T&16)===16,h.keyAgreement=(T&8)===8,h.keyCertSign=(T&4)===4,h.cRLSign=(T&2)===2,h.encipherOnly=(T&1)===1,h.decipherOnly=(N&128)===128}else if(h.name==="basicConstraints"){var s=e.fromDer(h.value);s.value.length>0&&s.value[0].type===e.Type.BOOLEAN?h.cA=s.value[0].value.charCodeAt(0)!==0:h.cA=!1;var O=null;s.value.length>0&&s.value[0].type===e.Type.INTEGER?O=s.value[0].value:s.value.length>1&&(O=s.value[1].value),O!==null&&(h.pathLenConstraint=e.derToInteger(O))}else if(h.name==="extKeyUsage")for(var s=e.fromDer(h.value),_=0;_<s.value.length;++_){var D=e.derToOid(s.value[_].value);D in a?h[a[D]]=!0:h[D]=!0}else if(h.name==="nsCertType"){var s=e.fromDer(h.value),T=0;s.value.length>1&&(T=s.value.charCodeAt(1)),h.client=(T&128)===128,h.server=(T&64)===64,h.email=(T&32)===32,h.objsign=(T&16)===16,h.reserved=(T&8)===8,h.sslCA=(T&4)===4,h.emailCA=(T&2)===2,h.objCA=(T&1)===1}else if(h.name==="subjectAltName"||h.name==="issuerAltName"){h.altNames=[];for(var V,s=e.fromDer(h.value),P=0;P<s.value.length;++P){V=s.value[P];var M={type:V.type,value:V.value};switch(h.altNames.push(M),V.type){case 1:case 2:case 6:break;case 7:M.ip=t.util.bytesToIP(V.value);break;case 8:M.oid=e.derToOid(V.value);break}}}else if(h.name==="subjectKeyIdentifier"){var s=e.fromDer(h.value);h.subjectKeyIdentifier=t.util.bytesToHex(s.value)}}return h},r.certificationRequestFromAsn1=function(x,h){var s={},T=[];if(!e.validate(x,l,s,T)){var N=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw N.errors=T,N}var O=e.derToOid(s.publicKeyOid);if(O!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var _=r.createCertificationRequest();if(_.version=s.csrVersion?s.csrVersion.charCodeAt(0):0,_.signatureOid=t.asn1.derToOid(s.csrSignatureOid),_.signatureParameters=B(_.signatureOid,s.csrSignatureParams,!0),_.siginfo.algorithmOid=t.asn1.derToOid(s.csrSignatureOid),_.siginfo.parameters=B(_.siginfo.algorithmOid,s.csrSignatureParams,!1),_.signature=s.csrSignature,_.certificationRequestInfo=s.certificationRequestInfo,h){_.md=v({signatureOid:_.signatureOid,type:"certification request"});var D=e.toDer(_.certificationRequestInfo);_.md.update(D.getBytes())}var V=t.md.sha1.create();return _.subject.getField=function(P){return m(_.subject,P)},_.subject.addField=function(P){b([P]),_.subject.attributes.push(P)},_.subject.attributes=r.RDNAttributesAsArray(s.certificationRequestInfoSubject,V),_.subject.hash=V.digest().toHex(),_.publicKey=r.publicKeyFromAsn1(s.subjectPublicKeyInfo),_.getAttribute=function(P){return m(_,P)},_.addAttribute=function(P){b([P]),_.attributes.push(P)},_.attributes=r.CRIAttributesAsArray(s.certificationRequestInfoAttributes||[]),_},r.createCertificationRequest=function(){var x={};return x.version=0,x.signatureOid=null,x.signature=null,x.siginfo={},x.siginfo.algorithmOid=null,x.subject={},x.subject.getField=function(h){return m(x.subject,h)},x.subject.addField=function(h){b([h]),x.subject.attributes.push(h)},x.subject.attributes=[],x.subject.hash=null,x.publicKey=null,x.attributes=[],x.getAttribute=function(h){return m(x,h)},x.addAttribute=function(h){b([h]),x.attributes.push(h)},x.md=null,x.setSubject=function(h){b(h),x.subject.attributes=h,x.subject.hash=null},x.setAttributes=function(h){b(h),x.attributes=h},x.sign=function(h,s){x.md=s||t.md.sha1.create();var T=a[x.md.algorithm+"WithRSAEncryption"];if(!T){var N=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw N.algorithm=x.md.algorithm,N}x.signatureOid=x.siginfo.algorithmOid=T,x.certificationRequestInfo=r.getCertificationRequestInfo(x);var O=e.toDer(x.certificationRequestInfo);x.md.update(O.getBytes()),x.signature=h.sign(x.md)},x.verify=function(){var h=!1,s=x.md;if(s===null){s=v({signatureOid:x.signatureOid,type:"certification request"});var T=x.certificationRequestInfo||r.getCertificationRequestInfo(x),N=e.toDer(T);s.update(N.getBytes())}return s!==null&&(h=d({certificate:x,md:s,signature:x.signature})),h},x};function y(x){for(var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),s,T,N=x.attributes,O=0;O<N.length;++O){s=N[O];var _=s.value,D=e.Type.PRINTABLESTRING;"valueTagClass"in s&&(D=s.valueTagClass,D===e.Type.UTF8&&(_=t.util.encodeUtf8(_))),T=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(s.type).getBytes()),e.create(e.Class.UNIVERSAL,D,!1,_)])]),h.value.push(T)}return h}function b(x){for(var h,s=0;s<x.length;++s){if(h=x[s],typeof h.name>"u"&&(h.type&&h.type in r.oids?h.name=r.oids[h.type]:h.shortName&&h.shortName in c&&(h.name=r.oids[c[h.shortName]])),typeof h.type>"u")if(h.name&&h.name in r.oids)h.type=r.oids[h.name];else{var T=new Error("Attribute type not specified.");throw T.attribute=h,T}if(typeof h.shortName>"u"&&h.name&&h.name in c&&(h.shortName=c[h.name]),h.type===a.extensionRequest&&(h.valueConstructed=!0,h.valueTagClass=e.Type.SEQUENCE,!h.value&&h.extensions)){h.value=[];for(var N=0;N<h.extensions.length;++N)h.value.push(r.certificateExtensionToAsn1(S(h.extensions[N])))}if(typeof h.value>"u"){var T=new Error("Attribute value not specified.");throw T.attribute=h,T}}}function S(x,h){if(h=h||{},typeof x.name>"u"&&x.id&&x.id in r.oids&&(x.name=r.oids[x.id]),typeof x.id>"u")if(x.name&&x.name in r.oids)x.id=r.oids[x.name];else{var s=new Error("Extension ID not specified.");throw s.extension=x,s}if(typeof x.value<"u")return x;if(x.name==="keyUsage"){var T=0,N=0,O=0;x.digitalSignature&&(N|=128,T=7),x.nonRepudiation&&(N|=64,T=6),x.keyEncipherment&&(N|=32,T=5),x.dataEncipherment&&(N|=16,T=4),x.keyAgreement&&(N|=8,T=3),x.keyCertSign&&(N|=4,T=2),x.cRLSign&&(N|=2,T=1),x.encipherOnly&&(N|=1,T=0),x.decipherOnly&&(O|=128,T=7);var _=String.fromCharCode(T);O!==0?_+=String.fromCharCode(N)+String.fromCharCode(O):N!==0&&(_+=String.fromCharCode(N)),x.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,_)}else if(x.name==="basicConstraints")x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),x.cA&&x.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"")),"pathLenConstraint"in x&&x.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.pathLenConstraint).getBytes()));else if(x.name==="extKeyUsage"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var D=x.value.value;for(var V in x)x[V]===!0&&(V in a?D.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a[V]).getBytes())):V.indexOf(".")!==-1&&D.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(V).getBytes())))}else if(x.name==="nsCertType"){var T=0,N=0;x.client&&(N|=128,T=7),x.server&&(N|=64,T=6),x.email&&(N|=32,T=5),x.objsign&&(N|=16,T=4),x.reserved&&(N|=8,T=3),x.sslCA&&(N|=4,T=2),x.emailCA&&(N|=2,T=1),x.objCA&&(N|=1,T=0);var _=String.fromCharCode(T);N!==0&&(_+=String.fromCharCode(N)),x.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,_)}else if(x.name==="subjectAltName"||x.name==="issuerAltName"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var P,M=0;M<x.altNames.length;++M){P=x.altNames[M];var _=P.value;if(P.type===7&&P.ip){if(_=t.util.bytesFromIP(P.ip),_===null){var s=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw s.extension=x,s}}else P.type===8&&(P.oid?_=e.oidToDer(e.oidToDer(P.oid)):_=e.oidToDer(_));x.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,P.type,!1,_))}}else if(x.name==="nsComment"&&h.cert){if(!/^[\x00-\x7F]*$/.test(x.comment)||x.comment.length<1||x.comment.length>128)throw new Error('Invalid "nsComment" content.');x.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,x.comment)}else if(x.name==="subjectKeyIdentifier"&&h.cert){var q=h.cert.generateSubjectKeyIdentifier();x.subjectKeyIdentifier=q.toHex(),x.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,q.getBytes())}else if(x.name==="authorityKeyIdentifier"&&h.cert){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var D=x.value.value;if(x.keyIdentifier){var $=x.keyIdentifier===!0?h.cert.generateSubjectKeyIdentifier().getBytes():x.keyIdentifier;D.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,$))}if(x.authorityCertIssuer){var G=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[y(x.authorityCertIssuer===!0?h.cert.issuer:x.authorityCertIssuer)])];D.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,G))}if(x.serialNumber){var Y=t.util.hexToBytes(x.serialNumber===!0?h.cert.serialNumber:x.serialNumber);D.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,Y))}}else if(x.name==="cRLDistributionPoints"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var D=x.value.value,j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),te=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),P,M=0;M<x.altNames.length;++M){P=x.altNames[M];var _=P.value;if(P.type===7&&P.ip){if(_=t.util.bytesFromIP(P.ip),_===null){var s=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw s.extension=x,s}}else P.type===8&&(P.oid?_=e.oidToDer(e.oidToDer(P.oid)):_=e.oidToDer(_));te.value.push(e.create(e.Class.CONTEXT_SPECIFIC,P.type,!1,_))}j.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[te])),D.push(j)}if(typeof x.value>"u"){var s=new Error("Extension value not specified.");throw s.extension=x,s}return x}function f(x,h){switch(x){case a["RSASSA-PSS"]:var s=[];return h.hash.algorithmOid!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),h.mgf.algorithmOid!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(h.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),h.saltLength!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(h.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,s);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function g(x){var h=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(x.attributes.length===0)return h;for(var s=x.attributes,T=0;T<s.length;++T){var N=s[T],O=N.value,_=e.Type.UTF8;"valueTagClass"in N&&(_=N.valueTagClass),_===e.Type.UTF8&&(O=t.util.encodeUtf8(O));var D=!1;"valueConstructed"in N&&(D=N.valueConstructed);var V=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(N.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,_,D,O)])]);h.value.push(V)}return h}var E=new Date("1950-01-01T00:00:00Z"),w=new Date("2050-01-01T00:00:00Z");function I(x){return x>=E&&x<w?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(x)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(x))}return r.getTBSCertificate=function(x){var h=I(x.validity.notBefore),s=I(x.validity.notAfter),T=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(x.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.siginfo.algorithmOid).getBytes()),f(x.siginfo.algorithmOid,x.siginfo.parameters)]),y(x.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,s]),y(x.subject),r.publicKeyToAsn1(x.publicKey)]);return x.issuer.uniqueId&&T.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.issuer.uniqueId)])),x.subject.uniqueId&&T.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.subject.uniqueId)])),x.extensions.length>0&&T.value.push(r.certificateExtensionsToAsn1(x.extensions)),T},r.getCertificationRequestInfo=function(x){var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.version).getBytes()),y(x.subject),r.publicKeyToAsn1(x.publicKey),g(x)]);return h},r.distinguishedNameToAsn1=function(x){return y(x)},r.certificateToAsn1=function(x){var h=x.tbsCertificate||r.getTBSCertificate(x);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.signatureOid).getBytes()),f(x.signatureOid,x.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.signature)])},r.certificateExtensionsToAsn1=function(x){var h=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),s=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);h.value.push(s);for(var T=0;T<x.length;++T)s.value.push(r.certificateExtensionToAsn1(x[T]));return h},r.certificateExtensionToAsn1=function(x){var h=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);h.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.id).getBytes())),x.critical&&h.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,""));var s=x.value;return typeof x.value!="string"&&(s=e.toDer(s).getBytes()),h.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s)),h},r.certificationRequestToAsn1=function(x){var h=x.certificationRequestInfo||r.getCertificationRequestInfo(x);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[h,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.signatureOid).getBytes()),f(x.signatureOid,x.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.signature)])},r.createCaStore=function(x){var h={certs:{}};h.getIssuer=function(_){var D=s(_.issuer);return D},h.addCertificate=function(_){if(typeof _=="string"&&(_=t.pki.certificateFromPem(_)),T(_.subject),!h.hasCertificate(_))if(_.subject.hash in h.certs){var D=h.certs[_.subject.hash];t.util.isArray(D)||(D=[D]),D.push(_),h.certs[_.subject.hash]=D}else h.certs[_.subject.hash]=_},h.hasCertificate=function(_){typeof _=="string"&&(_=t.pki.certificateFromPem(_));var D=s(_.subject);if(!D)return!1;t.util.isArray(D)||(D=[D]);for(var V=e.toDer(r.certificateToAsn1(_)).getBytes(),P=0;P<D.length;++P){var M=e.toDer(r.certificateToAsn1(D[P])).getBytes();if(V===M)return!0}return!1},h.listAllCertificates=function(){var _=[];for(var D in h.certs)if(h.certs.hasOwnProperty(D)){var V=h.certs[D];if(!t.util.isArray(V))_.push(V);else for(var P=0;P<V.length;++P)_.push(V[P])}return _},h.removeCertificate=function(_){var D;if(typeof _=="string"&&(_=t.pki.certificateFromPem(_)),T(_.subject),!h.hasCertificate(_))return null;var V=s(_.subject);if(!t.util.isArray(V))return D=h.certs[_.subject.hash],delete h.certs[_.subject.hash],D;for(var P=e.toDer(r.certificateToAsn1(_)).getBytes(),M=0;M<V.length;++M){var q=e.toDer(r.certificateToAsn1(V[M])).getBytes();P===q&&(D=V[M],V.splice(M,1))}return V.length===0&&delete h.certs[_.subject.hash],D};function s(_){return T(_),h.certs[_.hash]||null}function T(_){if(!_.hash){var D=t.md.sha1.create();_.attributes=r.RDNAttributesAsArray(y(_),D),_.hash=D.digest().toHex()}}if(x)for(var N=0;N<x.length;++N){var O=x[N];h.addCertificate(O)}return h},r.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},r.verifyCertificateChain=function(x,h,s){typeof s=="function"&&(s={verify:s}),s=s||{},h=h.slice(0);var T=h.slice(0),N=s.validityCheckDate;typeof N>"u"&&(N=new Date);var O=!0,_=null,D=0;do{var V=h.shift(),P=null,M=!1;if(N&&(N<V.validity.notBefore||N>V.validity.notAfter)&&(_={message:"Certificate is not valid yet or has expired.",error:r.certificateError.certificate_expired,notBefore:V.validity.notBefore,notAfter:V.validity.notAfter,now:N}),_===null){if(P=h[0]||x.getIssuer(V),P===null&&V.isIssuer(V)&&(M=!0,P=V),P){var q=P;t.util.isArray(q)||(q=[q]);for(var $=!1;!$&&q.length>0;){P=q.shift();try{$=P.verify(V)}catch{}}$||(_={message:"Certificate signature is invalid.",error:r.certificateError.bad_certificate})}_===null&&(!P||M)&&!x.hasCertificate(V)&&(_={message:"Certificate is not trusted.",error:r.certificateError.unknown_ca})}if(_===null&&P&&!V.isIssuer(P)&&(_={message:"Certificate issuer is invalid.",error:r.certificateError.bad_certificate}),_===null)for(var G={keyUsage:!0,basicConstraints:!0},Y=0;_===null&&Y<V.extensions.length;++Y){var j=V.extensions[Y];j.critical&&!(j.name in G)&&(_={message:"Certificate has an unsupported critical extension.",error:r.certificateError.unsupported_certificate})}if(_===null&&(!O||h.length===0&&(!P||M))){var te=V.getExtension("basicConstraints"),ue=V.getExtension("keyUsage");if(ue!==null&&(!ue.keyCertSign||te===null)&&(_={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:r.certificateError.bad_certificate}),_===null&&te!==null&&!te.cA&&(_={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:r.certificateError.bad_certificate}),_===null&&ue!==null&&"pathLenConstraint"in te){var X=D-1;X>te.pathLenConstraint&&(_={message:"Certificate basicConstraints pathLenConstraint violated.",error:r.certificateError.bad_certificate})}}var re=_===null?!0:_.error,W=s.verify?s.verify(re,D,T):re;if(W===!0)_=null;else throw re===!0&&(_={message:"The application rejected the certificate.",error:r.certificateError.bad_certificate}),(W||W===0)&&(typeof W=="object"&&!t.util.isArray(W)?(W.message&&(_.message=W.message),W.error&&(_.error=W.error)):typeof W=="string"&&(_.error=W)),_;O=!1,++D}while(h.length>0);return!0},oa.exports}var ji;function _o(){if(ji)return ia.exports;ji=1;var t=ge();kt(),Mr(),dr(),Ao(),wo(),Bt(),bn(),Hr(),Ee(),Qa();var e=t.asn1,r=t.pki,a=ia.exports=t.pkcs12=t.pkcs12||{},c={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},o={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},c,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},i={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},n={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},u={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function l(b,S,f,g){for(var E=[],w=0;w<b.length;w++)for(var I=0;I<b[w].safeBags.length;I++){var x=b[w].safeBags[I];if(!(g!==void 0&&x.type!==g)){if(S===null){E.push(x);continue}x.attributes[S]!==void 0&&x.attributes[S].indexOf(f)>=0&&E.push(x)}}return E}a.pkcs12FromAsn1=function(b,S,f){typeof S=="string"?(f=S,S=!0):S===void 0&&(S=!0);var g={},E=[];if(!e.validate(b,o,g,E)){var w=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw w.errors=w,w}var I={version:g.version.charCodeAt(0),safeContents:[],getBags:function(P){var M={},q;return"localKeyId"in P?q=P.localKeyId:"localKeyIdHex"in P&&(q=t.util.hexToBytes(P.localKeyIdHex)),q===void 0&&!("friendlyName"in P)&&"bagType"in P&&(M[P.bagType]=l(I.safeContents,null,null,P.bagType)),q!==void 0&&(M.localKeyId=l(I.safeContents,"localKeyId",q,P.bagType)),"friendlyName"in P&&(M.friendlyName=l(I.safeContents,"friendlyName",P.friendlyName,P.bagType)),M},getBagsByFriendlyName:function(P,M){return l(I.safeContents,"friendlyName",P,M)},getBagsByLocalKeyId:function(P,M){return l(I.safeContents,"localKeyId",P,M)}};if(g.version.charCodeAt(0)!==3){var w=new Error("PKCS#12 PFX of version other than 3 not supported.");throw w.version=g.version.charCodeAt(0),w}if(e.derToOid(g.contentType)!==r.oids.data){var w=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw w.oid=e.derToOid(g.contentType),w}var x=g.content.value[0];if(x.tagClass!==e.Class.UNIVERSAL||x.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(x=m(x),g.mac){var h=null,s=0,T=e.derToOid(g.macAlgorithm);switch(T){case r.oids.sha1:h=t.md.sha1.create(),s=20;break;case r.oids.sha256:h=t.md.sha256.create(),s=32;break;case r.oids.sha384:h=t.md.sha384.create(),s=48;break;case r.oids.sha512:h=t.md.sha512.create(),s=64;break;case r.oids.md5:h=t.md.md5.create(),s=16;break}if(h===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+T);var N=new t.util.ByteBuffer(g.macSalt),O="macIterations"in g?parseInt(t.util.bytesToHex(g.macIterations),16):1,_=a.generateKey(f,N,3,O,s,h),D=t.hmac.create();D.start(h,_),D.update(x.value);var V=D.getMac();if(V.getBytes()!==g.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return B(I,x.value,S,f),I};function m(b){if(b.composed||b.constructed){for(var S=t.util.createBuffer(),f=0;f<b.value.length;++f)S.putBytes(b.value[f].value);b.composed=b.constructed=!1,b.value=S.getBytes()}return b}function B(b,S,f,g){if(S=e.fromDer(S,f),S.tagClass!==e.Class.UNIVERSAL||S.type!==e.Type.SEQUENCE||S.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var E=0;E<S.value.length;E++){var w=S.value[E],I={},x=[];if(!e.validate(w,c,I,x)){var h=new Error("Cannot read ContentInfo.");throw h.errors=x,h}var s={encrypted:!1},T=null,N=I.content.value[0];switch(e.derToOid(I.contentType)){case r.oids.data:if(N.tagClass!==e.Class.UNIVERSAL||N.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");T=m(N).value;break;case r.oids.encryptedData:T=v(N,g),s.encrypted=!0;break;default:var h=new Error("Unsupported PKCS#12 contentType.");throw h.contentType=e.derToOid(I.contentType),h}s.safeBags=d(T,f,g),b.safeContents.push(s)}}function v(b,S){var f={},g=[];if(!e.validate(b,t.pkcs7.asn1.encryptedDataValidator,f,g)){var E=new Error("Cannot read EncryptedContentInfo.");throw E.errors=g,E}var w=e.derToOid(f.contentType);if(w!==r.oids.data){var E=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw E.oid=w,E}w=e.derToOid(f.encAlgorithm);var I=r.pbe.getCipher(w,f.encParameter,S),x=m(f.encryptedContentAsn1),h=t.util.createBuffer(x.value);if(I.update(h),!I.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return I.output.getBytes()}function d(b,S,f){if(!S&&b.length===0)return[];if(b=e.fromDer(b,S),b.tagClass!==e.Class.UNIVERSAL||b.type!==e.Type.SEQUENCE||b.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var g=[],E=0;E<b.value.length;E++){var w=b.value[E],I={},x=[];if(!e.validate(w,i,I,x)){var h=new Error("Cannot read SafeBag.");throw h.errors=x,h}var s={type:e.derToOid(I.bagId),attributes:y(I.bagAttributes)};g.push(s);var T,N,O=I.bagValue.value[0];switch(s.type){case r.oids.pkcs8ShroudedKeyBag:if(O=r.decryptPrivateKeyInfo(O,f),O===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case r.oids.keyBag:try{s.key=r.privateKeyFromAsn1(O)}catch{s.key=null,s.asn1=O}continue;case r.oids.certBag:T=u,N=function(){if(e.derToOid(I.certId)!==r.oids.x509Certificate){var D=new Error("Unsupported certificate type, only X.509 supported.");throw D.oid=e.derToOid(I.certId),D}var V=e.fromDer(I.cert,S);try{s.cert=r.certificateFromAsn1(V,!0)}catch{s.cert=null,s.asn1=V}};break;default:var h=new Error("Unsupported PKCS#12 SafeBag type.");throw h.oid=s.type,h}if(T!==void 0&&!e.validate(O,T,I,x)){var h=new Error("Cannot read PKCS#12 "+T.name);throw h.errors=x,h}N()}return g}function y(b){var S={};if(b!==void 0)for(var f=0;f<b.length;++f){var g={},E=[];if(!e.validate(b[f],n,g,E)){var w=new Error("Cannot read PKCS#12 BagAttribute.");throw w.errors=E,w}var I=e.derToOid(g.oid);if(r.oids[I]!==void 0){S[r.oids[I]]=[];for(var x=0;x<g.values.length;++x)S[r.oids[I]].push(g.values[x].value)}}return S}return a.toPkcs12Asn1=function(b,S,f,g){g=g||{},g.saltSize=g.saltSize||8,g.count=g.count||2048,g.algorithm=g.algorithm||g.encAlgorithm||"aes128","useMac"in g||(g.useMac=!0),"localKeyId"in g||(g.localKeyId=null),"generateLocalKeyId"in g||(g.generateLocalKeyId=!0);var E=g.localKeyId,w;if(E!==null)E=t.util.hexToBytes(E);else if(g.generateLocalKeyId)if(S){var I=t.util.isArray(S)?S[0]:S;typeof I=="string"&&(I=r.certificateFromPem(I));var x=t.md.sha1.create();x.update(e.toDer(r.certificateToAsn1(I)).getBytes()),E=x.digest().getBytes()}else E=t.random.getBytes(20);var h=[];E!==null&&h.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,E)])])),"friendlyName"in g&&h.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,g.friendlyName)])])),h.length>0&&(w=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,h));var s=[],T=[];S!==null&&(t.util.isArray(S)?T=S:T=[S]);for(var N=[],O=0;O<T.length;++O){S=T[O],typeof S=="string"&&(S=r.certificateFromPem(S));var _=O===0?w:void 0,D=r.certificateToAsn1(S),V=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(D).getBytes())])])]),_]);N.push(V)}if(N.length>0){var P=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,N),M=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(P).getBytes())])]);s.push(M)}var q=null;if(b!==null){var $=r.wrapRsaPrivateKey(r.privateKeyToAsn1(b));f===null?q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[$]),w]):q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[r.encryptPrivateKeyInfo($,f,g)]),w]);var G=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[q]),Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(G).getBytes())])]);s.push(Y)}var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,s),te;if(g.useMac){var x=t.md.sha1.create(),ue=new t.util.ByteBuffer(t.random.getBytes(g.saltSize)),X=g.count,b=a.generateKey(f,ue,3,X,20),re=t.hmac.create();re.start(x,b),re.update(e.toDer(j).getBytes());var W=re.getMac();te=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,W.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ue.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(X).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(j).getBytes())])]),te])},a.generateKey=t.pbe.generatePkcs12Key,ia.exports}var Zi;function Ro(){if(Zi)return Qn.exports;Zi=1;var t=ge();kt(),dr(),wo(),Er(),$a(),_o(),Ya(),bn(),Ee(),Qa();var e=t.asn1,r=Qn.exports=t.pki=t.pki||{};return r.pemToDer=function(a){var c=t.pem.decode(a)[0];if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(c.body)},r.privateKeyFromPem=function(a){var c=t.pem.decode(a)[0];if(c.type!=="PRIVATE KEY"&&c.type!=="RSA PRIVATE KEY"){var o=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw o.headerType=c.type,o}if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var i=e.fromDer(c.body);return r.privateKeyFromAsn1(i)},r.privateKeyToPem=function(a,c){var o={type:"RSA PRIVATE KEY",body:e.toDer(r.privateKeyToAsn1(a)).getBytes()};return t.pem.encode(o,{maxline:c})},r.privateKeyInfoToPem=function(a,c){var o={type:"PRIVATE KEY",body:e.toDer(a).getBytes()};return t.pem.encode(o,{maxline:c})},Qn.exports}var la,Wi;function No(){if(Wi)return la;Wi=1;var t=ge();kt(),Mr(),Ga(),Er(),Ro(),Bt(),Hr(),Ee();var e=function(C,U,k,p){var R=t.util.createBuffer(),H=C.length>>1,F=H+(C.length&1),J=C.substr(0,F),ie=C.substr(H,F),ce=t.util.createBuffer(),Q=t.hmac.create();k=U+k;var se=Math.ceil(p/16),he=Math.ceil(p/20);Q.start("MD5",J);var ve=t.util.createBuffer();ce.putBytes(k);for(var ye=0;ye<se;++ye)Q.start(null,null),Q.update(ce.getBytes()),ce.putBuffer(Q.digest()),Q.start(null,null),Q.update(ce.bytes()+k),ve.putBuffer(Q.digest());Q.start("SHA1",ie);var Te=t.util.createBuffer();ce.clear(),ce.putBytes(k);for(var ye=0;ye<he;++ye)Q.start(null,null),Q.update(ce.getBytes()),ce.putBuffer(Q.digest()),Q.start(null,null),Q.update(ce.bytes()+k),Te.putBuffer(Q.digest());return R.putBytes(t.util.xorBytes(ve.getBytes(),Te.getBytes(),p)),R},r=function(C,U,k){var p=t.hmac.create();p.start("SHA1",C);var R=t.util.createBuffer();return R.putInt32(U[0]),R.putInt32(U[1]),R.putByte(k.type),R.putByte(k.version.major),R.putByte(k.version.minor),R.putInt16(k.length),R.putBytes(k.fragment.bytes()),p.update(R.getBytes()),p.digest().getBytes()},a=function(C,U,k){var p=!1;try{var R=C.deflate(U.fragment.getBytes());U.fragment=t.util.createBuffer(R),U.length=R.length,p=!0}catch{}return p},c=function(C,U,k){var p=!1;try{var R=C.inflate(U.fragment.getBytes());U.fragment=t.util.createBuffer(R),U.length=R.length,p=!0}catch{}return p},o=function(C,U){var k=0;switch(U){case 1:k=C.getByte();break;case 2:k=C.getInt16();break;case 3:k=C.getInt24();break;case 4:k=C.getInt32();break}return t.util.createBuffer(C.getBytes(k))},i=function(C,U,k){C.putInt(k.length(),U<<3),C.putBuffer(k)},n={};n.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},n.SupportedVersions=[n.Versions.TLS_1_1,n.Versions.TLS_1_0],n.Version=n.SupportedVersions[0],n.MaxFragment=15360,n.ConnectionEnd={server:0,client:1},n.PRFAlgorithm={tls_prf_sha256:0},n.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},n.CipherType={stream:0,block:1,aead:2},n.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},n.CompressionMethod={none:0,deflate:1},n.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},n.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},n.Alert={},n.Alert.Level={warning:1,fatal:2},n.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},n.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},n.CipherSuites={},n.getCipherSuite=function(C){var U=null;for(var k in n.CipherSuites){var p=n.CipherSuites[k];if(p.id[0]===C.charCodeAt(0)&&p.id[1]===C.charCodeAt(1)){U=p;break}}return U},n.handleUnexpected=function(C,U){var k=!C.open&&C.entity===n.ConnectionEnd.client;k||C.error(C,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unexpected_message}})},n.handleHelloRequest=function(C,U,k){!C.handshaking&&C.handshakes>0&&(n.queue(C,n.createAlert(C,{level:n.Alert.Level.warning,description:n.Alert.Description.no_renegotiation})),n.flush(C)),C.process()},n.parseHelloMessage=function(C,U,k){var p=null,R=C.entity===n.ConnectionEnd.client;if(k<38)C.error(C,{message:R?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});else{var H=U.fragment,F=H.length();if(p={version:{major:H.getByte(),minor:H.getByte()},random:t.util.createBuffer(H.getBytes(32)),session_id:o(H,1),extensions:[]},R?(p.cipher_suite=H.getBytes(2),p.compression_method=H.getByte()):(p.cipher_suites=o(H,2),p.compression_methods=o(H,1)),F=k-(F-H.length()),F>0){for(var J=o(H,2);J.length()>0;)p.extensions.push({type:[J.getByte(),J.getByte()],data:o(J,2)});if(!R)for(var ie=0;ie<p.extensions.length;++ie){var ce=p.extensions[ie];if(ce.type[0]===0&&ce.type[1]===0)for(var Q=o(ce.data,2);Q.length()>0;){var se=Q.getByte();if(se!==0)break;C.session.extensions.server_name.serverNameList.push(o(Q,2).getBytes())}}}if(C.session.version&&(p.version.major!==C.session.version.major||p.version.minor!==C.session.version.minor))return C.error(C,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}});if(R)C.session.cipherSuite=n.getCipherSuite(p.cipher_suite);else for(var he=t.util.createBuffer(p.cipher_suites.bytes());he.length()>0&&(C.session.cipherSuite=n.getCipherSuite(he.getBytes(2)),C.session.cipherSuite===null););if(C.session.cipherSuite===null)return C.error(C,{message:"No cipher suites in common.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(p.cipher_suite)});R?C.session.compressionMethod=p.compression_method:C.session.compressionMethod=n.CompressionMethod.none}return p},n.createSecurityParameters=function(C,U){var k=C.entity===n.ConnectionEnd.client,p=U.random.bytes(),R=k?C.session.sp.client_random:p,H=k?p:n.createRandom().getBytes();C.session.sp={entity:C.entity,prf_algorithm:n.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:C.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:R,server_random:H}},n.handleServerHello=function(C,U,k){var p=n.parseHelloMessage(C,U,k);if(!C.fail){if(p.version.minor<=C.version.minor)C.version.minor=p.version.minor;else return C.error(C,{message:"Incompatible TLS version.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}});C.session.version=C.version;var R=p.session_id.bytes();R.length>0&&R===C.session.id?(C.expect=d,C.session.resuming=!0,C.session.sp.server_random=p.random.bytes()):(C.expect=l,C.session.resuming=!1,n.createSecurityParameters(C,p)),C.session.id=R,C.process()}},n.handleClientHello=function(C,U,k){var p=n.parseHelloMessage(C,U,k);if(!C.fail){var R=p.session_id.bytes(),H=null;if(C.sessionCache&&(H=C.sessionCache.getSession(R),H===null?R="":(H.version.major!==p.version.major||H.version.minor>p.version.minor)&&(H=null,R="")),R.length===0&&(R=t.random.getBytes(32)),C.session.id=R,C.session.clientHelloVersion=p.version,C.session.sp={},H)C.version=C.session.version=H.version,C.session.sp=H.sp;else{for(var F,J=1;J<n.SupportedVersions.length&&(F=n.SupportedVersions[J],!(F.minor<=p.version.minor));++J);C.version={major:F.major,minor:F.minor},C.session.version=C.version}H!==null?(C.expect=I,C.session.resuming=!0,C.session.sp.client_random=p.random.bytes()):(C.expect=C.verifyClient!==!1?g:E,C.session.resuming=!1,n.createSecurityParameters(C,p)),C.open=!0,n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createServerHello(C)})),C.session.resuming?(n.queue(C,n.createRecord(C,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),C.state.pending=n.createConnectionState(C),C.state.current.write=C.state.pending.write,n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createFinished(C)}))):(n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createCertificate(C)})),C.fail||(n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createServerKeyExchange(C)})),C.verifyClient!==!1&&n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createCertificateRequest(C)})),n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createServerHelloDone(C)})))),n.flush(C),C.process()}},n.handleCertificate=function(C,U,k){if(k<3)return C.error(C,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var p=U.fragment,R={certificate_list:o(p,3)},H,F,J=[];try{for(;R.certificate_list.length()>0;)H=o(R.certificate_list,3),F=t.asn1.fromDer(H),H=t.pki.certificateFromAsn1(F,!0),J.push(H)}catch(ce){return C.error(C,{message:"Could not parse certificate list.",cause:ce,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate}})}var ie=C.entity===n.ConnectionEnd.client;(ie||C.verifyClient===!0)&&J.length===0?C.error(C,{message:ie?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}}):J.length===0?C.expect=ie?m:E:(ie?C.session.serverCertificate=J[0]:C.session.clientCertificate=J[0],n.verifyCertificateChain(C,J)&&(C.expect=ie?m:E)),C.process()},n.handleServerKeyExchange=function(C,U,k){if(k>0)return C.error(C,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unsupported_certificate}});C.expect=B,C.process()},n.handleClientKeyExchange=function(C,U,k){if(k<48)return C.error(C,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unsupported_certificate}});var p=U.fragment,R={enc_pre_master_secret:o(p,2).getBytes()},H=null;if(C.getPrivateKey)try{H=C.getPrivateKey(C,C.session.serverCertificate),H=t.pki.privateKeyFromPem(H)}catch(ie){C.error(C,{message:"Could not get private key.",cause:ie,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}})}if(H===null)return C.error(C,{message:"No private key set.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}});try{var F=C.session.sp;F.pre_master_secret=H.decrypt(R.enc_pre_master_secret);var J=C.session.clientHelloVersion;if(J.major!==F.pre_master_secret.charCodeAt(0)||J.minor!==F.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{F.pre_master_secret=t.random.getBytes(48)}C.expect=I,C.session.clientCertificate!==null&&(C.expect=w),C.process()},n.handleCertificateRequest=function(C,U,k){if(k<3)return C.error(C,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var p=U.fragment,R={certificate_types:o(p,1),certificate_authorities:o(p,2)};C.session.certificateRequest=R,C.expect=v,C.process()},n.handleCertificateVerify=function(C,U,k){if(k<2)return C.error(C,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var p=U.fragment;p.read-=4;var R=p.bytes();p.read+=4;var H={signature:o(p,2).getBytes()},F=t.util.createBuffer();F.putBuffer(C.session.md5.digest()),F.putBuffer(C.session.sha1.digest()),F=F.getBytes();try{var J=C.session.clientCertificate;if(!J.publicKey.verify(F,H.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");C.session.md5.update(R),C.session.sha1.update(R)}catch{return C.error(C,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.handshake_failure}})}C.expect=I,C.process()},n.handleServerHelloDone=function(C,U,k){if(k>0)return C.error(C,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.record_overflow}});if(C.serverCertificate===null){var p={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.insufficient_security}},R=0,H=C.verify(C,p.alert.description,R,[]);if(H!==!0)return(H||H===0)&&(typeof H=="object"&&!t.util.isArray(H)?(H.message&&(p.message=H.message),H.alert&&(p.alert.description=H.alert)):typeof H=="number"&&(p.alert.description=H)),C.error(C,p)}C.session.certificateRequest!==null&&(U=n.createRecord(C,{type:n.ContentType.handshake,data:n.createCertificate(C)}),n.queue(C,U)),U=n.createRecord(C,{type:n.ContentType.handshake,data:n.createClientKeyExchange(C)}),n.queue(C,U),C.expect=S;var F=function(J,ie){J.session.certificateRequest!==null&&J.session.clientCertificate!==null&&n.queue(J,n.createRecord(J,{type:n.ContentType.handshake,data:n.createCertificateVerify(J,ie)})),n.queue(J,n.createRecord(J,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),J.state.pending=n.createConnectionState(J),J.state.current.write=J.state.pending.write,n.queue(J,n.createRecord(J,{type:n.ContentType.handshake,data:n.createFinished(J)})),J.expect=d,n.flush(J),J.process()};if(C.session.certificateRequest===null||C.session.clientCertificate===null)return F(C,null);n.getClientSignature(C,F)},n.handleChangeCipherSpec=function(C,U){if(U.fragment.getByte()!==1)return C.error(C,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var k=C.entity===n.ConnectionEnd.client;(C.session.resuming&&k||!C.session.resuming&&!k)&&(C.state.pending=n.createConnectionState(C)),C.state.current.read=C.state.pending.read,(!C.session.resuming&&k||C.session.resuming&&!k)&&(C.state.pending=null),C.expect=k?y:x,C.process()},n.handleFinished=function(C,U,k){var p=U.fragment;p.read-=4;var R=p.bytes();p.read+=4;var H=U.fragment.getBytes();p=t.util.createBuffer(),p.putBuffer(C.session.md5.digest()),p.putBuffer(C.session.sha1.digest());var F=C.entity===n.ConnectionEnd.client,J=F?"server finished":"client finished",ie=C.session.sp,ce=12,Q=e;if(p=Q(ie.master_secret,J,p.getBytes(),ce),p.getBytes()!==H)return C.error(C,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.decrypt_error}});C.session.md5.update(R),C.session.sha1.update(R),(C.session.resuming&&F||!C.session.resuming&&!F)&&(n.queue(C,n.createRecord(C,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),C.state.current.write=C.state.pending.write,C.state.pending=null,n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createFinished(C)}))),C.expect=F?b:h,C.handshaking=!1,++C.handshakes,C.peerCertificate=F?C.session.serverCertificate:C.session.clientCertificate,n.flush(C),C.isConnected=!0,C.connected(C),C.process()},n.handleAlert=function(C,U){var k=U.fragment,p={level:k.getByte(),description:k.getByte()},R;switch(p.description){case n.Alert.Description.close_notify:R="Connection closed.";break;case n.Alert.Description.unexpected_message:R="Unexpected message.";break;case n.Alert.Description.bad_record_mac:R="Bad record MAC.";break;case n.Alert.Description.decryption_failed:R="Decryption failed.";break;case n.Alert.Description.record_overflow:R="Record overflow.";break;case n.Alert.Description.decompression_failure:R="Decompression failed.";break;case n.Alert.Description.handshake_failure:R="Handshake failure.";break;case n.Alert.Description.bad_certificate:R="Bad certificate.";break;case n.Alert.Description.unsupported_certificate:R="Unsupported certificate.";break;case n.Alert.Description.certificate_revoked:R="Certificate revoked.";break;case n.Alert.Description.certificate_expired:R="Certificate expired.";break;case n.Alert.Description.certificate_unknown:R="Certificate unknown.";break;case n.Alert.Description.illegal_parameter:R="Illegal parameter.";break;case n.Alert.Description.unknown_ca:R="Unknown certificate authority.";break;case n.Alert.Description.access_denied:R="Access denied.";break;case n.Alert.Description.decode_error:R="Decode error.";break;case n.Alert.Description.decrypt_error:R="Decrypt error.";break;case n.Alert.Description.export_restriction:R="Export restriction.";break;case n.Alert.Description.protocol_version:R="Unsupported protocol version.";break;case n.Alert.Description.insufficient_security:R="Insufficient security.";break;case n.Alert.Description.internal_error:R="Internal error.";break;case n.Alert.Description.user_canceled:R="User canceled.";break;case n.Alert.Description.no_renegotiation:R="Renegotiation not supported.";break;default:R="Unknown error.";break}if(p.description===n.Alert.Description.close_notify)return C.close();C.error(C,{message:R,send:!1,origin:C.entity===n.ConnectionEnd.client?"server":"client",alert:p}),C.process()},n.handleHandshake=function(C,U){var k=U.fragment,p=k.getByte(),R=k.getInt24();if(R>k.length())return C.fragmented=U,U.fragment=t.util.createBuffer(),k.read-=4,C.process();C.fragmented=null,k.read-=4;var H=k.bytes(R+4);k.read+=4,p in te[C.entity][C.expect]?(C.entity===n.ConnectionEnd.server&&!C.open&&!C.fail&&(C.handshaking=!0,C.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),p!==n.HandshakeType.hello_request&&p!==n.HandshakeType.certificate_verify&&p!==n.HandshakeType.finished&&(C.session.md5.update(H),C.session.sha1.update(H)),te[C.entity][C.expect][p](C,U,R)):n.handleUnexpected(C,U)},n.handleApplicationData=function(C,U){C.data.putBuffer(U.fragment),C.dataReady(C),C.process()},n.handleHeartbeat=function(C,U){var k=U.fragment,p=k.getByte(),R=k.getInt16(),H=k.getBytes(R);if(p===n.HeartbeatMessageType.heartbeat_request){if(C.handshaking||R>H.length)return C.process();n.queue(C,n.createRecord(C,{type:n.ContentType.heartbeat,data:n.createHeartbeat(n.HeartbeatMessageType.heartbeat_response,H)})),n.flush(C)}else if(p===n.HeartbeatMessageType.heartbeat_response){if(H!==C.expectedHeartbeatPayload)return C.process();C.heartbeatReceived&&C.heartbeatReceived(C,t.util.createBuffer(H))}C.process()};var u=0,l=1,m=2,B=3,v=4,d=5,y=6,b=7,S=8,f=0,g=1,E=2,w=3,I=4,x=5,h=6,s=n.handleUnexpected,T=n.handleChangeCipherSpec,N=n.handleAlert,O=n.handleHandshake,_=n.handleApplicationData,D=n.handleHeartbeat,V=[];V[n.ConnectionEnd.client]=[[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[T,N,s,s,D],[s,N,O,s,D],[s,N,O,_,D],[s,N,O,s,D]],V[n.ConnectionEnd.server]=[[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[s,N,O,s,D],[T,N,s,s,D],[s,N,O,s,D],[s,N,O,_,D],[s,N,O,s,D]];var P=n.handleHelloRequest,M=n.handleServerHello,q=n.handleCertificate,$=n.handleServerKeyExchange,G=n.handleCertificateRequest,Y=n.handleServerHelloDone,j=n.handleFinished,te=[];te[n.ConnectionEnd.client]=[[s,s,M,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,q,$,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,$,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,j],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s]];var ue=n.handleClientHello,X=n.handleClientKeyExchange,re=n.handleCertificateVerify;te[n.ConnectionEnd.server]=[[s,ue,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,q,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,X,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,re,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,j],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s]],n.generateKeys=function(C,U){var k=e,p=U.client_random+U.server_random;C.session.resuming||(U.master_secret=k(U.pre_master_secret,"master secret",p,48).bytes(),U.pre_master_secret=null),p=U.server_random+U.client_random;var R=2*U.mac_key_length+2*U.enc_key_length,H=C.version.major===n.Versions.TLS_1_0.major&&C.version.minor===n.Versions.TLS_1_0.minor;H&&(R+=2*U.fixed_iv_length);var F=k(U.master_secret,"key expansion",p,R),J={client_write_MAC_key:F.getBytes(U.mac_key_length),server_write_MAC_key:F.getBytes(U.mac_key_length),client_write_key:F.getBytes(U.enc_key_length),server_write_key:F.getBytes(U.enc_key_length)};return H&&(J.client_write_IV=F.getBytes(U.fixed_iv_length),J.server_write_IV=F.getBytes(U.fixed_iv_length)),J},n.createConnectionState=function(C){var U=C.entity===n.ConnectionEnd.client,k=function(){var H={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(F){return!0},compressionState:null,compressFunction:function(F){return!0},updateSequenceNumber:function(){H.sequenceNumber[1]===4294967295?(H.sequenceNumber[1]=0,++H.sequenceNumber[0]):++H.sequenceNumber[1]}};return H},p={read:k(),write:k()};if(p.read.update=function(H,F){return p.read.cipherFunction(F,p.read)?p.read.compressFunction(H,F,p.read)||H.error(H,{message:"Could not decompress record.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.decompression_failure}}):H.error(H,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_record_mac}}),!H.fail},p.write.update=function(H,F){return p.write.compressFunction(H,F,p.write)?p.write.cipherFunction(F,p.write)||H.error(H,{message:"Could not encrypt record.",send:!1,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}):H.error(H,{message:"Could not compress record.",send:!1,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}),!H.fail},C.session){var R=C.session.sp;switch(C.session.cipherSuite.initSecurityParameters(R),R.keys=n.generateKeys(C,R),p.read.macKey=U?R.keys.server_write_MAC_key:R.keys.client_write_MAC_key,p.write.macKey=U?R.keys.client_write_MAC_key:R.keys.server_write_MAC_key,C.session.cipherSuite.initConnectionState(p,C,R),R.compression_algorithm){case n.CompressionMethod.none:break;case n.CompressionMethod.deflate:p.read.compressFunction=c,p.write.compressFunction=a;break;default:throw new Error("Unsupported compression algorithm.")}}return p},n.createRandom=function(){var C=new Date,U=+C+C.getTimezoneOffset()*6e4,k=t.util.createBuffer();return k.putInt32(U),k.putBytes(t.random.getBytes(28)),k},n.createRecord=function(C,U){if(!U.data)return null;var k={type:U.type,version:{major:C.version.major,minor:C.version.minor},length:U.data.length(),fragment:U.data};return k},n.createAlert=function(C,U){var k=t.util.createBuffer();return k.putByte(U.level),k.putByte(U.description),n.createRecord(C,{type:n.ContentType.alert,data:k})},n.createClientHello=function(C){C.session.clientHelloVersion={major:C.version.major,minor:C.version.minor};for(var U=t.util.createBuffer(),k=0;k<C.cipherSuites.length;++k){var p=C.cipherSuites[k];U.putByte(p.id[0]),U.putByte(p.id[1])}var R=U.length(),H=t.util.createBuffer();H.putByte(n.CompressionMethod.none);var F=H.length(),J=t.util.createBuffer();if(C.virtualHost){var ie=t.util.createBuffer();ie.putByte(0),ie.putByte(0);var ce=t.util.createBuffer();ce.putByte(0),i(ce,2,t.util.createBuffer(C.virtualHost));var Q=t.util.createBuffer();i(Q,2,ce),i(ie,2,Q),J.putBuffer(ie)}var se=J.length();se>0&&(se+=2);var he=C.session.id,ve=he.length+1+2+4+28+2+R+1+F+se,ye=t.util.createBuffer();return ye.putByte(n.HandshakeType.client_hello),ye.putInt24(ve),ye.putByte(C.version.major),ye.putByte(C.version.minor),ye.putBytes(C.session.sp.client_random),i(ye,1,t.util.createBuffer(he)),i(ye,2,U),i(ye,1,H),se>0&&i(ye,2,J),ye},n.createServerHello=function(C){var U=C.session.id,k=U.length+1+2+4+28+2+1,p=t.util.createBuffer();return p.putByte(n.HandshakeType.server_hello),p.putInt24(k),p.putByte(C.version.major),p.putByte(C.version.minor),p.putBytes(C.session.sp.server_random),i(p,1,t.util.createBuffer(U)),p.putByte(C.session.cipherSuite.id[0]),p.putByte(C.session.cipherSuite.id[1]),p.putByte(C.session.compressionMethod),p},n.createCertificate=function(C){var U=C.entity===n.ConnectionEnd.client,k=null;if(C.getCertificate){var p;U?p=C.session.certificateRequest:p=C.session.extensions.server_name.serverNameList,k=C.getCertificate(C,p)}var R=t.util.createBuffer();if(k!==null)try{t.util.isArray(k)||(k=[k]);for(var H=null,F=0;F<k.length;++F){var J=t.pem.decode(k[F])[0];if(J.type!=="CERTIFICATE"&&J.type!=="X509 CERTIFICATE"&&J.type!=="TRUSTED CERTIFICATE"){var ie=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ie.headerType=J.type,ie}if(J.procType&&J.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ce=t.util.createBuffer(J.body);H===null&&(H=t.asn1.fromDer(ce.bytes(),!1));var Q=t.util.createBuffer();i(Q,3,ce),R.putBuffer(Q)}k=t.pki.certificateFromAsn1(H),U?C.session.clientCertificate=k:C.session.serverCertificate=k}catch(ve){return C.error(C,{message:"Could not send certificate list.",cause:ve,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate}})}var se=3+R.length(),he=t.util.createBuffer();return he.putByte(n.HandshakeType.certificate),he.putInt24(se),i(he,3,R),he},n.createClientKeyExchange=function(C){var U=t.util.createBuffer();U.putByte(C.session.clientHelloVersion.major),U.putByte(C.session.clientHelloVersion.minor),U.putBytes(t.random.getBytes(46));var k=C.session.sp;k.pre_master_secret=U.getBytes();var p=C.session.serverCertificate.publicKey;U=p.encrypt(k.pre_master_secret);var R=U.length+2,H=t.util.createBuffer();return H.putByte(n.HandshakeType.client_key_exchange),H.putInt24(R),H.putInt16(U.length),H.putBytes(U),H},n.createServerKeyExchange=function(C){var U=t.util.createBuffer();return U},n.getClientSignature=function(C,U){var k=t.util.createBuffer();k.putBuffer(C.session.md5.digest()),k.putBuffer(C.session.sha1.digest()),k=k.getBytes(),C.getSignature=C.getSignature||function(p,R,H){var F=null;if(p.getPrivateKey)try{F=p.getPrivateKey(p,p.session.clientCertificate),F=t.pki.privateKeyFromPem(F)}catch(J){p.error(p,{message:"Could not get private key.",cause:J,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}})}F===null?p.error(p,{message:"No private key set.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}):R=F.sign(R,null),H(p,R)},C.getSignature(C,k,U)},n.createCertificateVerify=function(C,U){var k=U.length+2,p=t.util.createBuffer();return p.putByte(n.HandshakeType.certificate_verify),p.putInt24(k),p.putInt16(U.length),p.putBytes(U),p},n.createCertificateRequest=function(C){var U=t.util.createBuffer();U.putByte(1);var k=t.util.createBuffer();for(var p in C.caStore.certs){var R=C.caStore.certs[p],H=t.pki.distinguishedNameToAsn1(R.subject),F=t.asn1.toDer(H);k.putInt16(F.length()),k.putBuffer(F)}var J=1+U.length()+2+k.length(),ie=t.util.createBuffer();return ie.putByte(n.HandshakeType.certificate_request),ie.putInt24(J),i(ie,1,U),i(ie,2,k),ie},n.createServerHelloDone=function(C){var U=t.util.createBuffer();return U.putByte(n.HandshakeType.server_hello_done),U.putInt24(0),U},n.createChangeCipherSpec=function(){var C=t.util.createBuffer();return C.putByte(1),C},n.createFinished=function(C){var U=t.util.createBuffer();U.putBuffer(C.session.md5.digest()),U.putBuffer(C.session.sha1.digest());var k=C.entity===n.ConnectionEnd.client,p=C.session.sp,R=12,H=e,F=k?"client finished":"server finished";U=H(p.master_secret,F,U.getBytes(),R);var J=t.util.createBuffer();return J.putByte(n.HandshakeType.finished),J.putInt24(U.length()),J.putBuffer(U),J},n.createHeartbeat=function(C,U,k){typeof k>"u"&&(k=U.length);var p=t.util.createBuffer();p.putByte(C),p.putInt16(k),p.putBytes(U);var R=p.length(),H=Math.max(16,R-k-3);return p.putBytes(t.random.getBytes(H)),p},n.queue=function(C,U){if(U&&!(U.fragment.length()===0&&(U.type===n.ContentType.handshake||U.type===n.ContentType.alert||U.type===n.ContentType.change_cipher_spec))){if(U.type===n.ContentType.handshake){var k=U.fragment.bytes();C.session.md5.update(k),C.session.sha1.update(k),k=null}var p;if(U.fragment.length()<=n.MaxFragment)p=[U];else{p=[];for(var R=U.fragment.bytes();R.length>n.MaxFragment;)p.push(n.createRecord(C,{type:U.type,data:t.util.createBuffer(R.slice(0,n.MaxFragment))})),R=R.slice(n.MaxFragment);R.length>0&&p.push(n.createRecord(C,{type:U.type,data:t.util.createBuffer(R)}))}for(var H=0;H<p.length&&!C.fail;++H){var F=p[H],J=C.state.current.write;J.update(C,F)&&C.records.push(F)}}},n.flush=function(C){for(var U=0;U<C.records.length;++U){var k=C.records[U];C.tlsData.putByte(k.type),C.tlsData.putByte(k.version.major),C.tlsData.putByte(k.version.minor),C.tlsData.putInt16(k.fragment.length()),C.tlsData.putBuffer(C.records[U].fragment)}return C.records=[],C.tlsDataReady(C)};var W=function(C){switch(C){case!0:return!0;case t.pki.certificateError.bad_certificate:return n.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return n.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return n.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return n.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return n.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return n.Alert.Description.unknown_ca;default:return n.Alert.Description.bad_certificate}},pe=function(C){switch(C){case!0:return!0;case n.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case n.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case n.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case n.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case n.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case n.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};n.verifyCertificateChain=function(C,U){try{var k={};for(var p in C.verifyOptions)k[p]=C.verifyOptions[p];k.verify=function(H,F,J){var ie=W(H),ce=C.verify(C,H,F,J);if(ce!==!0){if(typeof ce=="object"&&!t.util.isArray(ce)){var Q=new Error("The application rejected the certificate.");throw Q.send=!0,Q.alert={level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate},ce.message&&(Q.message=ce.message),ce.alert&&(Q.alert.description=ce.alert),Q}ce!==H&&(ce=pe(ce))}return ce},t.pki.verifyCertificateChain(C.caStore,U,k)}catch(H){var R=H;(typeof R!="object"||t.util.isArray(R))&&(R={send:!0,alert:{level:n.Alert.Level.fatal,description:W(H)}}),"send"in R||(R.send=!0),"alert"in R||(R.alert={level:n.Alert.Level.fatal,description:W(R.error)}),C.error(C,R)}return!C.fail},n.createSessionCache=function(C,U){var k=null;if(C&&C.getSession&&C.setSession&&C.order)k=C;else{k={},k.cache=C||{},k.capacity=Math.max(U||100,1),k.order=[];for(var p in C)k.order.length<=U?k.order.push(p):delete C[p];k.getSession=function(R){var H=null,F=null;if(R?F=t.util.bytesToHex(R):k.order.length>0&&(F=k.order[0]),F!==null&&F in k.cache){H=k.cache[F],delete k.cache[F];for(var J in k.order)if(k.order[J]===F){k.order.splice(J,1);break}}return H},k.setSession=function(R,H){if(k.order.length===k.capacity){var F=k.order.shift();delete k.cache[F]}var F=t.util.bytesToHex(R);k.order.push(F),k.cache[F]=H}}return k},n.createConnection=function(C){var U=null;C.caStore?t.util.isArray(C.caStore)?U=t.pki.createCaStore(C.caStore):U=C.caStore:U=t.pki.createCaStore();var k=C.cipherSuites||null;if(k===null){k=[];for(var p in n.CipherSuites)k.push(n.CipherSuites[p])}var R=C.server?n.ConnectionEnd.server:n.ConnectionEnd.client,H=C.sessionCache?n.createSessionCache(C.sessionCache):null,F={version:{major:n.Version.major,minor:n.Version.minor},entity:R,sessionId:C.sessionId,caStore:U,sessionCache:H,cipherSuites:k,connected:C.connected,virtualHost:C.virtualHost||null,verifyClient:C.verifyClient||!1,verify:C.verify||function(Q,se,he,ve){return se},verifyOptions:C.verifyOptions||{},getCertificate:C.getCertificate||null,getPrivateKey:C.getPrivateKey||null,getSignature:C.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:C.tlsDataReady,dataReady:C.dataReady,heartbeatReceived:C.heartbeatReceived,closed:C.closed,error:function(Q,se){se.origin=se.origin||(Q.entity===n.ConnectionEnd.client?"client":"server"),se.send&&(n.queue(Q,n.createAlert(Q,se.alert)),n.flush(Q));var he=se.fatal!==!1;he&&(Q.fail=!0),C.error(Q,se),he&&Q.close(!1)},deflate:C.deflate||null,inflate:C.inflate||null};F.reset=function(Q){F.version={major:n.Version.major,minor:n.Version.minor},F.record=null,F.session=null,F.peerCertificate=null,F.state={pending:null,current:null},F.expect=F.entity===n.ConnectionEnd.client?u:f,F.fragmented=null,F.records=[],F.open=!1,F.handshakes=0,F.handshaking=!1,F.isConnected=!1,F.fail=!(Q||typeof Q>"u"),F.input.clear(),F.tlsData.clear(),F.data.clear(),F.state.current=n.createConnectionState(F)},F.reset();var J=function(Q,se){var he=se.type-n.ContentType.change_cipher_spec,ve=V[Q.entity][Q.expect];he in ve?ve[he](Q,se):n.handleUnexpected(Q,se)},ie=function(Q){var se=0,he=Q.input,ve=he.length();if(ve<5)se=5-ve;else{Q.record={type:he.getByte(),version:{major:he.getByte(),minor:he.getByte()},length:he.getInt16(),fragment:t.util.createBuffer(),ready:!1};var ye=Q.record.version.major===Q.version.major;ye&&Q.session&&Q.session.version&&(ye=Q.record.version.minor===Q.version.minor),ye||Q.error(Q,{message:"Incompatible TLS version.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}})}return se},ce=function(Q){var se=0,he=Q.input,ve=he.length();if(ve<Q.record.length)se=Q.record.length-ve;else{Q.record.fragment.putBytes(he.getBytes(Q.record.length)),he.compact();var ye=Q.state.current.read;ye.update(Q,Q.record)&&(Q.fragmented!==null&&(Q.fragmented.type===Q.record.type?(Q.fragmented.fragment.putBuffer(Q.record.fragment),Q.record=Q.fragmented):Q.error(Q,{message:"Invalid fragmented record.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unexpected_message}})),Q.record.ready=!0)}return se};return F.handshake=function(Q){if(F.entity!==n.ConnectionEnd.client)F.error(F,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(F.handshaking)F.error(F,{message:"Handshake already in progress.",fatal:!1});else{F.fail&&!F.open&&F.handshakes===0&&(F.fail=!1),F.handshaking=!0,Q=Q||"";var se=null;Q.length>0&&(F.sessionCache&&(se=F.sessionCache.getSession(Q)),se===null&&(Q="")),Q.length===0&&F.sessionCache&&(se=F.sessionCache.getSession(),se!==null&&(Q=se.id)),F.session={id:Q,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},se&&(F.version=se.version,F.session.sp=se.sp),F.session.sp.client_random=n.createRandom().getBytes(),F.open=!0,n.queue(F,n.createRecord(F,{type:n.ContentType.handshake,data:n.createClientHello(F)})),n.flush(F)}},F.process=function(Q){var se=0;return Q&&F.input.putBytes(Q),F.fail||(F.record!==null&&F.record.ready&&F.record.fragment.isEmpty()&&(F.record=null),F.record===null&&(se=ie(F)),!F.fail&&F.record!==null&&!F.record.ready&&(se=ce(F)),!F.fail&&F.record!==null&&F.record.ready&&J(F,F.record)),se},F.prepare=function(Q){return n.queue(F,n.createRecord(F,{type:n.ContentType.application_data,data:t.util.createBuffer(Q)})),n.flush(F)},F.prepareHeartbeatRequest=function(Q,se){return Q instanceof t.util.ByteBuffer&&(Q=Q.bytes()),typeof se>"u"&&(se=Q.length),F.expectedHeartbeatPayload=Q,n.queue(F,n.createRecord(F,{type:n.ContentType.heartbeat,data:n.createHeartbeat(n.HeartbeatMessageType.heartbeat_request,Q,se)})),n.flush(F)},F.close=function(Q){if(!F.fail&&F.sessionCache&&F.session){var se={id:F.session.id,version:F.session.version,sp:F.session.sp};se.sp.keys=null,F.sessionCache.setSession(se.id,se)}F.open&&(F.open=!1,F.input.clear(),(F.isConnected||F.handshaking)&&(F.isConnected=F.handshaking=!1,n.queue(F,n.createAlert(F,{level:n.Alert.Level.warning,description:n.Alert.Description.close_notify})),n.flush(F)),F.closed(F)),F.reset(Q)},F},la=t.tls=t.tls||{};for(var le in n)typeof n[le]!="function"&&(t.tls[le]=n[le]);return t.tls.prf_tls1=e,t.tls.hmac_sha1=r,t.tls.createSessionCache=n.createSessionCache,t.tls.createConnection=n.createConnection,la}var Ji;function x0(){if(Ji)return Mn.exports;Ji=1;var t=ge();hr(),No();var e=Mn.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(u){u.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,u.cipher_type=e.CipherType.block,u.enc_key_length=16,u.block_length=16,u.fixed_iv_length=16,u.record_iv_length=16,u.mac_algorithm=e.MACAlgorithm.hmac_sha1,u.mac_length=20,u.mac_key_length=20},initConnectionState:r},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(u){u.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,u.cipher_type=e.CipherType.block,u.enc_key_length=32,u.block_length=16,u.fixed_iv_length=16,u.record_iv_length=16,u.mac_algorithm=e.MACAlgorithm.hmac_sha1,u.mac_length=20,u.mac_key_length=20},initConnectionState:r};function r(u,l,m){var B=l.entity===t.tls.ConnectionEnd.client;u.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",B?m.keys.server_write_key:m.keys.client_write_key),iv:B?m.keys.server_write_IV:m.keys.client_write_IV},u.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",B?m.keys.client_write_key:m.keys.server_write_key),iv:B?m.keys.client_write_IV:m.keys.server_write_IV},u.read.cipherFunction=i,u.write.cipherFunction=a,u.read.macLength=u.write.macLength=m.mac_length,u.read.macFunction=u.write.macFunction=e.hmac_sha1}function a(u,l){var m=!1,B=l.macFunction(l.macKey,l.sequenceNumber,u);u.fragment.putBytes(B),l.updateSequenceNumber();var v;u.version.minor===e.Versions.TLS_1_0.minor?v=l.cipherState.init?null:l.cipherState.iv:v=t.random.getBytesSync(16),l.cipherState.init=!0;var d=l.cipherState.cipher;return d.start({iv:v}),u.version.minor>=e.Versions.TLS_1_1.minor&&d.output.putBytes(v),d.update(u.fragment),d.finish(c)&&(u.fragment=d.output,u.length=u.fragment.length(),m=!0),m}function c(u,l,m){if(!m){var B=u-l.length()%u;l.fillWithByte(B-1,B)}return!0}function o(u,l,m){var B=!0;if(m){for(var v=l.length(),d=l.last(),y=v-1-d;y<v-1;++y)B=B&&l.at(y)==d;B&&l.truncate(d+1)}return B}function i(u,l){var m=!1,B;u.version.minor===e.Versions.TLS_1_0.minor?B=l.cipherState.init?null:l.cipherState.iv:B=u.fragment.getBytes(16),l.cipherState.init=!0;var v=l.cipherState.cipher;v.start({iv:B}),v.update(u.fragment),m=v.finish(o);var d=l.macLength,y=t.random.getBytesSync(d),b=v.output.length();b>=d?(u.fragment=v.output.getBytes(b-d),y=v.output.getBytes(d)):u.fragment=v.output.getBytes(),u.fragment=t.util.createBuffer(u.fragment),u.length=u.fragment.length();var S=l.macFunction(l.macKey,l.sequenceNumber,u);return l.updateSequenceNumber(),m=n(l.macKey,y,S)&&m,m}function n(u,l,m){var B=t.hmac.create();return B.start("SHA1",u),B.update(l),l=B.digest().getBytes(),B.start(null,null),B.update(m),m=B.digest().getBytes(),l===m}return Mn.exports}var ha={exports:{}},es;function Lo(){if(es)return ha.exports;es=1;var t=ge();qt(),Ee();var e=ha.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var r=t.sha384=t.sha512.sha384=t.sha512.sha384||{};r.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=r,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(l){if(c||n(),typeof l>"u"&&(l="SHA-512"),!(l in i))throw new Error("Invalid SHA-512 algorithm: "+l);for(var m=i[l],B=null,v=t.util.createBuffer(),d=new Array(80),y=0;y<80;++y)d[y]=new Array(2);var b=64;switch(l){case"SHA-384":b=48;break;case"SHA-512/256":b=32;break;case"SHA-512/224":b=28;break}var S={algorithm:l.replace("-","").toLowerCase(),blockLength:128,digestLength:b,messageLength:0,fullMessageLength:null,messageLengthSize:16};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength128=[];for(var f=S.messageLengthSize/4,g=0;g<f;++g)S.fullMessageLength.push(0);v=t.util.createBuffer(),B=new Array(m.length);for(var g=0;g<m.length;++g)B[g]=m[g].slice(0);return S},S.start(),S.update=function(f,g){g==="utf8"&&(f=t.util.encodeUtf8(f));var E=f.length;S.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var w=S.fullMessageLength.length-1;w>=0;--w)S.fullMessageLength[w]+=E[1],E[1]=E[0]+(S.fullMessageLength[w]/4294967296>>>0),S.fullMessageLength[w]=S.fullMessageLength[w]>>>0,E[0]=E[1]/4294967296>>>0;return v.putBytes(f),u(B,d,v),(v.read>2048||v.length()===0)&&v.compact(),S},S.digest=function(){var f=t.util.createBuffer();f.putBytes(v.bytes());var g=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,E=g&S.blockLength-1;f.putBytes(a.substr(0,S.blockLength-E));for(var w,I,x=S.fullMessageLength[0]*8,h=0;h<S.fullMessageLength.length-1;++h)w=S.fullMessageLength[h+1]*8,I=w/4294967296>>>0,x+=I,f.putInt32(x>>>0),x=w>>>0;f.putInt32(x);for(var s=new Array(B.length),h=0;h<B.length;++h)s[h]=B[h].slice(0);u(s,d,f);var T=t.util.createBuffer(),N;l==="SHA-512"?N=s.length:l==="SHA-384"?N=s.length-2:N=s.length-4;for(var h=0;h<N;++h)T.putInt32(s[h][0]),(h!==N-1||l!=="SHA-512/224")&&T.putInt32(s[h][1]);return T},S};var a=null,c=!1,o=null,i=null;function n(){a="",a+=t.util.fillString("\0",128),o=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],i={},i["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],i["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],i["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],i["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],c=!0}function u(l,m,B){for(var v,d,y,b,S,f,g,E,w,I,x,h,s,T,N,O,_,D,V,P,M,q,$,G,Y,j,te,ue,X,re,W,pe,le,C,U,k=B.length();k>=128;){for(X=0;X<16;++X)m[X][0]=B.getInt32()>>>0,m[X][1]=B.getInt32()>>>0;for(;X<80;++X)pe=m[X-2],re=pe[0],W=pe[1],v=((re>>>19|W<<13)^(W>>>29|re<<3)^re>>>6)>>>0,d=((re<<13|W>>>19)^(W<<3|re>>>29)^(re<<26|W>>>6))>>>0,C=m[X-15],re=C[0],W=C[1],y=((re>>>1|W<<31)^(re>>>8|W<<24)^re>>>7)>>>0,b=((re<<31|W>>>1)^(re<<24|W>>>8)^(re<<25|W>>>7))>>>0,le=m[X-7],U=m[X-16],W=d+le[1]+b+U[1],m[X][0]=v+le[0]+y+U[0]+(W/4294967296>>>0)>>>0,m[X][1]=W>>>0;for(s=l[0][0],T=l[0][1],N=l[1][0],O=l[1][1],_=l[2][0],D=l[2][1],V=l[3][0],P=l[3][1],M=l[4][0],q=l[4][1],$=l[5][0],G=l[5][1],Y=l[6][0],j=l[6][1],te=l[7][0],ue=l[7][1],X=0;X<80;++X)g=((M>>>14|q<<18)^(M>>>18|q<<14)^(q>>>9|M<<23))>>>0,E=((M<<18|q>>>14)^(M<<14|q>>>18)^(q<<23|M>>>9))>>>0,w=(Y^M&($^Y))>>>0,I=(j^q&(G^j))>>>0,S=((s>>>28|T<<4)^(T>>>2|s<<30)^(T>>>7|s<<25))>>>0,f=((s<<4|T>>>28)^(T<<30|s>>>2)^(T<<25|s>>>7))>>>0,x=(s&N|_&(s^N))>>>0,h=(T&O|D&(T^O))>>>0,W=ue+E+I+o[X][1]+m[X][1],v=te+g+w+o[X][0]+m[X][0]+(W/4294967296>>>0)>>>0,d=W>>>0,W=f+h,y=S+x+(W/4294967296>>>0)>>>0,b=W>>>0,te=Y,ue=j,Y=$,j=G,$=M,G=q,W=P+d,M=V+v+(W/4294967296>>>0)>>>0,q=W>>>0,V=_,P=D,_=N,D=O,N=s,O=T,W=d+b,s=v+y+(W/4294967296>>>0)>>>0,T=W>>>0;W=l[0][1]+T,l[0][0]=l[0][0]+s+(W/4294967296>>>0)>>>0,l[0][1]=W>>>0,W=l[1][1]+O,l[1][0]=l[1][0]+N+(W/4294967296>>>0)>>>0,l[1][1]=W>>>0,W=l[2][1]+D,l[2][0]=l[2][0]+_+(W/4294967296>>>0)>>>0,l[2][1]=W>>>0,W=l[3][1]+P,l[3][0]=l[3][0]+V+(W/4294967296>>>0)>>>0,l[3][1]=W>>>0,W=l[4][1]+q,l[4][0]=l[4][0]+M+(W/4294967296>>>0)>>>0,l[4][1]=W>>>0,W=l[5][1]+G,l[5][0]=l[5][0]+$+(W/4294967296>>>0)>>>0,l[5][1]=W>>>0,W=l[6][1]+j,l[6][0]=l[6][0]+Y+(W/4294967296>>>0)>>>0,l[6][1]=W>>>0,W=l[7][1]+ue,l[7][0]=l[7][0]+te+(W/4294967296>>>0)>>>0,l[7][1]=W>>>0,k-=128}}return ha.exports}var Zr={},ts;function S0(){if(ts)return Zr;ts=1;var t=ge();kt();var e=t.asn1;return Zr.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Zr.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},Zr}var da,rs;function C0(){if(rs)return da;rs=1;var t=ge();Cn(),Bt(),Lo(),Ee();var e=S0(),r=e.publicKeyValidator,a=e.privateKeyValidator;if(typeof c>"u")var c=t.jsbn.BigInteger;var o=t.util.ByteBuffer,i=typeof Buffer>"u"?Uint8Array:Buffer;t.pki=t.pki||{},da=t.pki.ed25519=t.ed25519=t.ed25519||{};var n=t.ed25519;n.constants={},n.constants.PUBLIC_KEY_BYTE_LENGTH=32,n.constants.PRIVATE_KEY_BYTE_LENGTH=64,n.constants.SEED_BYTE_LENGTH=32,n.constants.SIGN_BYTE_LENGTH=64,n.constants.HASH_BYTE_LENGTH=64,n.generateKeyPair=function(C){C=C||{};var U=C.seed;if(U===void 0)U=t.random.getBytesSync(n.constants.SEED_BYTE_LENGTH);else if(typeof U=="string"){if(U.length!==n.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+n.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(U instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');U=u({message:U,encoding:"binary"});for(var k=new i(n.constants.PUBLIC_KEY_BYTE_LENGTH),p=new i(n.constants.PRIVATE_KEY_BYTE_LENGTH),R=0;R<32;++R)p[R]=U[R];return g(k,p),{publicKey:k,privateKey:p}},n.privateKeyFromAsn1=function(C){var U={},k=[],p=t.asn1.validate(C,a,U,k);if(!p){var R=new Error("Invalid Key.");throw R.errors=k,R}var H=t.asn1.derToOid(U.privateKeyOid),F=t.oids.EdDSA25519;if(H!==F)throw new Error('Invalid OID "'+H+'"; OID must be "'+F+'".');var J=U.privateKey,ie=u({message:t.asn1.fromDer(J).value,encoding:"binary"});return{privateKeyBytes:ie}},n.publicKeyFromAsn1=function(C){var U={},k=[],p=t.asn1.validate(C,r,U,k);if(!p){var R=new Error("Invalid Key.");throw R.errors=k,R}var H=t.asn1.derToOid(U.publicKeyOid),F=t.oids.EdDSA25519;if(H!==F)throw new Error('Invalid OID "'+H+'"; OID must be "'+F+'".');var J=U.ed25519PublicKey;if(J.length!==n.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return u({message:J,encoding:"binary"})},n.publicKeyFromPrivateKey=function(C){C=C||{};var U=u({message:C.privateKey,encoding:"binary"});if(U.length!==n.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+n.constants.PRIVATE_KEY_BYTE_LENGTH);for(var k=new i(n.constants.PUBLIC_KEY_BYTE_LENGTH),p=0;p<k.length;++p)k[p]=U[32+p];return k},n.sign=function(C){C=C||{};var U=u(C),k=u({message:C.privateKey,encoding:"binary"});if(k.length===n.constants.SEED_BYTE_LENGTH){var p=n.generateKeyPair({seed:k});k=p.privateKey}else if(k.length!==n.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+n.constants.SEED_BYTE_LENGTH+" or "+n.constants.PRIVATE_KEY_BYTE_LENGTH);var R=new i(n.constants.SIGN_BYTE_LENGTH+U.length);E(R,U,U.length,k);for(var H=new i(n.constants.SIGN_BYTE_LENGTH),F=0;F<H.length;++F)H[F]=R[F];return H},n.verify=function(C){C=C||{};var U=u(C);if(C.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var k=u({message:C.signature,encoding:"binary"});if(k.length!==n.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+n.constants.SIGN_BYTE_LENGTH);var p=u({message:C.publicKey,encoding:"binary"});if(p.length!==n.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+n.constants.PUBLIC_KEY_BYTE_LENGTH);var R=new i(n.constants.SIGN_BYTE_LENGTH+U.length),H=new i(n.constants.SIGN_BYTE_LENGTH+U.length),F;for(F=0;F<n.constants.SIGN_BYTE_LENGTH;++F)R[F]=k[F];for(F=0;F<U.length;++F)R[F+n.constants.SIGN_BYTE_LENGTH]=U[F];return w(H,R,R.length,p)>=0};function u(C){var U=C.message;if(U instanceof Uint8Array||U instanceof i)return U;var k=C.encoding;if(U===void 0)if(C.md)U=C.md.digest().getBytes(),k="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof U=="string"&&!k)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof U=="string"){if(typeof Buffer<"u")return Buffer.from(U,k);U=new o(U,k)}else if(!(U instanceof o))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var p=new i(U.length()),R=0;R<p.length;++R)p[R]=U.at(R);return p}var l=X(),m=X([1]),B=X([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=X([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=X([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=X([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),S=X([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(C,U){var k=t.md.sha512.create(),p=new o(C);k.update(p.getBytes(U),"binary");var R=k.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(R,"binary");for(var H=new i(n.constants.HASH_BYTE_LENGTH),F=0;F<64;++F)H[F]=R.charCodeAt(F);return H}function g(C,U){var k=[X(),X(),X(),X()],p,R=f(U,32);for(R[0]&=248,R[31]&=127,R[31]|=64,G(k,R),T(C,k),p=0;p<32;++p)U[p+32]=C[p];return 0}function E(C,U,k,p){var R,H,F=new Float64Array(64),J=[X(),X(),X(),X()],ie=f(p,32);ie[0]&=248,ie[31]&=127,ie[31]|=64;var ce=k+64;for(R=0;R<k;++R)C[64+R]=U[R];for(R=0;R<32;++R)C[32+R]=ie[32+R];var Q=f(C.subarray(32),k+32);for(x(Q),G(J,Q),T(C,J),R=32;R<64;++R)C[R]=p[R];var se=f(C,k+64);for(x(se),R=32;R<64;++R)F[R]=0;for(R=0;R<32;++R)F[R]=Q[R];for(R=0;R<32;++R)for(H=0;H<32;H++)F[R+H]+=se[R]*ie[H];return I(C.subarray(32),F),ce}function w(C,U,k,p){var R,H,F=new i(32),J=[X(),X(),X(),X()],ie=[X(),X(),X(),X()];if(H=-1,k<64||O(ie,p))return-1;for(R=0;R<k;++R)C[R]=U[R];for(R=0;R<32;++R)C[R+32]=p[R];var ce=f(C,k);if(x(ce),$(J,ie,ce),G(ie,U.subarray(32)),h(J,ie),T(F,J),k-=64,P(U,0,F,0)){for(R=0;R<k;++R)C[R]=0;return-1}for(R=0;R<k;++R)C[R]=U[R+64];return H=k,H}function I(C,U){var k,p,R,H;for(p=63;p>=32;--p){for(k=0,R=p-32,H=p-12;R<H;++R)U[R]+=k-16*U[p]*b[R-(p-32)],k=U[R]+128>>8,U[R]-=k*256;U[R]+=k,U[p]=0}for(k=0,R=0;R<32;++R)U[R]+=k-(U[31]>>4)*b[R],k=U[R]>>8,U[R]&=255;for(R=0;R<32;++R)U[R]-=k*b[R];for(p=0;p<32;++p)U[p+1]+=U[p]>>8,C[p]=U[p]&255}function x(C){for(var U=new Float64Array(64),k=0;k<64;++k)U[k]=C[k],C[k]=0;I(C,U)}function h(C,U){var k=X(),p=X(),R=X(),H=X(),F=X(),J=X(),ie=X(),ce=X(),Q=X();W(k,C[1],C[0]),W(Q,U[1],U[0]),le(k,k,Q),re(p,C[0],C[1]),re(Q,U[0],U[1]),le(p,p,Q),le(R,C[3],U[3]),le(R,R,v),le(H,C[2],U[2]),re(H,H,H),W(F,p,k),W(J,H,R),re(ie,H,R),re(ce,p,k),le(C[0],F,J),le(C[1],ce,ie),le(C[2],ie,J),le(C[3],F,ce)}function s(C,U,k){for(var p=0;p<4;++p)ue(C[p],U[p],k)}function T(C,U){var k=X(),p=X(),R=X();j(R,U[2]),le(k,U[0],R),le(p,U[1],R),N(C,p),C[31]^=q(k)<<7}function N(C,U){var k,p,R,H=X(),F=X();for(k=0;k<16;++k)F[k]=U[k];for(te(F),te(F),te(F),p=0;p<2;++p){for(H[0]=F[0]-65517,k=1;k<15;++k)H[k]=F[k]-65535-(H[k-1]>>16&1),H[k-1]&=65535;H[15]=F[15]-32767-(H[14]>>16&1),R=H[15]>>16&1,H[14]&=65535,ue(F,H,1-R)}for(k=0;k<16;k++)C[2*k]=F[k]&255,C[2*k+1]=F[k]>>8}function O(C,U){var k=X(),p=X(),R=X(),H=X(),F=X(),J=X(),ie=X();return Y(C[2],m),_(C[1],U),pe(R,C[1]),le(H,R,B),W(R,R,C[2]),re(H,C[2],H),pe(F,H),pe(J,F),le(ie,J,F),le(k,ie,R),le(k,k,H),D(k,k),le(k,k,R),le(k,k,H),le(k,k,H),le(C[0],k,H),pe(p,C[0]),le(p,p,H),V(p,R)&&le(C[0],C[0],S),pe(p,C[0]),le(p,p,H),V(p,R)?-1:(q(C[0])===U[31]>>7&&W(C[0],l,C[0]),le(C[3],C[0],C[1]),0)}function _(C,U){var k;for(k=0;k<16;++k)C[k]=U[2*k]+(U[2*k+1]<<8);C[15]&=32767}function D(C,U){var k=X(),p;for(p=0;p<16;++p)k[p]=U[p];for(p=250;p>=0;--p)pe(k,k),p!==1&&le(k,k,U);for(p=0;p<16;++p)C[p]=k[p]}function V(C,U){var k=new i(32),p=new i(32);return N(k,C),N(p,U),P(k,0,p,0)}function P(C,U,k,p){return M(C,U,k,p,32)}function M(C,U,k,p,R){var H,F=0;for(H=0;H<R;++H)F|=C[U+H]^k[p+H];return(1&F-1>>>8)-1}function q(C){var U=new i(32);return N(U,C),U[0]&1}function $(C,U,k){var p,R;for(Y(C[0],l),Y(C[1],m),Y(C[2],m),Y(C[3],l),R=255;R>=0;--R)p=k[R/8|0]>>(R&7)&1,s(C,U,p),h(U,C),h(C,C),s(C,U,p)}function G(C,U){var k=[X(),X(),X(),X()];Y(k[0],d),Y(k[1],y),Y(k[2],m),le(k[3],d,y),$(C,k,U)}function Y(C,U){var k;for(k=0;k<16;k++)C[k]=U[k]|0}function j(C,U){var k=X(),p;for(p=0;p<16;++p)k[p]=U[p];for(p=253;p>=0;--p)pe(k,k),p!==2&&p!==4&&le(k,k,U);for(p=0;p<16;++p)C[p]=k[p]}function te(C){var U,k,p=1;for(U=0;U<16;++U)k=C[U]+p+65535,p=Math.floor(k/65536),C[U]=k-p*65536;C[0]+=p-1+37*(p-1)}function ue(C,U,k){for(var p,R=~(k-1),H=0;H<16;++H)p=R&(C[H]^U[H]),C[H]^=p,U[H]^=p}function X(C){var U,k=new Float64Array(16);if(C)for(U=0;U<C.length;++U)k[U]=C[U];return k}function re(C,U,k){for(var p=0;p<16;++p)C[p]=U[p]+k[p]}function W(C,U,k){for(var p=0;p<16;++p)C[p]=U[p]-k[p]}function pe(C,U){le(C,U,U)}function le(C,U,k){var p,R,H=0,F=0,J=0,ie=0,ce=0,Q=0,se=0,he=0,ve=0,ye=0,Te=0,Re=0,_e=0,we=0,be=0,Be=0,Ne=0,je=0,Ze=0,nt=0,at=0,lt=0,pt=0,vt=0,Tt=0,Ut=0,Gt=0,ar=0,pr=0,Sr=0,qr=0,Ue=k[0],De=k[1],Pe=k[2],Oe=k[3],Ke=k[4],Ve=k[5],Fe=k[6],Me=k[7],He=k[8],qe=k[9],Ge=k[10],ze=k[11],Ae=k[12],Le=k[13],$e=k[14],Ye=k[15];p=U[0],H+=p*Ue,F+=p*De,J+=p*Pe,ie+=p*Oe,ce+=p*Ke,Q+=p*Ve,se+=p*Fe,he+=p*Me,ve+=p*He,ye+=p*qe,Te+=p*Ge,Re+=p*ze,_e+=p*Ae,we+=p*Le,be+=p*$e,Be+=p*Ye,p=U[1],F+=p*Ue,J+=p*De,ie+=p*Pe,ce+=p*Oe,Q+=p*Ke,se+=p*Ve,he+=p*Fe,ve+=p*Me,ye+=p*He,Te+=p*qe,Re+=p*Ge,_e+=p*ze,we+=p*Ae,be+=p*Le,Be+=p*$e,Ne+=p*Ye,p=U[2],J+=p*Ue,ie+=p*De,ce+=p*Pe,Q+=p*Oe,se+=p*Ke,he+=p*Ve,ve+=p*Fe,ye+=p*Me,Te+=p*He,Re+=p*qe,_e+=p*Ge,we+=p*ze,be+=p*Ae,Be+=p*Le,Ne+=p*$e,je+=p*Ye,p=U[3],ie+=p*Ue,ce+=p*De,Q+=p*Pe,se+=p*Oe,he+=p*Ke,ve+=p*Ve,ye+=p*Fe,Te+=p*Me,Re+=p*He,_e+=p*qe,we+=p*Ge,be+=p*ze,Be+=p*Ae,Ne+=p*Le,je+=p*$e,Ze+=p*Ye,p=U[4],ce+=p*Ue,Q+=p*De,se+=p*Pe,he+=p*Oe,ve+=p*Ke,ye+=p*Ve,Te+=p*Fe,Re+=p*Me,_e+=p*He,we+=p*qe,be+=p*Ge,Be+=p*ze,Ne+=p*Ae,je+=p*Le,Ze+=p*$e,nt+=p*Ye,p=U[5],Q+=p*Ue,se+=p*De,he+=p*Pe,ve+=p*Oe,ye+=p*Ke,Te+=p*Ve,Re+=p*Fe,_e+=p*Me,we+=p*He,be+=p*qe,Be+=p*Ge,Ne+=p*ze,je+=p*Ae,Ze+=p*Le,nt+=p*$e,at+=p*Ye,p=U[6],se+=p*Ue,he+=p*De,ve+=p*Pe,ye+=p*Oe,Te+=p*Ke,Re+=p*Ve,_e+=p*Fe,we+=p*Me,be+=p*He,Be+=p*qe,Ne+=p*Ge,je+=p*ze,Ze+=p*Ae,nt+=p*Le,at+=p*$e,lt+=p*Ye,p=U[7],he+=p*Ue,ve+=p*De,ye+=p*Pe,Te+=p*Oe,Re+=p*Ke,_e+=p*Ve,we+=p*Fe,be+=p*Me,Be+=p*He,Ne+=p*qe,je+=p*Ge,Ze+=p*ze,nt+=p*Ae,at+=p*Le,lt+=p*$e,pt+=p*Ye,p=U[8],ve+=p*Ue,ye+=p*De,Te+=p*Pe,Re+=p*Oe,_e+=p*Ke,we+=p*Ve,be+=p*Fe,Be+=p*Me,Ne+=p*He,je+=p*qe,Ze+=p*Ge,nt+=p*ze,at+=p*Ae,lt+=p*Le,pt+=p*$e,vt+=p*Ye,p=U[9],ye+=p*Ue,Te+=p*De,Re+=p*Pe,_e+=p*Oe,we+=p*Ke,be+=p*Ve,Be+=p*Fe,Ne+=p*Me,je+=p*He,Ze+=p*qe,nt+=p*Ge,at+=p*ze,lt+=p*Ae,pt+=p*Le,vt+=p*$e,Tt+=p*Ye,p=U[10],Te+=p*Ue,Re+=p*De,_e+=p*Pe,we+=p*Oe,be+=p*Ke,Be+=p*Ve,Ne+=p*Fe,je+=p*Me,Ze+=p*He,nt+=p*qe,at+=p*Ge,lt+=p*ze,pt+=p*Ae,vt+=p*Le,Tt+=p*$e,Ut+=p*Ye,p=U[11],Re+=p*Ue,_e+=p*De,we+=p*Pe,be+=p*Oe,Be+=p*Ke,Ne+=p*Ve,je+=p*Fe,Ze+=p*Me,nt+=p*He,at+=p*qe,lt+=p*Ge,pt+=p*ze,vt+=p*Ae,Tt+=p*Le,Ut+=p*$e,Gt+=p*Ye,p=U[12],_e+=p*Ue,we+=p*De,be+=p*Pe,Be+=p*Oe,Ne+=p*Ke,je+=p*Ve,Ze+=p*Fe,nt+=p*Me,at+=p*He,lt+=p*qe,pt+=p*Ge,vt+=p*ze,Tt+=p*Ae,Ut+=p*Le,Gt+=p*$e,ar+=p*Ye,p=U[13],we+=p*Ue,be+=p*De,Be+=p*Pe,Ne+=p*Oe,je+=p*Ke,Ze+=p*Ve,nt+=p*Fe,at+=p*Me,lt+=p*He,pt+=p*qe,vt+=p*Ge,Tt+=p*ze,Ut+=p*Ae,Gt+=p*Le,ar+=p*$e,pr+=p*Ye,p=U[14],be+=p*Ue,Be+=p*De,Ne+=p*Pe,je+=p*Oe,Ze+=p*Ke,nt+=p*Ve,at+=p*Fe,lt+=p*Me,pt+=p*He,vt+=p*qe,Tt+=p*Ge,Ut+=p*ze,Gt+=p*Ae,ar+=p*Le,pr+=p*$e,Sr+=p*Ye,p=U[15],Be+=p*Ue,Ne+=p*De,je+=p*Pe,Ze+=p*Oe,nt+=p*Ke,at+=p*Ve,lt+=p*Fe,pt+=p*Me,vt+=p*He,Tt+=p*qe,Ut+=p*Ge,Gt+=p*ze,ar+=p*Ae,pr+=p*Le,Sr+=p*$e,qr+=p*Ye,H+=38*Ne,F+=38*je,J+=38*Ze,ie+=38*nt,ce+=38*at,Q+=38*lt,se+=38*pt,he+=38*vt,ve+=38*Tt,ye+=38*Ut,Te+=38*Gt,Re+=38*ar,_e+=38*pr,we+=38*Sr,be+=38*qr,R=1,p=H+R+65535,R=Math.floor(p/65536),H=p-R*65536,p=F+R+65535,R=Math.floor(p/65536),F=p-R*65536,p=J+R+65535,R=Math.floor(p/65536),J=p-R*65536,p=ie+R+65535,R=Math.floor(p/65536),ie=p-R*65536,p=ce+R+65535,R=Math.floor(p/65536),ce=p-R*65536,p=Q+R+65535,R=Math.floor(p/65536),Q=p-R*65536,p=se+R+65535,R=Math.floor(p/65536),se=p-R*65536,p=he+R+65535,R=Math.floor(p/65536),he=p-R*65536,p=ve+R+65535,R=Math.floor(p/65536),ve=p-R*65536,p=ye+R+65535,R=Math.floor(p/65536),ye=p-R*65536,p=Te+R+65535,R=Math.floor(p/65536),Te=p-R*65536,p=Re+R+65535,R=Math.floor(p/65536),Re=p-R*65536,p=_e+R+65535,R=Math.floor(p/65536),_e=p-R*65536,p=we+R+65535,R=Math.floor(p/65536),we=p-R*65536,p=be+R+65535,R=Math.floor(p/65536),be=p-R*65536,p=Be+R+65535,R=Math.floor(p/65536),Be=p-R*65536,H+=R-1+37*(R-1),R=1,p=H+R+65535,R=Math.floor(p/65536),H=p-R*65536,p=F+R+65535,R=Math.floor(p/65536),F=p-R*65536,p=J+R+65535,R=Math.floor(p/65536),J=p-R*65536,p=ie+R+65535,R=Math.floor(p/65536),ie=p-R*65536,p=ce+R+65535,R=Math.floor(p/65536),ce=p-R*65536,p=Q+R+65535,R=Math.floor(p/65536),Q=p-R*65536,p=se+R+65535,R=Math.floor(p/65536),se=p-R*65536,p=he+R+65535,R=Math.floor(p/65536),he=p-R*65536,p=ve+R+65535,R=Math.floor(p/65536),ve=p-R*65536,p=ye+R+65535,R=Math.floor(p/65536),ye=p-R*65536,p=Te+R+65535,R=Math.floor(p/65536),Te=p-R*65536,p=Re+R+65535,R=Math.floor(p/65536),Re=p-R*65536,p=_e+R+65535,R=Math.floor(p/65536),_e=p-R*65536,p=we+R+65535,R=Math.floor(p/65536),we=p-R*65536,p=be+R+65535,R=Math.floor(p/65536),be=p-R*65536,p=Be+R+65535,R=Math.floor(p/65536),Be=p-R*65536,H+=R-1+37*(R-1),C[0]=H,C[1]=F,C[2]=J,C[3]=ie,C[4]=ce,C[5]=Q,C[6]=se,C[7]=he,C[8]=ve,C[9]=ye,C[10]=Te,C[11]=Re,C[12]=_e,C[13]=we,C[14]=be,C[15]=Be}return da}var pa,ns;function b0(){if(ns)return pa;ns=1;var t=ge();Ee(),Bt(),Cn(),pa=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(a,c){c=c||{};var o=c.prng||t.random,i={};return i.encrypt=function(n,u){var l=Math.ceil(n.n.bitLength()/8),m;do m=new e(t.util.bytesToHex(o.getBytesSync(l)),16).mod(n.n);while(m.compareTo(e.ONE)<=0);m=t.util.hexToBytes(m.toString(16));var B=l-m.length;B>0&&(m=t.util.fillString("\0",B)+m);var v=n.encrypt(m,"NONE"),d=a.generate(m,u);return{encapsulation:v,key:d}},i.decrypt=function(n,u,l){var m=n.decrypt(u,"NONE");return a.generate(m,l)},i},t.kem.kdf1=function(a,c){r(this,a,0,c||a.digestLength)},t.kem.kdf2=function(a,c){r(this,a,1,c||a.digestLength)};function r(a,c,o,i){a.generate=function(n,u){for(var l=new t.util.ByteBuffer,m=Math.ceil(u/i)+o,B=new t.util.ByteBuffer,v=o;v<m;++v){B.putInt32(v),c.start(),c.update(n+B.getBytes());var d=c.digest();l.putBytes(d.getBytes(i))}return l.truncate(l.length()-u),l.getBytes()}}return pa}var ya,as;function B0(){if(as)return ya;as=1;var t=ge();Ee(),ya=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},r=[],a=null;t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8;for(var c=0;c<t.log.levels.length;++c){var o=t.log.levels[c];e[o]={index:c,name:o.toUpperCase()}}t.log.logMessage=function(v){for(var d=e[v.level].index,y=0;y<r.length;++y){var b=r[y];if(b.flags&t.log.NO_LEVEL_CHECK)b.f(v);else{var S=e[b.level].index;d<=S&&b.f(b,v)}}},t.log.prepareStandard=function(v){"standard"in v||(v.standard=e[v.level].name+" ["+v.category+"] "+v.message)},t.log.prepareFull=function(v){if(!("full"in v)){var d=[v.message];d=d.concat([]),v.full=t.util.format.apply(this,d)}},t.log.prepareStandardFull=function(v){"standardFull"in v||(t.log.prepareStandard(v),v.standardFull=v.standard)};for(var i=["error","warning","info","debug","verbose"],c=0;c<i.length;++c)(function(d){t.log[d]=function(y,b){var S=Array.prototype.slice.call(arguments).slice(2),f={timestamp:new Date,level:d,category:y,message:b,arguments:S};t.log.logMessage(f)}})(i[c]);if(t.log.makeLogger=function(v){var d={flags:0,f:v};return t.log.setLevel(d,"none"),d},t.log.setLevel=function(v,d){var y=!1;if(v&&!(v.flags&t.log.LEVEL_LOCKED))for(var b=0;b<t.log.levels.length;++b){var S=t.log.levels[b];if(d==S){v.level=d,y=!0;break}}return y},t.log.lock=function(v,d){typeof d>"u"||d?v.flags|=t.log.LEVEL_LOCKED:v.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(v){r.push(v)},typeof console<"u"&&"log"in console){var n;if(console.error&&console.warn&&console.info&&console.debug){var u={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},l=function(v,d){t.log.prepareStandard(d);var y=u[d.level],b=[d.standard];b=b.concat(d.arguments.slice()),y.apply(console,b)};n=t.log.makeLogger(l)}else{var l=function(d,y){t.log.prepareStandardFull(y),console.log(y.standardFull)};n=t.log.makeLogger(l)}t.log.setLevel(n,"debug"),t.log.addLogger(n),a=n}else console={log:function(){}};if(a!==null&&typeof window<"u"&&window.location){var m=new URL(window.location.href).searchParams;if(m.has("console.level")&&t.log.setLevel(a,m.get("console.level").slice(-1)[0]),m.has("console.lock")){var B=m.get("console.lock").slice(-1)[0];B=="true"&&t.log.lock(a)}}return t.log.consoleLogger=a,ya}var ga,is;function T0(){return is||(is=1,ga=qt(),Ga(),Hr(),So(),Lo()),ga}var va={exports:{}},ss;function w0(){if(ss)return va.exports;ss=1;var t=ge();hr(),kt(),Sn(),dr(),Er(),Ao(),Bt(),Ee(),Qa();var e=t.asn1,r=va.exports=t.pkcs7=t.pkcs7||{};r.messageFromPem=function(d){var y=t.pem.decode(d)[0];if(y.type!=="PKCS7"){var b=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw b.headerType=y.type,b}if(y.procType&&y.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var S=e.fromDer(y.body);return r.messageFromAsn1(S)},r.messageToPem=function(d,y){var b={type:"PKCS7",body:e.toDer(d.toAsn1()).getBytes()};return t.pem.encode(b,{maxline:y})},r.messageFromAsn1=function(d){var y={},b=[];if(!e.validate(d,r.asn1.contentInfoValidator,y,b)){var S=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw S.errors=b,S}var f=e.derToOid(y.contentType),g;switch(f){case t.pki.oids.envelopedData:g=r.createEnvelopedData();break;case t.pki.oids.encryptedData:g=r.createEncryptedData();break;case t.pki.oids.signedData:g=r.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+f+" is not (yet) supported.")}return g.fromAsn1(y.content.value[0]),g},r.createSignedData=function(){var d=null;return d={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(S){if(B(d,S,r.asn1.signedDataValidator),d.certificates=[],d.crls=[],d.digestAlgorithmIdentifiers=[],d.contentInfo=null,d.signerInfos=[],d.rawCapture.certificates)for(var f=d.rawCapture.certificates.value,g=0;g<f.length;++g)d.certificates.push(t.pki.certificateFromAsn1(f[g]))},toAsn1:function(){d.contentInfo||d.sign();for(var S=[],f=0;f<d.certificates.length;++f)S.push(t.pki.certificateToAsn1(d.certificates[f]));var g=[],E=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d.digestAlgorithmIdentifiers),d.contentInfo])]);return S.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,S)),g.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,g)),E.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),E])},addSigner:function(S){var f=S.issuer,g=S.serialNumber;if(S.certificate){var E=S.certificate;typeof E=="string"&&(E=t.pki.certificateFromPem(E)),f=E.issuer.attributes,g=E.serialNumber}var w=S.key;if(!w)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof w=="string"&&(w=t.pki.privateKeyFromPem(w));var I=S.digestAlgorithm||t.pki.oids.sha1;switch(I){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+I)}var x=S.authenticatedAttributes||[];if(x.length>0){for(var h=!1,s=!1,T=0;T<x.length;++T){var N=x[T];if(!h&&N.type===t.pki.oids.contentType){if(h=!0,s)break;continue}if(!s&&N.type===t.pki.oids.messageDigest){if(s=!0,h)break;continue}}if(!h||!s)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}d.signers.push({key:w,version:1,issuer:f,serialNumber:g,digestAlgorithm:I,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:x,unauthenticatedAttributes:[]})},sign:function(S){if(S=S||{},(typeof d.content!="object"||d.contentInfo===null)&&(d.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in d)){var f;d.content instanceof t.util.ByteBuffer?f=d.content.bytes():typeof d.content=="string"&&(f=t.util.encodeUtf8(d.content)),S.detached?d.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f):d.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,f)]))}if(d.signers.length!==0){var g=y();b(g)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(S){typeof S=="string"&&(S=t.pki.certificateFromPem(S)),d.certificates.push(S)},addCertificateRevokationList:function(S){throw new Error("PKCS#7 CRL support not yet implemented.")}},d;function y(){for(var S={},f=0;f<d.signers.length;++f){var g=d.signers[f],E=g.digestAlgorithm;E in S||(S[E]=t.md[t.pki.oids[E]].create()),g.authenticatedAttributes.length===0?g.md=S[E]:g.md=t.md[t.pki.oids[E]].create()}d.digestAlgorithmIdentifiers=[];for(var E in S)d.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(E).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return S}function b(S){var f;if(d.detachedContent?f=d.detachedContent:(f=d.contentInfo.value[1],f=f.value[0]),!f)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var g=e.derToOid(d.contentInfo.value[0].value),E=e.toDer(f);E.getByte(),e.getBerValueLength(E),E=E.getBytes();for(var w in S)S[w].start().update(E);for(var I=new Date,x=0;x<d.signers.length;++x){var h=d.signers[x];if(h.authenticatedAttributes.length===0){if(g!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{h.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var s=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),T=0;T<h.authenticatedAttributes.length;++T){var N=h.authenticatedAttributes[T];N.type===t.pki.oids.messageDigest?N.value=S[h.digestAlgorithm].digest():N.type===t.pki.oids.signingTime&&(N.value||(N.value=I)),s.value.push(l(N)),h.authenticatedAttributesAsn1.value.push(l(N))}E=e.toDer(s).getBytes(),h.md.start().update(E)}h.signature=h.key.sign(h.md,"RSASSA-PKCS1-V1_5")}d.signerInfos=u(d.signers)}},r.createEncryptedData=function(){var d=null;return d={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(y){B(d,y,r.asn1.encryptedDataValidator)},decrypt:function(y){y!==void 0&&(d.encryptedContent.key=y),v(d)}},d},r.createEnvelopedData=function(){var d=null;return d={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(y){var b=B(d,y,r.asn1.envelopedDataValidator);d.recipients=o(b.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,i(d.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,m(d.encryptedContent))])])])},findRecipient:function(y){for(var b=y.issuer.attributes,S=0;S<d.recipients.length;++S){var f=d.recipients[S],g=f.issuer;if(f.serialNumber===y.serialNumber&&g.length===b.length){for(var E=!0,w=0;w<b.length;++w)if(g[w].type!==b[w].type||g[w].value!==b[w].value){E=!1;break}if(E)return f}}return null},decrypt:function(y,b){if(d.encryptedContent.key===void 0&&y!==void 0&&b!==void 0)switch(y.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var S=b.decrypt(y.encryptedContent.content);d.encryptedContent.key=t.util.createBuffer(S);break;default:throw new Error("Unsupported asymmetric cipher, OID "+y.encryptedContent.algorithm)}v(d)},addRecipient:function(y){d.recipients.push({version:0,issuer:y.issuer.attributes,serialNumber:y.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:y.publicKey}})},encrypt:function(y,b){if(d.encryptedContent.content===void 0){b=b||d.encryptedContent.algorithm,y=y||d.encryptedContent.key;var S,f,g;switch(b){case t.pki.oids["aes128-CBC"]:S=16,f=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:S=24,f=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:S=32,f=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:S=24,f=8,g=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+b)}if(y===void 0)y=t.util.createBuffer(t.random.getBytes(S));else if(y.length()!=S)throw new Error("Symmetric key has wrong length; got "+y.length()+" bytes, expected "+S+".");d.encryptedContent.algorithm=b,d.encryptedContent.key=y,d.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(f));var E=g(y);if(E.start(d.encryptedContent.parameter.copy()),E.update(d.content),!E.finish())throw new Error("Symmetric encryption failed.");d.encryptedContent.content=E.output}for(var w=0;w<d.recipients.length;++w){var I=d.recipients[w];if(I.encryptedContent.content===void 0)switch(I.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:I.encryptedContent.content=I.encryptedContent.key.encrypt(d.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+I.encryptedContent.algorithm)}}}},d};function a(d){var y={},b=[];if(!e.validate(d,r.asn1.recipientInfoValidator,y,b)){var S=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw S.errors=b,S}return{version:y.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(y.issuer),serialNumber:t.util.createBuffer(y.serial).toHex(),encryptedContent:{algorithm:e.derToOid(y.encAlgorithm),parameter:y.encParameter?y.encParameter.value:void 0,content:y.encKey}}}function c(d){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:d.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(d.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.encryptedContent.content)])}function o(d){for(var y=[],b=0;b<d.length;++b)y.push(a(d[b]));return y}function i(d){for(var y=[],b=0;b<d.length;++b)y.push(c(d[b]));return y}function n(d){var y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:d.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(d.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(d.authenticatedAttributesAsn1&&y.value.push(d.authenticatedAttributesAsn1),y.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),y.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.signature)),d.unauthenticatedAttributes.length>0){for(var b=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),S=0;S<d.unauthenticatedAttributes.length;++S){var f=d.unauthenticatedAttributes[S];b.values.push(l(f))}y.value.push(b)}return y}function u(d){for(var y=[],b=0;b<d.length;++b)y.push(n(d[b]));return y}function l(d){var y;if(d.type===t.pki.oids.contentType)y=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.value).getBytes());else if(d.type===t.pki.oids.messageDigest)y=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.value.bytes());else if(d.type===t.pki.oids.signingTime){var b=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z"),f=d.value;if(typeof f=="string"){var g=Date.parse(f);isNaN(g)?f.length===13?f=e.utcTimeToDate(f):f=e.generalizedTimeToDate(f):f=new Date(g)}f>=b&&f<S?y=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(f)):y=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(f))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[y])])}function m(d){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.algorithm).getBytes()),d.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.content.getBytes())])]}function B(d,y,b){var S={},f=[];if(!e.validate(y,b,S,f)){var g=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw g.errors=g,g}var E=e.derToOid(S.contentType);if(E!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(S.encryptedContent){var w="";if(t.util.isArray(S.encryptedContent))for(var I=0;I<S.encryptedContent.length;++I){if(S.encryptedContent[I].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");w+=S.encryptedContent[I].value}else w=S.encryptedContent;d.encryptedContent={algorithm:e.derToOid(S.encAlgorithm),parameter:t.util.createBuffer(S.encParameter.value),content:t.util.createBuffer(w)}}if(S.content){var w="";if(t.util.isArray(S.content))for(var I=0;I<S.content.length;++I){if(S.content[I].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");w+=S.content[I].value}else w=S.content;d.content=t.util.createBuffer(w)}return d.version=S.version.charCodeAt(0),d.rawCapture=S,S}function v(d){if(d.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(d.content===void 0){var y;switch(d.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:y=t.aes.createDecryptionCipher(d.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:y=t.des.createDecryptionCipher(d.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+d.encryptedContent.algorithm)}if(y.start(d.encryptedContent.parameter),y.update(d.encryptedContent.content),!y.finish())throw new Error("Symmetric decryption failed.");d.content=y.output}}return va.exports}var ma={exports:{}},os;function A0(){if(os)return ma.exports;os=1;var t=ge();hr(),Mr(),Ga(),Hr(),Ee();var e=ma.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(o,i,n){n=n||"",i=i||"";var u="ssh-rsa",l=i===""?"none":"aes256-cbc",m="PuTTY-User-Key-File-2: "+u+`\r
`;m+="Encryption: "+l+`\r
`,m+="Comment: "+n+`\r
`;var B=t.util.createBuffer();a(B,u),r(B,o.e),r(B,o.n);var v=t.util.encode64(B.bytes(),64),d=Math.floor(v.length/66)+1;m+="Public-Lines: "+d+`\r
`,m+=v;var y=t.util.createBuffer();r(y,o.d),r(y,o.p),r(y,o.q),r(y,o.qInv);var b;if(!i)b=t.util.encode64(y.bytes(),64);else{var S=y.length()+16-1;S-=S%16;var f=c(y.bytes());f.truncate(f.length()-S+y.length()),y.putBuffer(f);var g=t.util.createBuffer();g.putBuffer(c("\0\0\0\0",i)),g.putBuffer(c("\0\0\0",i));var E=t.aes.createEncryptionCipher(g.truncate(8),"CBC");E.start(t.util.createBuffer().fillWithByte(0,16)),E.update(y.copy()),E.finish();var w=E.output;w.truncate(16),b=t.util.encode64(w.bytes(),64)}d=Math.floor(b.length/66)+1,m+=`\r
Private-Lines: `+d+`\r
`,m+=b;var I=c("putty-private-key-file-mac-key",i),x=t.util.createBuffer();a(x,u),a(x,l),a(x,n),x.putInt32(B.length()),x.putBuffer(B),x.putInt32(y.length()),x.putBuffer(y);var h=t.hmac.create();return h.start("sha1",I),h.update(x.bytes()),m+=`\r
Private-MAC: `+h.digest().toHex()+`\r
`,m},e.publicKeyToOpenSSH=function(o,i){var n="ssh-rsa";i=i||"";var u=t.util.createBuffer();return a(u,n),r(u,o.e),r(u,o.n),n+" "+t.util.encode64(u.bytes())+" "+i},e.privateKeyToOpenSSH=function(o,i){return i?t.pki.encryptRsaPrivateKey(o,i,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(o)},e.getPublicKeyFingerprint=function(o,i){i=i||{};var n=i.md||t.md.md5.create(),u="ssh-rsa",l=t.util.createBuffer();a(l,u),r(l,o.e),r(l,o.n),n.start(),n.update(l.getBytes());var m=n.digest();if(i.encoding==="hex"){var B=m.toHex();return i.delimiter?B.match(/.{2}/g).join(i.delimiter):B}else{if(i.encoding==="binary")return m.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".')}return m};function r(o,i){var n=i.toString(16);n[0]>="8"&&(n="00"+n);var u=t.util.hexToBytes(n);o.putInt32(u.length),o.putBytes(u)}function a(o,i){o.putInt32(i.length),o.putString(i)}function c(){for(var o=t.md.sha1.create(),i=arguments.length,n=0;n<i;++n)o.update(arguments[n]);return o.digest()}return ma.exports}var Ea,fs;function I0(){return fs||(fs=1,Ea=ge(),hr(),x0(),kt(),qa(),Sn(),C0(),Mr(),b0(),B0(),T0(),Io(),$a(),Er(),Bo(),_o(),w0(),Ro(),To(),Co(),Ya(),Bt(),bo(),A0(),No(),Ee()),Ea}var _0=I0();const st=y0(_0),Ar=2048,cs=4096;function Xa(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}function R0(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function ko(t){let e="";for(let r=0;r<t.length;r++){const a=t.charCodeAt(r);e+=a.toString(16).padStart(2,"0")}return e}function Uo(t){const e=t.replace(/\s+/g,"");if(e.length%2!==0)throw new Error("Invalid hex string: length must be even");let r="";for(let a=0;a<e.length;a+=2){const c=Number.parseInt(e.substring(a,a+2),16);if(Number.isNaN(c))throw new Error(`Invalid hex string: invalid character at position ${a}`);r+=String.fromCharCode(c)}return r}function N0(t=Ar){if(t!==Ar&&t!==cs)throw new Error(`Invalid key size: expected ${Ar} or ${cs}, got ${t}`);const e=st.pki.rsa.generateKeyPair(t);return{publicKey:st.pki.publicKeyToPem(e.publicKey),privateKey:st.pki.privateKeyToPem(e.privateKey)}}function L0(t,e){try{const r=st.pki.publicKeyFromPem(e),a=Xa(t),c=r.encrypt(a,"RSA-OAEP");return{ciphertext:ko(c)}}catch(r){throw new Error(`RSA encryption failed: ${r instanceof Error?r.message:String(r)}`)}}function k0(t,e){try{const r=st.pki.privateKeyFromPem(e),a=Uo(t),c=r.decrypt(a,"RSA-OAEP");return R0(c)}catch(r){throw new Error(`RSA decryption failed: ${r instanceof Error?r.message:String(r)}`)}}function U0(t,e,r="SHA-256"){try{const a=st.pki.privateKeyFromPem(e),c=Xa(t),o=r.toLowerCase().replace("-","");let i;if(o==="sha256")i=st.md.sha256.create();else if(o==="sha384")i=st.md.sha384.create();else if(o==="sha512")i=st.md.sha512.create();else if(o==="sha1")i=st.md.sha1.create();else throw new Error(`Unsupported hash algorithm: ${r}`);i.update(c,"raw");const n=a.sign(i);return{signature:ko(n)}}catch(a){throw new Error(`RSA signing failed: ${a instanceof Error?a.message:String(a)}`)}}function D0(t,e,r,a="SHA-256"){try{const c=st.pki.publicKeyFromPem(r),o=Xa(t),i=a.toLowerCase().replace("-","");let n;if(i==="sha256")n=st.md.sha256.create();else if(i==="sha384")n=st.md.sha384.create();else if(i==="sha512")n=st.md.sha512.create();else if(i==="sha1")n=st.md.sha1.create();else throw new Error(`Unsupported hash algorithm: ${a}`);n.update(o,"raw");const u=Uo(e);return c.verify(n.digest().bytes(),u)}catch(c){if(c instanceof Error&&(c.message.includes("Encryption block is invalid")||c.message.includes("Encrypted message is invalid")))return!1;throw new Error(`RSA verification failed: ${c instanceof Error?c.message:String(c)}`)}}function P0(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function _a(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function xa(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Ie(t,e,r=""){const a=P0(t),c=t?.length,o=e!==void 0;if(!a||o&&c!==e){const i=r&&`"${r}" `,n=o?` of length ${e}`:"",u=a?`length=${c}`:`type=${typeof t}`;throw new Error(i+"expected Uint8Array"+n+", got "+u)}return t}function mr(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ja(t,e){Ie(t,void 0,"output");const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function O0(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function et(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ot(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Bn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const K0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function V0(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Do(t,e){if(t.length!==e.length)return!1;let r=0;for(let a=0;a<t.length;a++)r|=t[a]^e[a];return r===0}const Po=(t,e)=>{function r(a,...c){if(Ie(a,void 0,"key"),!K0)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const m=c[0];Ie(m,t.varSizeNonce?void 0:t.nonceLength,"nonce")}const o=t.tagLength;o&&c[1]!==void 0&&Ie(c[1],void 0,"AAD");const i=e(a,...c),n=(m,B)=>{if(B!==void 0){if(m!==2)throw new Error("cipher output not supported");Ie(B,void 0,"output")}};let u=!1;return{encrypt(m,B){if(u)throw new Error("cannot encrypt() twice with same key + nonce");return u=!0,Ie(m),n(i.encrypt.length,B),i.encrypt(m,B)},decrypt(m,B){if(Ie(m),o&&m.length<o)throw new Error('"ciphertext" expected length bigger than tagLength='+o);return n(i.decrypt.length,B),i.decrypt(m,B)}}}return Object.assign(r,t),r};function Ra(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error('"output" expected Uint8Array of length '+t+", got: "+e.length);if(r&&!un(e))throw new Error("invalid output, must be aligned");return e}function Oo(t,e,r){_a(r);const a=new Uint8Array(16),c=Bn(a);return c.setBigUint64(0,BigInt(e),r),c.setBigUint64(8,BigInt(t),r),a}function un(t){return t.byteOffset%4===0}function bt(t){return Uint8Array.from(t)}function xr(t=32){const e=typeof globalThis=="object"?globalThis.crypto:null;if(typeof e?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return e.getRandomValues(new Uint8Array(t))}const Ft=16,Za=new Uint8Array(16),It=et(Za),F0=225,M0=(t,e,r,a)=>{const c=a&1;return{s3:r<<31|a>>>1,s2:e<<31|r>>>1,s1:t<<31|e>>>1,s0:t>>>1^F0<<24&-(c&1)}},gt=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255|0;function H0(t){t.reverse();const e=t[15]&1;let r=0;for(let a=0;a<t.length;a++){const c=t[a];t[a]=c>>>1|r,r=(c&1)<<7}return t[0]^=-e&225,t}const q0=t=>t>64*1024?8:t>1024?4:2;class Ko{blockLen=Ft;outputLen=Ft;s0=0;s1=0;s2=0;s3=0;finished=!1;t;W;windowSize;constructor(e,r){Ie(e,16,"key"),e=bt(e);const a=Bn(e);let c=a.getUint32(0,!1),o=a.getUint32(4,!1),i=a.getUint32(8,!1),n=a.getUint32(12,!1);const u=[];for(let y=0;y<128;y++)u.push({s0:gt(c),s1:gt(o),s2:gt(i),s3:gt(n)}),{s0:c,s1:o,s2:i,s3:n}=M0(c,o,i,n);const l=q0(r||1024);if(![1,2,4,8].includes(l))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=l;const B=128/l,v=this.windowSize=2**l,d=[];for(let y=0;y<B;y++)for(let b=0;b<v;b++){let S=0,f=0,g=0,E=0;for(let w=0;w<l;w++){if(!(b>>>l-w-1&1))continue;const{s0:x,s1:h,s2:s,s3:T}=u[l*y+w];S^=x,f^=h,g^=s,E^=T}d.push({s0:S,s1:f,s2:g,s3:E})}this.t=d}_updateBlock(e,r,a,c){e^=this.s0,r^=this.s1,a^=this.s2,c^=this.s3;const{W:o,t:i,windowSize:n}=this;let u=0,l=0,m=0,B=0;const v=(1<<o)-1;let d=0;for(const y of[e,r,a,c])for(let b=0;b<4;b++){const S=y>>>8*b&255;for(let f=8/o-1;f>=0;f--){const g=S>>>o*f&v,{s0:E,s1:w,s2:I,s3:x}=i[d*n+g];u^=E,l^=w,m^=I,B^=x,d+=1}}this.s0=u,this.s1=l,this.s2=m,this.s3=B}update(e){mr(this),Ie(e),e=bt(e);const r=et(e),a=Math.floor(e.length/Ft),c=e.length%Ft;for(let o=0;o<a;o++)this._updateBlock(r[o*4+0],r[o*4+1],r[o*4+2],r[o*4+3]);return c&&(Za.set(e.subarray(a*Ft)),this._updateBlock(It[0],It[1],It[2],It[3]),ot(It)),this}destroy(){const{t:e}=this;for(const r of e)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(e){mr(this),ja(e,this),this.finished=!0;const{s0:r,s1:a,s2:c,s3:o}=this,i=et(e);return i[0]=r,i[1]=a,i[2]=c,i[3]=o,e}digest(){const e=new Uint8Array(Ft);return this.digestInto(e),this.destroy(),e}}class G0 extends Ko{constructor(e,r){Ie(e);const a=H0(bt(e));super(a,r),ot(a)}update(e){mr(this),Ie(e),e=bt(e);const r=et(e),a=e.length%Ft,c=Math.floor(e.length/Ft);for(let o=0;o<c;o++)this._updateBlock(gt(r[o*4+3]),gt(r[o*4+2]),gt(r[o*4+1]),gt(r[o*4+0]));return a&&(Za.set(e.subarray(c*Ft)),this._updateBlock(gt(It[3]),gt(It[2]),gt(It[1]),gt(It[0])),ot(It)),this}digestInto(e){mr(this),ja(e,this),this.finished=!0;const{s0:r,s1:a,s2:c,s3:o}=this,i=et(e);return i[0]=r,i[1]=a,i[2]=c,i[3]=o,e.reverse()}}function Vo(t){const e=(a,c)=>t(c,a.length).update(a).digest(),r=t(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(a,c)=>t(a,c),e}const us=Vo((t,e)=>new Ko(t,e));Vo((t,e)=>new G0(t,e));const Na=16,z0=4,Wr=new Uint8Array(Na),$0=283;function Y0(t){if(![16,24,32].includes(t.length))throw new Error('"aes key" expected Uint8Array of length 16/24/32, got length='+t.length)}function Wa(t){return t<<1^$0&-(t>>7)}function ls(t,e){let r=0;for(;e>0;e>>=1)r^=t&-(e&1),t=Wa(t);return r}const Q0=(()=>{const t=new Uint8Array(256);for(let r=0,a=1;r<256;r++,a^=Wa(a))t[r]=a;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let a=t[255-r];a|=a<<8,e[t[r]]=(a^a>>4^a>>5^a>>6^a>>7^99)&255}return ot(t),e})(),X0=t=>t<<24|t>>>8,Sa=t=>t<<8|t>>>24;function j0(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const r=new Uint32Array(256).map((l,m)=>e(t[m])),a=r.map(Sa),c=a.map(Sa),o=c.map(Sa),i=new Uint32Array(256*256),n=new Uint32Array(256*256),u=new Uint16Array(256*256);for(let l=0;l<256;l++)for(let m=0;m<256;m++){const B=l*256+m;i[B]=r[l]^a[m],n[B]=c[l]^o[m],u[B]=t[l]<<8|t[m]}return{sbox:t,sbox2:u,T0:r,T1:a,T2:c,T3:o,T01:i,T23:n}}const Fo=j0(Q0,t=>ls(t,3)<<24|t<<16|t<<8|ls(t,2)),Z0=(()=>{const t=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=Wa(r))t[e]=r;return t})();function W0(t){Ie(t);const e=t.length;Y0(t);const{sbox2:r}=Fo,a=[];un(t)||a.push(t=bt(t));const c=et(t),o=c.length,i=u=>Tr(r,u,u,u,u),n=new Uint32Array(e+28);n.set(c);for(let u=o;u<n.length;u++){let l=n[u-1];u%o===0?l=i(X0(l))^Z0[u/o-1]:o>6&&u%o===4&&(l=i(l)),n[u]=n[u-o]^l}return ot(...a),n}function Jr(t,e,r,a,c,o){return t[r<<8&65280|a>>>8&255]^e[c>>>8&65280|o>>>24&255]}function Tr(t,e,r,a,c){return t[e&255|r&65280]|t[a>>>16&255|c>>>16&65280]<<16}function hs(t,e,r,a,c){const{sbox2:o,T01:i,T23:n}=Fo;let u=0;e^=t[u++],r^=t[u++],a^=t[u++],c^=t[u++];const l=t.length/4-2;for(let y=0;y<l;y++){const b=t[u++]^Jr(i,n,e,r,a,c),S=t[u++]^Jr(i,n,r,a,c,e),f=t[u++]^Jr(i,n,a,c,e,r),g=t[u++]^Jr(i,n,c,e,r,a);e=b,r=S,a=f,c=g}const m=t[u++]^Tr(o,e,r,a,c),B=t[u++]^Tr(o,r,a,c,e),v=t[u++]^Tr(o,a,c,e,r),d=t[u++]^Tr(o,c,e,r,a);return{s0:m,s1:B,s2:v,s3:d}}function en(t,e,r,a,c){Ie(r,Na,"nonce"),Ie(a),c=Ra(a.length,c);const o=r,i=et(o),n=Bn(o),u=et(a),l=et(c),m=e?0:12,B=a.length;let v=n.getUint32(m,e),{s0:d,s1:y,s2:b,s3:S}=hs(t,i[0],i[1],i[2],i[3]);for(let g=0;g+4<=u.length;g+=4)l[g+0]=u[g+0]^d,l[g+1]=u[g+1]^y,l[g+2]=u[g+2]^b,l[g+3]=u[g+3]^S,v=v+1>>>0,n.setUint32(m,v,e),{s0:d,s1:y,s2:b,s3:S}=hs(t,i[0],i[1],i[2],i[3]);const f=Na*Math.floor(u.length/z0);if(f<B){const g=new Uint32Array([d,y,b,S]),E=O0(g);for(let w=f,I=0;w<B;w++,I++)c[w]=a[w]^E[I];ot(g)}return c}function J0(t,e,r,a,c){const o=c?c.length:0,i=t.create(r,a.length+o);c&&i.update(c);const n=Oo(8*a.length,8*o,e);i.update(a),i.update(n);const u=i.digest();return ot(n),u}const Mo=Po({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,r,a){if(r.length<8)throw new Error("aes/gcm: invalid nonce length");const c=16;function o(n,u,l){const m=J0(us,!1,n,l,a);for(let B=0;B<u.length;B++)m[B]^=u[B];return m}function i(){const n=W0(e),u=Wr.slice(),l=Wr.slice();if(en(n,!1,l,l,u),r.length===12)l.set(r);else{const B=Wr.slice();Bn(B).setBigUint64(8,BigInt(r.length*8),!1);const d=us.create(u).update(r).update(B);d.digestInto(l),d.destroy()}const m=en(n,!1,l,Wr);return{xk:n,authKey:u,counter:l,tagMask:m}}return{encrypt(n){const{xk:u,authKey:l,counter:m,tagMask:B}=i(),v=new Uint8Array(n.length+c),d=[u,l,m,B];un(n)||d.push(n=bt(n)),en(u,!1,m,n,v.subarray(0,n.length));const y=o(l,B,v.subarray(0,v.length-c));return d.push(y),v.set(y,n.length),ot(...d),v},decrypt(n){const{xk:u,authKey:l,counter:m,tagMask:B}=i(),v=[u,l,B,m];un(n)||v.push(n=bt(n));const d=n.subarray(0,-c),y=n.subarray(-c),b=o(l,B,d);if(v.push(b),!Do(b,y))throw new Error("aes/gcm: invalid ghash tag");const S=en(u,!1,m,d);return ot(...v),S}}}),kr=256,Ir=12,ln=16;function eu(t,e,r){if(e.length!==kr/8)throw new Error(`Invalid key length: expected ${kr/8} bytes, got ${e.length}`);const a=xr(Ir);if(a.length!==Ir)throw new Error(`Invalid IV length: expected ${Ir} bytes, got ${a.length}`);const o=Mo(e,a).encrypt(t),i=o.subarray(0,o.length-ln),n=o.subarray(o.length-ln);return{ciphertext:i,authTag:n,iv:a}}function tu(t,e,r,a){if(e.length!==kr/8)throw new Error(`Invalid key length: expected ${kr/8} bytes, got ${e.length}`);if(r.length!==Ir)throw new Error(`Invalid IV length: expected ${Ir} bytes, got ${r.length}`);if(a.length!==ln)throw new Error(`Invalid auth tag length: expected ${ln} bytes, got ${a.length}`);const c=Mo(e,r),o=new Uint8Array(t.length+a.length);o.set(t),o.set(a,t.length);try{return c.decrypt(o)}catch{throw new Error("Authentication failed: data may have been tampered with")}}function ru(){return xr(kr/8)}const Ho=t=>Uint8Array.from(t.split(""),e=>e.charCodeAt(0)),nu=Ho("expand 16-byte k"),au=Ho("expand 32-byte k"),iu=et(nu),su=et(au);function fe(t,e){return t<<e|t>>>32-e}function La(t){return t.byteOffset%4===0}const tn=64,ou=16,qo=2**32-1,ds=Uint32Array.of();function fu(t,e,r,a,c,o,i,n){const u=c.length,l=new Uint8Array(tn),m=et(l),B=La(c)&&La(o),v=B?et(c):ds,d=B?et(o):ds;for(let y=0;y<u;i++){if(t(e,r,a,m,i,n),i>=qo)throw new Error("arx: counter overflow");const b=Math.min(tn,u-y);if(B&&b===tn){const S=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let f=0,g;f<ou;f++)g=S+f,d[g]=v[g]^m[f];y+=tn;continue}for(let S=0,f;S<b;S++)f=y+S,o[f]=c[f]^l[S];y+=b}}function cu(t,e){const{allowShortKeys:r,extendNonceFn:a,counterLength:c,counterRight:o,rounds:i}=V0({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return xa(c),xa(i),_a(o),_a(r),(n,u,l,m,B=0)=>{Ie(n,void 0,"key"),Ie(u,void 0,"nonce"),Ie(l,void 0,"data");const v=l.length;if(m===void 0&&(m=new Uint8Array(v)),Ie(m,void 0,"output"),xa(B),B<0||B>=qo)throw new Error("arx: counter overflow");if(m.length<v)throw new Error(`arx: output (${m.length}) is shorter than data (${v})`);const d=[];let y=n.length,b,S;if(y===32)d.push(b=bt(n)),S=su;else if(y===16&&r)b=new Uint8Array(32),b.set(n),b.set(n,16),S=iu,d.push(b);else throw Ie(n,32,"arx key"),new Error("invalid key size");La(u)||d.push(u=bt(u));const f=et(b);if(a){if(u.length!==24)throw new Error("arx: extended nonce must be 24 bytes");a(S,f,et(u.subarray(0,16)),f),u=u.subarray(16)}const g=16-c;if(g!==u.length)throw new Error(`arx: nonce must be ${g} or 16 bytes`);if(g!==12){const w=new Uint8Array(12);w.set(u,o?0:12-u.length),u=w,d.push(u)}const E=et(u);return fu(t,S,f,E,l,m,B,i),ot(...d),m}}function We(t,e){return t[e++]&255|(t[e++]&255)<<8}class uu{blockLen=16;outputLen=16;buffer=new Uint8Array(16);r=new Uint16Array(10);h=new Uint16Array(10);pad=new Uint16Array(8);pos=0;finished=!1;constructor(e){e=bt(Ie(e,32,"key"));const r=We(e,0),a=We(e,2),c=We(e,4),o=We(e,6),i=We(e,8),n=We(e,10),u=We(e,12),l=We(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|a<<3)&8191,this.r[2]=(a>>>10|c<<6)&7939,this.r[3]=(c>>>7|o<<9)&8191,this.r[4]=(o>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|n<<2)&8191,this.r[7]=(n>>>11|u<<5)&8065,this.r[8]=(u>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let m=0;m<8;m++)this.pad[m]=We(e,16+2*m)}process(e,r,a=!1){const c=a?0:2048,{h:o,r:i}=this,n=i[0],u=i[1],l=i[2],m=i[3],B=i[4],v=i[5],d=i[6],y=i[7],b=i[8],S=i[9],f=We(e,r+0),g=We(e,r+2),E=We(e,r+4),w=We(e,r+6),I=We(e,r+8),x=We(e,r+10),h=We(e,r+12),s=We(e,r+14);let T=o[0]+(f&8191),N=o[1]+((f>>>13|g<<3)&8191),O=o[2]+((g>>>10|E<<6)&8191),_=o[3]+((E>>>7|w<<9)&8191),D=o[4]+((w>>>4|I<<12)&8191),V=o[5]+(I>>>1&8191),P=o[6]+((I>>>14|x<<2)&8191),M=o[7]+((x>>>11|h<<5)&8191),q=o[8]+((h>>>8|s<<8)&8191),$=o[9]+(s>>>5|c),G=0,Y=G+T*n+N*(5*S)+O*(5*b)+_*(5*y)+D*(5*d);G=Y>>>13,Y&=8191,Y+=V*(5*v)+P*(5*B)+M*(5*m)+q*(5*l)+$*(5*u),G+=Y>>>13,Y&=8191;let j=G+T*u+N*n+O*(5*S)+_*(5*b)+D*(5*y);G=j>>>13,j&=8191,j+=V*(5*d)+P*(5*v)+M*(5*B)+q*(5*m)+$*(5*l),G+=j>>>13,j&=8191;let te=G+T*l+N*u+O*n+_*(5*S)+D*(5*b);G=te>>>13,te&=8191,te+=V*(5*y)+P*(5*d)+M*(5*v)+q*(5*B)+$*(5*m),G+=te>>>13,te&=8191;let ue=G+T*m+N*l+O*u+_*n+D*(5*S);G=ue>>>13,ue&=8191,ue+=V*(5*b)+P*(5*y)+M*(5*d)+q*(5*v)+$*(5*B),G+=ue>>>13,ue&=8191;let X=G+T*B+N*m+O*l+_*u+D*n;G=X>>>13,X&=8191,X+=V*(5*S)+P*(5*b)+M*(5*y)+q*(5*d)+$*(5*v),G+=X>>>13,X&=8191;let re=G+T*v+N*B+O*m+_*l+D*u;G=re>>>13,re&=8191,re+=V*n+P*(5*S)+M*(5*b)+q*(5*y)+$*(5*d),G+=re>>>13,re&=8191;let W=G+T*d+N*v+O*B+_*m+D*l;G=W>>>13,W&=8191,W+=V*u+P*n+M*(5*S)+q*(5*b)+$*(5*y),G+=W>>>13,W&=8191;let pe=G+T*y+N*d+O*v+_*B+D*m;G=pe>>>13,pe&=8191,pe+=V*l+P*u+M*n+q*(5*S)+$*(5*b),G+=pe>>>13,pe&=8191;let le=G+T*b+N*y+O*d+_*v+D*B;G=le>>>13,le&=8191,le+=V*m+P*l+M*u+q*n+$*(5*S),G+=le>>>13,le&=8191;let C=G+T*S+N*b+O*y+_*d+D*v;G=C>>>13,C&=8191,C+=V*B+P*m+M*l+q*u+$*n,G+=C>>>13,C&=8191,G=(G<<2)+G|0,G=G+Y|0,Y=G&8191,G=G>>>13,j+=G,o[0]=Y,o[1]=j,o[2]=te,o[3]=ue,o[4]=X,o[5]=re,o[6]=W,o[7]=pe,o[8]=le,o[9]=C}finalize(){const{h:e,pad:r}=this,a=new Uint16Array(10);let c=e[1]>>>13;e[1]&=8191;for(let n=2;n<10;n++)e[n]+=c,c=e[n]>>>13,e[n]&=8191;e[0]+=c*5,c=e[0]>>>13,e[0]&=8191,e[1]+=c,c=e[1]>>>13,e[1]&=8191,e[2]+=c,a[0]=e[0]+5,c=a[0]>>>13,a[0]&=8191;for(let n=1;n<10;n++)a[n]=e[n]+c,c=a[n]>>>13,a[n]&=8191;a[9]-=8192;let o=(c^1)-1;for(let n=0;n<10;n++)a[n]&=o;o=~o;for(let n=0;n<10;n++)e[n]=e[n]&o|a[n];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let i=e[0]+r[0];e[0]=i&65535;for(let n=1;n<8;n++)i=(e[n]+r[n]|0)+(i>>>16)|0,e[n]=i&65535;ot(a)}update(e){mr(this),Ie(e),e=bt(e);const{buffer:r,blockLen:a}=this,c=e.length;for(let o=0;o<c;){const i=Math.min(a-this.pos,c-o);if(i===a){for(;a<=c-o;o+=a)this.process(e,o);continue}r.set(e.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===a&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){ot(this.h,this.r,this.buffer,this.pad)}digestInto(e){mr(this),ja(e,this),this.finished=!0;const{buffer:r,h:a}=this;let{pos:c}=this;if(c){for(r[c++]=1;c<16;c++)r[c]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let i=0;i<8;i++)e[o++]=a[i]>>>0,e[o++]=a[i]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}}function lu(t){const e=(a,c)=>t(c).update(a).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=a=>t(a),e}const Go=lu(t=>new uu(t));function hu(t,e,r,a,c,o=20){let i=t[0],n=t[1],u=t[2],l=t[3],m=e[0],B=e[1],v=e[2],d=e[3],y=e[4],b=e[5],S=e[6],f=e[7],g=c,E=r[0],w=r[1],I=r[2],x=i,h=n,s=u,T=l,N=m,O=B,_=v,D=d,V=y,P=b,M=S,q=f,$=g,G=E,Y=w,j=I;for(let ue=0;ue<o;ue+=2)x=x+N|0,$=fe($^x,16),V=V+$|0,N=fe(N^V,12),x=x+N|0,$=fe($^x,8),V=V+$|0,N=fe(N^V,7),h=h+O|0,G=fe(G^h,16),P=P+G|0,O=fe(O^P,12),h=h+O|0,G=fe(G^h,8),P=P+G|0,O=fe(O^P,7),s=s+_|0,Y=fe(Y^s,16),M=M+Y|0,_=fe(_^M,12),s=s+_|0,Y=fe(Y^s,8),M=M+Y|0,_=fe(_^M,7),T=T+D|0,j=fe(j^T,16),q=q+j|0,D=fe(D^q,12),T=T+D|0,j=fe(j^T,8),q=q+j|0,D=fe(D^q,7),x=x+O|0,j=fe(j^x,16),M=M+j|0,O=fe(O^M,12),x=x+O|0,j=fe(j^x,8),M=M+j|0,O=fe(O^M,7),h=h+_|0,$=fe($^h,16),q=q+$|0,_=fe(_^q,12),h=h+_|0,$=fe($^h,8),q=q+$|0,_=fe(_^q,7),s=s+D|0,G=fe(G^s,16),V=V+G|0,D=fe(D^V,12),s=s+D|0,G=fe(G^s,8),V=V+G|0,D=fe(D^V,7),T=T+N|0,Y=fe(Y^T,16),P=P+Y|0,N=fe(N^P,12),T=T+N|0,Y=fe(Y^T,8),P=P+Y|0,N=fe(N^P,7);let te=0;a[te++]=i+x|0,a[te++]=n+h|0,a[te++]=u+s|0,a[te++]=l+T|0,a[te++]=m+N|0,a[te++]=B+O|0,a[te++]=v+_|0,a[te++]=d+D|0,a[te++]=y+V|0,a[te++]=b+P|0,a[te++]=S+M|0,a[te++]=f+q|0,a[te++]=g+$|0,a[te++]=E+G|0,a[te++]=w+Y|0,a[te++]=I+j|0}function du(t,e,r,a){let c=t[0],o=t[1],i=t[2],n=t[3],u=e[0],l=e[1],m=e[2],B=e[3],v=e[4],d=e[5],y=e[6],b=e[7],S=r[0],f=r[1],g=r[2],E=r[3];for(let I=0;I<20;I+=2)c=c+u|0,S=fe(S^c,16),v=v+S|0,u=fe(u^v,12),c=c+u|0,S=fe(S^c,8),v=v+S|0,u=fe(u^v,7),o=o+l|0,f=fe(f^o,16),d=d+f|0,l=fe(l^d,12),o=o+l|0,f=fe(f^o,8),d=d+f|0,l=fe(l^d,7),i=i+m|0,g=fe(g^i,16),y=y+g|0,m=fe(m^y,12),i=i+m|0,g=fe(g^i,8),y=y+g|0,m=fe(m^y,7),n=n+B|0,E=fe(E^n,16),b=b+E|0,B=fe(B^b,12),n=n+B|0,E=fe(E^n,8),b=b+E|0,B=fe(B^b,7),c=c+l|0,E=fe(E^c,16),y=y+E|0,l=fe(l^y,12),c=c+l|0,E=fe(E^c,8),y=y+E|0,l=fe(l^y,7),o=o+m|0,S=fe(S^o,16),b=b+S|0,m=fe(m^b,12),o=o+m|0,S=fe(S^o,8),b=b+S|0,m=fe(m^b,7),i=i+B|0,f=fe(f^i,16),v=v+f|0,B=fe(B^v,12),i=i+B|0,f=fe(f^i,8),v=v+f|0,B=fe(B^v,7),n=n+u|0,g=fe(g^n,16),d=d+g|0,u=fe(u^d,12),n=n+u|0,g=fe(g^n,8),d=d+g|0,u=fe(u^d,7);let w=0;a[w++]=c,a[w++]=o,a[w++]=i,a[w++]=n,a[w++]=S,a[w++]=f,a[w++]=g,a[w++]=E}const pu=cu(hu,{counterRight:!1,counterLength:8,extendNonceFn:du,allowShortKeys:!1}),yu=new Uint8Array(16),ps=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(yu.subarray(r))},gu=new Uint8Array(32);function ys(t,e,r,a,c){c!==void 0&&Ie(c,void 0,"AAD");const o=t(e,r,gu),i=Oo(a.length,c?c.length:0,!0),n=Go.create(o);c&&ps(n,c),ps(n,a),n.update(i);const u=n.digest();return ot(o,i),u}const vu=t=>(e,r,a)=>({encrypt(o,i){const n=o.length;i=Ra(n+16,i,!1),i.set(o);const u=i.subarray(0,-16);t(e,r,u,u,1);const l=ys(t,e,r,u,a);return i.set(l,n),ot(l),i},decrypt(o,i){i=Ra(o.length-16,i,!1);const n=o.subarray(0,-16),u=o.subarray(-16),l=ys(t,e,r,n,a);if(!Do(u,l))throw new Error("invalid tag");return i.set(o.subarray(0,-16)),t(e,r,i,i,1),ot(l),i}}),zo=Po({blockSize:64,nonceLength:24,tagLength:16},vu(pu)),Ur=256,_r=24,hn=16;function mu(t,e,r){if(e.length!==Ur/8)throw new Error(`Invalid key length: expected ${Ur/8} bytes, got ${e.length}`);const a=xr(_r);if(a.length!==_r)throw new Error(`Invalid nonce length: expected ${_r} bytes, got ${a.length}`);const o=zo(e,a).encrypt(t),i=o.subarray(0,o.length-hn),n=o.subarray(o.length-hn);return{ciphertext:i,authTag:n,nonce:a}}function Eu(t,e,r,a){if(e.length!==Ur/8)throw new Error(`Invalid key length: expected ${Ur/8} bytes, got ${e.length}`);if(r.length!==_r)throw new Error(`Invalid nonce length: expected ${_r} bytes, got ${r.length}`);if(a.length!==hn)throw new Error(`Invalid auth tag length: expected ${hn} bytes, got ${a.length}`);const c=zo(e,r),o=new Uint8Array(t.length+a.length);o.set(t),o.set(a,t.length);try{return c.decrypt(o)}catch{throw new Error("Authentication failed: data may have been tampered with")}}function xu(){return xr(Ur/8)}const Dr=32,gs=16;function $o(t,e){if(e.length!==Dr)throw new Error(`Invalid key length: expected ${Dr} bytes, got ${e.length}`);const r=Go.create(e);return r.update(t),r.digest()}function Su(t,e,r){if(e.length!==Dr)throw new Error(`Invalid key length: expected ${Dr} bytes, got ${e.length}`);if(r.length!==gs)throw new Error(`Invalid tag length: expected ${gs} bytes, got ${r.length}`);const a=$o(t,e);return Cu(a,r)}function Cu(t,e){if(t.length!==e.length)return!1;let r=0;for(let a=0;a<t.length;a++)r|=t[a]^e[a];return r===0}function bu(){return xr(Dr)}async function vs(t){const e=await crypto.subtle.digest("SHA-256",t);return new Uint8Array(e)}async function ms(t){const e=await crypto.subtle.digest("SHA-512",t);return new Uint8Array(e)}async function Es(t){return Promise.resolve(Vf(t))}const Bu=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);function jt(t,e,r,a,c){return t=t+e+c|0,a=ft(a^t,16),r=r+a|0,e=ft(e^r,12),{a:t,b:e,c:r,d:a}}function Zt(t,e,r,a,c){return t=t+e+c|0,a=ft(a^t,8),r=r+a|0,e=ft(e^r,7),{a:t,b:e,c:r,d:a}}const ke=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ae=new Uint32Array(32);function Wt(t,e,r,a,c,o){const i=c[o],n=c[o+1];let u=ae[2*t],l=ae[2*t+1],m=ae[2*e],B=ae[2*e+1],v=ae[2*r],d=ae[2*r+1],y=ae[2*a],b=ae[2*a+1],S=Ua(u,m,i);l=Da(S,l,B,n),u=S|0,{Dh:b,Dl:y}={Dh:b^l,Dl:y^u},{Dh:b,Dl:y}={Dh:vf(b,y),Dl:mf(b)},{h:d,l:v}=St(d,v,b,y),{Bh:B,Bl:m}={Bh:B^d,Bl:m^v},{Bh:B,Bl:m}={Bh:er(B,m,24),Bl:tr(B,m,24)},ae[2*t]=u,ae[2*t+1]=l,ae[2*e]=m,ae[2*e+1]=B,ae[2*r]=v,ae[2*r+1]=d,ae[2*a]=y,ae[2*a+1]=b}function Jt(t,e,r,a,c,o){const i=c[o],n=c[o+1];let u=ae[2*t],l=ae[2*t+1],m=ae[2*e],B=ae[2*e+1],v=ae[2*r],d=ae[2*r+1],y=ae[2*a],b=ae[2*a+1],S=Ua(u,m,i);l=Da(S,l,B,n),u=S|0,{Dh:b,Dl:y}={Dh:b^l,Dl:y^u},{Dh:b,Dl:y}={Dh:er(b,y,16),Dl:tr(b,y,16)},{h:d,l:v}=St(d,v,b,y),{Bh:B,Bl:m}={Bh:B^d,Bl:m^v},{Bh:B,Bl:m}={Bh:br(B,m,63),Bl:Br(B,m,63)},ae[2*t]=u,ae[2*t+1]=l,ae[2*e]=m,ae[2*e+1]=B,ae[2*r]=v,ae[2*r+1]=d,ae[2*a]=y,ae[2*a+1]=b}function Tu(t,e={},r,a,c){if(dt(r),t<0||t>r)throw new Error("outputLen bigger than keyLen");const{key:o,salt:i,personalization:n}=e;if(o!==void 0&&(o.length<1||o.length>r))throw new Error('"key" expected to be undefined or of length=1..'+r);i!==void 0&&de(i,a,"salt"),n!==void 0&&de(n,c,"personalization")}class Yo{buffer;buffer32;finished=!1;destroyed=!1;length=0;pos=0;blockLen;outputLen;constructor(e,r){dt(e),dt(r),this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=cr(this.buffer)}update(e){Ht(this),de(e);const{blockLen:r,buffer:a,buffer32:c}=this,o=e.length,i=e.byteOffset,n=e.buffer;for(let u=0;u<o;){this.pos===r&&(it(c),this.compress(c,0,!1),it(c),this.pos=0);const l=Math.min(r-this.pos,o-u),m=i+u;if(l===r&&!(m%4)&&u+l<o){const B=new Uint32Array(n,m,Math.floor((o-u)/4));it(B);for(let v=0;u+r<o;v+=c.length,u+=r)this.length+=r,this.compress(B,v,!1);it(B);continue}a.set(e.subarray(u,u+l),this.pos),this.pos+=l,this.length+=l,u+=l}return this}digestInto(e){Ht(this),pn(e,this);const{pos:r,buffer32:a}=this;this.finished=!0,ut(this.buffer.subarray(r)),it(a),this.compress(a,0,!0),it(a);const c=cr(e);this.get().forEach((o,i)=>c[i]=Kt(o))}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}_cloneInto(e){const{buffer:r,length:a,finished:c,destroyed:o,outputLen:i,pos:n}=this;return e||=new this.constructor({dkLen:i}),e.set(...this.get()),e.buffer.set(r),e.destroyed=o,e.finished=c,e.length=a,e.pos=n,e.outputLen=i,e}clone(){return this._cloneInto()}}class wu extends Yo{v0l=ke[0]|0;v0h=ke[1]|0;v1l=ke[2]|0;v1h=ke[3]|0;v2l=ke[4]|0;v2h=ke[5]|0;v3l=ke[6]|0;v3h=ke[7]|0;v4l=ke[8]|0;v4h=ke[9]|0;v5l=ke[10]|0;v5h=ke[11]|0;v6l=ke[12]|0;v6h=ke[13]|0;v7l=ke[14]|0;v7h=ke[15]|0;constructor(e={}){const r=e.dkLen===void 0?64:e.dkLen;super(128,r),Tu(r,e,64,16,16);let{key:a,personalization:c,salt:o}=e,i=0;if(a!==void 0&&(de(a,void 0,"key"),i=a.length),this.v0l^=this.outputLen|i<<8|65536|1<<24,o!==void 0){de(o,void 0,"salt");const n=cr(o);this.v4l^=Kt(n[0]),this.v4h^=Kt(n[1]),this.v5l^=Kt(n[2]),this.v5h^=Kt(n[3])}if(c!==void 0){de(c,void 0,"personalization");const n=cr(c);this.v6l^=Kt(n[0]),this.v6h^=Kt(n[1]),this.v7l^=Kt(n[2]),this.v7h^=Kt(n[3])}if(a!==void 0){const n=new Uint8Array(this.blockLen);n.set(a),this.update(n)}}get(){let{v0l:e,v0h:r,v1l:a,v1h:c,v2l:o,v2h:i,v3l:n,v3h:u,v4l:l,v4h:m,v5l:B,v5h:v,v6l:d,v6h:y,v7l:b,v7h:S}=this;return[e,r,a,c,o,i,n,u,l,m,B,v,d,y,b,S]}set(e,r,a,c,o,i,n,u,l,m,B,v,d,y,b,S){this.v0l=e|0,this.v0h=r|0,this.v1l=a|0,this.v1h=c|0,this.v2l=o|0,this.v2h=i|0,this.v3l=n|0,this.v3h=u|0,this.v4l=l|0,this.v4h=m|0,this.v5l=B|0,this.v5h=v|0,this.v6l=d|0,this.v6h=y|0,this.v7l=b|0,this.v7h=S|0}compress(e,r,a){this.get().forEach((u,l)=>ae[l]=u),ae.set(ke,16);let{h:c,l:o}=on(BigInt(this.length));ae[24]=ke[8]^o,ae[25]=ke[9]^c,a&&(ae[28]=~ae[28],ae[29]=~ae[29]);let i=0;const n=Bu;for(let u=0;u<12;u++)Wt(0,4,8,12,e,r+2*n[i++]),Jt(0,4,8,12,e,r+2*n[i++]),Wt(1,5,9,13,e,r+2*n[i++]),Jt(1,5,9,13,e,r+2*n[i++]),Wt(2,6,10,14,e,r+2*n[i++]),Jt(2,6,10,14,e,r+2*n[i++]),Wt(3,7,11,15,e,r+2*n[i++]),Jt(3,7,11,15,e,r+2*n[i++]),Wt(0,5,10,15,e,r+2*n[i++]),Jt(0,5,10,15,e,r+2*n[i++]),Wt(1,6,11,12,e,r+2*n[i++]),Jt(1,6,11,12,e,r+2*n[i++]),Wt(2,7,8,13,e,r+2*n[i++]),Jt(2,7,8,13,e,r+2*n[i++]),Wt(3,4,9,14,e,r+2*n[i++]),Jt(3,4,9,14,e,r+2*n[i++]);this.v0l^=ae[0]^ae[16],this.v0h^=ae[1]^ae[17],this.v1l^=ae[2]^ae[18],this.v1h^=ae[3]^ae[19],this.v2l^=ae[4]^ae[20],this.v2h^=ae[5]^ae[21],this.v3l^=ae[6]^ae[22],this.v3h^=ae[7]^ae[23],this.v4l^=ae[8]^ae[24],this.v4h^=ae[9]^ae[25],this.v5l^=ae[10]^ae[26],this.v5h^=ae[11]^ae[27],this.v6l^=ae[12]^ae[28],this.v6h^=ae[13]^ae[29],this.v7l^=ae[14]^ae[30],this.v7h^=ae[15]^ae[31],ut(ae)}destroy(){this.destroyed=!0,ut(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Au=nr(t=>new wu(t));function xs(t,e,r,a,c,o,i,n,u,l,m,B,v,d,y,b,S,f,g,E){let w=0;for(let I=0;I<a;I++)({a:c,b:u,c:v,d:S}=jt(c,u,v,S,r[e+t[w++]])),{a:c,b:u,c:v,d:S}=Zt(c,u,v,S,r[e+t[w++]]),{a:o,b:l,c:d,d:f}=jt(o,l,d,f,r[e+t[w++]]),{a:o,b:l,c:d,d:f}=Zt(o,l,d,f,r[e+t[w++]]),{a:i,b:m,c:y,d:g}=jt(i,m,y,g,r[e+t[w++]]),{a:i,b:m,c:y,d:g}=Zt(i,m,y,g,r[e+t[w++]]),{a:n,b:B,c:b,d:E}=jt(n,B,b,E,r[e+t[w++]]),{a:n,b:B,c:b,d:E}=Zt(n,B,b,E,r[e+t[w++]]),{a:c,b:l,c:y,d:E}=jt(c,l,y,E,r[e+t[w++]]),{a:c,b:l,c:y,d:E}=Zt(c,l,y,E,r[e+t[w++]]),{a:o,b:m,c:b,d:S}=jt(o,m,b,S,r[e+t[w++]]),{a:o,b:m,c:b,d:S}=Zt(o,m,b,S,r[e+t[w++]]),{a:i,b:B,c:v,d:f}=jt(i,B,v,f,r[e+t[w++]]),{a:i,b:B,c:v,d:f}=Zt(i,B,v,f,r[e+t[w++]]),{a:n,b:u,c:d,d:g}=jt(n,u,d,g,r[e+t[w++]]),{a:n,b:u,c:d,d:g}=Zt(n,u,d,g,r[e+t[w++]]);return{v0:c,v1:o,v2:i,v3:n,v4:u,v5:l,v6:m,v7:B,v8:v,v9:d,v10:y,v11:b,v12:S,v13:f,v14:g,v15:E}}async function Ss(t){return Promise.resolve(Au(t))}const wt={CHUNK_START:1,CHUNK_END:2,PARENT:4,ROOT:8,KEYED_HASH:16,DERIVE_KEY_CONTEXT:32,DERIVE_KEY_MATERIAL:64},Ot=Vt.slice(),Cs=(()=>{const t=Array.from({length:16},(a,c)=>c),e=a=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(c=>a[c]),r=[];for(let a=0,c=t;a<7;a++,c=e(c))r.push(...c);return Uint8Array.from(r)})();class Ja extends Yo{chunkPos=0;chunksDone=0;flags=0;IV;state;stack=[];posOut=0;bufferOut32=new Uint32Array(16);bufferOut;chunkOut=0;enableXOF=!0;constructor(e={},r=0){super(64,e.dkLen===void 0?32:e.dkLen);const{key:a,context:c}=e,o=c!==void 0;if(a!==void 0){if(o)throw new Error('Only "key" or "context" can be specified at same time');de(a,32,"key");const i=a.slice();this.IV=cr(i),it(this.IV),this.flags=r|wt.KEYED_HASH}else if(o){de(c,void 0,"context");const i=c,n=new Ja({dkLen:32},wt.DERIVE_KEY_CONTEXT).update(i).digest();this.IV=cr(n),it(this.IV),this.flags=r|wt.DERIVE_KEY_MATERIAL}else this.IV=Ot.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=Af(this.bufferOut32)}get(){return[]}set(){}b2Compress(e,r,a,c=0){const{state:o,pos:i}=this,{h:n,l:u}=on(BigInt(e),!0),{v0:l,v1:m,v2:B,v3:v,v4:d,v5:y,v6:b,v7:S,v8:f,v9:g,v10:E,v11:w,v12:I,v13:x,v14:h,v15:s}=xs(Cs,c,a,7,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],Ot[0],Ot[1],Ot[2],Ot[3],n,u,i,r);o[0]=l^f,o[1]=m^g,o[2]=B^E,o[3]=v^w,o[4]=d^I,o[5]=y^x,o[6]=b^h,o[7]=S^s}compress(e,r=0,a=!1){let c=this.flags;if(this.chunkPos||(c|=wt.CHUNK_START),(this.chunkPos===15||a)&&(c|=wt.CHUNK_END),a||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,c,e,r),this.chunkPos+=1,this.chunkPos===16||a){let o=this.state;this.state=this.IV.slice();for(let i,n=this.chunksDone+1;(a||!(n&1))&&(i=this.stack.pop());n>>=1)this.buffer32.set(i,0),this.buffer32.set(o,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|wt.PARENT,this.buffer32,0),o=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(o)}this.pos=0}_cloneInto(e){e=super._cloneInto(e);const{IV:r,flags:a,state:c,chunkPos:o,posOut:i,chunkOut:n,stack:u,chunksDone:l}=this;return e.state.set(c.slice()),e.stack=u.map(m=>Uint32Array.from(m)),e.IV.set(r),e.flags=a,e.chunkPos=o,e.chunksDone=l,e.posOut=i,e.chunkOut=n,e.enableXOF=this.enableXOF,e.bufferOut32.set(this.bufferOut32),e}destroy(){this.destroyed=!0,ut(this.state,this.buffer32,this.IV,this.bufferOut32),ut(...this.stack)}b2CompressOut(){const{state:e,pos:r,flags:a,buffer32:c,bufferOut32:o}=this,{h:i,l:n}=on(BigInt(this.chunkOut++));it(c);const{v0:u,v1:l,v2:m,v3:B,v4:v,v5:d,v6:y,v7:b,v8:S,v9:f,v10:g,v11:E,v12:w,v13:I,v14:x,v15:h}=xs(Cs,0,c,7,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],Ot[0],Ot[1],Ot[2],Ot[3],n,i,r,a);o[0]=u^S,o[1]=l^f,o[2]=m^g,o[3]=B^E,o[4]=v^w,o[5]=d^I,o[6]=y^x,o[7]=b^h,o[8]=e[0]^S,o[9]=e[1]^f,o[10]=e[2]^g,o[11]=e[3]^E,o[12]=e[4]^w,o[13]=e[5]^I,o[14]=e[6]^x,o[15]=e[7]^h,it(c),it(o),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,ut(this.buffer.subarray(this.pos));let e=this.flags|wt.ROOT;this.stack.length?(e|=wt.PARENT,it(this.buffer32),this.compress(this.buffer32,0,!0),it(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):e|=(this.chunkPos?0:wt.CHUNK_START)|wt.CHUNK_END,this.flags=e,this.b2CompressOut()}writeInto(e){Ht(this,!1),de(e),this.finish();const{blockLen:r,bufferOut:a}=this;for(let c=0,o=e.length;c<o;){this.posOut>=r&&this.b2CompressOut();const i=Math.min(r-this.posOut,o-c);e.set(a.subarray(this.posOut,this.posOut+i),c),this.posOut+=i,c+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(e)}xof(e){return dt(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(pn(e,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}}const Iu=nr((t={})=>new Ja(t));async function bs(t){return Promise.resolve(Iu(t))}var Ca={exports:{}},ba,Bs;function _u(){if(Bs)return ba;Bs=1;var t=(function(){function e(v,d){var y=v.l+d.l,b={h:v.h+d.h+(y/2>>>31)>>>0,l:y>>>0};v.h=b.h,v.l=b.l}function r(v,d){v.h^=d.h,v.h>>>=0,v.l^=d.l,v.l>>>=0}function a(v,d){var y={h:v.h<<d|v.l>>>32-d,l:v.l<<d|v.h>>>32-d};v.h=y.h,v.l=y.l}function c(v){var d=v.l;v.l=v.h,v.h=d}function o(v,d,y,b){e(v,d),e(y,b),a(d,13),a(b,16),r(d,v),r(b,y),c(v),e(y,d),e(v,b),a(d,17),a(b,21),r(d,y),r(b,v),c(y)}function i(v,d){return v[d+3]<<24|v[d+2]<<16|v[d+1]<<8|v[d]}function n(v,d){typeof d=="string"&&(d=m(d));var y={h:v[1]>>>0,l:v[0]>>>0},b={h:v[3]>>>0,l:v[2]>>>0},S={h:y.h,l:y.l},f=y,g={h:b.h,l:b.l},E=b,w=d.length,I=w-7,x=new Uint8Array(new ArrayBuffer(8));r(S,{h:1936682341,l:1886610805}),r(g,{h:1685025377,l:1852075885}),r(f,{h:1819895653,l:1852142177}),r(E,{h:1952801890,l:2037671283});for(var h=0;h<I;){var s={h:i(d,h+4),l:i(d,h)};r(E,s),o(S,g,f,E),o(S,g,f,E),r(S,s),h+=8}x[7]=w;for(var T=0;h<w;)x[T++]=d[h++];for(;T<7;)x[T++]=0;var N={h:x[7]<<24|x[6]<<16|x[5]<<8|x[4],l:x[3]<<24|x[2]<<16|x[1]<<8|x[0]};r(E,N),o(S,g,f,E),o(S,g,f,E),r(S,N),r(f,{h:0,l:255}),o(S,g,f,E),o(S,g,f,E),o(S,g,f,E),o(S,g,f,E);var O=S;return r(O,g),r(O,f),r(O,E),O}function u(v,d){var y=n(v,d);return("0000000"+y.h.toString(16)).substr(-8)+("0000000"+y.l.toString(16)).substr(-8)}function l(v,d){var y=n(v,d);return(y.h&2097151)*4294967296+y.l}function m(v){if(typeof TextEncoder=="function")return new TextEncoder().encode(v);v=unescape(encodeURIComponent(v));for(var d=new Uint8Array(v.length),y=0,b=v.length;y<b;y++)d[y]=v.charCodeAt(y);return d}function B(v){var d=m(v);if(d.length!==16)throw Error("Key length must be 16 bytes");var y=new Uint32Array(4);return y[0]=i(d,0),y[1]=i(d,4),y[2]=i(d,8),y[3]=i(d,12),y}return{hash:n,hash_hex:u,hash_uint:l,string16_to_key:B,string_to_u8:m}})();return ba=t,ba}var Ts;function Ru(){return Ts||(Ts=1,(function(t,e){t.exports=_u()})(Ca)),Ca.exports}var Nu=Ru();const ka=128;async function ws(t,e){if(e.length!==ka/8)throw new Error(`Invalid key length: expected ${ka/8} bytes, got ${e.length}`);const r=new Uint32Array(4),a=new DataView(e.buffer,e.byteOffset,e.byteLength);for(let n=0;n<4;n++)r[n]=a.getUint32(n*4,!0);const c=Nu.hash(r,t),o=new Uint8Array(8),i=new DataView(o.buffer);return i.setUint32(0,c.l,!0),i.setUint32(4,c.h,!0),Promise.resolve(o)}function Lu(){return xr(ka/8)}let rn=null,Rt=null,As=!1;async function Tn(){if(!(As&&rn))try{const t=(await Ce(async()=>{const{default:r}=await import("./kyber_wasm-C1bZBNL7.js");return{default:r}},[])).default;let e;if(typeof process<"u"&&process.versions?.node){const{readFileSync:r}=await Ce(async()=>{const{readFileSync:l}=await Promise.resolve().then(()=>_t);return{readFileSync:l}},void 0),{fileURLToPath:a}=await Ce(async()=>{const{fileURLToPath:l}=await Promise.resolve().then(()=>_t);return{fileURLToPath:l}},void 0),{dirname:c,join:o}=await Ce(async()=>{const{dirname:l,join:m}=await Promise.resolve().then(()=>_t);return{dirname:l,join:m}},void 0),i=c(a(import.meta.url)),n=o(i,"../../wasm-src/kyber-wasm/pkg/kyber_wasm_bg.wasm"),u=r(n);rn=await t(u)}else e=new URL("/assets/kyber_wasm_bg-9RDN9wMl.wasm",import.meta.url).href,rn=await t({module:e});rn.init(),Rt=await Ce(()=>import("./kyber_wasm-C1bZBNL7.js"),[]),As=!0}catch(t){throw new Error(`Failed to initialize Kyber WebAssembly module: ${t}`)}}async function ku(){if(await Tn(),!Rt||!Rt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=Rt.generate_keypair();if(!t)throw new Error("Failed to generate Kyber key pair: null result");return Uu(t)}function Uu(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function Du(t){if(await Tn(),!Rt||!Rt.encapsulate)throw new Error("encapsulate function not found in wasm exports");const e=Rt.encapsulate(t);if(!e)throw new Error("Failed to encapsulate");try{return{ciphertext:new Uint8Array(e.ciphertext),sharedSecret:new Uint8Array(e.shared_secret)}}finally{typeof e.free=="function"&&e.free()}}async function Pu(t,e,r){if(await Tn(),!Rt||!Rt.decapsulate)throw new Error("decapsulate function not found in wasm exports");const a=Rt.decapsulate(t,e,r);if(!a)throw new Error("Failed to decapsulate");return new Uint8Array(a)}let nn=null,Nt=null,Is=!1;async function wn(){if(!(Is&&nn))try{const t=(await Ce(async()=>{const{default:e}=await import("./dilithium_wasm-D-H8aO0R.js");return{default:e}},[])).default;if(typeof process<"u"&&process.versions?.node){const{readFileSync:e}=await Ce(async()=>{const{readFileSync:u}=await Promise.resolve().then(()=>_t);return{readFileSync:u}},void 0),{fileURLToPath:r}=await Ce(async()=>{const{fileURLToPath:u}=await Promise.resolve().then(()=>_t);return{fileURLToPath:u}},void 0),{dirname:a,join:c}=await Ce(async()=>{const{dirname:u,join:l}=await Promise.resolve().then(()=>_t);return{dirname:u,join:l}},void 0),o=a(r(import.meta.url)),i=c(o,"../../wasm-src/dilithium-wasm/pkg/dilithium_wasm_bg.wasm"),n=e(i);nn=await t(n)}else{const e=new URL("/assets/dilithium_wasm_bg-CuMJEY0E.wasm",import.meta.url).href;nn=await t({module:e})}nn.init(),Nt=await Ce(()=>import("./dilithium_wasm-D-H8aO0R.js"),[]),Is=!0}catch(t){throw new Error(`Failed to initialize Dilithium WebAssembly module: ${t}`)}}async function Ou(){if(await wn(),!Nt||!Nt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=Nt.generate_keypair();if(!t)throw new Error("Failed to generate Dilithium key pair: null result");return Ku(t)}function Ku(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function Vu(t,e){if(await wn(),!Nt||!Nt.sign)throw new Error("sign function not found in wasm exports");const r=Nt.sign(t,e);if(!r)throw new Error("Failed to sign");return new Uint8Array(r)}async function Fu(t,e,r){if(await wn(),!Nt||!Nt.verify)throw new Error("verify function not found in wasm exports");return Nt.verify(t,e,r)}let an=null,Lt=null,_s=!1;async function An(){if(!(_s&&an))try{const t=(await Ce(async()=>{const{default:e}=await import("./falcon_rust_wasm-B-IzugbX.js");return{default:e}},[])).default;if(typeof process<"u"&&process.versions?.node){const{readFileSync:e}=await Ce(async()=>{const{readFileSync:u}=await Promise.resolve().then(()=>_t);return{readFileSync:u}},void 0),{fileURLToPath:r}=await Ce(async()=>{const{fileURLToPath:u}=await Promise.resolve().then(()=>_t);return{fileURLToPath:u}},void 0),{dirname:a,join:c}=await Ce(async()=>{const{dirname:u,join:l}=await Promise.resolve().then(()=>_t);return{dirname:u,join:l}},void 0),o=a(r(import.meta.url)),i=c(o,"../../wasm-src/falcon-rust-wasm/pkg/falcon_rust_wasm_bg.wasm"),n=e(i);an=await t(n)}else{const e=new URL("/assets/falcon_rust_wasm_bg-B2h8gh_x.wasm",import.meta.url).href;an=await t({module:e})}an.init(),Lt=await Ce(()=>import("./falcon_rust_wasm-B-IzugbX.js"),[]),_s=!0}catch(t){throw new Error(`Failed to initialize FALCON WebAssembly module: ${t}`)}}async function Mu(){if(await An(),!Lt||!Lt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=Lt.generate_keypair();if(!t)throw new Error("Failed to generate FALCON key pair: null result");return Hu(t)}function Hu(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function qu(t,e){if(await An(),!Lt||!Lt.sign_message)throw new Error("sign_message function not found in wasm exports");const r=Lt.sign_message(t,e);if(!r)throw new Error("Failed to sign");return new Uint8Array(r)}async function Gu(t,e,r){if(await An(),!Lt||!Lt.verify_signature)throw new Error("verify_signature function not found in wasm exports");return Lt.verify_signature(t,e,r)}function zu(){return{selectedCrypto:"",aesState:{key:null,plaintext:"",plaintextBytes:null,ciphertext:null,iv:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},chacha20State:{key:null,plaintext:"",plaintextBytes:null,ciphertext:null,nonce:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},poly1305State:{key:null,message:"",messageBytes:null,tag:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,mac:!0,verification:!0}},rsaState:{keyPair:null,keySize:Ar,mode:"encryption",plaintext:"",plaintextBytes:null,ciphertext:"",decrypted:"",decryptedBytes:null,signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0,signing:!0,verification:!0}},eccState:{keyPair:null,curve:"secp256k1",mode:"signature",signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,ecdhPrivateKey:"",ecdhPublicKey:"",sharedSecret:"",error:"",showDetails:{keyGeneration:!0,signing:!0,verification:!0,ecdh:!0}},ibeState:{initialized:!1,masterKey:null,publicParams:null,identity:"",privateKey:null,plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},abeState:{initialized:!1,masterKey:null,publicParams:null,attributes:[],attributeInput:"",privateKey:null,policy:"",plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,decryptionSucceeded:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},hashState:{selectedAlgorithm:"sha256",inputText:"",inputBytes:null,hash:null,processingTime:0,error:"",siphashKey:null,showDetails:{input:!0,processing:!0,output:!0},comparisonMode:!1,comparisonResults:{}},kyberState:{initialized:!1,publicKey:null,privateKey:null,ciphertext:null,sharedSecret:null,decapsulatedSecret:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,encapsulation:!0,decapsulation:!0}},dilithiumState:{initialized:!1,publicKey:null,privateKey:null,message:"",messageBytes:null,signature:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,signing:!0,verification:!0}},falconState:{initialized:!1,publicKey:null,privateKey:null,message:"",messageBytes:null,signature:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,signing:!0,verification:!0}},resetState(){this.aesState={key:null,plaintext:"",plaintextBytes:null,ciphertext:null,iv:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},this.chacha20State={key:null,plaintext:"",plaintextBytes:null,ciphertext:null,nonce:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},this.poly1305State={key:null,message:"",messageBytes:null,tag:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,mac:!0,verification:!0}},this.rsaState={keyPair:null,keySize:Ar,mode:"encryption",plaintext:"",plaintextBytes:null,ciphertext:"",decrypted:"",decryptedBytes:null,signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0,signing:!0,verification:!0}},this.eccState={keyPair:null,curve:"secp256k1",mode:"signature",signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,ecdhPrivateKey:"",ecdhPublicKey:"",sharedSecret:"",error:"",showDetails:{keyGeneration:!0,signing:!0,verification:!0,ecdh:!0}},this.ibeState={initialized:!1,masterKey:null,publicParams:null,identity:"",privateKey:null,plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},this.abeState={initialized:!1,masterKey:null,publicParams:null,attributes:[],attributeInput:"",privateKey:null,policy:"",plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,decryptionSucceeded:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}};let t="sha256",e=!1;this.selectedCrypto==="hash-sha256"?t="sha256":this.selectedCrypto==="hash-sha512"?t="sha512":this.selectedCrypto==="hash-sha3-256"?t="sha3-256":this.selectedCrypto==="hash-blake2b"?t="blake2b":this.selectedCrypto==="hash-blake3"?t="blake3":this.selectedCrypto==="hash-compare"?e=!0:this.selectedCrypto==="siphash"&&(t="siphash"),this.hashState={selectedAlgorithm:t,inputText:"",inputBytes:null,hash:null,processingTime:0,error:"",siphashKey:null,showDetails:{input:!0,processing:!0,output:!0},comparisonMode:e,comparisonResults:{}},this.kyberState={initialized:!1,publicKey:null,privateKey:null,ciphertext:null,sharedSecret:null,decapsulatedSecret:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,encapsulation:!0,decapsulation:!0}}},formatBytes(t){return t?At(t):""},formatBytesReadable(t){if(!t)return"";const e=At(t);return e.match(/.{1,2}/g)?.join(" ")||e},formatBytesAsASCII(t){return t?Array.from(t).map(e=>e>=32&&e<=126?String.fromCharCode(e):".").join(""):""},getBytesInfo(t){return t?{hex:At(t),hexFormatted:this.formatBytesReadable(t),decimal:Array.from(t).join(", "),ascii:this.formatBytesAsASCII(t),length:t.length}:{hex:"",hexFormatted:"",decimal:"",ascii:"",length:0}},stringToBytes(t){return new TextEncoder().encode(t)},bytesToString(t){return new TextDecoder().decode(t)},hexToBytes(t){const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=Number.parseInt(t.substr(r,2),16);return e},generateAESKey(){try{this.aesState.key=ru(),this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptAES(){if(!(!this.aesState.key||!this.aesState.plaintext))try{const t=this.stringToBytes(this.aesState.plaintext);this.aesState.plaintextBytes=t;const e=eu(t,this.aesState.key);this.aesState.ciphertext=e.ciphertext,this.aesState.iv=e.iv,this.aesState.authTag=e.authTag,this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptAES(){if(!(!this.aesState.ciphertext||!this.aesState.key||!this.aesState.iv||!this.aesState.authTag))try{const t=tu(this.aesState.ciphertext,this.aesState.key,this.aesState.iv,this.aesState.authTag);this.aesState.decryptedBytes=t,this.aesState.decrypted=this.bytesToString(t),this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`,this.aesState.decrypted="",this.aesState.decryptedBytes=null}},generateChaCha20Key(){try{this.chacha20State.key=xu(),this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptChaCha20(){if(!(!this.chacha20State.key||!this.chacha20State.plaintext))try{const t=this.stringToBytes(this.chacha20State.plaintext);this.chacha20State.plaintextBytes=t;const e=mu(t,this.chacha20State.key);this.chacha20State.ciphertext=e.ciphertext,this.chacha20State.nonce=e.nonce,this.chacha20State.authTag=e.authTag,this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptChaCha20(){if(!(!this.chacha20State.ciphertext||!this.chacha20State.key||!this.chacha20State.nonce||!this.chacha20State.authTag))try{const t=Eu(this.chacha20State.ciphertext,this.chacha20State.key,this.chacha20State.nonce,this.chacha20State.authTag);this.chacha20State.decryptedBytes=t,this.chacha20State.decrypted=this.bytesToString(t),this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`,this.chacha20State.decrypted="",this.chacha20State.decryptedBytes=null}},generatePoly1305Key(){try{this.poly1305State.key=bu(),this.poly1305State.error=""}catch(t){this.poly1305State.error=`: ${t instanceof Error?t.message:String(t)}`}},computePoly1305MAC(){if(!(!this.poly1305State.key||!this.poly1305State.message))try{const t=this.stringToBytes(this.poly1305State.message);this.poly1305State.messageBytes=t,this.poly1305State.tag=$o(t,this.poly1305State.key),this.poly1305State.error=""}catch(t){this.poly1305State.error=`MAC: ${t instanceof Error?t.message:String(t)}`}},verifyPoly1305MAC(){if(!(!this.poly1305State.key||!this.poly1305State.tag||!this.poly1305State.verificationMessage))try{const t=this.stringToBytes(this.poly1305State.verificationMessage);this.poly1305State.verificationMessageBytes=t,this.poly1305State.verified=Su(t,this.poly1305State.key,this.poly1305State.tag),this.poly1305State.error=""}catch(t){this.poly1305State.error=`MAC: ${t instanceof Error?t.message:String(t)}`,this.poly1305State.verified=!1}},generateRsaKeyPair(){try{const t=Number(this.rsaState.keySize);this.rsaState.keyPair=N0(t),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.plaintext))try{const t=this.stringToBytes(this.rsaState.plaintext);this.rsaState.plaintextBytes=t;const e=L0(t,this.rsaState.keyPair.publicKey);this.rsaState.ciphertext=e.ciphertext,this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.ciphertext))try{const t=k0(this.rsaState.ciphertext,this.rsaState.keyPair.privateKey);this.rsaState.decryptedBytes=t,this.rsaState.decrypted=this.bytesToString(t),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`,this.rsaState.decrypted="",this.rsaState.decryptedBytes=null}},signRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.signatureMessage))try{const t=this.stringToBytes(this.rsaState.signatureMessage);this.rsaState.signatureMessageBytes=t;const e=U0(t,this.rsaState.keyPair.privateKey);this.rsaState.signature=e.signature,this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},verifyRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.signature||!this.rsaState.verificationMessage))try{const t=this.stringToBytes(this.rsaState.verificationMessage);this.rsaState.verificationMessageBytes=t,this.rsaState.verified=D0(t,this.rsaState.signature,this.rsaState.keyPair.publicKey),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`,this.rsaState.verified=!1}},generateEccKeyPair(){try{this.eccState.keyPair=s0(this.eccState.curve),this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`}},signECC(){if(!(!this.eccState.keyPair||!this.eccState.signatureMessage))try{const t=this.stringToBytes(this.eccState.signatureMessage);this.eccState.signatureMessageBytes=t;const e=this.eccState.keyPair.curve,r=e==="ed25519"||e==="ed448"?f0(t,this.eccState.keyPair.privateKey,e):mo(t,this.eccState.keyPair.privateKey,e);this.eccState.signature=r.signature,this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`}},verifyECC(){if(!(!this.eccState.keyPair||!this.eccState.signature||!this.eccState.verificationMessage))try{const t=this.stringToBytes(this.eccState.verificationMessage);this.eccState.verificationMessageBytes=t;const e=this.eccState.keyPair.curve;this.eccState.verified=e==="ed25519"||e==="ed448"?c0(t,this.eccState.signature,this.eccState.keyPair.publicKey,e):Eo(t,this.eccState.signature,this.eccState.keyPair.publicKey,e),this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`,this.eccState.verified=!1}},async initializeIBE(){try{this.ibeState.error="",await Fr(),this.ibeState.initialized=!0}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.initialized=!1}},async generateIBEKeyPair(){this.ibeState.initialized||await this.initializeIBE();try{const t=await u0();this.ibeState.masterKey=t.masterKey,this.ibeState.publicParams=t.publicParams,this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`}},async extractIBEKey(){if(!this.ibeState.masterKey||!this.ibeState.identity){this.ibeState.error="";return}try{this.ibeState.privateKey=await l0(this.ibeState.masterKey,this.ibeState.identity),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.privateKey=null}},async encryptIBE(){if(!(!this.ibeState.publicParams||!this.ibeState.identity||!this.ibeState.plaintext))try{const t=this.stringToBytes(this.ibeState.plaintext);this.ibeState.plaintextBytes=t,this.ibeState.ciphertext=await h0(this.ibeState.publicParams,this.ibeState.identity,t),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.ciphertext=null}},async decryptIBE(){if(!(!this.ibeState.privateKey||!this.ibeState.ciphertext))try{const t=await d0(this.ibeState.privateKey,this.ibeState.ciphertext);this.ibeState.decryptedBytes=t,this.ibeState.decrypted=this.bytesToString(t),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.decrypted="",this.ibeState.decryptedBytes=null}},async initializeABE(){if(!this.abeState.initialized)try{this.abeState.error="",await Pr(),this.abeState.initialized=!0}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.initialized=!1}},async generateABEKeyPair(){this.abeState.initialized||await this.initializeABE();try{const t=await df();this.abeState.masterKey=t.masterKey,this.abeState.publicParams=t.publicParams,this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`}},async extractABEKey(){if(!this.abeState.masterKey||!this.abeState.attributes.length){this.abeState.error="";return}try{this.abeState.privateKey=await pf(this.abeState.masterKey,this.abeState.attributes),this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.privateKey=null}},addAttribute(){const t=this.abeState.attributeInput.trim();if(!t)return;const e=t.split(",").map(r=>r.trim()).filter(r=>r.length>0);for(const r of e)this.abeState.attributes.includes(r)||this.abeState.attributes.push(r);this.abeState.attributeInput=""},removeAttribute(t){this.abeState.attributes.splice(t,1)},async encryptABE(){if(!(!this.abeState.publicParams||!this.abeState.policy||!this.abeState.plaintext))try{const t=this.stringToBytes(this.abeState.plaintext);this.abeState.plaintextBytes=t,this.abeState.ciphertext=await yf(this.abeState.publicParams,this.abeState.policy,t),this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.ciphertext=null}},async decryptABE(){if(!(!this.abeState.privateKey||!this.abeState.ciphertext))try{const t=await gf(this.abeState.privateKey,this.abeState.ciphertext);this.abeState.decryptedBytes=t,this.abeState.decrypted=this.bytesToString(t),this.abeState.decryptionSucceeded=!0,this.abeState.error=""}catch(t){const e=t instanceof Error?t.message:String(t);e.includes("Attribute mismatch")||e.includes("")?(this.abeState.decryptionSucceeded=!1,this.abeState.error=""):(this.abeState.error=`: ${e}`,this.abeState.decryptionSucceeded=null),this.abeState.decrypted="",this.abeState.decryptedBytes=null}},computeECDH(){if(!(!this.eccState.ecdhPrivateKey||!this.eccState.ecdhPublicKey))try{const t=this.eccState.curve;if(t==="ed25519"||t==="ed448"){this.eccState.error=`ECDH${t}`;return}const e=o0(this.eccState.ecdhPrivateKey,this.eccState.ecdhPublicKey,t);this.eccState.sharedSecret=e.sharedSecret,this.eccState.error=""}catch(t){this.eccState.error=`ECDH: ${t instanceof Error?t.message:String(t)}`}},generateSipHashKey(){try{this.hashState.siphashKey=Lu(),this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async computeHash(){if(!this.hashState.inputText){this.hashState.error="";return}try{const t=performance.now(),e=new TextEncoder().encode(this.hashState.inputText);this.hashState.inputBytes=e;let r;switch(this.hashState.selectedAlgorithm){case"sha256":r=await vs(e);break;case"sha512":r=await ms(e);break;case"sha3-256":r=await Es(e);break;case"blake2b":r=await Ss(e);break;case"blake3":r=await bs(e);break;case"siphash":if(!this.hashState.siphashKey){this.hashState.error="SipHash";return}r=await ws(e,this.hashState.siphashKey);break;default:this.hashState.error="";return}this.hashState.hash=r,this.hashState.processingTime=performance.now()-t,this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async compareAllHashes(){if(!this.hashState.inputText){this.hashState.error="";return}try{const t=new TextEncoder().encode(this.hashState.inputText);this.hashState.inputBytes=t,this.hashState.comparisonResults={};const e=[{name:"SHA-256",fn:vs},{name:"SHA-512",fn:ms},{name:"SHA-3-256",fn:Es},{name:"BLAKE2b",fn:Ss},{name:"BLAKE3",fn:bs}];for(const r of e){const a=performance.now(),c=await r.fn(t),o=performance.now()-a;this.hashState.comparisonResults[r.name]={hash:At(c),time:o}}if(this.hashState.siphashKey){const r=performance.now(),a=await ws(t,this.hashState.siphashKey),c=performance.now()-r;this.hashState.comparisonResults["SipHash-2-4"]={hash:At(a),time:c}}this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initKyber(){try{this.kyberState.error="",await Tn(),this.kyberState.initialized=!0}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`,this.kyberState.initialized=!1}},async generateKyberKeyPair(){this.kyberState.initialized||await this.initKyber();try{this.kyberState.error="";const t=await ku();this.kyberState.publicKey=t.publicKey,this.kyberState.privateKey=t.privateKey}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async encapsulateKyber(){if(!this.kyberState.publicKey){this.kyberState.error="";return}try{this.kyberState.error="";const t=await Du(this.kyberState.publicKey);this.kyberState.ciphertext=t.ciphertext,this.kyberState.sharedSecret=t.sharedSecret}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async decapsulateKyber(){if(!this.kyberState.ciphertext||!this.kyberState.privateKey||!this.kyberState.publicKey){this.kyberState.error="";return}try{this.kyberState.error="";const t=await Pu(this.kyberState.ciphertext,this.kyberState.privateKey,this.kyberState.publicKey);this.kyberState.decapsulatedSecret=t}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initDilithium(){try{this.dilithiumState.error="",await wn(),this.dilithiumState.initialized=!0}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`,this.dilithiumState.initialized=!1}},async generateDilithiumKeyPair(){this.dilithiumState.initialized||await this.initDilithium();try{this.dilithiumState.error="";const t=await Ou();this.dilithiumState.publicKey=t.publicKey,this.dilithiumState.privateKey=t.privateKey}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async signDilithium(){if(!this.dilithiumState.privateKey){this.dilithiumState.error="";return}if(!this.dilithiumState.message){this.dilithiumState.error="";return}try{this.dilithiumState.error="";const t=new TextEncoder().encode(this.dilithiumState.message);this.dilithiumState.messageBytes=t;const e=await Vu(t,this.dilithiumState.privateKey);this.dilithiumState.signature=e}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async verifyDilithium(){if(!this.dilithiumState.signature||!this.dilithiumState.publicKey){this.dilithiumState.error="";return}if(!this.dilithiumState.verificationMessage){this.dilithiumState.error="";return}try{this.dilithiumState.error="";const t=new TextEncoder().encode(this.dilithiumState.verificationMessage);this.dilithiumState.verificationMessageBytes=t;const e=await Fu(t,this.dilithiumState.signature,this.dilithiumState.publicKey);this.dilithiumState.verified=e}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initFalcon(){try{this.falconState.error="",await An(),this.falconState.initialized=!0}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`,this.falconState.initialized=!1}},async generateFalconKeyPair(){this.falconState.initialized||await this.initFalcon();try{this.falconState.error="";const t=await Mu();this.falconState.publicKey=t.publicKey,this.falconState.privateKey=t.privateKey}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}},async signFalcon(){if(!this.falconState.privateKey){this.falconState.error="";return}if(!this.falconState.message){this.falconState.error="";return}try{this.falconState.error="";const t=new TextEncoder().encode(this.falconState.message);this.falconState.messageBytes=t;const e=await qu(t,this.falconState.privateKey);this.falconState.signature=e}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}},async verifyFalcon(){if(!this.falconState.signature||!this.falconState.publicKey){this.falconState.error="";return}if(!this.falconState.verificationMessage){this.falconState.error="";return}try{this.falconState.error="";const t=new TextEncoder().encode(this.falconState.verificationMessage);this.falconState.verificationMessageBytes=t;const e=await Gu(t,this.falconState.signature,this.falconState.publicKey);this.falconState.verified=e}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}}}}typeof window<"u"&&(window.cryptoApp=zu);
