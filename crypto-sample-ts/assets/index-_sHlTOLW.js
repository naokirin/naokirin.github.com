(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))a(f);new MutationObserver(f=>{for(const o of f)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(f){const o={};return f.integrity&&(o.integrity=f.integrity),f.referrerPolicy&&(o.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?o.credentials="include":f.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(f){if(f.ep)return;f.ep=!0;const o=r(f);fetch(f.href,o)}})();const mf="modulepreload",Ef=function(t,e){return new URL(t,e).href},ri={},xe=function(e,r,a){let f=Promise.resolve();if(r&&r.length>0){let h=function(m){return Promise.all(m.map(B=>Promise.resolve(B).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};const i=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),u=n?.nonce||n?.getAttribute("nonce");f=h(r.map(m=>{if(m=Ef(m,a),m in ri)return;ri[m]=!0;const B=m.endsWith(".css"),v=B?'[rel="stylesheet"]':"";if(a)for(let p=i.length-1;p>=0;p--){const b=i[p];if(b.href===m&&(!B||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${v}`))return;const d=document.createElement("link");if(d.rel=B?"stylesheet":mf,B||(d.as="script"),d.crossOrigin="",d.href=m,u&&d.setAttribute("nonce",u),document.head.appendChild(d),B)return new Promise((p,b)=>{d.addEventListener("load",p),d.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(i){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=i,window.dispatchEvent(n),!n.defaultPrevented)throw i}return f.then(i=>{for(const n of i||[])n.status==="rejected"&&o(n.reason);return e().catch(o)})};let Ct=null,ni=!1;async function Ut(){if(!(ni&&Ct))try{const t=(await xe(async()=>{const{default:e}=await import("./abe_wasm-DosIi_Df.js");return{default:e}},[],import.meta.url)).default;Ct=await t({module_or_path:new URL(""+new URL("abe_wasm_bg-BykReuYG.wasm",import.meta.url).href,import.meta.url).href}),Ct.init(),ni=!0}catch(t){throw new Error(`Failed to initialize ABE WebAssembly module: ${t}`)}}async function xf(){if(await Ut(),!Ct)throw new Error("ABE module not initialized");const{ABE:t}=await xe(async()=>{const{ABE:o}=await import("./abe_wasm-DosIi_Df.js");return{ABE:o}},[],import.meta.url),r=new t().setup();if(!r||typeof r!="object")throw new Error("Failed to generate ABE key pair");const a=r.master_key,f=r.public_params;return{masterKey:a,publicParams:f}}async function Sf(t,e){if(await Ut(),!Ct)throw new Error("ABE module not initialized");const{ABE:r}=await xe(async()=>{const{ABE:o}=await import("./abe_wasm-DosIi_Df.js");return{ABE:o}},[],import.meta.url),f=new r().key_gen(t,e);if(!f)throw new Error("Failed to extract ABE private key");return f}async function bf(t,e,r){if(await Ut(),!Ct)throw new Error("ABE module not initialized");const{ABE:a}=await xe(async()=>{const{ABE:o}=await import("./abe_wasm-DosIi_Df.js");return{ABE:o}},[],import.meta.url),f=new a;try{return f.encrypt(t,e,r)}catch(o){throw new Error(`ABE encrypt failed: ${o}`)}}async function Cf(t,e){if(await Ut(),!Ct)throw new Error("ABE module not initialized");const{ABE:r}=await xe(async()=>{const{ABE:f}=await import("./abe_wasm-DosIi_Df.js");return{ABE:f}},[],import.meta.url),a=new r;try{return a.decrypt(t,e)}catch(f){throw new Error(`ABE decrypt failed: ${f}`)}}async function Bf(){if(await Ut(),!Ct)throw new Error("ABE module not initialized");try{const{KPABE:t}=await xe(async()=>{const{KPABE:o}=await import("./abe_wasm-DosIi_Df.js");return{KPABE:o}},[],import.meta.url),r=new t().setup();if(!r||typeof r!="object")throw new Error("Failed to generate KP-ABE key pair");const a=r.master_key,f=r.public_params;if(!a||!f)throw new Error("Invalid KP-ABE key pair structure");return{masterKey:a,publicParams:f}}catch(t){throw new Error(`KP-ABE key pair generation failed: ${t instanceof Error?t.message:String(t)}`)}}async function wf(t,e){if(await Ut(),!Ct)throw new Error("ABE module not initialized");try{const{KPABE:r}=await xe(async()=>{const{KPABE:o}=await import("./abe_wasm-DosIi_Df.js");return{KPABE:o}},[],import.meta.url),f=new r().key_gen(t,e);if(!f)throw new Error("Failed to extract KP-ABE private key");return f}catch(r){throw new Error(`KP-ABE key extraction failed: ${r instanceof Error?r.message:String(r)}`)}}async function Af(t,e,r){if(await Ut(),!Ct)throw new Error("ABE module not initialized");const{KPABE:a}=await xe(async()=>{const{KPABE:o}=await import("./abe_wasm-DosIi_Df.js");return{KPABE:o}},[],import.meta.url),f=new a;try{return f.encrypt(t,e,r)}catch(o){throw new Error(`KP-ABE encrypt failed: ${o}`)}}async function Tf(t,e){if(await Ut(),!Ct)throw new Error("ABE module not initialized");const{KPABE:r}=await xe(async()=>{const{KPABE:f}=await import("./abe_wasm-DosIi_Df.js");return{KPABE:f}},[],import.meta.url),a=new r;try{return a.decrypt(t,e)}catch(f){throw new Error(`KP-ABE decrypt failed: ${f}`)}}const Yr=BigInt(2**32-1),ai=BigInt(32);function fn(t,e=!1){return e?{h:Number(t&Yr),l:Number(t>>ai&Yr)}:{h:Number(t>>ai&Yr)|0,l:Number(t&Yr)|0}}function ks(t,e=!1){const r=t.length;let a=new Uint32Array(r),f=new Uint32Array(r);for(let o=0;o<r;o++){const{h:i,l:n}=fn(t[o],e);[a[o],f[o]]=[i,n]}return[a,f]}const ii=(t,e,r)=>t>>>r,si=(t,e,r)=>t<<32-r|e>>>r,rr=(t,e,r)=>t>>>r|e<<32-r,nr=(t,e,r)=>t<<32-r|e>>>r,Ar=(t,e,r)=>t<<64-r|e>>>r-32,Tr=(t,e,r)=>t>>>r-32|e<<64-r,If=(t,e)=>e,_f=(t,e)=>t,Rf=(t,e,r)=>t<<r|e>>>32-r,Nf=(t,e,r)=>e<<r|t>>>32-r,kf=(t,e,r)=>e<<r-32|t>>>64-r,Lf=(t,e,r)=>t<<r-32|e>>>64-r;function St(t,e,r,a){const f=(e>>>0)+(a>>>0);return{h:t+r+(f/2**32|0)|0,l:f|0}}const Pa=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Ka=(t,e,r,a)=>e+r+a+(t/2**32|0)|0,Uf=(t,e,r,a)=>(t>>>0)+(e>>>0)+(r>>>0)+(a>>>0),Df=(t,e,r,a,f)=>e+r+a+f+(t/2**32|0)|0,Pf=(t,e,r,a,f)=>(t>>>0)+(e>>>0)+(r>>>0)+(a>>>0)+(f>>>0),Kf=(t,e,r,a,f,o)=>e+r+a+f+o+(t/2**32|0)|0;function pn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function dt(t,e=""){if(!Number.isSafeInteger(t)||t<0){const r=e&&`"${e}" `;throw new Error(`${r}expected integer >= 0, got ${t}`)}}function de(t,e,r=""){const a=pn(t),f=t?.length,o=e!==void 0;if(!a||o&&f!==e){const i=r&&`"${r}" `,n=o?` of length ${e}`:"",u=a?`length=${f}`:`type=${typeof t}`;throw new Error(i+"expected Uint8Array"+n+", got "+u)}return t}function Ls(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash must wrapped by utils.createHasher");dt(t.outputLen),dt(t.blockLen)}function Gt(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function yn(t,e){de(t,void 0,"digestInto() output");const r=e.outputLen;if(t.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function Of(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function ur(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ut(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Rn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ft(t,e){return t<<32-e|t>>>e}const Us=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ds(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Ft=Us?t=>t:t=>Ds(t);function Vf(t){for(let e=0;e<t.length;e++)t[e]=Ds(t[e]);return t}const it=Us?t=>t:Vf,Ps=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ff=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Or(t){if(de(t),Ps)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Ff[t[r]];return e}const Ot={_0:48,_9:57,A:65,F:70,a:97,f:102};function oi(t){if(t>=Ot._0&&t<=Ot._9)return t-Ot._0;if(t>=Ot.A&&t<=Ot.F)return t-(Ot.A-10);if(t>=Ot.a&&t<=Ot.f)return t-(Ot.a-10)}function Lr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(Ps)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const a=new Uint8Array(r);for(let f=0,o=0;f<r;f++,o+=2){const i=oi(t.charCodeAt(o)),n=oi(t.charCodeAt(o+1));if(i===void 0||n===void 0){const u=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+o)}a[f]=i*16+n}return a}function bt(...t){let e=0;for(let a=0;a<t.length;a++){const f=t[a];de(f),e+=f.length}const r=new Uint8Array(e);for(let a=0,f=0;a<t.length;a++){const o=t[a];r.set(o,f),f+=o.length}return r}function ir(t,e={}){const r=(f,o)=>t(o).update(f).digest(),a=t(void 0);return r.outputLen=a.outputLen,r.blockLen=a.blockLen,r.create=f=>t(f),Object.assign(r,e),Object.freeze(r)}function Oa(t=32){const e=typeof globalThis=="object"?globalThis.crypto:null;if(typeof e?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return e.getRandomValues(new Uint8Array(t))}const Vr=t=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,t])}),Mf=BigInt(0),wr=BigInt(1),Hf=BigInt(2),qf=BigInt(7),Gf=BigInt(256),$f=BigInt(113),Ks=[],Os=[],Vs=[];for(let t=0,e=wr,r=1,a=0;t<24;t++){[r,a]=[a,(2*r+3*a)%5],Ks.push(2*(5*a+r)),Os.push((t+1)*(t+2)/2%64);let f=Mf;for(let o=0;o<7;o++)e=(e<<wr^(e>>qf)*$f)%Gf,e&Hf&&(f^=wr<<(wr<<BigInt(o))-wr);Vs.push(f)}const Fs=ks(Vs,!0),zf=Fs[0],Yf=Fs[1],fi=(t,e,r)=>r>32?kf(t,e,r):Rf(t,e,r),ci=(t,e,r)=>r>32?Lf(t,e,r):Nf(t,e,r);function Qf(t,e=24){const r=new Uint32Array(10);for(let a=24-e;a<24;a++){for(let i=0;i<10;i++)r[i]=t[i]^t[i+10]^t[i+20]^t[i+30]^t[i+40];for(let i=0;i<10;i+=2){const n=(i+8)%10,u=(i+2)%10,h=r[u],m=r[u+1],B=fi(h,m,1)^r[n],v=ci(h,m,1)^r[n+1];for(let d=0;d<50;d+=10)t[i+d]^=B,t[i+d+1]^=v}let f=t[2],o=t[3];for(let i=0;i<24;i++){const n=Os[i],u=fi(f,o,n),h=ci(f,o,n),m=Ks[i];f=t[m],o=t[m+1],t[m]=u,t[m+1]=h}for(let i=0;i<50;i+=10){for(let n=0;n<10;n++)r[n]=t[i+n];for(let n=0;n<10;n++)t[i+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=zf[a],t[1]^=Yf[a]}ut(r)}class gn{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(e,r,a,f=!1,o=24){if(this.blockLen=e,this.suffix=r,this.outputLen=a,this.enableXOF=f,this.rounds=o,dt(a,"outputLen"),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=ur(this.state)}clone(){return this._cloneInto()}keccak(){it(this.state32),Qf(this.state32,this.rounds),it(this.state32),this.posOut=0,this.pos=0}update(e){Gt(this),de(e);const{blockLen:r,state:a}=this,f=e.length;for(let o=0;o<f;){const i=Math.min(r-this.pos,f-o);for(let n=0;n<i;n++)a[this.pos++]^=e[o++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:a,blockLen:f}=this;e[a]^=r,(r&128)!==0&&a===f-1&&this.keccak(),e[f-1]^=128,this.keccak()}writeInto(e){Gt(this,!1),de(e),this.finish();const r=this.state,{blockLen:a}=this;for(let f=0,o=e.length;f<o;){this.posOut>=a&&this.keccak();const i=Math.min(a-this.posOut,o-f);e.set(r.subarray(this.posOut,this.posOut+i),f),this.posOut+=i,f+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return dt(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(yn(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ut(this.state)}_cloneInto(e){const{blockLen:r,suffix:a,outputLen:f,rounds:o,enableXOF:i}=this;return e||=new gn(r,a,f,i,o),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=a,e.outputLen=f,e.enableXOF=i,e.destroyed=this.destroyed,e}}const Xf=(t,e,r,a={})=>ir(()=>new gn(e,t,r),a),jf=Xf(6,136,32,Vr(8)),Zf=(t,e,r,a={})=>ir((f={})=>new gn(e,t,f.dkLen===void 0?r:f.dkLen,!0),a),Wf=Zf(31,136,32,Vr(12));const Va=BigInt(0),wa=BigInt(1);function lr(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}" `;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function Ms(t){if(typeof t=="bigint"){if(!on(t))throw new Error("positive bigint expected, got "+t)}else dt(t);return t}function Qr(t){const e=Ms(t).toString(16);return e.length&1?"0"+e:e}function Hs(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Va:BigInt("0x"+t)}function vn(t){return Hs(Or(t))}function Ur(t){return Hs(Or(Aa(de(t)).reverse()))}function Fa(t,e){dt(e),t=Ms(t);const r=Lr(t.toString(16).padStart(e*2,"0"));if(r.length!==e)throw new Error("number too large");return r}function qs(t,e){return Fa(t,e).reverse()}function Aa(t){return Uint8Array.from(t)}function Jf(t){return Uint8Array.from(t,(e,r)=>{const a=e.charCodeAt(0);if(e.length!==1||a>127)throw new Error(`string contains non-ASCII character "${t[r]}" with code ${a} at position ${r}`);return a})}const on=t=>typeof t=="bigint"&&Va<=t;function ec(t,e,r){return on(t)&&on(e)&&on(r)&&e<=t&&t<r}function Ta(t,e,r,a){if(!ec(e,r,a))throw new Error("expected valid "+t+": "+r+" <= n < "+a+", got "+e)}function tc(t){let e;for(e=0;t>Va;t>>=wa,e+=1);return e}const Ma=t=>(wa<<BigInt(t))-wa;function rc(t,e,r){if(dt(t,"hashLen"),dt(e,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");const a=S=>new Uint8Array(S),f=Uint8Array.of(),o=Uint8Array.of(0),i=Uint8Array.of(1),n=1e3;let u=a(t),h=a(t),m=0;const B=()=>{u.fill(1),h.fill(0),m=0},v=(...S)=>r(h,bt(u,...S)),d=(S=f)=>{h=v(o,S),u=v(),S.length!==0&&(h=v(i,S),u=v())},p=()=>{if(m++>=n)throw new Error("drbg: tried max amount of iterations");let S=0;const c=[];for(;S<e;){u=v();const g=u.slice();c.push(g),S+=u.length}return bt(...c)};return(S,c)=>{B(),d(S);let g;for(;!(g=c(p()));)d();return B(),g}}function Fr(t,e={},r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function a(o,i,n){const u=t[o];if(n&&u===void 0)return;const h=typeof u;if(h!==i||u===null)throw new Error(`param "${o}" is invalid: expected ${i}, got ${h}`)}const f=(o,i)=>Object.entries(o).forEach(([n,u])=>a(n,u,i));f(e,!1),f(r,!0)}function cn(t){const e=new WeakMap;return(r,...a)=>{const f=e.get(r);if(f!==void 0)return f;const o=t(r,...a);return e.set(r,o),o}}const ct=BigInt(0),Je=BigInt(1),or=BigInt(2),Gs=BigInt(3),$s=BigInt(4),zs=BigInt(5),nc=BigInt(7),Ys=BigInt(8),ac=BigInt(9),Qs=BigInt(16);function be(t,e){const r=t%e;return r>=ct?r:e+r}function me(t,e,r){let a=t;for(;e-- >ct;)a*=a,a%=r;return a}function ui(t,e){if(t===ct)throw new Error("invert: expected non-zero number");if(e<=ct)throw new Error("invert: expected positive modulus, got "+e);let r=be(t,e),a=e,f=ct,o=Je;for(;r!==ct;){const n=a/r,u=a%r,h=f-o*n;a=r,r=u,f=o,o=h}if(a!==Je)throw new Error("invert: does not exist");return be(f,e)}function Ha(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function Xs(t,e){const r=(t.ORDER+Je)/$s,a=t.pow(e,r);return Ha(t,a,e),a}function ic(t,e){const r=(t.ORDER-zs)/Ys,a=t.mul(e,or),f=t.pow(a,r),o=t.mul(e,f),i=t.mul(t.mul(o,or),f),n=t.mul(o,t.sub(i,t.ONE));return Ha(t,n,e),n}function sc(t){const e=hr(t),r=js(t),a=r(e,e.neg(e.ONE)),f=r(e,a),o=r(e,e.neg(a)),i=(t+nc)/Qs;return(n,u)=>{let h=n.pow(u,i),m=n.mul(h,a);const B=n.mul(h,f),v=n.mul(h,o),d=n.eql(n.sqr(m),u),p=n.eql(n.sqr(B),u);h=n.cmov(h,m,d),m=n.cmov(v,B,p);const b=n.eql(n.sqr(m),u),S=n.cmov(h,m,b);return Ha(n,S,u),S}}function js(t){if(t<Gs)throw new Error("sqrt is not defined for small field");let e=t-Je,r=0;for(;e%or===ct;)e/=or,r++;let a=or;const f=hr(t);for(;li(f,a)===1;)if(a++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Xs;let o=f.pow(a,e);const i=(e+Je)/or;return function(u,h){if(u.is0(h))return h;if(li(u,h)!==1)throw new Error("Cannot find square root");let m=r,B=u.mul(u.ONE,o),v=u.pow(h,e),d=u.pow(h,i);for(;!u.eql(v,u.ONE);){if(u.is0(v))return u.ZERO;let p=1,b=u.sqr(v);for(;!u.eql(b,u.ONE);)if(p++,b=u.sqr(b),p===m)throw new Error("Cannot find square root");const S=Je<<BigInt(m-p-1),c=u.pow(B,S);m=p,B=u.sqr(c),v=u.mul(v,B),d=u.mul(d,c)}return d}}function oc(t){return t%$s===Gs?Xs:t%Ys===zs?ic:t%Qs===ac?sc(t):js(t)}const fc=(t,e)=>(be(t,e)&Je)===Je,cc=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function uc(t){const e={ORDER:"bigint",BYTES:"number",BITS:"number"},r=cc.reduce((a,f)=>(a[f]="function",a),e);return Fr(t,r),t}function lc(t,e,r){if(r<ct)throw new Error("invalid exponent, negatives unsupported");if(r===ct)return t.ONE;if(r===Je)return e;let a=t.ONE,f=e;for(;r>ct;)r&Je&&(a=t.mul(a,f)),f=t.sqr(f),r>>=Je;return a}function Zs(t,e,r=!1){const a=new Array(e.length).fill(r?t.ZERO:void 0),f=e.reduce((i,n,u)=>t.is0(n)?i:(a[u]=i,t.mul(i,n)),t.ONE),o=t.inv(f);return e.reduceRight((i,n,u)=>t.is0(n)?i:(a[u]=t.mul(i,a[u]),t.mul(i,n)),o),a}function li(t,e){const r=(t.ORDER-Je)/or,a=t.pow(e,r),f=t.eql(a,t.ONE),o=t.eql(a,t.ZERO),i=t.eql(a,t.neg(t.ONE));if(!f&&!o&&!i)throw new Error("invalid Legendre symbol result");return f?1:o?0:-1}function hc(t,e){e!==void 0&&dt(e);const r=e!==void 0?e:t.toString(2).length,a=Math.ceil(r/8);return{nBitLength:r,nByteLength:a}}class dc{ORDER;BITS;BYTES;isLE;ZERO=ct;ONE=Je;_lengths;_sqrt;_mod;constructor(e,r={}){if(e<=ct)throw new Error("invalid field: expected ORDER > 0, got "+e);let a;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(a=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));const{nBitLength:f,nByteLength:o}=hc(e,a);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=e,this.BITS=f,this.BYTES=o,this._sqrt=void 0,Object.preventExtensions(this)}create(e){return be(e,this.ORDER)}isValid(e){if(typeof e!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof e);return ct<=e&&e<this.ORDER}is0(e){return e===ct}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}isOdd(e){return(e&Je)===Je}neg(e){return be(-e,this.ORDER)}eql(e,r){return e===r}sqr(e){return be(e*e,this.ORDER)}add(e,r){return be(e+r,this.ORDER)}sub(e,r){return be(e-r,this.ORDER)}mul(e,r){return be(e*r,this.ORDER)}pow(e,r){return lc(this,e,r)}div(e,r){return be(e*ui(r,this.ORDER),this.ORDER)}sqrN(e){return e*e}addN(e,r){return e+r}subN(e,r){return e-r}mulN(e,r){return e*r}inv(e){return ui(e,this.ORDER)}sqrt(e){return this._sqrt||(this._sqrt=oc(this.ORDER)),this._sqrt(this,e)}toBytes(e){return this.isLE?qs(e,this.BYTES):Fa(e,this.BYTES)}fromBytes(e,r=!1){de(e);const{_lengths:a,BYTES:f,isLE:o,ORDER:i,_mod:n}=this;if(a){if(!a.includes(e.length)||e.length>f)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);const h=new Uint8Array(f);h.set(e,o?0:h.length-e.length),e=h}if(e.length!==f)throw new Error("Field.fromBytes: expected "+f+" bytes, got "+e.length);let u=o?Ur(e):vn(e);if(n&&(u=be(u,i)),!r&&!this.isValid(u))throw new Error("invalid field element: outside of range 0..ORDER");return u}invertBatch(e){return Zs(this,e)}cmov(e,r,a){return a?r:e}}function hr(t,e={}){return new dc(t,e)}function Ws(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Js(t){const e=Ws(t);return e+Math.ceil(e/2)}function pc(t,e,r=!1){de(t);const a=t.length,f=Ws(e),o=Js(e);if(a<16||a<o||a>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+a);const i=r?Ur(t):vn(t),n=be(i,e-Je)+Je;return r?qs(n,f):Fa(n,f)}const Er=BigInt(0),fr=BigInt(1);function un(t,e){const r=e.negate();return t?r:e}function _r(t,e){const r=Zs(t.Fp,e.map(a=>a.Z));return e.map((a,f)=>t.fromAffine(a.toAffine(r[f])))}function eo(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Nn(t,e){eo(t,e);const r=Math.ceil(e/t)+1,a=2**(t-1),f=2**t,o=Ma(t),i=BigInt(t);return{windows:r,windowSize:a,mask:o,maxNumber:f,shiftBy:i}}function hi(t,e,r){const{windowSize:a,mask:f,maxNumber:o,shiftBy:i}=r;let n=Number(t&f),u=t>>i;n>a&&(n-=o,u+=fr);const h=e*a,m=h+Math.abs(n)-1,B=n===0,v=n<0,d=e%2!==0;return{nextN:u,offset:m,isZero:B,isNeg:v,isNegF:d,offsetF:h}}const kn=new WeakMap,to=new WeakMap;function Ln(t){return to.get(t)||1}function di(t){if(t!==Er)throw new Error("invalid wNAF")}class ro{BASE;ZERO;Fn;bits;constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,a=this.ZERO){let f=e;for(;r>Er;)r&fr&&(a=a.add(f)),f=f.double(),r>>=fr;return a}precomputeWindow(e,r){const{windows:a,windowSize:f}=Nn(r,this.bits),o=[];let i=e,n=i;for(let u=0;u<a;u++){n=i,o.push(n);for(let h=1;h<f;h++)n=n.add(i),o.push(n);i=n.double()}return o}wNAF(e,r,a){if(!this.Fn.isValid(a))throw new Error("invalid scalar");let f=this.ZERO,o=this.BASE;const i=Nn(e,this.bits);for(let n=0;n<i.windows;n++){const{nextN:u,offset:h,isZero:m,isNeg:B,isNegF:v,offsetF:d}=hi(a,n,i);a=u,m?o=o.add(un(v,r[d])):f=f.add(un(B,r[h]))}return di(a),{p:f,f:o}}wNAFUnsafe(e,r,a,f=this.ZERO){const o=Nn(e,this.bits);for(let i=0;i<o.windows&&a!==Er;i++){const{nextN:n,offset:u,isZero:h,isNeg:m}=hi(a,i,o);if(a=n,!h){const B=r[u];f=f.add(m?B.negate():B)}}return di(a),f}getPrecomputes(e,r,a){let f=kn.get(r);return f||(f=this.precomputeWindow(r,e),e!==1&&(typeof a=="function"&&(f=a(f)),kn.set(r,f))),f}cached(e,r,a){const f=Ln(e);return this.wNAF(f,this.getPrecomputes(f,e,a),r)}unsafe(e,r,a,f){const o=Ln(e);return o===1?this._unsafeLadder(e,r,f):this.wNAFUnsafe(o,this.getPrecomputes(o,e,a),r,f)}createCache(e,r){eo(r,this.bits),to.set(e,r),kn.delete(e)}hasCache(e){return Ln(e)!==1}}function yc(t,e,r,a){let f=e,o=t.ZERO,i=t.ZERO;for(;r>Er||a>Er;)r&fr&&(o=o.add(f)),a&fr&&(i=i.add(f)),f=f.double(),r>>=fr,a>>=fr;return{p1:o,p2:i}}function pi(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return uc(e),e}else return hr(t,{isLE:r})}function no(t,e,r={},a){if(a===void 0&&(a=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const u of["p","n","h"]){const h=e[u];if(!(typeof h=="bigint"&&h>Er))throw new Error(`CURVE.${u} must be positive bigint`)}const f=pi(e.p,r.Fp,a),o=pi(e.n,r.Fn,a),n=["Gx","Gy","a",t==="weierstrass"?"b":"d"];for(const u of n)if(!f.isValid(e[u]))throw new Error(`CURVE.${u} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:f,Fn:o}}function ao(t,e){return function(a){const f=t(a);return{secretKey:f,publicKey:e(f)}}}const Qt=BigInt(0),Xe=BigInt(1),Un=BigInt(2),gc=BigInt(8);function vc(t,e,r,a){const f=t.sqr(r),o=t.sqr(a),i=t.add(t.mul(e.a,f),o),n=t.add(t.ONE,t.mul(e.d,t.mul(f,o)));return t.eql(i,n)}function io(t,e={}){const r=no("edwards",t,e,e.FpFnLE),{Fp:a,Fn:f}=r;let o=r.CURVE;const{h:i}=o;Fr(e,{},{uvRatio:"function"});const n=Un<<BigInt(f.BYTES*8)-Xe,u=S=>a.create(S),h=e.uvRatio||((S,c)=>{try{return{isValid:!0,value:a.sqrt(a.div(S,c))}}catch{return{isValid:!1,value:Qt}}});if(!vc(a,o,o.Gx,o.Gy))throw new Error("bad curve params: generator point");function m(S,c,g=!1){const E=g?Xe:Qt;return Ta("coordinate "+S,c,E,n),c}function B(S){if(!(S instanceof p))throw new Error("EdwardsPoint expected")}const v=cn((S,c)=>{const{X:g,Y:E,Z:A}=S,I=S.is0();c==null&&(c=I?gc:a.inv(A));const x=u(g*c),l=u(E*c),s=a.mul(A,c);if(I)return{x:Qt,y:Xe};if(s!==Xe)throw new Error("invZ was invalid");return{x,y:l}}),d=cn(S=>{const{a:c,d:g}=o;if(S.is0())throw new Error("bad point: ZERO");const{X:E,Y:A,Z:I,T:x}=S,l=u(E*E),s=u(A*A),w=u(I*I),N=u(w*w),K=u(l*c),_=u(w*u(K+s)),D=u(N+u(g*u(l*s)));if(_!==D)throw new Error("bad point: equation left != right (1)");const V=u(E*A),P=u(I*x);if(V!==P)throw new Error("bad point: equation left != right (2)");return!0});class p{static BASE=new p(o.Gx,o.Gy,Xe,u(o.Gx*o.Gy));static ZERO=new p(Qt,Xe,Xe,Qt);static Fp=a;static Fn=f;X;Y;Z;T;constructor(c,g,E,A){this.X=m("x",c),this.Y=m("y",g),this.Z=m("z",E,!0),this.T=m("t",A),Object.freeze(this)}static CURVE(){return o}static fromAffine(c){if(c instanceof p)throw new Error("extended point not allowed");const{x:g,y:E}=c||{};return m("x",g),m("y",E),new p(g,E,Xe,u(g*E))}static fromBytes(c,g=!1){const E=a.BYTES,{a:A,d:I}=o;c=Aa(de(c,E,"point")),lr(g,"zip215");const x=Aa(c),l=c[E-1];x[E-1]=l&-129;const s=Ur(x),w=g?n:a.ORDER;Ta("point.y",s,Qt,w);const N=u(s*s),K=u(N-Xe),_=u(I*N-A);let{isValid:D,value:V}=h(K,_);if(!D)throw new Error("bad point: invalid y coordinate");const P=(V&Xe)===Xe,M=(l&128)!==0;if(!g&&V===Qt&&M)throw new Error("bad point: x=0 and x_0=1");return M!==P&&(V=u(-V)),p.fromAffine({x:V,y:s})}static fromHex(c,g=!1){return p.fromBytes(Lr(c),g)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(c=8,g=!0){return b.createCache(this,c),g||this.multiply(Un),this}assertValidity(){d(this)}equals(c){B(c);const{X:g,Y:E,Z:A}=this,{X:I,Y:x,Z:l}=c,s=u(g*l),w=u(I*A),N=u(E*l),K=u(x*A);return s===w&&N===K}is0(){return this.equals(p.ZERO)}negate(){return new p(u(-this.X),this.Y,this.Z,u(-this.T))}double(){const{a:c}=o,{X:g,Y:E,Z:A}=this,I=u(g*g),x=u(E*E),l=u(Un*u(A*A)),s=u(c*I),w=g+E,N=u(u(w*w)-I-x),K=s+x,_=K-l,D=s-x,V=u(N*_),P=u(K*D),M=u(N*D),q=u(_*K);return new p(V,P,q,M)}add(c){B(c);const{a:g,d:E}=o,{X:A,Y:I,Z:x,T:l}=this,{X:s,Y:w,Z:N,T:K}=c,_=u(A*s),D=u(I*w),V=u(l*E*K),P=u(x*N),M=u((A+I)*(s+w)-_-D),q=P-V,z=P+V,G=u(D-g*_),Y=u(M*q),j=u(z*G),te=u(M*G),ue=u(q*z);return new p(Y,j,ue,te)}subtract(c){return this.add(c.negate())}multiply(c){if(!f.isValidNot0(c))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:g,f:E}=b.cached(this,c,A=>_r(p,A));return _r(p,[g,E])[0]}multiplyUnsafe(c,g=p.ZERO){if(!f.isValid(c))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return c===Qt?p.ZERO:this.is0()||c===Xe?this:b.unsafe(this,c,E=>_r(p,E),g)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return b.unsafe(this,o.n).is0()}toAffine(c){return v(this,c)}clearCofactor(){return i===Xe?this:this.multiplyUnsafe(i)}toBytes(){const{x:c,y:g}=this.toAffine(),E=a.toBytes(g);return E[E.length-1]|=c&Xe?128:0,E}toHex(){return Or(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const b=new ro(p,f.BITS);return p.BASE.precompute(8),p}function so(t,e,r={}){if(typeof e!="function")throw new Error('"hash" function param is required');Fr(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:a}=r,{BASE:f,Fp:o,Fn:i}=t,n=r.randomBytes||Oa,u=r.adjustScalarBytes||(s=>s),h=r.domain||((s,w,N)=>{if(lr(N,"phflag"),w.length||N)throw new Error("Contexts/pre-hash are not supported");return s});function m(s){return i.create(Ur(s))}function B(s){const w=E.secretKey;de(s,E.secretKey,"secretKey");const N=de(e(s),2*w,"hashedSecretKey"),K=u(N.slice(0,w)),_=N.slice(w,2*w),D=m(K);return{head:K,prefix:_,scalar:D}}function v(s){const{head:w,prefix:N,scalar:K}=B(s),_=f.multiply(K),D=_.toBytes();return{head:w,prefix:N,scalar:K,point:_,pointBytes:D}}function d(s){return v(s).pointBytes}function p(s=Uint8Array.of(),...w){const N=bt(...w);return m(e(h(N,de(s,void 0,"context"),!!a)))}function b(s,w,N={}){s=de(s,void 0,"message"),a&&(s=a(s));const{prefix:K,scalar:_,pointBytes:D}=v(w),V=p(N.context,K,s),P=f.multiply(V).toBytes(),M=p(N.context,P,D,s),q=i.create(V+M*_);if(!i.isValid(q))throw new Error("sign failed: invalid s");const z=bt(P,i.toBytes(q));return de(z,E.signature,"result")}const S={zip215:!0};function c(s,w,N,K=S){const{context:_,zip215:D}=K,V=E.signature;s=de(s,V,"signature"),w=de(w,void 0,"message"),N=de(N,E.publicKey,"publicKey"),D!==void 0&&lr(D,"zip215"),a&&(w=a(w));const P=V/2,M=s.subarray(0,P),q=Ur(s.subarray(P,V));let z,G,Y;try{z=t.fromBytes(N,D),G=t.fromBytes(M,D),Y=f.multiplyUnsafe(q)}catch{return!1}if(!D&&z.isSmallOrder())return!1;const j=p(_,G.toBytes(),z.toBytes(),w);return G.add(z.multiplyUnsafe(j)).subtract(Y).clearCofactor().is0()}const g=o.BYTES,E={secretKey:g,publicKey:g,signature:2*g,seed:g};function A(s=n(E.seed)){return de(s,E.seed,"seed")}function I(s){return pn(s)&&s.length===i.BYTES}function x(s,w){try{return!!t.fromBytes(s,w)}catch{return!1}}const l={getExtendedPublicKey:v,randomSecretKey:A,isValidSecretKey:I,isValidPublicKey:x,toMontgomery(s){const{y:w}=t.fromBytes(s),N=E.publicKey,K=N===32;if(!K&&N!==57)throw new Error("only defined for 25519 and 448");const _=K?o.div(Xe+w,Xe-w):o.div(w-Xe,w+Xe);return o.toBytes(_)},toMontgomerySecret(s){const w=E.secretKey;de(s,w);const N=e(s.subarray(0,w));return u(N).subarray(0,w)}};return Object.freeze({keygen:ao(A,d),getPublicKey:d,sign:b,verify:c,utils:l,Point:t,lengths:E})}const mn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),oo={p:mn,n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},mc=ir(()=>Wf.create({dkLen:114})),Ec=BigInt(1),yi=BigInt(2),gi=BigInt(3),xc=BigInt(11),Sc=BigInt(22),vi=BigInt(44),bc=BigInt(88),Cc=BigInt(223);function Bc(t){const e=mn,r=t*t*t%e,a=r*r*t%e,f=me(a,gi,e)*a%e,o=me(f,gi,e)*a%e,i=me(o,yi,e)*r%e,n=me(i,xc,e)*i%e,u=me(n,Sc,e)*n%e,h=me(u,vi,e)*u%e,m=me(h,bc,e)*h%e,B=me(m,vi,e)*u%e,v=me(B,yi,e)*r%e,d=me(v,Ec,e)*t%e;return me(d,Cc,e)*v%e}function wc(t){return t[0]&=252,t[55]|=128,t[56]=0,t}function Ac(t,e){const r=mn,a=be(t*t*e,r),f=be(a*t,r),o=be(f*a*e,r),i=Bc(o),n=be(f*i,r),u=be(n*n,r);return{isValid:be(u*e,r)===t,value:n}}const Tc=hr(mn,{BITS:456,isLE:!0}),Ic=hr(oo.n,{BITS:456,isLE:!0});function _c(t,e,r){if(e.length>255)throw new Error("context must be smaller than 255, got: "+e.length);return bt(Jf("SigEd448"),new Uint8Array([r?1:0,e.length]),e,t)}const Rc=io(oo,{Fp:Tc,Fn:Ic,uvRatio:Ac});function Nc(t){return so(Rc,mc,Object.assign({adjustScalarBytes:wc,domain:_c},t))}const kc=Nc({});function Lc(t,e,r){return t&e^~t&r}function Uc(t,e,r){return t&e^t&r^e&r}class fo{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(e,r,a,f){this.blockLen=e,this.outputLen=r,this.padOffset=a,this.isLE=f,this.buffer=new Uint8Array(e),this.view=Rn(this.buffer)}update(e){Gt(this),de(e);const{view:r,buffer:a,blockLen:f}=this,o=e.length;for(let i=0;i<o;){const n=Math.min(f-this.pos,o-i);if(n===f){const u=Rn(e);for(;f<=o-i;i+=f)this.process(u,i);continue}a.set(e.subarray(i,i+n),this.pos),this.pos+=n,i+=n,this.pos===f&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Gt(this),yn(e,this),this.finished=!0;const{buffer:r,view:a,blockLen:f,isLE:o}=this;let{pos:i}=this;r[i++]=128,ut(this.buffer.subarray(i)),this.padOffset>f-i&&(this.process(a,0),i=0);for(let B=i;B<f;B++)r[B]=0;a.setBigUint64(f-8,BigInt(this.length*8),o),this.process(a,0);const n=Rn(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const h=u/4,m=this.get();if(h>m.length)throw new Error("_sha2: outputLen bigger than state");for(let B=0;B<h;B++)n.setUint32(4*B,m[B],o)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}_cloneInto(e){e||=new this.constructor,e.set(...this.get());const{blockLen:r,buffer:a,length:f,finished:o,destroyed:i,pos:n}=this;return e.destroyed=i,e.finished=o,e.length=f,e.pos=n,f%r&&e.buffer.set(a),e}clone(){return this._cloneInto()}}const Mt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),rt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Dc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xt=new Uint32Array(64);class Pc extends fo{constructor(e){super(64,e,8,!1)}get(){const{A:e,B:r,C:a,D:f,E:o,F:i,G:n,H:u}=this;return[e,r,a,f,o,i,n,u]}set(e,r,a,f,o,i,n,u){this.A=e|0,this.B=r|0,this.C=a|0,this.D=f|0,this.E=o|0,this.F=i|0,this.G=n|0,this.H=u|0}process(e,r){for(let B=0;B<16;B++,r+=4)Xt[B]=e.getUint32(r,!1);for(let B=16;B<64;B++){const v=Xt[B-15],d=Xt[B-2],p=ft(v,7)^ft(v,18)^v>>>3,b=ft(d,17)^ft(d,19)^d>>>10;Xt[B]=b+Xt[B-7]+p+Xt[B-16]|0}let{A:a,B:f,C:o,D:i,E:n,F:u,G:h,H:m}=this;for(let B=0;B<64;B++){const v=ft(n,6)^ft(n,11)^ft(n,25),d=m+v+Lc(n,u,h)+Dc[B]+Xt[B]|0,b=(ft(a,2)^ft(a,13)^ft(a,22))+Uc(a,f,o)|0;m=h,h=u,u=n,n=i+d|0,i=o,o=f,f=a,a=d+b|0}a=a+this.A|0,f=f+this.B|0,o=o+this.C|0,i=i+this.D|0,n=n+this.E|0,u=u+this.F|0,h=h+this.G|0,m=m+this.H|0,this.set(a,f,o,i,n,u,h,m)}roundClean(){ut(Xt)}destroy(){this.set(0,0,0,0,0,0,0,0),ut(this.buffer)}}class Kc extends Pc{A=Mt[0]|0;B=Mt[1]|0;C=Mt[2]|0;D=Mt[3]|0;E=Mt[4]|0;F=Mt[5]|0;G=Mt[6]|0;H=Mt[7]|0;constructor(){super(32)}}const co=ks(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Oc=co[0],Vc=co[1],jt=new Uint32Array(80),Zt=new Uint32Array(80);class uo extends fo{constructor(e){super(128,e,16,!1)}get(){const{Ah:e,Al:r,Bh:a,Bl:f,Ch:o,Cl:i,Dh:n,Dl:u,Eh:h,El:m,Fh:B,Fl:v,Gh:d,Gl:p,Hh:b,Hl:S}=this;return[e,r,a,f,o,i,n,u,h,m,B,v,d,p,b,S]}set(e,r,a,f,o,i,n,u,h,m,B,v,d,p,b,S){this.Ah=e|0,this.Al=r|0,this.Bh=a|0,this.Bl=f|0,this.Ch=o|0,this.Cl=i|0,this.Dh=n|0,this.Dl=u|0,this.Eh=h|0,this.El=m|0,this.Fh=B|0,this.Fl=v|0,this.Gh=d|0,this.Gl=p|0,this.Hh=b|0,this.Hl=S|0}process(e,r){for(let E=0;E<16;E++,r+=4)jt[E]=e.getUint32(r),Zt[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const A=jt[E-15]|0,I=Zt[E-15]|0,x=rr(A,I,1)^rr(A,I,8)^ii(A,I,7),l=nr(A,I,1)^nr(A,I,8)^si(A,I,7),s=jt[E-2]|0,w=Zt[E-2]|0,N=rr(s,w,19)^Ar(s,w,61)^ii(s,w,6),K=nr(s,w,19)^Tr(s,w,61)^si(s,w,6),_=Uf(l,K,Zt[E-7],Zt[E-16]),D=Df(_,x,N,jt[E-7],jt[E-16]);jt[E]=D|0,Zt[E]=_|0}let{Ah:a,Al:f,Bh:o,Bl:i,Ch:n,Cl:u,Dh:h,Dl:m,Eh:B,El:v,Fh:d,Fl:p,Gh:b,Gl:S,Hh:c,Hl:g}=this;for(let E=0;E<80;E++){const A=rr(B,v,14)^rr(B,v,18)^Ar(B,v,41),I=nr(B,v,14)^nr(B,v,18)^Tr(B,v,41),x=B&d^~B&b,l=v&p^~v&S,s=Pf(g,I,l,Vc[E],Zt[E]),w=Kf(s,c,A,x,Oc[E],jt[E]),N=s|0,K=rr(a,f,28)^Ar(a,f,34)^Ar(a,f,39),_=nr(a,f,28)^Tr(a,f,34)^Tr(a,f,39),D=a&o^a&n^o&n,V=f&i^f&u^i&u;c=b|0,g=S|0,b=d|0,S=p|0,d=B|0,p=v|0,{h:B,l:v}=St(h|0,m|0,w|0,N|0),h=n|0,m=u|0,n=o|0,u=i|0,o=a|0,i=f|0;const P=Pa(N,_,V);a=Ka(P,w,K,D),f=P|0}({h:a,l:f}=St(this.Ah|0,this.Al|0,a|0,f|0)),{h:o,l:i}=St(this.Bh|0,this.Bl|0,o|0,i|0),{h:n,l:u}=St(this.Ch|0,this.Cl|0,n|0,u|0),{h,l:m}=St(this.Dh|0,this.Dl|0,h|0,m|0),{h:B,l:v}=St(this.Eh|0,this.El|0,B|0,v|0),{h:d,l:p}=St(this.Fh|0,this.Fl|0,d|0,p|0),{h:b,l:S}=St(this.Gh|0,this.Gl|0,b|0,S|0),{h:c,l:g}=St(this.Hh|0,this.Hl|0,c|0,g|0),this.set(a,f,o,i,n,u,h,m,B,v,d,p,b,S,c,g)}roundClean(){ut(jt,Zt)}destroy(){ut(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Fc extends uo{Ah=rt[0]|0;Al=rt[1]|0;Bh=rt[2]|0;Bl=rt[3]|0;Ch=rt[4]|0;Cl=rt[5]|0;Dh=rt[6]|0;Dl=rt[7]|0;Eh=rt[8]|0;El=rt[9]|0;Fh=rt[10]|0;Fl=rt[11]|0;Gh=rt[12]|0;Gl=rt[13]|0;Hh=rt[14]|0;Hl=rt[15]|0;constructor(){super(64)}}class Mc extends uo{Ah=tt[0]|0;Al=tt[1]|0;Bh=tt[2]|0;Bl=tt[3]|0;Ch=tt[4]|0;Cl=tt[5]|0;Dh=tt[6]|0;Dl=tt[7]|0;Eh=tt[8]|0;El=tt[9]|0;Fh=tt[10]|0;Fl=tt[11]|0;Gh=tt[12]|0;Gl=tt[13]|0;Hh=tt[14]|0;Hl=tt[15]|0;constructor(){super(48)}}const lo=ir(()=>new Kc,Vr(1)),ho=ir(()=>new Fc,Vr(3)),Hc=ir(()=>new Mc,Vr(2));const qc=BigInt(1),mi=BigInt(2),Gc=BigInt(5),$c=BigInt(8),qa=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),zc={p:qa,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:$c,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Yc(t){const e=BigInt(10),r=BigInt(20),a=BigInt(40),f=BigInt(80),o=qa,n=t*t%o*t%o,u=me(n,mi,o)*n%o,h=me(u,qc,o)*t%o,m=me(h,Gc,o)*h%o,B=me(m,e,o)*m%o,v=me(B,r,o)*B%o,d=me(v,a,o)*v%o,p=me(d,f,o)*d%o,b=me(p,f,o)*d%o,S=me(b,e,o)*m%o;return{pow_p_5_8:me(S,mi,o)*t%o,b2:n}}function Qc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Ei=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Xc(t,e){const r=qa,a=be(e*e*e,r),f=be(a*a*e,r),o=Yc(t*f).pow_p_5_8;let i=be(t*a*o,r);const n=be(e*i*i,r),u=i,h=be(i*Ei,r),m=n===t,B=n===be(-t,r),v=n===be(-t*Ei,r);return m&&(i=u),(B||v)&&(i=h),fc(i,r)&&(i=be(-i,r)),{isValid:m||B,value:i}}const jc=io(zc,{uvRatio:Xc});function Zc(t){return so(jc,ho,Object.assign({adjustScalarBytes:Qc},t))}const Wc=Zc({});class po{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(e,r){if(Ls(e),de(r,void 0,"key"),this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,f=new Uint8Array(a);f.set(r.length>a?e.create().update(r).digest():r);for(let o=0;o<f.length;o++)f[o]^=54;this.iHash.update(f),this.oHash=e.create();for(let o=0;o<f.length;o++)f[o]^=106;this.oHash.update(f),ut(f)}update(e){return Gt(this),this.iHash.update(e),this}digestInto(e){Gt(this),de(e,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||=Object.create(Object.getPrototypeOf(this),{});const{oHash:r,iHash:a,finished:f,destroyed:o,blockLen:i,outputLen:n}=this;return e=e,e.finished=f,e.destroyed=o,e.blockLen=i,e.outputLen=n,e.oHash=r._cloneInto(e.oHash),e.iHash=a._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const yo=(t,e,r)=>new po(t,e).update(r).digest();yo.create=(t,e)=>new po(t,e);const xi=(t,e)=>(t+(t>=0?e:-e)/go)/e;function Jc(t,e,r){const[[a,f],[o,i]]=e,n=xi(i*t,r),u=xi(-f*t,r);let h=t-n*a-u*o,m=-n*f-u*i;const B=h<qt,v=m<qt;B&&(h=-h),v&&(m=-m);const d=Ma(Math.ceil(tc(r)/2))+mr;if(h<qt||h>=d||m<qt||m>=d)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:B,k1:h,k2neg:v,k2:m}}function Ia(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Dn(t,e){const r={};for(let a of Object.keys(e))r[a]=t[a]===void 0?e[a]:t[a];return lr(r.lowS,"lowS"),lr(r.prehash,"prehash"),r.format!==void 0&&Ia(r.format),r}class eu extends Error{constructor(e=""){super(e)}}const ar={Err:eu,_tlv:{encode:(t,e)=>{const{Err:r}=ar;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const a=e.length/2,f=Qr(a);if(f.length/2&128)throw new r("tlv.encode: long form length too big");const o=a>127?Qr(f.length/2|128):"";return Qr(t)+o+f+e},decode(t,e){const{Err:r}=ar;let a=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[a++]!==t)throw new r("tlv.decode: wrong tlv");const f=e[a++],o=!!(f&128);let i=0;if(!o)i=f;else{const u=f&127;if(!u)throw new r("tlv.decode(long): indefinite length not supported");if(u>4)throw new r("tlv.decode(long): byte length is too big");const h=e.subarray(a,a+u);if(h.length!==u)throw new r("tlv.decode: length bytes not complete");if(h[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const m of h)i=i<<8|m;if(a+=u,i<128)throw new r("tlv.decode(long): not minimal encoding")}const n=e.subarray(a,a+i);if(n.length!==i)throw new r("tlv.decode: wrong value length");return{v:n,l:e.subarray(a+i)}}},_int:{encode(t){const{Err:e}=ar;if(t<qt)throw new e("integer: negative integers are not allowed");let r=Qr(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=ar;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return vn(t)}},toSig(t){const{Err:e,_int:r,_tlv:a}=ar,f=de(t,void 0,"signature"),{v:o,l:i}=a.decode(48,f);if(i.length)throw new e("invalid signature: left bytes after parsing");const{v:n,l:u}=a.decode(2,o),{v:h,l:m}=a.decode(2,u);if(m.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(n),s:r.decode(h)}},hexFromSig(t){const{_tlv:e,_int:r}=ar,a=e.encode(2,r.encode(t.r)),f=e.encode(2,r.encode(t.s)),o=a+f;return e.encode(48,o)}},qt=BigInt(0),mr=BigInt(1),go=BigInt(2),Xr=BigInt(3),tu=BigInt(4);function En(t,e={}){const r=no("weierstrass",t,e),{Fp:a,Fn:f}=r;let o=r.CURVE;const{h:i,n}=o;Fr(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});const{endo:u}=e;if(u&&(!a.is0(o.a)||typeof u.beta!="bigint"||!Array.isArray(u.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const h=mo(a,f);function m(){if(!a.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function B(_,D,V){const{x:P,y:M}=D.toAffine(),q=a.toBytes(P);if(lr(V,"isCompressed"),V){m();const z=!a.isOdd(M);return bt(vo(z),q)}else return bt(Uint8Array.of(4),q,a.toBytes(M))}function v(_){de(_,void 0,"Point");const{publicKey:D,publicKeyUncompressed:V}=h,P=_.length,M=_[0],q=_.subarray(1);if(P===D&&(M===2||M===3)){const z=a.fromBytes(q);if(!a.isValid(z))throw new Error("bad point: is not on curve, wrong x");const G=b(z);let Y;try{Y=a.sqrt(G)}catch(ue){const X=ue instanceof Error?": "+ue.message:"";throw new Error("bad point: is not on curve, sqrt error"+X)}m();const j=a.isOdd(Y);return(M&1)===1!==j&&(Y=a.neg(Y)),{x:z,y:Y}}else if(P===V&&M===4){const z=a.BYTES,G=a.fromBytes(q.subarray(0,z)),Y=a.fromBytes(q.subarray(z,z*2));if(!S(G,Y))throw new Error("bad point: is not on curve");return{x:G,y:Y}}else throw new Error(`bad point: got length ${P}, expected compressed=${D} or uncompressed=${V}`)}const d=e.toBytes||B,p=e.fromBytes||v;function b(_){const D=a.sqr(_),V=a.mul(D,_);return a.add(a.add(V,a.mul(_,o.a)),o.b)}function S(_,D){const V=a.sqr(D),P=b(_);return a.eql(V,P)}if(!S(o.Gx,o.Gy))throw new Error("bad curve params: generator point");const c=a.mul(a.pow(o.a,Xr),tu),g=a.mul(a.sqr(o.b),BigInt(27));if(a.is0(a.add(c,g)))throw new Error("bad curve params: a or b");function E(_,D,V=!1){if(!a.isValid(D)||V&&a.is0(D))throw new Error(`bad point coordinate ${_}`);return D}function A(_){if(!(_ instanceof w))throw new Error("Weierstrass Point expected")}function I(_){if(!u||!u.basises)throw new Error("no endo");return Jc(_,u.basises,f.ORDER)}const x=cn((_,D)=>{const{X:V,Y:P,Z:M}=_;if(a.eql(M,a.ONE))return{x:V,y:P};const q=_.is0();D==null&&(D=q?a.ONE:a.inv(M));const z=a.mul(V,D),G=a.mul(P,D),Y=a.mul(M,D);if(q)return{x:a.ZERO,y:a.ZERO};if(!a.eql(Y,a.ONE))throw new Error("invZ was invalid");return{x:z,y:G}}),l=cn(_=>{if(_.is0()){if(e.allowInfinityPoint&&!a.is0(_.Y))return;throw new Error("bad point: ZERO")}const{x:D,y:V}=_.toAffine();if(!a.isValid(D)||!a.isValid(V))throw new Error("bad point: x or y not field elements");if(!S(D,V))throw new Error("bad point: equation left != right");if(!_.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function s(_,D,V,P,M){return V=new w(a.mul(V.X,_),V.Y,V.Z),D=un(P,D),V=un(M,V),D.add(V)}class w{static BASE=new w(o.Gx,o.Gy,a.ONE);static ZERO=new w(a.ZERO,a.ONE,a.ZERO);static Fp=a;static Fn=f;X;Y;Z;constructor(D,V,P){this.X=E("x",D),this.Y=E("y",V,!0),this.Z=E("z",P),Object.freeze(this)}static CURVE(){return o}static fromAffine(D){const{x:V,y:P}=D||{};if(!D||!a.isValid(V)||!a.isValid(P))throw new Error("invalid affine point");if(D instanceof w)throw new Error("projective point not allowed");return a.is0(V)&&a.is0(P)?w.ZERO:new w(V,P,a.ONE)}static fromBytes(D){const V=w.fromAffine(p(de(D,void 0,"point")));return V.assertValidity(),V}static fromHex(D){return w.fromBytes(Lr(D))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(D=8,V=!0){return K.createCache(this,D),V||this.multiply(Xr),this}assertValidity(){l(this)}hasEvenY(){const{y:D}=this.toAffine();if(!a.isOdd)throw new Error("Field doesn't support isOdd");return!a.isOdd(D)}equals(D){A(D);const{X:V,Y:P,Z:M}=this,{X:q,Y:z,Z:G}=D,Y=a.eql(a.mul(V,G),a.mul(q,M)),j=a.eql(a.mul(P,G),a.mul(z,M));return Y&&j}negate(){return new w(this.X,a.neg(this.Y),this.Z)}double(){const{a:D,b:V}=o,P=a.mul(V,Xr),{X:M,Y:q,Z:z}=this;let G=a.ZERO,Y=a.ZERO,j=a.ZERO,te=a.mul(M,M),ue=a.mul(q,q),X=a.mul(z,z),re=a.mul(M,q);return re=a.add(re,re),j=a.mul(M,z),j=a.add(j,j),G=a.mul(D,j),Y=a.mul(P,X),Y=a.add(G,Y),G=a.sub(ue,Y),Y=a.add(ue,Y),Y=a.mul(G,Y),G=a.mul(re,G),j=a.mul(P,j),X=a.mul(D,X),re=a.sub(te,X),re=a.mul(D,re),re=a.add(re,j),j=a.add(te,te),te=a.add(j,te),te=a.add(te,X),te=a.mul(te,re),Y=a.add(Y,te),X=a.mul(q,z),X=a.add(X,X),te=a.mul(X,re),G=a.sub(G,te),j=a.mul(X,ue),j=a.add(j,j),j=a.add(j,j),new w(G,Y,j)}add(D){A(D);const{X:V,Y:P,Z:M}=this,{X:q,Y:z,Z:G}=D;let Y=a.ZERO,j=a.ZERO,te=a.ZERO;const ue=o.a,X=a.mul(o.b,Xr);let re=a.mul(V,q),W=a.mul(P,z),pe=a.mul(M,G),le=a.add(V,P),C=a.add(q,z);le=a.mul(le,C),C=a.add(re,W),le=a.sub(le,C),C=a.add(V,M);let U=a.add(q,G);return C=a.mul(C,U),U=a.add(re,pe),C=a.sub(C,U),U=a.add(P,M),Y=a.add(z,G),U=a.mul(U,Y),Y=a.add(W,pe),U=a.sub(U,Y),te=a.mul(ue,C),Y=a.mul(X,pe),te=a.add(Y,te),Y=a.sub(W,te),te=a.add(W,te),j=a.mul(Y,te),W=a.add(re,re),W=a.add(W,re),pe=a.mul(ue,pe),C=a.mul(X,C),W=a.add(W,pe),pe=a.sub(re,pe),pe=a.mul(ue,pe),C=a.add(C,pe),re=a.mul(W,C),j=a.add(j,re),re=a.mul(U,C),Y=a.mul(le,Y),Y=a.sub(Y,re),re=a.mul(le,W),te=a.mul(U,te),te=a.add(te,re),new w(Y,j,te)}subtract(D){return this.add(D.negate())}is0(){return this.equals(w.ZERO)}multiply(D){const{endo:V}=e;if(!f.isValidNot0(D))throw new Error("invalid scalar: out of range");let P,M;const q=z=>K.cached(this,z,G=>_r(w,G));if(V){const{k1neg:z,k1:G,k2neg:Y,k2:j}=I(D),{p:te,f:ue}=q(G),{p:X,f:re}=q(j);M=ue.add(re),P=s(V.beta,te,X,z,Y)}else{const{p:z,f:G}=q(D);P=z,M=G}return _r(w,[P,M])[0]}multiplyUnsafe(D){const{endo:V}=e,P=this;if(!f.isValid(D))throw new Error("invalid scalar: out of range");if(D===qt||P.is0())return w.ZERO;if(D===mr)return P;if(K.hasCache(this))return this.multiply(D);if(V){const{k1neg:M,k1:q,k2neg:z,k2:G}=I(D),{p1:Y,p2:j}=yc(w,P,q,G);return s(V.beta,Y,j,M,z)}else return K.unsafe(P,D)}toAffine(D){return x(this,D)}isTorsionFree(){const{isTorsionFree:D}=e;return i===mr?!0:D?D(w,this):K.unsafe(this,n).is0()}clearCofactor(){const{clearCofactor:D}=e;return i===mr?this:D?D(w,this):this.multiplyUnsafe(i)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}toBytes(D=!0){return lr(D,"isCompressed"),this.assertValidity(),d(w,this,D)}toHex(D=!0){return Or(this.toBytes(D))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const N=f.BITS,K=new ro(w,e.endo?Math.ceil(N/2):N);return w.BASE.precompute(8),w}function vo(t){return Uint8Array.of(t?2:3)}function mo(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function ru(t,e={}){const{Fn:r}=t,a=e.randomBytes||Oa,f=Object.assign(mo(t.Fp,r),{seed:Js(r.ORDER)});function o(d){try{const p=r.fromBytes(d);return r.isValidNot0(p)}catch{return!1}}function i(d,p){const{publicKey:b,publicKeyUncompressed:S}=f;try{const c=d.length;return p===!0&&c!==b||p===!1&&c!==S?!1:!!t.fromBytes(d)}catch{return!1}}function n(d=a(f.seed)){return pc(de(d,f.seed,"seed"),r.ORDER)}function u(d,p=!0){return t.BASE.multiply(r.fromBytes(d)).toBytes(p)}function h(d){const{secretKey:p,publicKey:b,publicKeyUncompressed:S}=f;if(!pn(d)||"_lengths"in r&&r._lengths||p===b)return;const c=de(d,void 0,"key").length;return c===b||c===S}function m(d,p,b=!0){if(h(d)===!0)throw new Error("first arg must be private key");if(h(p)===!1)throw new Error("second arg must be public key");const S=r.fromBytes(d);return t.fromBytes(p).multiply(S).toBytes(b)}const B={isValidSecretKey:o,isValidPublicKey:i,randomSecretKey:n},v=ao(n,u);return Object.freeze({getPublicKey:u,getSharedSecret:m,keygen:v,Point:t,utils:B,lengths:f})}function xn(t,e,r={}){Ls(e),Fr(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);const a=r.randomBytes||Oa,f=r.hmac||((V,P)=>yo(e,V,P)),{Fp:o,Fn:i}=t,{ORDER:n,BITS:u}=i,{keygen:h,getPublicKey:m,getSharedSecret:B,utils:v,lengths:d}=ru(t,r),p={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},b=n*go<o.ORDER;function S(V){const P=n>>mr;return V>P}function c(V,P){if(!i.isValidNot0(P))throw new Error(`invalid signature ${V}: out of range 1..Point.Fn.ORDER`);return P}function g(){if(b)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function E(V,P){Ia(P);const M=d.signature,q=P==="compact"?M:P==="recovered"?M+1:void 0;return de(V,q)}class A{r;s;recovery;constructor(P,M,q){if(this.r=c("r",P),this.s=c("s",M),q!=null){if(g(),![0,1,2,3].includes(q))throw new Error("invalid recovery id");this.recovery=q}Object.freeze(this)}static fromBytes(P,M=p.format){E(P,M);let q;if(M==="der"){const{r:j,s:te}=ar.toSig(de(P));return new A(j,te)}M==="recovered"&&(q=P[0],M="compact",P=P.subarray(1));const z=d.signature/2,G=P.subarray(0,z),Y=P.subarray(z,z*2);return new A(i.fromBytes(G),i.fromBytes(Y),q)}static fromHex(P,M){return this.fromBytes(Lr(P),M)}assertRecovery(){const{recovery:P}=this;if(P==null)throw new Error("invalid recovery id: must be present");return P}addRecoveryBit(P){return new A(this.r,this.s,P)}recoverPublicKey(P){const{r:M,s:q}=this,z=this.assertRecovery(),G=z===2||z===3?M+n:M;if(!o.isValid(G))throw new Error("invalid recovery id: sig.r+curve.n != R.x");const Y=o.toBytes(G),j=t.fromBytes(bt(vo((z&1)===0),Y)),te=i.inv(G),ue=x(de(P,void 0,"msgHash")),X=i.create(-ue*te),re=i.create(q*te),W=t.BASE.multiplyUnsafe(X).add(j.multiplyUnsafe(re));if(W.is0())throw new Error("invalid recovery: point at infinify");return W.assertValidity(),W}hasHighS(){return S(this.s)}toBytes(P=p.format){if(Ia(P),P==="der")return Lr(ar.hexFromSig(this));const{r:M,s:q}=this,z=i.toBytes(M),G=i.toBytes(q);return P==="recovered"?(g(),bt(Uint8Array.of(this.assertRecovery()),z,G)):bt(z,G)}toHex(P){return Or(this.toBytes(P))}}const I=r.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const M=vn(P),q=P.length*8-u;return q>0?M>>BigInt(q):M},x=r.bits2int_modN||function(P){return i.create(I(P))},l=Ma(u);function s(V){return Ta("num < 2^"+u,V,qt,l),i.toBytes(V)}function w(V,P){return de(V,void 0,"message"),P?de(e(V),void 0,"prehashed message"):V}function N(V,P,M){const{lowS:q,prehash:z,extraEntropy:G}=Dn(M,p);V=w(V,z);const Y=x(V),j=i.fromBytes(P);if(!i.isValidNot0(j))throw new Error("invalid private key");const te=[s(j),s(Y)];if(G!=null&&G!==!1){const W=G===!0?a(d.secretKey):G;te.push(de(W,void 0,"extraEntropy"))}const ue=bt(...te),X=Y;function re(W){const pe=I(W);if(!i.isValidNot0(pe))return;const le=i.inv(pe),C=t.BASE.multiply(pe).toAffine(),U=i.create(C.x);if(U===qt)return;const L=i.create(le*i.create(X+U*j));if(L===qt)return;let y=(C.x===U?0:2)|Number(C.y&mr),R=L;return q&&S(L)&&(R=i.neg(L),y^=1),new A(U,R,b?void 0:y)}return{seed:ue,k2sig:re}}function K(V,P,M={}){const{seed:q,k2sig:z}=N(V,P,M);return rc(e.outputLen,i.BYTES,f)(q,z).toBytes(M.format)}function _(V,P,M,q={}){const{lowS:z,prehash:G,format:Y}=Dn(q,p);if(M=de(M,void 0,"publicKey"),P=w(P,G),!pn(V)){const j=V instanceof A?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+j)}E(V,Y);try{const j=A.fromBytes(V,Y),te=t.fromBytes(M);if(z&&j.hasHighS())return!1;const{r:ue,s:X}=j,re=x(P),W=i.inv(X),pe=i.create(re*W),le=i.create(ue*W),C=t.BASE.multiplyUnsafe(pe).add(te.multiplyUnsafe(le));return C.is0()?!1:i.create(C.x)===ue}catch{return!1}}function D(V,P,M={}){const{prehash:q}=Dn(M,p);return P=w(P,q),A.fromBytes(V,"recovered").recoverPublicKey(P).toBytes()}return Object.freeze({keygen:h,getPublicKey:m,getSharedSecret:B,utils:v,lengths:d,Point:t,sign:K,verify:_,recoverPublicKey:D,Signature:A,hash:e})}const nu={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},au={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Eo={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},iu=En(nu),su=xn(iu,lo),ou=En(au),fu=xn(ou,Hc),cu=hr(Eo.n,{allowedLengths:[65,66]}),uu=En(Eo,{Fn:cu}),lu=xn(uu,ho);const Ga={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},hu={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Si=BigInt(2);function du(t){const e=Ga.p,r=BigInt(3),a=BigInt(6),f=BigInt(11),o=BigInt(22),i=BigInt(23),n=BigInt(44),u=BigInt(88),h=t*t*t%e,m=h*h*t%e,B=me(m,r,e)*m%e,v=me(B,r,e)*m%e,d=me(v,Si,e)*h%e,p=me(d,f,e)*d%e,b=me(p,o,e)*p%e,S=me(b,n,e)*b%e,c=me(S,u,e)*S%e,g=me(c,n,e)*b%e,E=me(g,r,e)*m%e,A=me(E,i,e)*p%e,I=me(A,a,e)*h%e,x=me(I,Si,e);if(!_a.eql(_a.sqr(x),t))throw new Error("Cannot find square root");return x}const _a=hr(Ga.p,{sqrt:du}),pu=En(Ga,{Fp:_a,endo:hu}),yu=xn(pu,lo);function It(t){return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}function Dr(t){const e=t.replace(/\s+/g,"");if(e.length%2!==0)throw new Error("Invalid hex string: length must be even");const r=new Uint8Array(e.length/2);for(let a=0;a<e.length;a+=2){const f=Number.parseInt(e.substring(a,a+2),16);if(Number.isNaN(f))throw new Error(`Invalid hex string: invalid character at position ${a}`);r[a/2]=f}return r}function gu(t){return t==="secp256k1"||t==="p256"||t==="p384"||t==="p521"}function Sn(t){switch(t){case"secp256k1":return yu;case"p256":return su;case"p384":return fu;case"p521":return lu;case"ed25519":return Wc;case"ed448":return kc;default:throw new Error(`Unsupported curve: ${t}`)}}function vu(t="secp256k1"){const e=Sn(t),r=e.utils.randomSecretKey(),a=e.getPublicKey(r);return{privateKey:It(r),publicKey:It(a),curve:t}}function xo(t,e,r="secp256k1"){try{const a=Sn(r),f=Dr(e);if(r==="ed25519"||r==="ed448"){const u=a.sign(t,f),h=u instanceof Uint8Array?u:new Uint8Array(u);return{signature:It(h)}}const o=a.sign(t,f),i=o instanceof Uint8Array?o:new Uint8Array(o),n=It(i);return r==="secp256k1"&&typeof o=="object"&&"recovery"in o?{signature:n,recoveryId:o.recovery}:{signature:n}}catch(a){throw new Error(`ECDSA signing failed: ${a instanceof Error?a.message:String(a)}`)}}function So(t,e,r,a="secp256k1"){try{const f=Sn(a),o=Dr(r),i=Dr(e);return f.verify(i,t,o)}catch(f){if(f instanceof Error&&f.message.includes("Invalid signature"))return!1;throw new Error(`ECDSA verification failed: ${f instanceof Error?f.message:String(f)}`)}}function mu(t,e,r="secp256k1"){try{const a=Sn(r),f=Dr(t),o=Dr(e);if(!gu(r))throw new Error(`ECDH is not supported for ${r}`);const n=a.getSharedSecret(f,o);return{sharedSecret:It(n)}}catch(a){throw new Error(`ECDH computation failed: ${a instanceof Error?a.message:String(a)}`)}}function Eu(t,e,r="ed25519"){return xo(t,e,r)}function xu(t,e,r,a="ed25519"){return So(t,e,r,a)}let cr=null,bi=!1;async function Mr(){if(!(bi&&cr))try{const t=(await xe(async()=>{const{default:e}=await import("./ibe_wasm-Drswr2Qh.js");return{default:e}},[],import.meta.url)).default;cr=await t({module_or_path:new URL(""+new URL("ibe_wasm_bg-C_JPAl-h.wasm",import.meta.url).href,import.meta.url).href}),cr.init(),bi=!0}catch(t){throw new Error(`Failed to initialize IBE WebAssembly module: ${t}`)}}async function Su(){if(await Mr(),!cr)throw new Error("IBE module not initialized");const{IBE:t}=await xe(async()=>{const{IBE:r}=await import("./ibe_wasm-Drswr2Qh.js");return{IBE:r}},[],import.meta.url),e=new t;try{const r=e.setup();if(r instanceof Error)throw r;const a=r.master_key,f=r.public_params;if(!a||!f)throw new Error("Failed to get master_key or public_params from setup result");return{masterKey:a,publicParams:f}}catch(r){throw new Error(`IBE setup failed: ${r}`)}}async function bu(t,e){if(await Mr(),!cr)throw new Error("IBE module not initialized");const{IBE:r}=await xe(async()=>{const{IBE:f}=await import("./ibe_wasm-Drswr2Qh.js");return{IBE:f}},[],import.meta.url),a=new r;try{return a.extract(t,e)}catch(f){throw new Error(`IBE extract failed: ${f}`)}}async function Cu(t,e,r){if(await Mr(),!cr)throw new Error("IBE module not initialized");const{IBE:a}=await xe(async()=>{const{IBE:o}=await import("./ibe_wasm-Drswr2Qh.js");return{IBE:o}},[],import.meta.url),f=new a;try{return f.encrypt(t,e,r)}catch(o){throw new Error(`IBE encrypt failed: ${o}`)}}async function Bu(t,e){if(await Mr(),!cr)throw new Error("IBE module not initialized");const{IBE:r}=await xe(async()=>{const{IBE:f}=await import("./ibe_wasm-Drswr2Qh.js");return{IBE:f}},[],import.meta.url),a=new r;try{return a.decrypt(t,e)}catch(f){throw new Error(`IBE decrypt failed: ${f}`)}}var wu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Au(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Tu(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var f=!1;try{f=this instanceof a}catch{}return f?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var f=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,f.get?f:{enumerable:!0,get:function(){return t[a]}})}),r}var Pn,Ci;function ge(){return Ci||(Ci=1,Pn={options:{usePureJavaScript:!1}}),Pn}var Kn={exports:{}},On,Bi;function Iu(){if(Bi)return On;Bi=1;var t={};On=t;var e={};t.encode=function(a,f,o){if(typeof f!="string")throw new TypeError('"alphabet" must be a string.');if(o!==void 0&&typeof o!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(a instanceof Uint8Array))i=r(a,f);else{var n=0,u=f.length,h=f.charAt(0),m=[0];for(n=0;n<a.length;++n){for(var B=0,v=a[n];B<m.length;++B)v+=m[B]<<8,m[B]=v%u,v=v/u|0;for(;v>0;)m.push(v%u),v=v/u|0}for(n=0;a[n]===0&&n<a.length-1;++n)i+=h;for(n=m.length-1;n>=0;--n)i+=f[m[n]]}if(o){var d=new RegExp(".{1,"+o+"}","g");i=i.match(d).join(`\r
`)}return i},t.decode=function(a,f){if(typeof a!="string")throw new TypeError('"input" must be a string.');if(typeof f!="string")throw new TypeError('"alphabet" must be a string.');var o=e[f];if(!o){o=e[f]=[];for(var i=0;i<f.length;++i)o[f.charCodeAt(i)]=i}a=a.replace(/\s/g,"");for(var n=f.length,u=f.charAt(0),h=[0],i=0;i<a.length;i++){var m=o[a.charCodeAt(i)];if(m===void 0)return;for(var B=0,v=m;B<h.length;++B)v+=h[B]*n,h[B]=v&255,v>>=8;for(;v>0;)h.push(v&255),v>>=8}for(var d=0;a[d]===u&&d<a.length-1;++d)h.push(0);return typeof Buffer<"u"?Buffer.from(h.reverse()):new Uint8Array(h.reverse())};function r(a,f){var o=0,i=f.length,n=f.charAt(0),u=[0];for(o=0;o<a.length();++o){for(var h=0,m=a.at(o);h<u.length;++h)m+=u[h]<<8,u[h]=m%i,m=m/i|0;for(;m>0;)u.push(m%i),m=m/i|0}var B="";for(o=0;a.at(o)===0&&o<a.length()-1;++o)B+=n;for(o=u.length-1;o>=0;--o)B+=f[u[o]];return B}return On}var wi;function Ee(){if(wi)return Kn.exports;wi=1;var t=ge(),e=Iu(),r=Kn.exports=t.util=t.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){r.nextTick=process.nextTick,typeof setImmediate=="function"?r.setImmediate=setImmediate:r.setImmediate=r.nextTick;return}if(typeof setImmediate=="function"){r.setImmediate=function(){return setImmediate.apply(void 0,arguments)},r.nextTick=function(l){return setImmediate(l)};return}if(r.setImmediate=function(l){setTimeout(l,0)},typeof window<"u"&&typeof window.postMessage=="function"){let l=function(s){if(s.source===window&&s.data===c){s.stopPropagation();var w=g.slice();g.length=0,w.forEach(function(N){N()})}};var c="forge.setImmediate",g=[];r.setImmediate=function(s){g.push(s),g.length===1&&window.postMessage(c,"*")},window.addEventListener("message",l,!0)}if(typeof MutationObserver<"u"){var E=Date.now(),A=!0,I=document.createElement("div"),g=[];new MutationObserver(function(){var s=g.slice();g.length=0,s.forEach(function(w){w()})}).observe(I,{attributes:!0});var x=r.setImmediate;r.setImmediate=function(s){Date.now()-E>15?(E=Date.now(),x(s)):(g.push(s),g.length===1&&I.setAttribute("a",A=!A))}}r.nextTick=r.setImmediate})(),r.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,r.globalScope=(function(){return r.isNodejs?wu:typeof self>"u"?window:self})(),r.isArray=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"},r.isArrayBuffer=function(c){return typeof ArrayBuffer<"u"&&c instanceof ArrayBuffer},r.isArrayBufferView=function(c){return c&&r.isArrayBuffer(c.buffer)&&c.byteLength!==void 0};function a(c){if(!(c===8||c===16||c===24||c===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+c)}r.ByteBuffer=f;function f(c){if(this.data="",this.read=0,typeof c=="string")this.data=c;else if(r.isArrayBuffer(c)||r.isArrayBufferView(c))if(typeof Buffer<"u"&&c instanceof Buffer)this.data=c.toString("binary");else{var g=new Uint8Array(c);try{this.data=String.fromCharCode.apply(null,g)}catch{for(var E=0;E<g.length;++E)this.putByte(g[E])}}else(c instanceof f||typeof c=="object"&&typeof c.data=="string"&&typeof c.read=="number")&&(this.data=c.data,this.read=c.read);this._constructedStringLength=0}r.ByteStringBuffer=f;var o=4096;r.ByteStringBuffer.prototype._optimizeConstructedString=function(c){this._constructedStringLength+=c,this._constructedStringLength>o&&(this.data.substr(0,1),this._constructedStringLength=0)},r.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},r.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},r.ByteStringBuffer.prototype.putByte=function(c){return this.putBytes(String.fromCharCode(c))},r.ByteStringBuffer.prototype.fillWithByte=function(c,g){c=String.fromCharCode(c);for(var E=this.data;g>0;)g&1&&(E+=c),g>>>=1,g>0&&(c+=c);return this.data=E,this._optimizeConstructedString(g),this},r.ByteStringBuffer.prototype.putBytes=function(c){return this.data+=c,this._optimizeConstructedString(c.length),this},r.ByteStringBuffer.prototype.putString=function(c){return this.putBytes(r.encodeUtf8(c))},r.ByteStringBuffer.prototype.putInt16=function(c){return this.putBytes(String.fromCharCode(c>>8&255)+String.fromCharCode(c&255))},r.ByteStringBuffer.prototype.putInt24=function(c){return this.putBytes(String.fromCharCode(c>>16&255)+String.fromCharCode(c>>8&255)+String.fromCharCode(c&255))},r.ByteStringBuffer.prototype.putInt32=function(c){return this.putBytes(String.fromCharCode(c>>24&255)+String.fromCharCode(c>>16&255)+String.fromCharCode(c>>8&255)+String.fromCharCode(c&255))},r.ByteStringBuffer.prototype.putInt16Le=function(c){return this.putBytes(String.fromCharCode(c&255)+String.fromCharCode(c>>8&255))},r.ByteStringBuffer.prototype.putInt24Le=function(c){return this.putBytes(String.fromCharCode(c&255)+String.fromCharCode(c>>8&255)+String.fromCharCode(c>>16&255))},r.ByteStringBuffer.prototype.putInt32Le=function(c){return this.putBytes(String.fromCharCode(c&255)+String.fromCharCode(c>>8&255)+String.fromCharCode(c>>16&255)+String.fromCharCode(c>>24&255))},r.ByteStringBuffer.prototype.putInt=function(c,g){a(g);var E="";do g-=8,E+=String.fromCharCode(c>>g&255);while(g>0);return this.putBytes(E)},r.ByteStringBuffer.prototype.putSignedInt=function(c,g){return c<0&&(c+=2<<g-1),this.putInt(c,g)},r.ByteStringBuffer.prototype.putBuffer=function(c){return this.putBytes(c.getBytes())},r.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},r.ByteStringBuffer.prototype.getInt16=function(){var c=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,c},r.ByteStringBuffer.prototype.getInt24=function(){var c=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,c},r.ByteStringBuffer.prototype.getInt32=function(){var c=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,c},r.ByteStringBuffer.prototype.getInt16Le=function(){var c=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,c},r.ByteStringBuffer.prototype.getInt24Le=function(){var c=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,c},r.ByteStringBuffer.prototype.getInt32Le=function(){var c=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,c},r.ByteStringBuffer.prototype.getInt=function(c){a(c);var g=0;do g=(g<<8)+this.data.charCodeAt(this.read++),c-=8;while(c>0);return g},r.ByteStringBuffer.prototype.getSignedInt=function(c){var g=this.getInt(c),E=2<<c-2;return g>=E&&(g-=E<<1),g},r.ByteStringBuffer.prototype.getBytes=function(c){var g;return c?(c=Math.min(this.length(),c),g=this.data.slice(this.read,this.read+c),this.read+=c):c===0?g="":(g=this.read===0?this.data:this.data.slice(this.read),this.clear()),g},r.ByteStringBuffer.prototype.bytes=function(c){return typeof c>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+c)},r.ByteStringBuffer.prototype.at=function(c){return this.data.charCodeAt(this.read+c)},r.ByteStringBuffer.prototype.setAt=function(c,g){return this.data=this.data.substr(0,this.read+c)+String.fromCharCode(g)+this.data.substr(this.read+c+1),this},r.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},r.ByteStringBuffer.prototype.copy=function(){var c=r.createBuffer(this.data);return c.read=this.read,c},r.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},r.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},r.ByteStringBuffer.prototype.truncate=function(c){var g=Math.max(0,this.length()-c);return this.data=this.data.substr(this.read,g),this.read=0,this},r.ByteStringBuffer.prototype.toHex=function(){for(var c="",g=this.read;g<this.data.length;++g){var E=this.data.charCodeAt(g);E<16&&(c+="0"),c+=E.toString(16)}return c},r.ByteStringBuffer.prototype.toString=function(){return r.decodeUtf8(this.bytes())};function i(c,g){g=g||{},this.read=g.readOffset||0,this.growSize=g.growSize||1024;var E=r.isArrayBuffer(c),A=r.isArrayBufferView(c);if(E||A){E?this.data=new DataView(c):this.data=new DataView(c.buffer,c.byteOffset,c.byteLength),this.write="writeOffset"in g?g.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,c!=null&&this.putBytes(c),"writeOffset"in g&&(this.write=g.writeOffset)}r.DataBuffer=i,r.DataBuffer.prototype.length=function(){return this.write-this.read},r.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},r.DataBuffer.prototype.accommodate=function(c,g){if(this.length()>=c)return this;g=Math.max(g||this.growSize,c);var E=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),A=new Uint8Array(this.length()+g);return A.set(E),this.data=new DataView(A.buffer),this},r.DataBuffer.prototype.putByte=function(c){return this.accommodate(1),this.data.setUint8(this.write++,c),this},r.DataBuffer.prototype.fillWithByte=function(c,g){this.accommodate(g);for(var E=0;E<g;++E)this.data.setUint8(c);return this},r.DataBuffer.prototype.putBytes=function(c,g){if(r.isArrayBufferView(c)){var E=new Uint8Array(c.buffer,c.byteOffset,c.byteLength),A=E.byteLength-E.byteOffset;this.accommodate(A);var I=new Uint8Array(this.data.buffer,this.write);return I.set(E),this.write+=A,this}if(r.isArrayBuffer(c)){var E=new Uint8Array(c);this.accommodate(E.byteLength);var I=new Uint8Array(this.data.buffer);return I.set(E,this.write),this.write+=E.byteLength,this}if(c instanceof r.DataBuffer||typeof c=="object"&&typeof c.read=="number"&&typeof c.write=="number"&&r.isArrayBufferView(c.data)){var E=new Uint8Array(c.data.byteLength,c.read,c.length());this.accommodate(E.byteLength);var I=new Uint8Array(c.data.byteLength,this.write);return I.set(E),this.write+=E.byteLength,this}if(c instanceof r.ByteStringBuffer&&(c=c.data,g="binary"),g=g||"binary",typeof c=="string"){var x;if(g==="hex")return this.accommodate(Math.ceil(c.length/2)),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.hex.decode(c,x,this.write),this;if(g==="base64")return this.accommodate(Math.ceil(c.length/4)*3),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.base64.decode(c,x,this.write),this;if(g==="utf8"&&(c=r.encodeUtf8(c),g="binary"),g==="binary"||g==="raw")return this.accommodate(c.length),x=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.raw.decode(x),this;if(g==="utf16")return this.accommodate(c.length*2),x=new Uint16Array(this.data.buffer,this.write),this.write+=r.text.utf16.encode(x),this;throw new Error("Invalid encoding: "+g)}throw Error("Invalid parameter: "+c)},r.DataBuffer.prototype.putBuffer=function(c){return this.putBytes(c),c.clear(),this},r.DataBuffer.prototype.putString=function(c){return this.putBytes(c,"utf16")},r.DataBuffer.prototype.putInt16=function(c){return this.accommodate(2),this.data.setInt16(this.write,c),this.write+=2,this},r.DataBuffer.prototype.putInt24=function(c){return this.accommodate(3),this.data.setInt16(this.write,c>>8&65535),this.data.setInt8(this.write,c>>16&255),this.write+=3,this},r.DataBuffer.prototype.putInt32=function(c){return this.accommodate(4),this.data.setInt32(this.write,c),this.write+=4,this},r.DataBuffer.prototype.putInt16Le=function(c){return this.accommodate(2),this.data.setInt16(this.write,c,!0),this.write+=2,this},r.DataBuffer.prototype.putInt24Le=function(c){return this.accommodate(3),this.data.setInt8(this.write,c>>16&255),this.data.setInt16(this.write,c>>8&65535,!0),this.write+=3,this},r.DataBuffer.prototype.putInt32Le=function(c){return this.accommodate(4),this.data.setInt32(this.write,c,!0),this.write+=4,this},r.DataBuffer.prototype.putInt=function(c,g){a(g),this.accommodate(g/8);do g-=8,this.data.setInt8(this.write++,c>>g&255);while(g>0);return this},r.DataBuffer.prototype.putSignedInt=function(c,g){return a(g),this.accommodate(g/8),c<0&&(c+=2<<g-1),this.putInt(c,g)},r.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},r.DataBuffer.prototype.getInt16=function(){var c=this.data.getInt16(this.read);return this.read+=2,c},r.DataBuffer.prototype.getInt24=function(){var c=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,c},r.DataBuffer.prototype.getInt32=function(){var c=this.data.getInt32(this.read);return this.read+=4,c},r.DataBuffer.prototype.getInt16Le=function(){var c=this.data.getInt16(this.read,!0);return this.read+=2,c},r.DataBuffer.prototype.getInt24Le=function(){var c=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,c},r.DataBuffer.prototype.getInt32Le=function(){var c=this.data.getInt32(this.read,!0);return this.read+=4,c},r.DataBuffer.prototype.getInt=function(c){a(c);var g=0;do g=(g<<8)+this.data.getInt8(this.read++),c-=8;while(c>0);return g},r.DataBuffer.prototype.getSignedInt=function(c){var g=this.getInt(c),E=2<<c-2;return g>=E&&(g-=E<<1),g},r.DataBuffer.prototype.getBytes=function(c){var g;return c?(c=Math.min(this.length(),c),g=this.data.slice(this.read,this.read+c),this.read+=c):c===0?g="":(g=this.read===0?this.data:this.data.slice(this.read),this.clear()),g},r.DataBuffer.prototype.bytes=function(c){return typeof c>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+c)},r.DataBuffer.prototype.at=function(c){return this.data.getUint8(this.read+c)},r.DataBuffer.prototype.setAt=function(c,g){return this.data.setUint8(c,g),this},r.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},r.DataBuffer.prototype.copy=function(){return new r.DataBuffer(this)},r.DataBuffer.prototype.compact=function(){if(this.read>0){var c=new Uint8Array(this.data.buffer,this.read),g=new Uint8Array(c.byteLength);g.set(c),this.data=new DataView(g),this.write-=this.read,this.read=0}return this},r.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},r.DataBuffer.prototype.truncate=function(c){return this.write=Math.max(0,this.length()-c),this.read=Math.min(this.read,this.write),this},r.DataBuffer.prototype.toHex=function(){for(var c="",g=this.read;g<this.data.byteLength;++g){var E=this.data.getUint8(g);E<16&&(c+="0"),c+=E.toString(16)}return c},r.DataBuffer.prototype.toString=function(c){var g=new Uint8Array(this.data,this.read,this.length());if(c=c||"utf8",c==="binary"||c==="raw")return r.binary.raw.encode(g);if(c==="hex")return r.binary.hex.encode(g);if(c==="base64")return r.binary.base64.encode(g);if(c==="utf8")return r.text.utf8.decode(g);if(c==="utf16")return r.text.utf16.decode(g);throw new Error("Invalid encoding: "+c)},r.createBuffer=function(c,g){return g=g||"raw",c!==void 0&&g==="utf8"&&(c=r.encodeUtf8(c)),new r.ByteBuffer(c)},r.fillString=function(c,g){for(var E="";g>0;)g&1&&(E+=c),g>>>=1,g>0&&(c+=c);return E},r.xorBytes=function(c,g,E){for(var A="",I="",x="",l=0,s=0;E>0;--E,++l)I=c.charCodeAt(l)^g.charCodeAt(l),s>=10&&(A+=x,x="",s=0),x+=String.fromCharCode(I),++s;return A+=x,A},r.hexToBytes=function(c){var g="",E=0;for(c.length&!0&&(E=1,g+=String.fromCharCode(parseInt(c[0],16)));E<c.length;E+=2)g+=String.fromCharCode(parseInt(c.substr(E,2),16));return g},r.bytesToHex=function(c){return r.createBuffer(c).toHex()},r.int32ToBytes=function(c){return String.fromCharCode(c>>24&255)+String.fromCharCode(c>>16&255)+String.fromCharCode(c>>8&255)+String.fromCharCode(c&255)};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],h="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";r.encode64=function(c,g){for(var E="",A="",I,x,l,s=0;s<c.length;)I=c.charCodeAt(s++),x=c.charCodeAt(s++),l=c.charCodeAt(s++),E+=n.charAt(I>>2),E+=n.charAt((I&3)<<4|x>>4),isNaN(x)?E+="==":(E+=n.charAt((x&15)<<2|l>>6),E+=isNaN(l)?"=":n.charAt(l&63)),g&&E.length>g&&(A+=E.substr(0,g)+`\r
`,E=E.substr(g));return A+=E,A},r.decode64=function(c){c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var g="",E,A,I,x,l=0;l<c.length;)E=u[c.charCodeAt(l++)-43],A=u[c.charCodeAt(l++)-43],I=u[c.charCodeAt(l++)-43],x=u[c.charCodeAt(l++)-43],g+=String.fromCharCode(E<<2|A>>4),I!==64&&(g+=String.fromCharCode((A&15)<<4|I>>2),x!==64&&(g+=String.fromCharCode((I&3)<<6|x)));return g},r.encodeUtf8=function(c){return unescape(encodeURIComponent(c))},r.decodeUtf8=function(c){return decodeURIComponent(escape(c))},r.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},r.binary.raw.encode=function(c){return String.fromCharCode.apply(null,c)},r.binary.raw.decode=function(c,g,E){var A=g;A||(A=new Uint8Array(c.length)),E=E||0;for(var I=E,x=0;x<c.length;++x)A[I++]=c.charCodeAt(x);return g?I-E:A},r.binary.hex.encode=r.bytesToHex,r.binary.hex.decode=function(c,g,E){var A=g;A||(A=new Uint8Array(Math.ceil(c.length/2))),E=E||0;var I=0,x=E;for(c.length&1&&(I=1,A[x++]=parseInt(c[0],16));I<c.length;I+=2)A[x++]=parseInt(c.substr(I,2),16);return g?x-E:A},r.binary.base64.encode=function(c,g){for(var E="",A="",I,x,l,s=0;s<c.byteLength;)I=c[s++],x=c[s++],l=c[s++],E+=n.charAt(I>>2),E+=n.charAt((I&3)<<4|x>>4),isNaN(x)?E+="==":(E+=n.charAt((x&15)<<2|l>>6),E+=isNaN(l)?"=":n.charAt(l&63)),g&&E.length>g&&(A+=E.substr(0,g)+`\r
`,E=E.substr(g));return A+=E,A},r.binary.base64.decode=function(c,g,E){var A=g;A||(A=new Uint8Array(Math.ceil(c.length/4)*3)),c=c.replace(/[^A-Za-z0-9\+\/\=]/g,""),E=E||0;for(var I,x,l,s,w=0,N=E;w<c.length;)I=u[c.charCodeAt(w++)-43],x=u[c.charCodeAt(w++)-43],l=u[c.charCodeAt(w++)-43],s=u[c.charCodeAt(w++)-43],A[N++]=I<<2|x>>4,l!==64&&(A[N++]=(x&15)<<4|l>>2,s!==64&&(A[N++]=(l&3)<<6|s));return g?N-E:A.subarray(0,N)},r.binary.base58.encode=function(c,g){return r.binary.baseN.encode(c,h,g)},r.binary.base58.decode=function(c,g){return r.binary.baseN.decode(c,h,g)},r.text={utf8:{},utf16:{}},r.text.utf8.encode=function(c,g,E){c=r.encodeUtf8(c);var A=g;A||(A=new Uint8Array(c.length)),E=E||0;for(var I=E,x=0;x<c.length;++x)A[I++]=c.charCodeAt(x);return g?I-E:A},r.text.utf8.decode=function(c){return r.decodeUtf8(String.fromCharCode.apply(null,c))},r.text.utf16.encode=function(c,g,E){var A=g;A||(A=new Uint8Array(c.length*2));var I=new Uint16Array(A.buffer);E=E||0;for(var x=E,l=E,s=0;s<c.length;++s)I[l++]=c.charCodeAt(s),x+=2;return g?x-E:A},r.text.utf16.decode=function(c){return String.fromCharCode.apply(null,new Uint16Array(c.buffer))},r.deflate=function(c,g,E){if(g=r.decode64(c.deflate(r.encode64(g)).rval),E){var A=2,I=g.charCodeAt(1);I&32&&(A=6),g=g.substring(A,g.length-4)}return g},r.inflate=function(c,g,E){var A=c.inflate(r.encode64(g)).rval;return A===null?null:r.decode64(A)};var m=function(c,g,E){if(!c)throw new Error("WebStorage not available.");var A;if(E===null?A=c.removeItem(g):(E=r.encode64(JSON.stringify(E)),A=c.setItem(g,E)),typeof A<"u"&&A.rval!==!0){var I=new Error(A.error.message);throw I.id=A.error.id,I.name=A.error.name,I}},B=function(c,g){if(!c)throw new Error("WebStorage not available.");var E=c.getItem(g);if(c.init)if(E.rval===null){if(E.error){var A=new Error(E.error.message);throw A.id=E.error.id,A.name=E.error.name,A}E=null}else E=E.rval;return E!==null&&(E=JSON.parse(r.decode64(E))),E},v=function(c,g,E,A){var I=B(c,g);I===null&&(I={}),I[E]=A,m(c,g,I)},d=function(c,g,E){var A=B(c,g);return A!==null&&(A=E in A?A[E]:null),A},p=function(c,g,E){var A=B(c,g);if(A!==null&&E in A){delete A[E];var I=!0;for(var x in A){I=!1;break}I&&(A=null),m(c,g,A)}},b=function(c,g){m(c,g,null)},S=function(c,g,E){var A=null;typeof E>"u"&&(E=["web","flash"]);var I,x=!1,l=null;for(var s in E){I=E[s];try{if(I==="flash"||I==="both"){if(g[0]===null)throw new Error("Flash local storage not available.");A=c.apply(this,g),x=I==="flash"}(I==="web"||I==="both")&&(g[0]=localStorage,A=c.apply(this,g),x=!0)}catch(w){l=w}if(x)break}if(!x)throw l;return A};return r.setItem=function(c,g,E,A,I){S(v,arguments,I)},r.getItem=function(c,g,E,A){return S(d,arguments,A)},r.removeItem=function(c,g,E,A){S(p,arguments,A)},r.clearItems=function(c,g,E){S(b,arguments,E)},r.isEmpty=function(c){for(var g in c)if(c.hasOwnProperty(g))return!1;return!0},r.format=function(c){for(var g=/%./g,E,A,I=0,x=[],l=0;E=g.exec(c);){A=c.substring(l,g.lastIndex-2),A.length>0&&x.push(A),l=g.lastIndex;var s=E[0][1];switch(s){case"s":case"o":I<arguments.length?x.push(arguments[I+++1]):x.push("<?>");break;case"%":x.push("%");break;default:x.push("<%"+s+"?>")}}return x.push(c.substring(l)),x.join("")},r.formatNumber=function(c,g,E,A){var I=c,x=isNaN(g=Math.abs(g))?2:g,l=E===void 0?",":E,s=A===void 0?".":A,w=I<0?"-":"",N=parseInt(I=Math.abs(+I||0).toFixed(x),10)+"",K=N.length>3?N.length%3:0;return w+(K?N.substr(0,K)+s:"")+N.substr(K).replace(/(\d{3})(?=\d)/g,"$1"+s)+(x?l+Math.abs(I-N).toFixed(x).slice(2):"")},r.formatSize=function(c){return c>=1073741824?c=r.formatNumber(c/1073741824,2,".","")+" GiB":c>=1048576?c=r.formatNumber(c/1048576,2,".","")+" MiB":c>=1024?c=r.formatNumber(c/1024,0)+" KiB":c=r.formatNumber(c,0)+" bytes",c},r.bytesFromIP=function(c){return c.indexOf(".")!==-1?r.bytesFromIPv4(c):c.indexOf(":")!==-1?r.bytesFromIPv6(c):null},r.bytesFromIPv4=function(c){if(c=c.split("."),c.length!==4)return null;for(var g=r.createBuffer(),E=0;E<c.length;++E){var A=parseInt(c[E],10);if(isNaN(A))return null;g.putByte(A)}return g.getBytes()},r.bytesFromIPv6=function(c){var g=0;c=c.split(":").filter(function(l){return l.length===0&&++g,!0});for(var E=(8-c.length+g)*2,A=r.createBuffer(),I=0;I<8;++I){if(!c[I]||c[I].length===0){A.fillWithByte(0,E),E=0;continue}var x=r.hexToBytes(c[I]);x.length<2&&A.putByte(0),A.putBytes(x)}return A.getBytes()},r.bytesToIP=function(c){return c.length===4?r.bytesToIPv4(c):c.length===16?r.bytesToIPv6(c):null},r.bytesToIPv4=function(c){if(c.length!==4)return null;for(var g=[],E=0;E<c.length;++E)g.push(c.charCodeAt(E));return g.join(".")},r.bytesToIPv6=function(c){if(c.length!==16)return null;for(var g=[],E=[],A=0,I=0;I<c.length;I+=2){for(var x=r.bytesToHex(c[I]+c[I+1]);x[0]==="0"&&x!=="0";)x=x.substr(1);if(x==="0"){var l=E[E.length-1],s=g.length;!l||s!==l.end+1?E.push({start:s,end:s}):(l.end=s,l.end-l.start>E[A].end-E[A].start&&(A=E.length-1))}g.push(x)}if(E.length>0){var w=E[A];w.end-w.start>0&&(g.splice(w.start,w.end-w.start+1,""),w.start===0&&g.unshift(""),w.end===7&&g.push(""))}return g.join(":")},r.estimateCores=function(c,g){if(typeof c=="function"&&(g=c,c={}),c=c||{},"cores"in r&&!c.update)return g(null,r.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return r.cores=navigator.hardwareConcurrency,g(null,r.cores);if(typeof Worker>"u")return r.cores=1,g(null,r.cores);if(typeof Blob>"u")return r.cores=2,g(null,r.cores);var E=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(l){var s=Date.now(),w=s+4;self.postMessage({st:s,et:w})})}).toString(),")()"],{type:"application/javascript"}));A([],5,16);function A(l,s,w){if(s===0){var N=Math.floor(l.reduce(function(K,_){return K+_},0)/l.length);return r.cores=Math.max(1,N),URL.revokeObjectURL(E),g(null,r.cores)}I(w,function(K,_){l.push(x(w,_)),A(l,s-1,w)})}function I(l,s){for(var w=[],N=[],K=0;K<l;++K){var _=new Worker(E);_.addEventListener("message",function(D){if(N.push(D.data),N.length===l){for(var V=0;V<l;++V)w[V].terminate();s(null,N)}}),w.push(_)}for(var K=0;K<l;++K)w[K].postMessage(K)}function x(l,s){for(var w=[],N=0;N<l;++N)for(var K=s[N],_=w[N]=[],D=0;D<l;++D)if(N!==D){var V=s[D];(K.st>V.st&&K.st<V.et||V.st>K.st&&V.st<K.et)&&_.push(D)}return w.reduce(function(P,M){return Math.max(P,M.length)},0)}},Kn.exports}var Vn,Ai;function $a(){if(Ai)return Vn;Ai=1;var t=ge();Ee(),Vn=t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(r,a){var f=r;if(typeof f=="string"&&(f=t.cipher.getAlgorithm(f),f&&(f=f())),!f)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:f,key:a,decrypt:!1})},t.cipher.createDecipher=function(r,a){var f=r;if(typeof f=="string"&&(f=t.cipher.getAlgorithm(f),f&&(f=f())),!f)throw new Error("Unsupported algorithm: "+r);return new t.cipher.BlockCipher({algorithm:f,key:a,decrypt:!0})},t.cipher.registerAlgorithm=function(r,a){r=r.toUpperCase(),t.cipher.algorithms[r]=a},t.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in t.cipher.algorithms?t.cipher.algorithms[r]:null};var e=t.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};return e.prototype.start=function(r){r=r||{};var a={};for(var f in r)a[f]=r[f];a.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=r.output||t.util.createBuffer(),this.mode.start(a)},e.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(f){return r(this.blockSize,f,!1)},this.mode.unpad=function(f){return r(this.blockSize,f,!0)});var a={};return a.decrypt=this._decrypt,a.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,a)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,a))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,a))},Vn}var Fn={exports:{}},Ti;function bo(){if(Ti)return Fn.exports;Ti=1;var t=ge();Ee(),t.cipher=t.cipher||{};var e=Fn.exports=t.cipher.modes=t.cipher.modes||{};e.ecb=function(o){o=o||{},this.name="ECB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(o){},e.ecb.prototype.encrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u])},e.ecb.prototype.decrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u])},e.ecb.prototype.pad=function(o,i){var n=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();return o.fillWithByte(n,n),!0},e.ecb.prototype.unpad=function(o,i){if(i.overflow>0)return!1;var n=o.length(),u=o.at(n-1);return u>this.blockSize<<2?!1:(o.truncate(u),!0)},e.cbc=function(o){o=o||{},this.name="CBC",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(o){if(o.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in o)this._iv=r(o.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=this._prev[u]^o.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._outBlock[u]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(o,i,n){if(o.length()<this.blockSize&&!(n&&o.length()>0))return!0;for(var u=0;u<this._ints;++u)this._inBlock[u]=o.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var u=0;u<this._ints;++u)i.putInt32(this._prev[u]^this._outBlock[u]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(o,i){var n=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();return o.fillWithByte(n,n),!0},e.cbc.prototype.unpad=function(o,i){if(i.overflow>0)return!1;var n=o.length(),u=o.at(n-1);return u>this.blockSize<<2?!1:(o.truncate(u),!0)},e.cfb=function(o){o=o||{},this.name="CFB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var h=0;h<this._ints;++h)this._inBlock[h]=o.getInt32()^this._outBlock[h],i.putInt32(this._inBlock[h]);return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialBlock[h]=o.getInt32()^this._outBlock[h],this._partialOutput.putInt32(this._partialBlock[h]);if(m>0)o.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._partialBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var h=0;h<this._ints;++h)this._inBlock[h]=o.getInt32(),i.putInt32(this._inBlock[h]^this._outBlock[h]);return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialBlock[h]=o.getInt32(),this._partialOutput.putInt32(this._partialBlock[h]^this._outBlock[h]);if(m>0)o.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._partialBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.ofb=function(o){o=o||{},this.name="OFB",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(o,i,n){var u=o.length();if(o.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var h=0;h<this._ints;++h)i.putInt32(o.getInt32()^this._outBlock[h]),this._inBlock[h]=this._outBlock[h];return}var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(o.getInt32()^this._outBlock[h]);if(m>0)o.read-=this.blockSize;else for(var h=0;h<this._ints;++h)this._inBlock[h]=this._outBlock[h];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(o){o=o||{},this.name="CTR",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");this._iv=r(o.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize)for(var h=0;h<this._ints;++h)i.putInt32(o.getInt32()^this._outBlock[h]);else{var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(o.getInt32()^this._outBlock[h]);if(m>0&&(o.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0}a(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(o){o=o||{},this.name="GCM",this.cipher=o.cipher,this.blockSize=o.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(o){if(!("iv"in o))throw new Error("Invalid IV parameter.");var i=t.util.createBuffer(o.iv);this._cipherLength=0;var n;if("additionalData"in o?n=t.util.createBuffer(o.additionalData):n=t.util.createBuffer(),"tagLength"in o?this._tagLength=o.tagLength:this._tagLength=128,this._tag=null,o.decrypt&&(this._tag=t.util.createBuffer(o.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var u=i.length();if(u===12)this._j0=[i.getInt32(),i.getInt32(),i.getInt32(),1];else{for(this._j0=[0,0,0,0];i.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[i.getInt32(),i.getInt32(),i.getInt32(),i.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(f(u*8)))}this._inBlock=this._j0.slice(0),a(this._inBlock),this._partialBytes=0,n=t.util.createBuffer(n),this._aDataLength=f(n.length()*8);var h=n.length()%this.blockSize;for(h&&n.fillWithByte(0,this.blockSize-h),this._s=[0,0,0,0];n.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()])},e.gcm.prototype.encrypt=function(o,i,n){var u=o.length();if(u===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&u>=this.blockSize){for(var h=0;h<this._ints;++h)i.putInt32(this._outBlock[h]^=o.getInt32());this._cipherLength+=this.blockSize}else{var m=(this.blockSize-u)%this.blockSize;m>0&&(m=this.blockSize-m),this._partialOutput.clear();for(var h=0;h<this._ints;++h)this._partialOutput.putInt32(o.getInt32()^this._outBlock[h]);if(m<=0||n){if(n){var B=u%this.blockSize;this._cipherLength+=B,this._partialOutput.truncate(this.blockSize-B)}else this._cipherLength+=this.blockSize;for(var h=0;h<this._ints;++h)this._outBlock[h]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),m>0&&!n)return o.read-=this.blockSize,i.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=m,!0;i.putBytes(this._partialOutput.getBytes(u-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),a(this._inBlock)},e.gcm.prototype.decrypt=function(o,i,n){var u=o.length();if(u<this.blockSize&&!(n&&u>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),a(this._inBlock),this._hashBlock[0]=o.getInt32(),this._hashBlock[1]=o.getInt32(),this._hashBlock[2]=o.getInt32(),this._hashBlock[3]=o.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var h=0;h<this._ints;++h)i.putInt32(this._outBlock[h]^this._hashBlock[h]);u<this.blockSize?this._cipherLength+=u%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(o,i){var n=!0;i.decrypt&&i.overflow&&o.truncate(this.blockSize-i.overflow),this.tag=t.util.createBuffer();var u=this._aDataLength.concat(f(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,u);var h=[];this.cipher.encrypt(this._j0,h);for(var m=0;m<this._ints;++m)this.tag.putInt32(this._s[m]^h[m]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),i.decrypt&&this.tag.bytes()!==this._tag&&(n=!1),n},e.gcm.prototype.multiply=function(o,i){for(var n=[0,0,0,0],u=i.slice(0),h=0;h<128;++h){var m=o[h/32|0]&1<<31-h%32;m&&(n[0]^=u[0],n[1]^=u[1],n[2]^=u[2],n[3]^=u[3]),this.pow(u,u)}return n},e.gcm.prototype.pow=function(o,i){for(var n=o[3]&1,u=3;u>0;--u)i[u]=o[u]>>>1|(o[u-1]&1)<<31;i[0]=o[0]>>>1,n&&(i[0]^=this._R)},e.gcm.prototype.tableMultiply=function(o){for(var i=[0,0,0,0],n=0;n<32;++n){var u=n/8|0,h=o[u]>>>(7-n%8)*4&15,m=this._m[n][h];i[0]^=m[0],i[1]^=m[1],i[2]^=m[2],i[3]^=m[3]}return i},e.gcm.prototype.ghash=function(o,i,n){return i[0]^=n[0],i[1]^=n[1],i[2]^=n[2],i[3]^=n[3],this.tableMultiply(i)},e.gcm.prototype.generateHashTable=function(o,i){for(var n=8/i,u=4*n,h=16*n,m=new Array(h),B=0;B<h;++B){var v=[0,0,0,0],d=B/u|0,p=(u-1-B%u)*i;v[d]=1<<i-1<<p,m[B]=this.generateSubHashTable(this.multiply(v,o),i)}return m},e.gcm.prototype.generateSubHashTable=function(o,i){var n=1<<i,u=n>>>1,h=new Array(n);h[u]=o.slice(0);for(var m=u>>>1;m>0;)this.pow(h[2*m],h[m]=[]),m>>=1;for(m=2;m<u;){for(var B=1;B<m;++B){var v=h[m],d=h[B];h[m+B]=[v[0]^d[0],v[1]^d[1],v[2]^d[2],v[3]^d[3]]}m*=2}for(h[0]=[0,0,0,0],m=u+1;m<n;++m){var p=h[m^u];h[m]=[o[0]^p[0],o[1]^p[1],o[2]^p[2],o[3]^p[3]]}return h};function r(o,i){if(typeof o=="string"&&(o=t.util.createBuffer(o)),t.util.isArray(o)&&o.length>4){var n=o;o=t.util.createBuffer();for(var u=0;u<n.length;++u)o.putByte(n[u])}if(o.length()<i)throw new Error("Invalid IV length; got "+o.length()+" bytes and expected "+i+" bytes.");if(!t.util.isArray(o)){for(var h=[],m=i/4,u=0;u<m;++u)h.push(o.getInt32());o=h}return o}function a(o){o[o.length-1]=o[o.length-1]+1&4294967295}function f(o){return[o/4294967296|0,o&4294967295]}return Fn.exports}var Mn,Ii;function dr(){if(Ii)return Mn;Ii=1;var t=ge();$a(),bo(),Ee(),Mn=t.aes=t.aes||{},t.aes.startEncrypting=function(d,p,b,S){var c=v({key:d,output:b,decrypt:!1,mode:S});return c.start(p),c},t.aes.createEncryptionCipher=function(d,p){return v({key:d,output:null,decrypt:!1,mode:p})},t.aes.startDecrypting=function(d,p,b,S){var c=v({key:d,output:b,decrypt:!0,mode:S});return c.start(p),c},t.aes.createDecryptionCipher=function(d,p){return v({key:d,output:null,decrypt:!0,mode:p})},t.aes.Algorithm=function(d,p){r||h();var b=this;b.name=d,b.mode=new p({blockSize:16,cipher:{encrypt:function(S,c){return B(b._w,S,c,!1)},decrypt:function(S,c){return B(b._w,S,c,!0)}}}),b._init=!1},t.aes.Algorithm.prototype.initialize=function(d){if(!this._init){var p=d.key,b;if(typeof p=="string"&&(p.length===16||p.length===24||p.length===32))p=t.util.createBuffer(p);else if(t.util.isArray(p)&&(p.length===16||p.length===24||p.length===32)){b=p,p=t.util.createBuffer();for(var S=0;S<b.length;++S)p.putByte(b[S])}if(!t.util.isArray(p)){b=p,p=[];var c=b.length();if(c===16||c===24||c===32){c=c>>>2;for(var S=0;S<c;++S)p.push(b.getInt32())}}if(!t.util.isArray(p)||!(p.length===4||p.length===6||p.length===8))throw new Error("Invalid key parameter.");var g=this.mode.name,E=["CFB","OFB","CTR","GCM"].indexOf(g)!==-1;this._w=m(p,d.decrypt&&!E),this._init=!0}},t.aes._expandKey=function(d,p){return r||h(),m(d,p)},t.aes._updateBlock=B,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);function e(d,p){var b=function(){return new t.aes.Algorithm(d,p)};t.cipher.registerAlgorithm(d,b)}var r=!1,a=4,f,o,i,n,u;function h(){r=!0,i=[0,1,2,4,8,16,32,64,128,27,54];for(var d=new Array(256),p=0;p<128;++p)d[p]=p<<1,d[p+128]=p+128<<1^283;f=new Array(256),o=new Array(256),n=new Array(4),u=new Array(4);for(var p=0;p<4;++p)n[p]=new Array(256),u[p]=new Array(256);for(var b=0,S=0,c,g,E,A,I,x,l,p=0;p<256;++p){A=S^S<<1^S<<2^S<<3^S<<4,A=A>>8^A&255^99,f[b]=A,o[A]=b,I=d[A],c=d[b],g=d[c],E=d[g],x=I<<24^A<<16^A<<8^(A^I),l=(c^g^E)<<24^(b^E)<<16^(b^g^E)<<8^(b^c^E);for(var s=0;s<4;++s)n[s][b]=x,u[s][A]=l,x=x<<24|x>>>8,l=l<<24|l>>>8;b===0?b=S=1:(b=c^d[d[d[c^E]]],S^=d[d[S]])}}function m(d,p){for(var b=d.slice(0),S,c=1,g=b.length,E=g+6+1,A=a*E,I=g;I<A;++I)S=b[I-1],I%g===0?(S=f[S>>>16&255]<<24^f[S>>>8&255]<<16^f[S&255]<<8^f[S>>>24]^i[c]<<24,c++):g>6&&I%g===4&&(S=f[S>>>24]<<24^f[S>>>16&255]<<16^f[S>>>8&255]<<8^f[S&255]),b[I]=b[I-g]^S;if(p){var x,l=u[0],s=u[1],w=u[2],N=u[3],K=b.slice(0);A=b.length;for(var I=0,_=A-a;I<A;I+=a,_-=a)if(I===0||I===A-a)K[I]=b[_],K[I+1]=b[_+3],K[I+2]=b[_+2],K[I+3]=b[_+1];else for(var D=0;D<a;++D)x=b[_+D],K[I+(3&-D)]=l[f[x>>>24]]^s[f[x>>>16&255]]^w[f[x>>>8&255]]^N[f[x&255]];b=K}return b}function B(d,p,b,S){var c=d.length/4-1,g,E,A,I,x;S?(g=u[0],E=u[1],A=u[2],I=u[3],x=o):(g=n[0],E=n[1],A=n[2],I=n[3],x=f);var l,s,w,N,K,_,D;l=p[0]^d[0],s=p[S?3:1]^d[1],w=p[2]^d[2],N=p[S?1:3]^d[3];for(var V=3,P=1;P<c;++P)K=g[l>>>24]^E[s>>>16&255]^A[w>>>8&255]^I[N&255]^d[++V],_=g[s>>>24]^E[w>>>16&255]^A[N>>>8&255]^I[l&255]^d[++V],D=g[w>>>24]^E[N>>>16&255]^A[l>>>8&255]^I[s&255]^d[++V],N=g[N>>>24]^E[l>>>16&255]^A[s>>>8&255]^I[w&255]^d[++V],l=K,s=_,w=D;b[0]=x[l>>>24]<<24^x[s>>>16&255]<<16^x[w>>>8&255]<<8^x[N&255]^d[++V],b[S?3:1]=x[s>>>24]<<24^x[w>>>16&255]<<16^x[N>>>8&255]<<8^x[l&255]^d[++V],b[2]=x[w>>>24]<<24^x[N>>>16&255]<<16^x[l>>>8&255]<<8^x[s&255]^d[++V],b[S?1:3]=x[N>>>24]<<24^x[l>>>16&255]<<16^x[s>>>8&255]<<8^x[w&255]^d[++V]}function v(d){d=d||{};var p=(d.mode||"CBC").toUpperCase(),b="AES-"+p,S;d.decrypt?S=t.cipher.createDecipher(b,d.key):S=t.cipher.createCipher(b,d.key);var c=S.start;return S.start=function(g,E){var A=null;E instanceof t.util.ByteBuffer&&(A=E,E={}),E=E||{},E.output=A,E.iv=g,c.call(S,E)},S}return Mn}var Hn={exports:{}},qn={exports:{}},Gn={exports:{}},_i;function pr(){if(_i)return Gn.exports;_i=1;var t=ge();t.pki=t.pki||{};var e=Gn.exports=t.pki.oids=t.oids=t.oids||{};function r(f,o){e[f]=o,e[o]=f}function a(f,o){e[f]=o}return r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("1.3.14.3.2.29","sha1WithRSASignature"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("2.16.840.1.101.3.4.2.4","sha224"),r("2.16.840.1.101.3.4.2.5","sha512-224"),r("2.16.840.1.101.3.4.2.6","sha512-256"),r("1.2.840.113549.2.2","md2"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.4","surname"),r("2.5.4.5","serialNumber"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.12","title"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("2.5.4.42","givenName"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),a("2.5.29.1","authorityKeyIdentifier"),a("2.5.29.2","keyAttributes"),a("2.5.29.3","certificatePolicies"),a("2.5.29.4","keyUsageRestriction"),a("2.5.29.5","policyMapping"),a("2.5.29.6","subtreesConstraint"),a("2.5.29.7","subjectAltName"),a("2.5.29.8","issuerAltName"),a("2.5.29.9","subjectDirectoryAttributes"),a("2.5.29.10","basicConstraints"),a("2.5.29.11","nameConstraints"),a("2.5.29.12","policyConstraints"),a("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),a("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),a("2.5.29.20","cRLNumber"),a("2.5.29.21","cRLReason"),a("2.5.29.22","expirationDate"),a("2.5.29.23","instructionCode"),a("2.5.29.24","invalidityDate"),a("2.5.29.25","cRLDistributionPoints"),a("2.5.29.26","issuingDistributionPoint"),a("2.5.29.27","deltaCRLIndicator"),a("2.5.29.28","issuingDistributionPoint"),a("2.5.29.29","certificateIssuer"),a("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),a("2.5.29.33","policyMappings"),a("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),a("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),a("2.5.29.46","freshestCRL"),a("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping"),Gn.exports}var Ri;function Dt(){if(Ri)return qn.exports;Ri=1;var t=ge();Ee(),pr();var e=qn.exports=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(i,n,u,h,m){if(t.util.isArray(h)){for(var B=[],v=0;v<h.length;++v)h[v]!==void 0&&B.push(h[v]);h=B}var d={tagClass:i,type:n,constructed:u,composed:u||t.util.isArray(h),value:h};return m&&"bitStringContents"in m&&(d.bitStringContents=m.bitStringContents,d.original=e.copy(d)),d},e.copy=function(i,n){var u;if(t.util.isArray(i)){u=[];for(var h=0;h<i.length;++h)u.push(e.copy(i[h],n));return u}return typeof i=="string"?i:(u={tagClass:i.tagClass,type:i.type,constructed:i.constructed,composed:i.composed,value:e.copy(i.value,n)},n&&!n.excludeBitStringContents&&(u.bitStringContents=i.bitStringContents),u)},e.equals=function(i,n,u){if(t.util.isArray(i)){if(!t.util.isArray(n)||i.length!==n.length)return!1;for(var h=0;h<i.length;++h)if(!e.equals(i[h],n[h]))return!1;return!0}if(typeof i!=typeof n)return!1;if(typeof i=="string")return i===n;var m=i.tagClass===n.tagClass&&i.type===n.type&&i.constructed===n.constructed&&i.composed===n.composed&&e.equals(i.value,n.value);return u&&u.includeBitStringContents&&(m=m&&i.bitStringContents===n.bitStringContents),m},e.getBerValueLength=function(i){var n=i.getByte();if(n!==128){var u,h=n&128;return h?u=i.getInt((n&127)<<3):u=n,u}};function r(i,n,u){if(u>n){var h=new Error("Too few bytes to parse DER.");throw h.available=i.length(),h.remaining=n,h.requested=u,h}}var a=function(i,n){var u=i.getByte();if(n--,u!==128){var h,m=u&128;if(!m)h=u;else{var B=u&127;r(i,n,B),h=i.getInt(B<<3)}if(h<0)throw new Error("Negative length: "+h);return h}};e.fromDer=function(i,n){n===void 0&&(n={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof n=="boolean"&&(n={strict:n,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in n||(n.strict=!0),"parseAllBytes"in n||(n.parseAllBytes=!0),"decodeBitStrings"in n||(n.decodeBitStrings=!0),typeof i=="string"&&(i=t.util.createBuffer(i));var u=i.length(),h=f(i,i.length(),0,n);if(n.parseAllBytes&&i.length()!==0){var m=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw m.byteCount=u,m.remaining=i.length(),m}return h};function f(i,n,u,h){var m;r(i,n,2);var B=i.getByte();n--;var v=B&192,d=B&31;m=i.length();var p=a(i,n);if(n-=m-i.length(),p!==void 0&&p>n){if(h.strict){var b=new Error("Too few bytes to read ASN.1 value.");throw b.available=i.length(),b.remaining=n,b.requested=p,b}p=n}var S,c,g=(B&32)===32;if(g)if(S=[],p===void 0)for(;;){if(r(i,n,2),i.bytes(2)==="\0\0"){i.getBytes(2),n-=2;break}m=i.length(),S.push(f(i,n,u+1,h)),n-=m-i.length()}else for(;p>0;)m=i.length(),S.push(f(i,p,u+1,h)),n-=m-i.length(),p-=m-i.length();if(S===void 0&&v===e.Class.UNIVERSAL&&d===e.Type.BITSTRING&&(c=i.bytes(p)),S===void 0&&h.decodeBitStrings&&v===e.Class.UNIVERSAL&&d===e.Type.BITSTRING&&p>1){var E=i.read,A=n,I=0;if(d===e.Type.BITSTRING&&(r(i,n,1),I=i.getByte(),n--),I===0)try{m=i.length();var x={strict:!0,decodeBitStrings:!0},l=f(i,n,u+1,x),s=m-i.length();n-=s,d==e.Type.BITSTRING&&s++;var w=l.tagClass;s===p&&(w===e.Class.UNIVERSAL||w===e.Class.CONTEXT_SPECIFIC)&&(S=[l])}catch{}S===void 0&&(i.read=E,n=A)}if(S===void 0){if(p===void 0){if(h.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=n}if(d===e.Type.BMPSTRING)for(S="";p>0;p-=2)r(i,n,2),S+=String.fromCharCode(i.getInt16()),n-=2;else S=i.getBytes(p),n-=p}var N=c===void 0?null:{bitStringContents:c};return e.create(v,d,g,S,N)}e.toDer=function(i){var n=t.util.createBuffer(),u=i.tagClass|i.type,h=t.util.createBuffer(),m=!1;if("bitStringContents"in i&&(m=!0,i.original&&(m=e.equals(i,i.original))),m)h.putBytes(i.bitStringContents);else if(i.composed){i.constructed?u|=32:h.putByte(0);for(var B=0;B<i.value.length;++B)i.value[B]!==void 0&&h.putBuffer(e.toDer(i.value[B]))}else if(i.type===e.Type.BMPSTRING)for(var B=0;B<i.value.length;++B)h.putInt16(i.value.charCodeAt(B));else i.type===e.Type.INTEGER&&i.value.length>1&&(i.value.charCodeAt(0)===0&&(i.value.charCodeAt(1)&128)===0||i.value.charCodeAt(0)===255&&(i.value.charCodeAt(1)&128)===128)?h.putBytes(i.value.substr(1)):h.putBytes(i.value);if(n.putByte(u),h.length()<=127)n.putByte(h.length()&127);else{var v=h.length(),d="";do d+=String.fromCharCode(v&255),v=v>>>8;while(v>0);n.putByte(d.length|128);for(var B=d.length-1;B>=0;--B)n.putByte(d.charCodeAt(B))}return n.putBuffer(h),n},e.oidToDer=function(i){var n=i.split("."),u=t.util.createBuffer();u.putByte(40*parseInt(n[0],10)+parseInt(n[1],10));for(var h,m,B,v,d=2;d<n.length;++d){h=!0,m=[],B=parseInt(n[d],10);do v=B&127,B=B>>>7,h||(v|=128),m.push(v),h=!1;while(B>0);for(var p=m.length-1;p>=0;--p)u.putByte(m[p])}return u},e.derToOid=function(i){var n;typeof i=="string"&&(i=t.util.createBuffer(i));var u=i.getByte();n=Math.floor(u/40)+"."+u%40;for(var h=0;i.length()>0;)u=i.getByte(),h=h<<7,u&128?h+=u&127:(n+="."+(h+u),h=0);return n},e.utcTimeToDate=function(i){var n=new Date,u=parseInt(i.substr(0,2),10);u=u>=50?1900+u:2e3+u;var h=parseInt(i.substr(2,2),10)-1,m=parseInt(i.substr(4,2),10),B=parseInt(i.substr(6,2),10),v=parseInt(i.substr(8,2),10),d=0;if(i.length>11){var p=i.charAt(10),b=10;p!=="+"&&p!=="-"&&(d=parseInt(i.substr(10,2),10),b+=2)}if(n.setUTCFullYear(u,h,m),n.setUTCHours(B,v,d,0),b&&(p=i.charAt(b),p==="+"||p==="-")){var S=parseInt(i.substr(b+1,2),10),c=parseInt(i.substr(b+4,2),10),g=S*60+c;g*=6e4,p==="+"?n.setTime(+n-g):n.setTime(+n+g)}return n},e.generalizedTimeToDate=function(i){var n=new Date,u=parseInt(i.substr(0,4),10),h=parseInt(i.substr(4,2),10)-1,m=parseInt(i.substr(6,2),10),B=parseInt(i.substr(8,2),10),v=parseInt(i.substr(10,2),10),d=parseInt(i.substr(12,2),10),p=0,b=0,S=!1;i.charAt(i.length-1)==="Z"&&(S=!0);var c=i.length-5,g=i.charAt(c);if(g==="+"||g==="-"){var E=parseInt(i.substr(c+1,2),10),A=parseInt(i.substr(c+4,2),10);b=E*60+A,b*=6e4,g==="+"&&(b*=-1),S=!0}return i.charAt(14)==="."&&(p=parseFloat(i.substr(14),10)*1e3),S?(n.setUTCFullYear(u,h,m),n.setUTCHours(B,v,d,p),n.setTime(+n+b)):(n.setFullYear(u,h,m),n.setHours(B,v,d,p)),n},e.dateToUtcTime=function(i){if(typeof i=="string")return i;var n="",u=[];u.push((""+i.getUTCFullYear()).substr(2)),u.push(""+(i.getUTCMonth()+1)),u.push(""+i.getUTCDate()),u.push(""+i.getUTCHours()),u.push(""+i.getUTCMinutes()),u.push(""+i.getUTCSeconds());for(var h=0;h<u.length;++h)u[h].length<2&&(n+="0"),n+=u[h];return n+="Z",n},e.dateToGeneralizedTime=function(i){if(typeof i=="string")return i;var n="",u=[];u.push(""+i.getUTCFullYear()),u.push(""+(i.getUTCMonth()+1)),u.push(""+i.getUTCDate()),u.push(""+i.getUTCHours()),u.push(""+i.getUTCMinutes()),u.push(""+i.getUTCSeconds());for(var h=0;h<u.length;++h)u[h].length<2&&(n+="0"),n+=u[h];return n+="Z",n},e.integerToDer=function(i){var n=t.util.createBuffer();if(i>=-128&&i<128)return n.putSignedInt(i,8);if(i>=-32768&&i<32768)return n.putSignedInt(i,16);if(i>=-8388608&&i<8388608)return n.putSignedInt(i,24);if(i>=-2147483648&&i<2147483648)return n.putSignedInt(i,32);var u=new Error("Integer too large; max is 32-bits.");throw u.integer=i,u},e.derToInteger=function(i){typeof i=="string"&&(i=t.util.createBuffer(i));var n=i.length()*8;if(n>32)throw new Error("Integer too large; max is 32-bits.");return i.getSignedInt(n)},e.validate=function(i,n,u,h){var m=!1;if((i.tagClass===n.tagClass||typeof n.tagClass>"u")&&(i.type===n.type||typeof n.type>"u"))if(i.constructed===n.constructed||typeof n.constructed>"u"){if(m=!0,n.value&&t.util.isArray(n.value))for(var B=0,v=0;m&&v<n.value.length;++v)m=n.value[v].optional||!1,i.value[B]&&(m=e.validate(i.value[B],n.value[v],u,h),m?++B:n.value[v].optional&&(m=!0)),!m&&h&&h.push("["+n.name+'] Tag class "'+n.tagClass+'", type "'+n.type+'" expected value length "'+n.value.length+'", got "'+i.value.length+'"');if(m&&u&&(n.capture&&(u[n.capture]=i.value),n.captureAsn1&&(u[n.captureAsn1]=i),n.captureBitStringContents&&"bitStringContents"in i&&(u[n.captureBitStringContents]=i.bitStringContents),n.captureBitStringValue&&"bitStringContents"in i))if(i.bitStringContents.length<2)u[n.captureBitStringValue]="";else{var d=i.bitStringContents.charCodeAt(0);if(d!==0)throw new Error("captureBitStringValue only supported for zero unused bits");u[n.captureBitStringValue]=i.bitStringContents.slice(1)}}else h&&h.push("["+n.name+'] Expected constructed "'+n.constructed+'", got "'+i.constructed+'"');else h&&(i.tagClass!==n.tagClass&&h.push("["+n.name+'] Expected tag class "'+n.tagClass+'", got "'+i.tagClass+'"'),i.type!==n.type&&h.push("["+n.name+'] Expected type "'+n.type+'", got "'+i.type+'"'));return m};var o=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(i,n,u){var h="";n=n||0,u=u||2,n>0&&(h+=`
`);for(var m="",B=0;B<n*u;++B)m+=" ";switch(h+=m+"Tag: ",i.tagClass){case e.Class.UNIVERSAL:h+="Universal:";break;case e.Class.APPLICATION:h+="Application:";break;case e.Class.CONTEXT_SPECIFIC:h+="Context-Specific:";break;case e.Class.PRIVATE:h+="Private:";break}if(i.tagClass===e.Class.UNIVERSAL)switch(h+=i.type,i.type){case e.Type.NONE:h+=" (None)";break;case e.Type.BOOLEAN:h+=" (Boolean)";break;case e.Type.INTEGER:h+=" (Integer)";break;case e.Type.BITSTRING:h+=" (Bit string)";break;case e.Type.OCTETSTRING:h+=" (Octet string)";break;case e.Type.NULL:h+=" (Null)";break;case e.Type.OID:h+=" (Object Identifier)";break;case e.Type.ODESC:h+=" (Object Descriptor)";break;case e.Type.EXTERNAL:h+=" (External or Instance of)";break;case e.Type.REAL:h+=" (Real)";break;case e.Type.ENUMERATED:h+=" (Enumerated)";break;case e.Type.EMBEDDED:h+=" (Embedded PDV)";break;case e.Type.UTF8:h+=" (UTF8)";break;case e.Type.ROID:h+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:h+=" (Sequence)";break;case e.Type.SET:h+=" (Set)";break;case e.Type.PRINTABLESTRING:h+=" (Printable String)";break;case e.Type.IA5String:h+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:h+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:h+=" (Generalized time)";break;case e.Type.BMPSTRING:h+=" (BMP String)";break}else h+=i.type;if(h+=`
`,h+=m+"Constructed: "+i.constructed+`
`,i.composed){for(var v=0,d="",B=0;B<i.value.length;++B)i.value[B]!==void 0&&(v+=1,d+=e.prettyPrint(i.value[B],n+1,u),B+1<i.value.length&&(d+=","));h+=m+"Sub values: "+v+d}else{if(h+=m+"Value: ",i.type===e.Type.OID){var p=e.derToOid(i.value);h+=p,t.pki&&t.pki.oids&&p in t.pki.oids&&(h+=" ("+t.pki.oids[p]+") ")}if(i.type===e.Type.INTEGER)try{h+=e.derToInteger(i.value)}catch{h+="0x"+t.util.bytesToHex(i.value)}else if(i.type===e.Type.BITSTRING){if(i.value.length>1?h+="0x"+t.util.bytesToHex(i.value.slice(1)):h+="(none)",i.value.length>0){var b=i.value.charCodeAt(0);b==1?h+=" (1 unused bit shown)":b>1&&(h+=" ("+b+" unused bits shown)")}}else if(i.type===e.Type.OCTETSTRING)o.test(i.value)||(h+="("+i.value+") "),h+="0x"+t.util.bytesToHex(i.value);else if(i.type===e.Type.UTF8)try{h+=t.util.decodeUtf8(i.value)}catch(S){if(S.message==="URI malformed")h+="0x"+t.util.bytesToHex(i.value)+" (malformed UTF8)";else throw S}else i.type===e.Type.PRINTABLESTRING||i.type===e.Type.IA5String?h+=i.value:o.test(i.value)?h+="0x"+t.util.bytesToHex(i.value):i.value.length===0?h+="[null]":h+=i.value}return h},qn.exports}var $n={exports:{}},zn,Ni;function $t(){if(Ni)return zn;Ni=1;var t=ge();return zn=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},zn}var ki;function Hr(){if(ki)return $n.exports;ki=1;var t=ge();$t(),Ee();var e=$n.exports=t.hmac=t.hmac||{};return e.create=function(){var r=null,a=null,f=null,o=null,i={};return i.start=function(n,u){if(n!==null)if(typeof n=="string")if(n=n.toLowerCase(),n in t.md.algorithms)a=t.md.algorithms[n].create();else throw new Error('Unknown hash algorithm "'+n+'"');else a=n;if(u===null)u=r;else{if(typeof u=="string")u=t.util.createBuffer(u);else if(t.util.isArray(u)){var h=u;u=t.util.createBuffer();for(var m=0;m<h.length;++m)u.putByte(h[m])}var B=u.length();B>a.blockLength&&(a.start(),a.update(u.bytes()),u=a.digest()),f=t.util.createBuffer(),o=t.util.createBuffer(),B=u.length();for(var m=0;m<B;++m){var h=u.at(m);f.putByte(54^h),o.putByte(92^h)}if(B<a.blockLength)for(var h=a.blockLength-B,m=0;m<h;++m)f.putByte(54),o.putByte(92);r=u,f=f.bytes(),o=o.bytes()}a.start(),a.update(f)},i.update=function(n){a.update(n)},i.getMac=function(){var n=a.digest().bytes();return a.start(),a.update(o),a.update(n),a.digest()},i.digest=i.getMac,i},$n.exports}var Yn={exports:{}},Li;function za(){if(Li)return Yn.exports;Li=1;var t=ge();$t(),Ee();var e=Yn.exports=t.md5=t.md5||{};t.md.md5=t.md.algorithms.md5=e,e.create=function(){i||n();var h=null,m=t.util.createBuffer(),B=new Array(16),v={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return v.start=function(){v.messageLength=0,v.fullMessageLength=v.messageLength64=[];for(var d=v.messageLengthSize/4,p=0;p<d;++p)v.fullMessageLength.push(0);return m=t.util.createBuffer(),h={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},v},v.start(),v.update=function(d,p){p==="utf8"&&(d=t.util.encodeUtf8(d));var b=d.length;v.messageLength+=b,b=[b/4294967296>>>0,b>>>0];for(var S=v.fullMessageLength.length-1;S>=0;--S)v.fullMessageLength[S]+=b[1],b[1]=b[0]+(v.fullMessageLength[S]/4294967296>>>0),v.fullMessageLength[S]=v.fullMessageLength[S]>>>0,b[0]=b[1]/4294967296>>>0;return m.putBytes(d),u(h,B,m),(m.read>2048||m.length()===0)&&m.compact(),v},v.digest=function(){var d=t.util.createBuffer();d.putBytes(m.bytes());var p=v.fullMessageLength[v.fullMessageLength.length-1]+v.messageLengthSize,b=p&v.blockLength-1;d.putBytes(r.substr(0,v.blockLength-b));for(var S,c=0,g=v.fullMessageLength.length-1;g>=0;--g)S=v.fullMessageLength[g]*8+c,c=S/4294967296>>>0,d.putInt32Le(S>>>0);var E={h0:h.h0,h1:h.h1,h2:h.h2,h3:h.h3};u(E,B,d);var A=t.util.createBuffer();return A.putInt32Le(E.h0),A.putInt32Le(E.h1),A.putInt32Le(E.h2),A.putInt32Le(E.h3),A},v};var r=null,a=null,f=null,o=null,i=!1;function n(){r="",r+=t.util.fillString("\0",64),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],f=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],o=new Array(64);for(var h=0;h<64;++h)o[h]=Math.floor(Math.abs(Math.sin(h+1))*4294967296);i=!0}function u(h,m,B){for(var v,d,p,b,S,c,g,E,A=B.length();A>=64;){for(d=h.h0,p=h.h1,b=h.h2,S=h.h3,E=0;E<16;++E)m[E]=B.getInt32Le(),c=S^p&(b^S),v=d+c+o[E]+m[E],g=f[E],d=S,S=b,b=p,p+=v<<g|v>>>32-g;for(;E<32;++E)c=b^S&(p^b),v=d+c+o[E]+m[a[E]],g=f[E],d=S,S=b,b=p,p+=v<<g|v>>>32-g;for(;E<48;++E)c=p^b^S,v=d+c+o[E]+m[a[E]],g=f[E],d=S,S=b,b=p,p+=v<<g|v>>>32-g;for(;E<64;++E)c=b^(p|~S),v=d+c+o[E]+m[a[E]],g=f[E],d=S,S=b,b=p,p+=v<<g|v>>>32-g;h.h0=h.h0+d|0,h.h1=h.h1+p|0,h.h2=h.h2+b|0,h.h3=h.h3+S|0,A-=64}}return Yn.exports}var Qn={exports:{}},Ui;function Cr(){if(Ui)return Qn.exports;Ui=1;var t=ge();Ee();var e=Qn.exports=t.pem=t.pem||{};e.encode=function(f,o){o=o||{};var i="-----BEGIN "+f.type+`-----\r
`,n;if(f.procType&&(n={name:"Proc-Type",values:[String(f.procType.version),f.procType.type]},i+=r(n)),f.contentDomain&&(n={name:"Content-Domain",values:[f.contentDomain]},i+=r(n)),f.dekInfo&&(n={name:"DEK-Info",values:[f.dekInfo.algorithm]},f.dekInfo.parameters&&n.values.push(f.dekInfo.parameters),i+=r(n)),f.headers)for(var u=0;u<f.headers.length;++u)i+=r(f.headers[u]);return f.procType&&(i+=`\r
`),i+=t.util.encode64(f.body,o.maxline||64)+`\r
`,i+="-----END "+f.type+`-----\r
`,i},e.decode=function(f){for(var o=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,u=/\r?\n/,h;h=i.exec(f),!!h;){var m=h[1];m==="NEW CERTIFICATE REQUEST"&&(m="CERTIFICATE REQUEST");var B={type:m,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(h[3])};if(o.push(B),!!h[2]){for(var v=h[2].split(u),d=0;h&&d<v.length;){for(var p=v[d].replace(/\s+$/,""),b=d+1;b<v.length;++b){var S=v[b];if(!/\s/.test(S[0]))break;p+=S,d=b}if(h=p.match(n),h){for(var c={name:h[1],values:[]},g=h[2].split(","),E=0;E<g.length;++E)c.values.push(a(g[E]));if(B.procType)if(!B.contentDomain&&c.name==="Content-Domain")B.contentDomain=g[0]||"";else if(!B.dekInfo&&c.name==="DEK-Info"){if(c.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');B.dekInfo={algorithm:g[0],parameters:g[1]||null}}else B.headers.push(c);else{if(c.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(c.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');B.procType={version:g[0],type:g[1]}}}++d}if(B.procType==="ENCRYPTED"&&!B.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(o.length===0)throw new Error("Invalid PEM formatted message.");return o};function r(f){for(var o=f.name+": ",i=[],n=function(v,d){return" "+d},u=0;u<f.values.length;++u)i.push(f.values[u].replace(/^(\S+\r\n)/,n));o+=i.join(",")+`\r
`;for(var h=0,m=-1,u=0;u<o.length;++u,++h)if(h>65&&m!==-1){var B=o[m];B===","?(++m,o=o.substr(0,m)+`\r
 `+o.substr(m)):o=o.substr(0,m)+`\r
`+B+o.substr(m+1),h=u-m-1,m=-1,++u}else(o[u]===" "||o[u]==="	"||o[u]===",")&&(m=u);return o}function a(f){return f.replace(/^\s+/,"")}return Qn.exports}var Xn={exports:{}},jn,Di;function bn(){if(Di)return jn;Di=1;var t=ge();$a(),bo(),Ee(),jn=t.des=t.des||{},t.des.startEncrypting=function(d,p,b,S){var c=v({key:d,output:b,decrypt:!1,mode:S||(p===null?"ECB":"CBC")});return c.start(p),c},t.des.createEncryptionCipher=function(d,p){return v({key:d,output:null,decrypt:!1,mode:p})},t.des.startDecrypting=function(d,p,b,S){var c=v({key:d,output:b,decrypt:!0,mode:S||(p===null?"ECB":"CBC")});return c.start(p),c},t.des.createDecryptionCipher=function(d,p){return v({key:d,output:null,decrypt:!0,mode:p})},t.des.Algorithm=function(d,p){var b=this;b.name=d,b.mode=new p({blockSize:8,cipher:{encrypt:function(S,c){return B(b._keys,S,c,!1)},decrypt:function(S,c){return B(b._keys,S,c,!0)}}}),b._init=!1},t.des.Algorithm.prototype.initialize=function(d){if(!this._init){var p=t.util.createBuffer(d.key);if(this.name.indexOf("3DES")===0&&p.length()!==24)throw new Error("Invalid Triple-DES key size: "+p.length()*8);this._keys=m(p),this._init=!0}},e("DES-ECB",t.cipher.modes.ecb),e("DES-CBC",t.cipher.modes.cbc),e("DES-CFB",t.cipher.modes.cfb),e("DES-OFB",t.cipher.modes.ofb),e("DES-CTR",t.cipher.modes.ctr),e("3DES-ECB",t.cipher.modes.ecb),e("3DES-CBC",t.cipher.modes.cbc),e("3DES-CFB",t.cipher.modes.cfb),e("3DES-OFB",t.cipher.modes.ofb),e("3DES-CTR",t.cipher.modes.ctr);function e(d,p){var b=function(){return new t.des.Algorithm(d,p)};t.cipher.registerAlgorithm(d,b)}var r=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],a=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],f=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],o=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],i=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],n=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],u=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],h=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function m(d){for(var p=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],b=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],S=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],c=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],g=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],E=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],A=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],I=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],x=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],s=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],w=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],N=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],K=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],_=d.length()>8?3:1,D=[],V=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],P=0,M,q=0;q<_;q++){var z=d.getInt32(),G=d.getInt32();M=(z>>>4^G)&252645135,G^=M,z^=M<<4,M=(G>>>-16^z)&65535,z^=M,G^=M<<-16,M=(z>>>2^G)&858993459,G^=M,z^=M<<2,M=(G>>>-16^z)&65535,z^=M,G^=M<<-16,M=(z>>>1^G)&1431655765,G^=M,z^=M<<1,M=(G>>>8^z)&16711935,z^=M,G^=M<<8,M=(z>>>1^G)&1431655765,G^=M,z^=M<<1,M=z<<8|G>>>20&240,z=G<<24|G<<8&16711680|G>>>8&65280|G>>>24&240,G=M;for(var Y=0;Y<V.length;++Y){V[Y]?(z=z<<2|z>>>26,G=G<<2|G>>>26):(z=z<<1|z>>>27,G=G<<1|G>>>27),z&=-15,G&=-15;var j=p[z>>>28]|b[z>>>24&15]|S[z>>>20&15]|c[z>>>16&15]|g[z>>>12&15]|E[z>>>8&15]|A[z>>>4&15],te=I[G>>>28]|x[G>>>24&15]|l[G>>>20&15]|s[G>>>16&15]|w[G>>>12&15]|N[G>>>8&15]|K[G>>>4&15];M=(te>>>16^j)&65535,D[P++]=j^M,D[P++]=te^M<<16}}return D}function B(d,p,b,S){var c=d.length===32?3:9,g;c===3?g=S?[30,-2,-2]:[0,32,2]:g=S?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var E,A=p[0],I=p[1];E=(A>>>4^I)&252645135,I^=E,A^=E<<4,E=(A>>>16^I)&65535,I^=E,A^=E<<16,E=(I>>>2^A)&858993459,A^=E,I^=E<<2,E=(I>>>8^A)&16711935,A^=E,I^=E<<8,E=(A>>>1^I)&1431655765,I^=E,A^=E<<1,A=A<<1|A>>>31,I=I<<1|I>>>31;for(var x=0;x<c;x+=3){for(var l=g[x+1],s=g[x+2],w=g[x];w!=l;w+=s){var N=I^d[w],K=(I>>>4|I<<28)^d[w+1];E=A,A=I,I=E^(a[N>>>24&63]|o[N>>>16&63]|n[N>>>8&63]|h[N&63]|r[K>>>24&63]|f[K>>>16&63]|i[K>>>8&63]|u[K&63])}E=A,A=I,I=E}A=A>>>1|A<<31,I=I>>>1|I<<31,E=(A>>>1^I)&1431655765,I^=E,A^=E<<1,E=(I>>>8^A)&16711935,A^=E,I^=E<<8,E=(I>>>2^A)&858993459,A^=E,I^=E<<2,E=(A>>>16^I)&65535,I^=E,A^=E<<16,E=(A>>>4^I)&252645135,I^=E,A^=E<<4,b[0]=A,b[1]=I}function v(d){d=d||{};var p=(d.mode||"CBC").toUpperCase(),b="DES-"+p,S;d.decrypt?S=t.cipher.createDecipher(b,d.key):S=t.cipher.createCipher(b,d.key);var c=S.start;return S.start=function(g,E){var A=null;E instanceof t.util.ByteBuffer&&(A=E,E={}),E=E||{},E.output=A,E.iv=g,c.call(S,E)},S}return jn}const _u={},Rt=Object.freeze(Object.defineProperty({__proto__:null,default:_u},Symbol.toStringTag,{value:"Module"})),Ya=Tu(Rt);var Zn,Pi;function Qa(){if(Pi)return Zn;Pi=1;var t=ge();Hr(),$t(),Ee();var e=t.pkcs5=t.pkcs5||{},r;return t.util.isNodejs&&!t.options.usePureJavaScript&&(r=Ya),Zn=t.pbkdf2=e.pbkdf2=function(a,f,o,i,n,u){if(typeof n=="function"&&(u=n,n=null),t.util.isNodejs&&!t.options.usePureJavaScript&&r.pbkdf2&&(n===null||typeof n!="object")&&(r.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),a=Buffer.from(a,"binary"),f=Buffer.from(f,"binary"),u?r.pbkdf2Sync.length===4?r.pbkdf2(a,f,o,i,function(x,l){if(x)return u(x);u(null,l.toString("binary"))}):r.pbkdf2(a,f,o,i,n,function(x,l){if(x)return u(x);u(null,l.toString("binary"))}):r.pbkdf2Sync.length===4?r.pbkdf2Sync(a,f,o,i).toString("binary"):r.pbkdf2Sync(a,f,o,i,n).toString("binary");if((typeof n>"u"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in t.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=t.md[n].create()}var h=n.digestLength;if(i>4294967295*h){var m=new Error("Derived key is too long.");if(u)return u(m);throw m}var B=Math.ceil(i/h),v=i-(B-1)*h,d=t.hmac.create();d.start(n,a);var p="",b,S,c;if(!u){for(var g=1;g<=B;++g){d.start(null,null),d.update(f),d.update(t.util.int32ToBytes(g)),b=c=d.digest().getBytes();for(var E=2;E<=o;++E)d.start(null,null),d.update(c),S=d.digest().getBytes(),b=t.util.xorBytes(b,S,h),c=S;p+=g<B?b:b.substr(0,v)}return p}var g=1,E;function A(){if(g>B)return u(null,p);d.start(null,null),d.update(f),d.update(t.util.int32ToBytes(g)),b=c=d.digest().getBytes(),E=2,I()}function I(){if(E<=o)return d.start(null,null),d.update(c),S=d.digest().getBytes(),b=t.util.xorBytes(b,S,h),c=S,++E,t.util.setImmediate(I);p+=g<B?b:b.substr(0,v),++g,A()}A()},Zn}var jr={exports:{}},Wn={exports:{}},Ki;function Co(){if(Ki)return Wn.exports;Ki=1;var t=ge();$t(),Ee();var e=Wn.exports=t.sha256=t.sha256||{};t.md.sha256=t.md.algorithms.sha256=e,e.create=function(){a||o();var n=null,u=t.util.createBuffer(),h=new Array(64),m={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return m.start=function(){m.messageLength=0,m.fullMessageLength=m.messageLength64=[];for(var B=m.messageLengthSize/4,v=0;v<B;++v)m.fullMessageLength.push(0);return u=t.util.createBuffer(),n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},m},m.start(),m.update=function(B,v){v==="utf8"&&(B=t.util.encodeUtf8(B));var d=B.length;m.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var p=m.fullMessageLength.length-1;p>=0;--p)m.fullMessageLength[p]+=d[1],d[1]=d[0]+(m.fullMessageLength[p]/4294967296>>>0),m.fullMessageLength[p]=m.fullMessageLength[p]>>>0,d[0]=d[1]/4294967296>>>0;return u.putBytes(B),i(n,h,u),(u.read>2048||u.length()===0)&&u.compact(),m},m.digest=function(){var B=t.util.createBuffer();B.putBytes(u.bytes());var v=m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize,d=v&m.blockLength-1;B.putBytes(r.substr(0,m.blockLength-d));for(var p,b,S=m.fullMessageLength[0]*8,c=0;c<m.fullMessageLength.length-1;++c)p=m.fullMessageLength[c+1]*8,b=p/4294967296>>>0,S+=b,B.putInt32(S>>>0),S=p>>>0;B.putInt32(S);var g={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};i(g,h,B);var E=t.util.createBuffer();return E.putInt32(g.h0),E.putInt32(g.h1),E.putInt32(g.h2),E.putInt32(g.h3),E.putInt32(g.h4),E.putInt32(g.h5),E.putInt32(g.h6),E.putInt32(g.h7),E},m};var r=null,a=!1,f=null;function o(){r="",r+=t.util.fillString("\0",64),f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=!0}function i(n,u,h){for(var m,B,v,d,p,b,S,c,g,E,A,I,x,l,s,w=h.length();w>=64;){for(S=0;S<16;++S)u[S]=h.getInt32();for(;S<64;++S)m=u[S-2],m=(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10,B=u[S-15],B=(B>>>7|B<<25)^(B>>>18|B<<14)^B>>>3,u[S]=m+u[S-7]+B+u[S-16]|0;for(c=n.h0,g=n.h1,E=n.h2,A=n.h3,I=n.h4,x=n.h5,l=n.h6,s=n.h7,S=0;S<64;++S)d=(I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7),p=l^I&(x^l),v=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),b=c&g|E&(c^g),m=s+d+p+f[S]+u[S],B=v+b,s=l,l=x,x=I,I=A+m>>>0,A=E,E=g,g=c,c=m+B>>>0;n.h0=n.h0+c|0,n.h1=n.h1+g|0,n.h2=n.h2+E|0,n.h3=n.h3+A|0,n.h4=n.h4+I|0,n.h5=n.h5+x|0,n.h6=n.h6+l|0,n.h7=n.h7+s|0,w-=64}}return Wn.exports}var Jn={exports:{}},Oi;function Bo(){if(Oi)return Jn.exports;Oi=1;var t=ge();Ee();var e=null;t.util.isNodejs&&!t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=Ya);var r=Jn.exports=t.prng=t.prng||{};return r.create=function(a){for(var f={plugin:a,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},o=a.md,i=new Array(32),n=0;n<32;++n)i[n]=o.create();f.pools=i,f.pool=0,f.generate=function(v,d){if(!d)return f.generateSync(v);var p=f.plugin.cipher,b=f.plugin.increment,S=f.plugin.formatKey,c=f.plugin.formatSeed,g=t.util.createBuffer();f.key=null,E();function E(A){if(A)return d(A);if(g.length()>=v)return d(null,g.getBytes(v));if(f.generated>1048575&&(f.key=null),f.key===null)return t.util.nextTick(function(){u(E)});var I=p(f.key,f.seed);f.generated+=I.length,g.putBytes(I),f.key=S(p(f.key,b(f.seed))),f.seed=c(p(f.key,f.seed)),t.util.setImmediate(E)}},f.generateSync=function(v){var d=f.plugin.cipher,p=f.plugin.increment,b=f.plugin.formatKey,S=f.plugin.formatSeed;f.key=null;for(var c=t.util.createBuffer();c.length()<v;){f.generated>1048575&&(f.key=null),f.key===null&&h();var g=d(f.key,f.seed);f.generated+=g.length,c.putBytes(g),f.key=b(d(f.key,p(f.seed))),f.seed=S(d(f.key,f.seed))}return c.getBytes(v)};function u(v){if(f.pools[0].messageLength>=32)return m(),v();var d=32-f.pools[0].messageLength<<5;f.seedFile(d,function(p,b){if(p)return v(p);f.collect(b),m(),v()})}function h(){if(f.pools[0].messageLength>=32)return m();var v=32-f.pools[0].messageLength<<5;f.collect(f.seedFileSync(v)),m()}function m(){f.reseeds=f.reseeds===4294967295?0:f.reseeds+1;var v=f.plugin.md.create();v.update(f.keyBytes);for(var d=1,p=0;p<32;++p)f.reseeds%d===0&&(v.update(f.pools[p].digest().getBytes()),f.pools[p].start()),d=d<<1;f.keyBytes=v.digest().getBytes(),v.start(),v.update(f.keyBytes);var b=v.digest().getBytes();f.key=f.plugin.formatKey(f.keyBytes),f.seed=f.plugin.formatSeed(b),f.generated=0}function B(v){var d=null,p=t.util.globalScope,b=p.crypto||p.msCrypto;b&&b.getRandomValues&&(d=function(s){return b.getRandomValues(s)});var S=t.util.createBuffer();if(d)for(;S.length()<v;){var c=Math.max(1,Math.min(v-S.length(),65536)/4),g=new Uint32Array(Math.floor(c));try{d(g);for(var E=0;E<g.length;++E)S.putInt32(g[E])}catch(s){if(!(typeof QuotaExceededError<"u"&&s instanceof QuotaExceededError))throw s}}if(S.length()<v)for(var A,I,x,l=Math.floor(Math.random()*65536);S.length()<v;){I=16807*(l&65535),A=16807*(l>>16),I+=(A&32767)<<16,I+=A>>15,I=(I&2147483647)+(I>>31),l=I&4294967295;for(var E=0;E<3;++E)x=l>>>(E<<3),x^=Math.floor(Math.random()*256),S.putByte(x&255)}return S.getBytes(v)}return e?(f.seedFile=function(v,d){e.randomBytes(v,function(p,b){if(p)return d(p);d(null,b.toString())})},f.seedFileSync=function(v){return e.randomBytes(v).toString()}):(f.seedFile=function(v,d){try{d(null,B(v))}catch(p){d(p)}},f.seedFileSync=B),f.collect=function(v){for(var d=v.length,p=0;p<d;++p)f.pools[f.pool].update(v.substr(p,1)),f.pool=f.pool===31?0:f.pool+1},f.collectInt=function(v,d){for(var p="",b=0;b<d;b+=8)p+=String.fromCharCode(v>>b&255);f.collect(p)},f.registerWorker=function(v){if(v===self)f.seedFile=function(p,b){function S(c){var g=c.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",S),b(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",S),self.postMessage({forge:{prng:{needed:p}}})};else{var d=function(p){var b=p.data;b.forge&&b.forge.prng&&f.seedFile(b.forge.prng.needed,function(S,c){v.postMessage({forge:{prng:{err:S,bytes:c}}})})};v.addEventListener("message",d)}},f},Jn.exports}var Vi;function wt(){if(Vi)return jr.exports;Vi=1;var t=ge();return dr(),Co(),Bo(),Ee(),(function(){if(t.random&&t.random.getBytes){jr.exports=t.random;return}(function(e){var r={},a=new Array(4),f=t.util.createBuffer();r.formatKey=function(v){var d=t.util.createBuffer(v);return v=new Array(4),v[0]=d.getInt32(),v[1]=d.getInt32(),v[2]=d.getInt32(),v[3]=d.getInt32(),t.aes._expandKey(v,!1)},r.formatSeed=function(v){var d=t.util.createBuffer(v);return v=new Array(4),v[0]=d.getInt32(),v[1]=d.getInt32(),v[2]=d.getInt32(),v[3]=d.getInt32(),v},r.cipher=function(v,d){return t.aes._updateBlock(v,d,a,!1),f.putInt32(a[0]),f.putInt32(a[1]),f.putInt32(a[2]),f.putInt32(a[3]),f.getBytes()},r.increment=function(v){return++v[3],v},r.md=t.md.sha256;function o(){var v=t.prng.create(r);return v.getBytes=function(d,p){return v.generate(d,p)},v.getBytesSync=function(d){return v.generate(d)},v}var i=o(),n=null,u=t.util.globalScope,h=u.crypto||u.msCrypto;if(h&&h.getRandomValues&&(n=function(v){return h.getRandomValues(v)}),t.options.usePureJavaScript||!t.util.isNodejs&&!n){if(i.collectInt(+new Date,32),typeof navigator<"u"){var m="";for(var B in navigator)try{typeof navigator[B]=="string"&&(m+=navigator[B])}catch{}i.collect(m),m=null}e&&(e().mousemove(function(v){i.collectInt(v.clientX,16),i.collectInt(v.clientY,16)}),e().keypress(function(v){i.collectInt(v.charCode,8)}))}if(!t.random)t.random=i;else for(var B in i)t.random[B]=i[B];t.random.createInstance=o,jr.exports=t.random})(typeof jQuery<"u"?jQuery:null)})(),jr.exports}var ea,Fi;function wo(){if(Fi)return ea;Fi=1;var t=ge();Ee();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],a=function(i,n){return i<<n&65535|(i&65535)>>16-n},f=function(i,n){return(i&65535)>>n|i<<16-n&65535};ea=t.rc2=t.rc2||{},t.rc2.expandKey=function(i,n){typeof i=="string"&&(i=t.util.createBuffer(i)),n=n||128;var u=i,h=i.length(),m=n,B=Math.ceil(m/8),v=255>>(m&7),d;for(d=h;d<128;d++)u.putByte(e[u.at(d-1)+u.at(d-h)&255]);for(u.setAt(128-B,e[u.at(128-B)&v]),d=127-B;d>=0;d--)u.setAt(d,e[u.at(d+1)^u.at(d+B)]);return u};var o=function(i,n,u){var h=!1,m=null,B=null,v=null,d,p,b,S,c=[];for(i=t.rc2.expandKey(i,n),b=0;b<64;b++)c.push(i.getInt16Le());u?(d=function(A){for(b=0;b<4;b++)A[b]+=c[S]+(A[(b+3)%4]&A[(b+2)%4])+(~A[(b+3)%4]&A[(b+1)%4]),A[b]=a(A[b],r[b]),S++},p=function(A){for(b=0;b<4;b++)A[b]+=c[A[(b+3)%4]&63]}):(d=function(A){for(b=3;b>=0;b--)A[b]=f(A[b],r[b]),A[b]-=c[S]+(A[(b+3)%4]&A[(b+2)%4])+(~A[(b+3)%4]&A[(b+1)%4]),S--},p=function(A){for(b=3;b>=0;b--)A[b]-=c[A[(b+3)%4]&63]});var g=function(A){var I=[];for(b=0;b<4;b++){var x=m.getInt16Le();v!==null&&(u?x^=v.getInt16Le():v.putInt16Le(x)),I.push(x&65535)}S=u?0:63;for(var l=0;l<A.length;l++)for(var s=0;s<A[l][0];s++)A[l][1](I);for(b=0;b<4;b++)v!==null&&(u?v.putInt16Le(I[b]):I[b]^=v.getInt16Le()),B.putInt16Le(I[b])},E=null;return E={start:function(A,I){A&&typeof A=="string"&&(A=t.util.createBuffer(A)),h=!1,m=t.util.createBuffer(),B=I||new t.util.createBuffer,v=A,E.output=B},update:function(A){for(h||m.putBuffer(A);m.length()>=8;)g([[5,d],[1,p],[6,d],[1,p],[5,d]])},finish:function(A){var I=!0;if(u)if(A)I=A(8,m,!u);else{var x=m.length()===8?8:8-m.length();m.fillWithByte(x,x)}if(I&&(h=!0,E.update()),!u&&(I=m.length()===0,I))if(A)I=A(8,B,!u);else{var l=B.length(),s=B.at(l-1);s>l?I=!1:B.truncate(s)}return I}},E};return t.rc2.startEncrypting=function(i,n,u){var h=t.rc2.createEncryptionCipher(i,128);return h.start(n,u),h},t.rc2.createEncryptionCipher=function(i,n){return o(i,n,!0)},t.rc2.startDecrypting=function(i,n,u){var h=t.rc2.createDecryptionCipher(i,128);return h.start(n,u),h},t.rc2.createDecryptionCipher=function(i,n){return o(i,n,!1)},ea}var ta,Mi;function Cn(){if(Mi)return ta;Mi=1;var t=ge();ta=t.jsbn=t.jsbn||{};var e;function r(T,k,O){this.data=[],T!=null&&(typeof T=="number"?this.fromNumber(T,k,O):k==null&&typeof T!="string"?this.fromString(T,256):this.fromString(T,k))}t.jsbn.BigInteger=r;function a(){return new r(null)}function f(T,k,O,$,Z,ee){for(;--ee>=0;){var oe=k*this.data[T++]+O.data[$]+Z;Z=Math.floor(oe/67108864),O.data[$++]=oe&67108863}return Z}function o(T,k,O,$,Z,ee){for(var oe=k&32767,ne=k>>15;--ee>=0;){var Se=this.data[T]&32767,Qe=this.data[T++]>>15,yt=ne*Se+Qe*oe;Se=oe*Se+((yt&32767)<<15)+O.data[$]+(Z&1073741823),Z=(Se>>>30)+(yt>>>15)+ne*Qe+(Z>>>30),O.data[$++]=Se&1073741823}return Z}function i(T,k,O,$,Z,ee){for(var oe=k&16383,ne=k>>14;--ee>=0;){var Se=this.data[T]&16383,Qe=this.data[T++]>>14,yt=ne*Se+Qe*oe;Se=oe*Se+((yt&16383)<<14)+O.data[$]+Z,Z=(Se>>28)+(yt>>14)+ne*Qe,O.data[$++]=Se&268435455}return Z}typeof navigator>"u"?(r.prototype.am=i,e=28):navigator.appName=="Microsoft Internet Explorer"?(r.prototype.am=o,e=30):navigator.appName!="Netscape"?(r.prototype.am=f,e=26):(r.prototype.am=i,e=28),r.prototype.DB=e,r.prototype.DM=(1<<e)-1,r.prototype.DV=1<<e;var n=52;r.prototype.FV=Math.pow(2,n),r.prototype.F1=n-e,r.prototype.F2=2*e-n;var u="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array,m,B;for(m=48,B=0;B<=9;++B)h[m++]=B;for(m=97,B=10;B<36;++B)h[m++]=B;for(m=65,B=10;B<36;++B)h[m++]=B;function v(T){return u.charAt(T)}function d(T,k){var O=h[T.charCodeAt(k)];return O??-1}function p(T){for(var k=this.t-1;k>=0;--k)T.data[k]=this.data[k];T.t=this.t,T.s=this.s}function b(T){this.t=1,this.s=T<0?-1:0,T>0?this.data[0]=T:T<-1?this.data[0]=T+this.DV:this.t=0}function S(T){var k=a();return k.fromInt(T),k}function c(T,k){var O;if(k==16)O=4;else if(k==8)O=3;else if(k==256)O=8;else if(k==2)O=1;else if(k==32)O=5;else if(k==4)O=2;else{this.fromRadix(T,k);return}this.t=0,this.s=0;for(var $=T.length,Z=!1,ee=0;--$>=0;){var oe=O==8?T[$]&255:d(T,$);if(oe<0){T.charAt($)=="-"&&(Z=!0);continue}Z=!1,ee==0?this.data[this.t++]=oe:ee+O>this.DB?(this.data[this.t-1]|=(oe&(1<<this.DB-ee)-1)<<ee,this.data[this.t++]=oe>>this.DB-ee):this.data[this.t-1]|=oe<<ee,ee+=O,ee>=this.DB&&(ee-=this.DB)}O==8&&(T[0]&128)!=0&&(this.s=-1,ee>0&&(this.data[this.t-1]|=(1<<this.DB-ee)-1<<ee)),this.clamp(),Z&&r.ZERO.subTo(this,this)}function g(){for(var T=this.s&this.DM;this.t>0&&this.data[this.t-1]==T;)--this.t}function E(T){if(this.s<0)return"-"+this.negate().toString(T);var k;if(T==16)k=4;else if(T==8)k=3;else if(T==2)k=1;else if(T==32)k=5;else if(T==4)k=2;else return this.toRadix(T);var O=(1<<k)-1,$,Z=!1,ee="",oe=this.t,ne=this.DB-oe*this.DB%k;if(oe-- >0)for(ne<this.DB&&($=this.data[oe]>>ne)>0&&(Z=!0,ee=v($));oe>=0;)ne<k?($=(this.data[oe]&(1<<ne)-1)<<k-ne,$|=this.data[--oe]>>(ne+=this.DB-k)):($=this.data[oe]>>(ne-=k)&O,ne<=0&&(ne+=this.DB,--oe)),$>0&&(Z=!0),Z&&(ee+=v($));return Z?ee:"0"}function A(){var T=a();return r.ZERO.subTo(this,T),T}function I(){return this.s<0?this.negate():this}function x(T){var k=this.s-T.s;if(k!=0)return k;var O=this.t;if(k=O-T.t,k!=0)return this.s<0?-k:k;for(;--O>=0;)if((k=this.data[O]-T.data[O])!=0)return k;return 0}function l(T){var k=1,O;return(O=T>>>16)!=0&&(T=O,k+=16),(O=T>>8)!=0&&(T=O,k+=8),(O=T>>4)!=0&&(T=O,k+=4),(O=T>>2)!=0&&(T=O,k+=2),(O=T>>1)!=0&&(T=O,k+=1),k}function s(){return this.t<=0?0:this.DB*(this.t-1)+l(this.data[this.t-1]^this.s&this.DM)}function w(T,k){var O;for(O=this.t-1;O>=0;--O)k.data[O+T]=this.data[O];for(O=T-1;O>=0;--O)k.data[O]=0;k.t=this.t+T,k.s=this.s}function N(T,k){for(var O=T;O<this.t;++O)k.data[O-T]=this.data[O];k.t=Math.max(this.t-T,0),k.s=this.s}function K(T,k){var O=T%this.DB,$=this.DB-O,Z=(1<<$)-1,ee=Math.floor(T/this.DB),oe=this.s<<O&this.DM,ne;for(ne=this.t-1;ne>=0;--ne)k.data[ne+ee+1]=this.data[ne]>>$|oe,oe=(this.data[ne]&Z)<<O;for(ne=ee-1;ne>=0;--ne)k.data[ne]=0;k.data[ee]=oe,k.t=this.t+ee+1,k.s=this.s,k.clamp()}function _(T,k){k.s=this.s;var O=Math.floor(T/this.DB);if(O>=this.t){k.t=0;return}var $=T%this.DB,Z=this.DB-$,ee=(1<<$)-1;k.data[0]=this.data[O]>>$;for(var oe=O+1;oe<this.t;++oe)k.data[oe-O-1]|=(this.data[oe]&ee)<<Z,k.data[oe-O]=this.data[oe]>>$;$>0&&(k.data[this.t-O-1]|=(this.s&ee)<<Z),k.t=this.t-O,k.clamp()}function D(T,k){for(var O=0,$=0,Z=Math.min(T.t,this.t);O<Z;)$+=this.data[O]-T.data[O],k.data[O++]=$&this.DM,$>>=this.DB;if(T.t<this.t){for($-=T.s;O<this.t;)$+=this.data[O],k.data[O++]=$&this.DM,$>>=this.DB;$+=this.s}else{for($+=this.s;O<T.t;)$-=T.data[O],k.data[O++]=$&this.DM,$>>=this.DB;$-=T.s}k.s=$<0?-1:0,$<-1?k.data[O++]=this.DV+$:$>0&&(k.data[O++]=$),k.t=O,k.clamp()}function V(T,k){var O=this.abs(),$=T.abs(),Z=O.t;for(k.t=Z+$.t;--Z>=0;)k.data[Z]=0;for(Z=0;Z<$.t;++Z)k.data[Z+O.t]=O.am(0,$.data[Z],k,Z,0,O.t);k.s=0,k.clamp(),this.s!=T.s&&r.ZERO.subTo(k,k)}function P(T){for(var k=this.abs(),O=T.t=2*k.t;--O>=0;)T.data[O]=0;for(O=0;O<k.t-1;++O){var $=k.am(O,k.data[O],T,2*O,0,1);(T.data[O+k.t]+=k.am(O+1,2*k.data[O],T,2*O+1,$,k.t-O-1))>=k.DV&&(T.data[O+k.t]-=k.DV,T.data[O+k.t+1]=1)}T.t>0&&(T.data[T.t-1]+=k.am(O,k.data[O],T,2*O,0,1)),T.s=0,T.clamp()}function M(T,k,O){var $=T.abs();if(!($.t<=0)){var Z=this.abs();if(Z.t<$.t){k?.fromInt(0),O!=null&&this.copyTo(O);return}O==null&&(O=a());var ee=a(),oe=this.s,ne=T.s,Se=this.DB-l($.data[$.t-1]);Se>0?($.lShiftTo(Se,ee),Z.lShiftTo(Se,O)):($.copyTo(ee),Z.copyTo(O));var Qe=ee.t,yt=ee.data[Qe-1];if(yt!=0){var ht=yt*(1<<this.F1)+(Qe>1?ee.data[Qe-2]>>this.F2:0),Kt=this.FV/ht,$r=(1<<this.F1)/ht,Et=1<<this.F2,xt=O.t,zr=xt-Qe,Yt=k??a();for(ee.dlShiftTo(zr,Yt),O.compareTo(Yt)>=0&&(O.data[O.t++]=1,O.subTo(Yt,O)),r.ONE.dlShiftTo(Qe,Yt),Yt.subTo(ee,ee);ee.t<Qe;)ee.data[ee.t++]=0;for(;--zr>=0;){var _n=O.data[--xt]==yt?this.DM:Math.floor(O.data[xt]*Kt+(O.data[xt-1]+Et)*$r);if((O.data[xt]+=ee.am(0,_n,O,zr,0,Qe))<_n)for(ee.dlShiftTo(zr,Yt),O.subTo(Yt,O);O.data[xt]<--_n;)O.subTo(Yt,O)}k!=null&&(O.drShiftTo(Qe,k),oe!=ne&&r.ZERO.subTo(k,k)),O.t=Qe,O.clamp(),Se>0&&O.rShiftTo(Se,O),oe<0&&r.ZERO.subTo(O,O)}}}function q(T){var k=a();return this.abs().divRemTo(T,null,k),this.s<0&&k.compareTo(r.ZERO)>0&&T.subTo(k,k),k}function z(T){this.m=T}function G(T){return T.s<0||T.compareTo(this.m)>=0?T.mod(this.m):T}function Y(T){return T}function j(T){T.divRemTo(this.m,null,T)}function te(T,k,O){T.multiplyTo(k,O),this.reduce(O)}function ue(T,k){T.squareTo(k),this.reduce(k)}z.prototype.convert=G,z.prototype.revert=Y,z.prototype.reduce=j,z.prototype.mulTo=te,z.prototype.sqrTo=ue;function X(){if(this.t<1)return 0;var T=this.data[0];if((T&1)==0)return 0;var k=T&3;return k=k*(2-(T&15)*k)&15,k=k*(2-(T&255)*k)&255,k=k*(2-((T&65535)*k&65535))&65535,k=k*(2-T*k%this.DV)%this.DV,k>0?this.DV-k:-k}function re(T){this.m=T,this.mp=T.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<T.DB-15)-1,this.mt2=2*T.t}function W(T){var k=a();return T.abs().dlShiftTo(this.m.t,k),k.divRemTo(this.m,null,k),T.s<0&&k.compareTo(r.ZERO)>0&&this.m.subTo(k,k),k}function pe(T){var k=a();return T.copyTo(k),this.reduce(k),k}function le(T){for(;T.t<=this.mt2;)T.data[T.t++]=0;for(var k=0;k<this.m.t;++k){var O=T.data[k]&32767,$=O*this.mpl+((O*this.mph+(T.data[k]>>15)*this.mpl&this.um)<<15)&T.DM;for(O=k+this.m.t,T.data[O]+=this.m.am(0,$,T,k,0,this.m.t);T.data[O]>=T.DV;)T.data[O]-=T.DV,T.data[++O]++}T.clamp(),T.drShiftTo(this.m.t,T),T.compareTo(this.m)>=0&&T.subTo(this.m,T)}function C(T,k){T.squareTo(k),this.reduce(k)}function U(T,k,O){T.multiplyTo(k,O),this.reduce(O)}re.prototype.convert=W,re.prototype.revert=pe,re.prototype.reduce=le,re.prototype.mulTo=U,re.prototype.sqrTo=C;function L(){return(this.t>0?this.data[0]&1:this.s)==0}function y(T,k){if(T>4294967295||T<1)return r.ONE;var O=a(),$=a(),Z=k.convert(this),ee=l(T)-1;for(Z.copyTo(O);--ee>=0;)if(k.sqrTo(O,$),(T&1<<ee)>0)k.mulTo($,Z,O);else{var oe=O;O=$,$=oe}return k.revert(O)}function R(T,k){var O;return T<256||k.isEven()?O=new z(k):O=new re(k),this.exp(T,O)}r.prototype.copyTo=p,r.prototype.fromInt=b,r.prototype.fromString=c,r.prototype.clamp=g,r.prototype.dlShiftTo=w,r.prototype.drShiftTo=N,r.prototype.lShiftTo=K,r.prototype.rShiftTo=_,r.prototype.subTo=D,r.prototype.multiplyTo=V,r.prototype.squareTo=P,r.prototype.divRemTo=M,r.prototype.invDigit=X,r.prototype.isEven=L,r.prototype.exp=y,r.prototype.toString=E,r.prototype.negate=A,r.prototype.abs=I,r.prototype.compareTo=x,r.prototype.bitLength=s,r.prototype.mod=q,r.prototype.modPowInt=R,r.ZERO=S(0),r.ONE=S(1);function H(){var T=a();return this.copyTo(T),T}function F(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function J(){return this.t==0?this.s:this.data[0]<<24>>24}function ie(){return this.t==0?this.s:this.data[0]<<16>>16}function ce(T){return Math.floor(Math.LN2*this.DB/Math.log(T))}function Q(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function se(T){if(T==null&&(T=10),this.signum()==0||T<2||T>36)return"0";var k=this.chunkSize(T),O=Math.pow(T,k),$=S(O),Z=a(),ee=a(),oe="";for(this.divRemTo($,Z,ee);Z.signum()>0;)oe=(O+ee.intValue()).toString(T).substr(1)+oe,Z.divRemTo($,Z,ee);return ee.intValue().toString(T)+oe}function he(T,k){this.fromInt(0),k==null&&(k=10);for(var O=this.chunkSize(k),$=Math.pow(k,O),Z=!1,ee=0,oe=0,ne=0;ne<T.length;++ne){var Se=d(T,ne);if(Se<0){T.charAt(ne)=="-"&&this.signum()==0&&(Z=!0);continue}oe=k*oe+Se,++ee>=O&&(this.dMultiply($),this.dAddOffset(oe,0),ee=0,oe=0)}ee>0&&(this.dMultiply(Math.pow(k,ee)),this.dAddOffset(oe,0)),Z&&r.ZERO.subTo(this,this)}function ve(T,k,O){if(typeof k=="number")if(T<2)this.fromInt(1);else for(this.fromNumber(T,O),this.testBit(T-1)||this.bitwiseTo(r.ONE.shiftLeft(T-1),Ne,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(k);)this.dAddOffset(2,0),this.bitLength()>T&&this.subTo(r.ONE.shiftLeft(T-1),this);else{var $=new Array,Z=T&7;$.length=(T>>3)+1,k.nextBytes($),Z>0?$[0]&=(1<<Z)-1:$[0]=0,this.fromString($,256)}}function ye(){var T=this.t,k=new Array;k[0]=this.s;var O=this.DB-T*this.DB%8,$,Z=0;if(T-- >0)for(O<this.DB&&($=this.data[T]>>O)!=(this.s&this.DM)>>O&&(k[Z++]=$|this.s<<this.DB-O);T>=0;)O<8?($=(this.data[T]&(1<<O)-1)<<8-O,$|=this.data[--T]>>(O+=this.DB-8)):($=this.data[T]>>(O-=8)&255,O<=0&&(O+=this.DB,--T)),($&128)!=0&&($|=-256),Z==0&&(this.s&128)!=($&128)&&++Z,(Z>0||$!=this.s)&&(k[Z++]=$);return k}function we(T){return this.compareTo(T)==0}function Re(T){return this.compareTo(T)<0?this:T}function _e(T){return this.compareTo(T)>0?this:T}function Ae(T,k,O){var $,Z,ee=Math.min(T.t,this.t);for($=0;$<ee;++$)O.data[$]=k(this.data[$],T.data[$]);if(T.t<this.t){for(Z=T.s&this.DM,$=ee;$<this.t;++$)O.data[$]=k(this.data[$],Z);O.t=this.t}else{for(Z=this.s&this.DM,$=ee;$<T.t;++$)O.data[$]=k(Z,T.data[$]);O.t=T.t}O.s=k(this.s,T.s),O.clamp()}function Ce(T,k){return T&k}function Be(T){var k=a();return this.bitwiseTo(T,Ce,k),k}function Ne(T,k){return T|k}function je(T){var k=a();return this.bitwiseTo(T,Ne,k),k}function Ze(T,k){return T^k}function nt(T){var k=a();return this.bitwiseTo(T,Ze,k),k}function at(T,k){return T&~k}function lt(T){var k=a();return this.bitwiseTo(T,at,k),k}function pt(){for(var T=a(),k=0;k<this.t;++k)T.data[k]=this.DM&~this.data[k];return T.t=this.t,T.s=~this.s,T}function vt(T){var k=a();return T<0?this.rShiftTo(-T,k):this.lShiftTo(T,k),k}function At(T){var k=a();return T<0?this.lShiftTo(-T,k):this.rShiftTo(T,k),k}function Pt(T){if(T==0)return-1;var k=0;return(T&65535)==0&&(T>>=16,k+=16),(T&255)==0&&(T>>=8,k+=8),(T&15)==0&&(T>>=4,k+=4),(T&3)==0&&(T>>=2,k+=2),(T&1)==0&&++k,k}function zt(){for(var T=0;T<this.t;++T)if(this.data[T]!=0)return T*this.DB+Pt(this.data[T]);return this.s<0?this.t*this.DB:-1}function sr(T){for(var k=0;T!=0;)T&=T-1,++k;return k}function gr(){for(var T=0,k=this.s&this.DM,O=0;O<this.t;++O)T+=sr(this.data[O]^k);return T}function Br(T){var k=Math.floor(T/this.DB);return k>=this.t?this.s!=0:(this.data[k]&1<<T%this.DB)!=0}function Gr(T,k){var O=r.ONE.shiftLeft(T);return this.bitwiseTo(O,k,O),O}function Ue(T){return this.changeBit(T,Ne)}function De(T){return this.changeBit(T,at)}function Pe(T){return this.changeBit(T,Ze)}function Ke(T,k){for(var O=0,$=0,Z=Math.min(T.t,this.t);O<Z;)$+=this.data[O]+T.data[O],k.data[O++]=$&this.DM,$>>=this.DB;if(T.t<this.t){for($+=T.s;O<this.t;)$+=this.data[O],k.data[O++]=$&this.DM,$>>=this.DB;$+=this.s}else{for($+=this.s;O<T.t;)$+=T.data[O],k.data[O++]=$&this.DM,$>>=this.DB;$+=T.s}k.s=$<0?-1:0,$>0?k.data[O++]=$:$<-1&&(k.data[O++]=this.DV+$),k.t=O,k.clamp()}function Oe(T){var k=a();return this.addTo(T,k),k}function Ve(T){var k=a();return this.subTo(T,k),k}function Fe(T){var k=a();return this.multiplyTo(T,k),k}function Me(T){var k=a();return this.divRemTo(T,k,null),k}function He(T){var k=a();return this.divRemTo(T,null,k),k}function qe(T){var k=a(),O=a();return this.divRemTo(T,k,O),new Array(k,O)}function Ge(T){this.data[this.t]=this.am(0,T-1,this,0,0,this.t),++this.t,this.clamp()}function $e(T,k){if(T!=0){for(;this.t<=k;)this.data[this.t++]=0;for(this.data[k]+=T;this.data[k]>=this.DV;)this.data[k]-=this.DV,++k>=this.t&&(this.data[this.t++]=0),++this.data[k]}}function Te(){}function ke(T){return T}function ze(T,k,O){T.multiplyTo(k,O)}function Ye(T,k){T.squareTo(k)}Te.prototype.convert=ke,Te.prototype.revert=ke,Te.prototype.mulTo=ze,Te.prototype.sqrTo=Ye;function tf(T){return this.exp(T,new Te)}function rf(T,k,O){var $=Math.min(this.t+T.t,k);for(O.s=0,O.t=$;$>0;)O.data[--$]=0;var Z;for(Z=O.t-this.t;$<Z;++$)O.data[$+this.t]=this.am(0,T.data[$],O,$,0,this.t);for(Z=Math.min(T.t,k);$<Z;++$)this.am(0,T.data[$],O,$,0,k-$);O.clamp()}function nf(T,k,O){--k;var $=O.t=this.t+T.t-k;for(O.s=0;--$>=0;)O.data[$]=0;for($=Math.max(k-this.t,0);$<T.t;++$)O.data[this.t+$-k]=this.am(k-$,T.data[$],O,0,0,this.t+$-k);O.clamp(),O.drShiftTo(1,O)}function vr(T){this.r2=a(),this.q3=a(),r.ONE.dlShiftTo(2*T.t,this.r2),this.mu=this.r2.divide(T),this.m=T}function af(T){if(T.s<0||T.t>2*this.m.t)return T.mod(this.m);if(T.compareTo(this.m)<0)return T;var k=a();return T.copyTo(k),this.reduce(k),k}function sf(T){return T}function of(T){for(T.drShiftTo(this.m.t-1,this.r2),T.t>this.m.t+1&&(T.t=this.m.t+1,T.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);T.compareTo(this.r2)<0;)T.dAddOffset(1,this.m.t+1);for(T.subTo(this.r2,T);T.compareTo(this.m)>=0;)T.subTo(this.m,T)}function ff(T,k){T.squareTo(k),this.reduce(k)}function cf(T,k,O){T.multiplyTo(k,O),this.reduce(O)}vr.prototype.convert=af,vr.prototype.revert=sf,vr.prototype.reduce=of,vr.prototype.mulTo=cf,vr.prototype.sqrTo=ff;function uf(T,k){var O=T.bitLength(),$,Z=S(1),ee;if(O<=0)return Z;O<18?$=1:O<48?$=3:O<144?$=4:O<768?$=5:$=6,O<8?ee=new z(k):k.isEven()?ee=new vr(k):ee=new re(k);var oe=new Array,ne=3,Se=$-1,Qe=(1<<$)-1;if(oe[1]=ee.convert(this),$>1){var yt=a();for(ee.sqrTo(oe[1],yt);ne<=Qe;)oe[ne]=a(),ee.mulTo(yt,oe[ne-2],oe[ne]),ne+=2}var ht=T.t-1,Kt,$r=!0,Et=a(),xt;for(O=l(T.data[ht])-1;ht>=0;){for(O>=Se?Kt=T.data[ht]>>O-Se&Qe:(Kt=(T.data[ht]&(1<<O+1)-1)<<Se-O,ht>0&&(Kt|=T.data[ht-1]>>this.DB+O-Se)),ne=$;(Kt&1)==0;)Kt>>=1,--ne;if((O-=ne)<0&&(O+=this.DB,--ht),$r)oe[Kt].copyTo(Z),$r=!1;else{for(;ne>1;)ee.sqrTo(Z,Et),ee.sqrTo(Et,Z),ne-=2;ne>0?ee.sqrTo(Z,Et):(xt=Z,Z=Et,Et=xt),ee.mulTo(Et,oe[Kt],Z)}for(;ht>=0&&(T.data[ht]&1<<O)==0;)ee.sqrTo(Z,Et),xt=Z,Z=Et,Et=xt,--O<0&&(O=this.DB-1,--ht)}return ee.revert(Z)}function lf(T){var k=this.s<0?this.negate():this.clone(),O=T.s<0?T.negate():T.clone();if(k.compareTo(O)<0){var $=k;k=O,O=$}var Z=k.getLowestSetBit(),ee=O.getLowestSetBit();if(ee<0)return k;for(Z<ee&&(ee=Z),ee>0&&(k.rShiftTo(ee,k),O.rShiftTo(ee,O));k.signum()>0;)(Z=k.getLowestSetBit())>0&&k.rShiftTo(Z,k),(Z=O.getLowestSetBit())>0&&O.rShiftTo(Z,O),k.compareTo(O)>=0?(k.subTo(O,k),k.rShiftTo(1,k)):(O.subTo(k,O),O.rShiftTo(1,O));return ee>0&&O.lShiftTo(ee,O),O}function hf(T){if(T<=0)return 0;var k=this.DV%T,O=this.s<0?T-1:0;if(this.t>0)if(k==0)O=this.data[0]%T;else for(var $=this.t-1;$>=0;--$)O=(k*O+this.data[$])%T;return O}function df(T){var k=T.isEven();if(this.isEven()&&k||T.signum()==0)return r.ZERO;for(var O=T.clone(),$=this.clone(),Z=S(1),ee=S(0),oe=S(0),ne=S(1);O.signum()!=0;){for(;O.isEven();)O.rShiftTo(1,O),k?((!Z.isEven()||!ee.isEven())&&(Z.addTo(this,Z),ee.subTo(T,ee)),Z.rShiftTo(1,Z)):ee.isEven()||ee.subTo(T,ee),ee.rShiftTo(1,ee);for(;$.isEven();)$.rShiftTo(1,$),k?((!oe.isEven()||!ne.isEven())&&(oe.addTo(this,oe),ne.subTo(T,ne)),oe.rShiftTo(1,oe)):ne.isEven()||ne.subTo(T,ne),ne.rShiftTo(1,ne);O.compareTo($)>=0?(O.subTo($,O),k&&Z.subTo(oe,Z),ee.subTo(ne,ee)):($.subTo(O,$),k&&oe.subTo(Z,oe),ne.subTo(ee,ne))}if($.compareTo(r.ONE)!=0)return r.ZERO;if(ne.compareTo(T)>=0)return ne.subtract(T);if(ne.signum()<0)ne.addTo(T,ne);else return ne;return ne.signum()<0?ne.add(T):ne}var mt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],pf=(1<<26)/mt[mt.length-1];function yf(T){var k,O=this.abs();if(O.t==1&&O.data[0]<=mt[mt.length-1]){for(k=0;k<mt.length;++k)if(O.data[0]==mt[k])return!0;return!1}if(O.isEven())return!1;for(k=1;k<mt.length;){for(var $=mt[k],Z=k+1;Z<mt.length&&$<pf;)$*=mt[Z++];for($=O.modInt($);k<Z;)if($%mt[k++]==0)return!1}return O.millerRabin(T)}function gf(T){var k=this.subtract(r.ONE),O=k.getLowestSetBit();if(O<=0)return!1;for(var $=k.shiftRight(O),Z=vf(),ee,oe=0;oe<T;++oe){do ee=new r(this.bitLength(),Z);while(ee.compareTo(r.ONE)<=0||ee.compareTo(k)>=0);var ne=ee.modPow($,this);if(ne.compareTo(r.ONE)!=0&&ne.compareTo(k)!=0){for(var Se=1;Se++<O&&ne.compareTo(k)!=0;)if(ne=ne.modPowInt(2,this),ne.compareTo(r.ONE)==0)return!1;if(ne.compareTo(k)!=0)return!1}}return!0}function vf(){return{nextBytes:function(T){for(var k=0;k<T.length;++k)T[k]=Math.floor(Math.random()*256)}}}return r.prototype.chunkSize=ce,r.prototype.toRadix=se,r.prototype.fromRadix=he,r.prototype.fromNumber=ve,r.prototype.bitwiseTo=Ae,r.prototype.changeBit=Gr,r.prototype.addTo=Ke,r.prototype.dMultiply=Ge,r.prototype.dAddOffset=$e,r.prototype.multiplyLowerTo=rf,r.prototype.multiplyUpperTo=nf,r.prototype.modInt=hf,r.prototype.millerRabin=gf,r.prototype.clone=H,r.prototype.intValue=F,r.prototype.byteValue=J,r.prototype.shortValue=ie,r.prototype.signum=Q,r.prototype.toByteArray=ye,r.prototype.equals=we,r.prototype.min=Re,r.prototype.max=_e,r.prototype.and=Be,r.prototype.or=je,r.prototype.xor=nt,r.prototype.andNot=lt,r.prototype.not=pt,r.prototype.shiftLeft=vt,r.prototype.shiftRight=At,r.prototype.getLowestSetBit=zt,r.prototype.bitCount=gr,r.prototype.testBit=Br,r.prototype.setBit=Ue,r.prototype.clearBit=De,r.prototype.flipBit=Pe,r.prototype.add=Oe,r.prototype.subtract=Ve,r.prototype.multiply=Fe,r.prototype.divide=Me,r.prototype.remainder=He,r.prototype.divideAndRemainder=qe,r.prototype.modPow=uf,r.prototype.modInverse=df,r.prototype.pow=tf,r.prototype.gcd=lf,r.prototype.isProbablePrime=yf,ta}var ra={exports:{}},na={exports:{}},Hi;function qr(){if(Hi)return na.exports;Hi=1;var t=ge();$t(),Ee();var e=na.exports=t.sha1=t.sha1||{};t.md.sha1=t.md.algorithms.sha1=e,e.create=function(){a||f();var i=null,n=t.util.createBuffer(),u=new Array(80),h={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return h.start=function(){h.messageLength=0,h.fullMessageLength=h.messageLength64=[];for(var m=h.messageLengthSize/4,B=0;B<m;++B)h.fullMessageLength.push(0);return n=t.util.createBuffer(),i={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},h},h.start(),h.update=function(m,B){B==="utf8"&&(m=t.util.encodeUtf8(m));var v=m.length;h.messageLength+=v,v=[v/4294967296>>>0,v>>>0];for(var d=h.fullMessageLength.length-1;d>=0;--d)h.fullMessageLength[d]+=v[1],v[1]=v[0]+(h.fullMessageLength[d]/4294967296>>>0),h.fullMessageLength[d]=h.fullMessageLength[d]>>>0,v[0]=v[1]/4294967296>>>0;return n.putBytes(m),o(i,u,n),(n.read>2048||n.length()===0)&&n.compact(),h},h.digest=function(){var m=t.util.createBuffer();m.putBytes(n.bytes());var B=h.fullMessageLength[h.fullMessageLength.length-1]+h.messageLengthSize,v=B&h.blockLength-1;m.putBytes(r.substr(0,h.blockLength-v));for(var d,p,b=h.fullMessageLength[0]*8,S=0;S<h.fullMessageLength.length-1;++S)d=h.fullMessageLength[S+1]*8,p=d/4294967296>>>0,b+=p,m.putInt32(b>>>0),b=d>>>0;m.putInt32(b);var c={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3,h4:i.h4};o(c,u,m);var g=t.util.createBuffer();return g.putInt32(c.h0),g.putInt32(c.h1),g.putInt32(c.h2),g.putInt32(c.h3),g.putInt32(c.h4),g},h};var r=null,a=!1;function f(){r="",r+=t.util.fillString("\0",64),a=!0}function o(i,n,u){for(var h,m,B,v,d,p,b,S,c=u.length();c>=64;){for(m=i.h0,B=i.h1,v=i.h2,d=i.h3,p=i.h4,S=0;S<16;++S)h=u.getInt32(),n[S]=h,b=d^B&(v^d),h=(m<<5|m>>>27)+b+p+1518500249+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<20;++S)h=n[S-3]^n[S-8]^n[S-14]^n[S-16],h=h<<1|h>>>31,n[S]=h,b=d^B&(v^d),h=(m<<5|m>>>27)+b+p+1518500249+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<32;++S)h=n[S-3]^n[S-8]^n[S-14]^n[S-16],h=h<<1|h>>>31,n[S]=h,b=B^v^d,h=(m<<5|m>>>27)+b+p+1859775393+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<40;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,b=B^v^d,h=(m<<5|m>>>27)+b+p+1859775393+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<60;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,b=B&v|d&(B^v),h=(m<<5|m>>>27)+b+p+2400959708+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;for(;S<80;++S)h=n[S-6]^n[S-16]^n[S-28]^n[S-32],h=h<<2|h>>>30,n[S]=h,b=B^v^d,h=(m<<5|m>>>27)+b+p+3395469782+h,p=d,d=v,v=(B<<30|B>>>2)>>>0,B=m,m=h;i.h0=i.h0+m|0,i.h1=i.h1+B|0,i.h2=i.h2+v|0,i.h3=i.h3+d|0,i.h4=i.h4+p|0,c-=64}}return na.exports}var qi;function Ao(){if(qi)return ra.exports;qi=1;var t=ge();Ee(),wt(),qr();var e=ra.exports=t.pkcs1=t.pkcs1||{};e.encode_rsa_oaep=function(a,f,o){var i,n,u,h;typeof o=="string"?(i=o,n=arguments[3]||void 0,u=arguments[4]||void 0):o&&(i=o.label||void 0,n=o.seed||void 0,u=o.md||void 0,o.mgf1&&o.mgf1.md&&(h=o.mgf1.md)),u?u.start():u=t.md.sha1.create(),h||(h=u);var m=Math.ceil(a.n.bitLength()/8),B=m-2*u.digestLength-2;if(f.length>B){var v=new Error("RSAES-OAEP input message length is too long.");throw v.length=f.length,v.maxLength=B,v}i||(i=""),u.update(i,"raw");for(var d=u.digest(),p="",b=B-f.length,S=0;S<b;S++)p+="\0";var c=d.getBytes()+p+""+f;if(!n)n=t.random.getBytes(u.digestLength);else if(n.length!==u.digestLength){var v=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw v.seedLength=n.length,v.digestLength=u.digestLength,v}var g=r(n,m-u.digestLength-1,h),E=t.util.xorBytes(c,g,c.length),A=r(E,u.digestLength,h),I=t.util.xorBytes(n,A,n.length);return"\0"+I+E},e.decode_rsa_oaep=function(a,f,o){var i,n,u;typeof o=="string"?(i=o,n=arguments[3]||void 0):o&&(i=o.label||void 0,n=o.md||void 0,o.mgf1&&o.mgf1.md&&(u=o.mgf1.md));var h=Math.ceil(a.n.bitLength()/8);if(f.length!==h){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=f.length,E.expectedLength=h,E}if(n===void 0?n=t.md.sha1.create():n.start(),u||(u=n),h<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var m=n.digest().getBytes(),B=f.charAt(0),v=f.substring(1,n.digestLength+1),d=f.substring(1+n.digestLength),p=r(d,n.digestLength,u),b=t.util.xorBytes(v,p,v.length),S=r(b,h-n.digestLength-1,u),c=t.util.xorBytes(d,S,d.length),g=c.substring(0,n.digestLength),E=B!=="\0",A=0;A<n.digestLength;++A)E|=m.charAt(A)!==g.charAt(A);for(var I=1,x=n.digestLength,l=n.digestLength;l<c.length;l++){var s=c.charCodeAt(l),w=s&1^1,N=I?65534:0;E|=s&N,I=I&w,x+=I}if(E||c.charCodeAt(x)!==1)throw new Error("Invalid RSAES-OAEP padding.");return c.substring(x+1)};function r(a,f,o){o||(o=t.md.sha1.create());for(var i="",n=Math.ceil(f/o.digestLength),u=0;u<n;++u){var h=String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255);o.start(),o.update(a+h),i+=o.digest().getBytes()}return i.substring(0,f)}return ra.exports}var Zr={exports:{}},Gi;function To(){if(Gi)return Zr.exports;Gi=1;var t=ge();return Ee(),Cn(),wt(),(function(){if(t.prime){Zr.exports=t.prime;return}var e=Zr.exports=t.prime=t.prime||{},r=t.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],f=new r(null);f.fromInt(30);var o=function(v,d){return v|d};e.generateProbablePrime=function(v,d,p){typeof d=="function"&&(p=d,d={}),d=d||{};var b=d.algorithm||"PRIMEINC";typeof b=="string"&&(b={name:b}),b.options=b.options||{};var S=d.prng||t.random,c={nextBytes:function(g){for(var E=S.getBytesSync(g.length),A=0;A<g.length;++A)g[A]=E.charCodeAt(A)}};if(b.name==="PRIMEINC")return i(v,c,b.options,p);throw new Error("Invalid prime generation algorithm: "+b.name)};function i(v,d,p,b){return"workers"in p?h(v,d,p,b):n(v,d,p,b)}function n(v,d,p,b){var S=m(v,d),c=0,g=B(S.bitLength());"millerRabinTests"in p&&(g=p.millerRabinTests);var E=10;"maxBlockTime"in p&&(E=p.maxBlockTime),u(S,v,d,c,g,E,b)}function u(v,d,p,b,S,c,g){var E=+new Date;do{if(v.bitLength()>d&&(v=m(d,p)),v.isProbablePrime(S))return g(null,v);v.dAddOffset(a[b++%8],0)}while(c<0||+new Date-E<c);t.util.setImmediate(function(){u(v,d,p,b,S,c,g)})}function h(v,d,p,b){if(typeof Worker>"u")return n(v,d,p,b);var S=m(v,d),c=p.workers,g=p.workLoad||100,E=g*30/8,A=p.workerScript||"forge/prime.worker.js";if(c===-1)return t.util.estimateCores(function(x,l){x&&(l=2),c=l-1,I()});I();function I(){c=Math.max(1,c);for(var x=[],l=0;l<c;++l)x[l]=new Worker(A);for(var l=0;l<c;++l)x[l].addEventListener("message",w);var s=!1;function w(N){if(!s){var K=N.data;if(K.found){for(var _=0;_<x.length;++_)x[_].terminate();return s=!0,b(null,new r(K.prime,16))}S.bitLength()>v&&(S=m(v,d));var D=S.toString(16);N.target.postMessage({hex:D,workLoad:g}),S.dAddOffset(E,0)}}}}function m(v,d){var p=new r(v,d),b=v-1;return p.testBit(b)||p.bitwiseTo(r.ONE.shiftLeft(b),o,p),p.dAddOffset(31-p.mod(f).byteValue(),0),p}function B(v){return v<=100?27:v<=150?18:v<=200?15:v<=250?12:v<=300?9:v<=350?8:v<=400?7:v<=500?6:v<=600?5:v<=800?4:v<=1250?3:2}})(),Zr.exports}var aa,$i;function Bn(){if($i)return aa;$i=1;var t=ge();if(Dt(),Cn(),pr(),Ao(),To(),wt(),Ee(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.util.isNodejs?Ya:null,a=t.asn1,f=t.util;t.pki=t.pki||{},aa=t.pki.rsa=t.rsa=t.rsa||{};var o=t.pki,i=[6,4,2,4,2,4,6,2],n={name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},h={name:"RSAPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},m=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},B={name:"DigestInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},v=function(l){var s;if(l.algorithm in o.oids)s=o.oids[l.algorithm];else{var w=new Error("Unknown message digest algorithm.");throw w.algorithm=l.algorithm,w}var N=a.oidToDer(s).getBytes(),K=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]),_=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);_.value.push(a.create(a.Class.UNIVERSAL,a.Type.OID,!1,N)),_.value.push(a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,""));var D=a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,l.digest().getBytes());return K.value.push(_),K.value.push(D),a.toDer(K).getBytes()},d=function(l,s,w){if(w)return l.modPow(s.e,s.n);if(!s.p||!s.q)return l.modPow(s.d,s.n);s.dP||(s.dP=s.d.mod(s.p.subtract(e.ONE))),s.dQ||(s.dQ=s.d.mod(s.q.subtract(e.ONE))),s.qInv||(s.qInv=s.q.modInverse(s.p));var N;do N=new e(t.util.bytesToHex(t.random.getBytes(s.n.bitLength()/8)),16);while(N.compareTo(s.n)>=0||!N.gcd(s.n).equals(e.ONE));l=l.multiply(N.modPow(s.e,s.n)).mod(s.n);for(var K=l.mod(s.p).modPow(s.dP,s.p),_=l.mod(s.q).modPow(s.dQ,s.q);K.compareTo(_)<0;)K=K.add(s.p);var D=K.subtract(_).multiply(s.qInv).mod(s.p).multiply(s.q).add(_);return D=D.multiply(N.modInverse(s.n)).mod(s.n),D};o.rsa.encrypt=function(l,s,w){var N=w,K,_=Math.ceil(s.n.bitLength()/8);w!==!1&&w!==!0?(N=w===2,K=p(l,s,w)):(K=t.util.createBuffer(),K.putBytes(l));for(var D=new e(K.toHex(),16),V=d(D,s,N),P=V.toString(16),M=t.util.createBuffer(),q=_-Math.ceil(P.length/2);q>0;)M.putByte(0),--q;return M.putBytes(t.util.hexToBytes(P)),M.getBytes()},o.rsa.decrypt=function(l,s,w,N){var K=Math.ceil(s.n.bitLength()/8);if(l.length!==K){var _=new Error("Encrypted message length is invalid.");throw _.length=l.length,_.expected=K,_}var D=new e(t.util.createBuffer(l).toHex(),16);if(D.compareTo(s.n)>=0)throw new Error("Encrypted message is invalid.");for(var V=d(D,s,w),P=V.toString(16),M=t.util.createBuffer(),q=K-Math.ceil(P.length/2);q>0;)M.putByte(0),--q;return M.putBytes(t.util.hexToBytes(P)),N!==!1?b(M.getBytes(),s,w):M.getBytes()},o.rsa.createKeyPairGenerationState=function(l,s,w){typeof l=="string"&&(l=parseInt(l,10)),l=l||2048,w=w||{};var N=w.prng||t.random,K={nextBytes:function(V){for(var P=N.getBytesSync(V.length),M=0;M<V.length;++M)V[M]=P.charCodeAt(M)}},_=w.algorithm||"PRIMEINC",D;if(_==="PRIMEINC")D={algorithm:_,state:0,bits:l,rng:K,eInt:s||65537,e:new e(null),p:null,q:null,qBits:l>>1,pBits:l-(l>>1),pqState:0,num:null,keys:null},D.e.fromInt(D.eInt);else throw new Error("Invalid key generation algorithm: "+_);return D},o.rsa.stepKeyPairGenerationState=function(l,s){"algorithm"in l||(l.algorithm="PRIMEINC");var w=new e(null);w.fromInt(30);for(var N=0,K=function(z,G){return z|G},_=+new Date,D,V=0;l.keys===null&&(s<=0||V<s);){if(l.state===0){var P=l.p===null?l.pBits:l.qBits,M=P-1;l.pqState===0?(l.num=new e(P,l.rng),l.num.testBit(M)||l.num.bitwiseTo(e.ONE.shiftLeft(M),K,l.num),l.num.dAddOffset(31-l.num.mod(w).byteValue(),0),N=0,++l.pqState):l.pqState===1?l.num.bitLength()>P?l.pqState=0:l.num.isProbablePrime(g(l.num.bitLength()))?++l.pqState:l.num.dAddOffset(i[N++%8],0):l.pqState===2?l.pqState=l.num.subtract(e.ONE).gcd(l.e).compareTo(e.ONE)===0?3:0:l.pqState===3&&(l.pqState=0,l.p===null?l.p=l.num:l.q=l.num,l.p!==null&&l.q!==null&&++l.state,l.num=null)}else if(l.state===1)l.p.compareTo(l.q)<0&&(l.num=l.p,l.p=l.q,l.q=l.num),++l.state;else if(l.state===2)l.p1=l.p.subtract(e.ONE),l.q1=l.q.subtract(e.ONE),l.phi=l.p1.multiply(l.q1),++l.state;else if(l.state===3)l.phi.gcd(l.e).compareTo(e.ONE)===0?++l.state:(l.p=null,l.q=null,l.state=0);else if(l.state===4)l.n=l.p.multiply(l.q),l.n.bitLength()===l.bits?++l.state:(l.q=null,l.state=0);else if(l.state===5){var q=l.e.modInverse(l.phi);l.keys={privateKey:o.rsa.setPrivateKey(l.n,l.e,q,l.p,l.q,q.mod(l.p1),q.mod(l.q1),l.q.modInverse(l.p)),publicKey:o.rsa.setPublicKey(l.n,l.e)}}D=+new Date,V+=D-_,_=D}return l.keys!==null},o.rsa.generateKeyPair=function(l,s,w,N){if(arguments.length===1?typeof l=="object"?(w=l,l=void 0):typeof l=="function"&&(N=l,l=void 0):arguments.length===2?typeof l=="number"?typeof s=="function"?(N=s,s=void 0):typeof s!="number"&&(w=s,s=void 0):(w=l,N=s,l=void 0,s=void 0):arguments.length===3&&(typeof s=="number"?typeof w=="function"&&(N=w,w=void 0):(N=w,w=s,s=void 0)),w=w||{},l===void 0&&(l=w.bits||2048),s===void 0&&(s=w.e||65537),!t.options.usePureJavaScript&&!w.prng&&l>=256&&l<=16384&&(s===65537||s===3)){if(N){if(E("generateKeyPair"))return r.generateKeyPair("rsa",{modulusLength:l,publicExponent:s,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(V,P,M){if(V)return N(V);N(null,{privateKey:o.privateKeyFromPem(M),publicKey:o.publicKeyFromPem(P)})});if(A("generateKey")&&A("exportKey"))return f.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:l,publicExponent:x(s),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(V){return f.globalScope.crypto.subtle.exportKey("pkcs8",V.privateKey)}).then(void 0,function(V){N(V)}).then(function(V){if(V){var P=o.privateKeyFromAsn1(a.fromDer(t.util.createBuffer(V)));N(null,{privateKey:P,publicKey:o.setRsaPublicKey(P.n,P.e)})}});if(I("generateKey")&&I("exportKey")){var K=f.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:l,publicExponent:x(s),hash:{name:"SHA-256"}},!0,["sign","verify"]);K.oncomplete=function(V){var P=V.target.result,M=f.globalScope.msCrypto.subtle.exportKey("pkcs8",P.privateKey);M.oncomplete=function(q){var z=q.target.result,G=o.privateKeyFromAsn1(a.fromDer(t.util.createBuffer(z)));N(null,{privateKey:G,publicKey:o.setRsaPublicKey(G.n,G.e)})},M.onerror=function(q){N(q)}},K.onerror=function(V){N(V)};return}}else if(E("generateKeyPairSync")){var _=r.generateKeyPairSync("rsa",{modulusLength:l,publicExponent:s,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:o.privateKeyFromPem(_.privateKey),publicKey:o.publicKeyFromPem(_.publicKey)}}}var D=o.rsa.createKeyPairGenerationState(l,s,w);if(!N)return o.rsa.stepKeyPairGenerationState(D,0),D.keys;S(D,w,N)},o.setRsaPublicKey=o.rsa.setPublicKey=function(l,s){var w={n:l,e:s};return w.encrypt=function(N,K,_){if(typeof K=="string"?K=K.toUpperCase():K===void 0&&(K="RSAES-PKCS1-V1_5"),K==="RSAES-PKCS1-V1_5")K={encode:function(V,P,M){return p(V,P,2).getBytes()}};else if(K==="RSA-OAEP"||K==="RSAES-OAEP")K={encode:function(V,P){return t.pkcs1.encode_rsa_oaep(P,V,_)}};else if(["RAW","NONE","NULL",null].indexOf(K)!==-1)K={encode:function(V){return V}};else if(typeof K=="string")throw new Error('Unsupported encryption scheme: "'+K+'".');var D=K.encode(N,w,!0);return o.rsa.encrypt(D,w,!0)},w.verify=function(N,K,_,D){typeof _=="string"?_=_.toUpperCase():_===void 0&&(_="RSASSA-PKCS1-V1_5"),D===void 0&&(D={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in D||(D._parseAllDigestBytes=!0),_==="RSASSA-PKCS1-V1_5"?_={verify:function(P,M){M=b(M,w,!0);var q=a.fromDer(M,{parseAllBytes:D._parseAllDigestBytes}),z={},G=[];if(!a.validate(q,B,z,G)){var Y=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw Y.errors=G,Y}var j=a.derToOid(z.algorithmIdentifier);if(!(j===t.oids.md2||j===t.oids.md5||j===t.oids.sha1||j===t.oids.sha224||j===t.oids.sha256||j===t.oids.sha384||j===t.oids.sha512||j===t.oids["sha512-224"]||j===t.oids["sha512-256"])){var Y=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw Y.oid=j,Y}if((j===t.oids.md2||j===t.oids.md5)&&!("parameters"in z))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return P===z.digest}}:(_==="NONE"||_==="NULL"||_===null)&&(_={verify:function(P,M){return M=b(M,w,!0),P===M}});var V=o.rsa.decrypt(K,w,!0,!1);return _.verify(N,V,w.n.bitLength())},w},o.setRsaPrivateKey=o.rsa.setPrivateKey=function(l,s,w,N,K,_,D,V){var P={n:l,e:s,d:w,p:N,q:K,dP:_,dQ:D,qInv:V};return P.decrypt=function(M,q,z){typeof q=="string"?q=q.toUpperCase():q===void 0&&(q="RSAES-PKCS1-V1_5");var G=o.rsa.decrypt(M,P,!1,!1);if(q==="RSAES-PKCS1-V1_5")q={decode:b};else if(q==="RSA-OAEP"||q==="RSAES-OAEP")q={decode:function(Y,j){return t.pkcs1.decode_rsa_oaep(j,Y,z)}};else if(["RAW","NONE","NULL",null].indexOf(q)!==-1)q={decode:function(Y){return Y}};else throw new Error('Unsupported encryption scheme: "'+q+'".');return q.decode(G,P,!1)},P.sign=function(M,q){var z=!1;typeof q=="string"&&(q=q.toUpperCase()),q===void 0||q==="RSASSA-PKCS1-V1_5"?(q={encode:v},z=1):(q==="NONE"||q==="NULL"||q===null)&&(q={encode:function(){return M}},z=1);var G=q.encode(M,P.n.bitLength());return o.rsa.encrypt(G,P,z)},P},o.wrapRsaPrivateKey=function(l){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(0).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.oids.rsaEncryption).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(l).getBytes())])},o.privateKeyFromAsn1=function(l){var s={},w=[];if(a.validate(l,n,s,w)&&(l=a.fromDer(t.util.createBuffer(s.privateKey))),s={},w=[],!a.validate(l,u,s,w)){var N=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw N.errors=w,N}var K,_,D,V,P,M,q,z;return K=t.util.createBuffer(s.privateKeyModulus).toHex(),_=t.util.createBuffer(s.privateKeyPublicExponent).toHex(),D=t.util.createBuffer(s.privateKeyPrivateExponent).toHex(),V=t.util.createBuffer(s.privateKeyPrime1).toHex(),P=t.util.createBuffer(s.privateKeyPrime2).toHex(),M=t.util.createBuffer(s.privateKeyExponent1).toHex(),q=t.util.createBuffer(s.privateKeyExponent2).toHex(),z=t.util.createBuffer(s.privateKeyCoefficient).toHex(),o.setRsaPrivateKey(new e(K,16),new e(_,16),new e(D,16),new e(V,16),new e(P,16),new e(M,16),new e(q,16),new e(z,16))},o.privateKeyToAsn1=o.privateKeyToRSAPrivateKey=function(l){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(0).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.n)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.e)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.d)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.p)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.q)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.dP)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.dQ)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.qInv))])},o.publicKeyFromAsn1=function(l){var s={},w=[];if(a.validate(l,m,s,w)){var N=a.derToOid(s.publicKeyOid);if(N!==o.oids.rsaEncryption){var K=new Error("Cannot read public key. Unknown OID.");throw K.oid=N,K}l=s.rsaPublicKey}if(w=[],!a.validate(l,h,s,w)){var K=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw K.errors=w,K}var _=t.util.createBuffer(s.publicKeyModulus).toHex(),D=t.util.createBuffer(s.publicKeyExponent).toHex();return o.setRsaPublicKey(new e(_,16),new e(D,16))},o.publicKeyToAsn1=o.publicKeyToSubjectPublicKeyInfo=function(l){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.oids.rsaEncryption).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,[o.publicKeyToRSAPublicKey(l)])])},o.publicKeyToRSAPublicKey=function(l){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.n)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,c(l.e))])};function p(l,s,w){var N=t.util.createBuffer(),K=Math.ceil(s.n.bitLength()/8);if(l.length>K-11){var _=new Error("Message is too long for PKCS#1 v1.5 padding.");throw _.length=l.length,_.max=K-11,_}N.putByte(0),N.putByte(w);var D=K-3-l.length,V;if(w===0||w===1){V=w===0?0:255;for(var P=0;P<D;++P)N.putByte(V)}else for(;D>0;){for(var M=0,q=t.random.getBytes(D),P=0;P<D;++P)V=q.charCodeAt(P),V===0?++M:N.putByte(V);D=M}return N.putByte(0),N.putBytes(l),N}function b(l,s,w,N){var K=Math.ceil(s.n.bitLength()/8),_=t.util.createBuffer(l),D=_.getByte(),V=_.getByte();if(D!==0||w&&V!==0&&V!==1||!w&&V!=2||w&&V===0&&typeof N>"u")throw new Error("Encryption block is invalid.");var P=0;if(V===0){P=K-3-N;for(var M=0;M<P;++M)if(_.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(V===1)for(P=0;_.length()>1;){if(_.getByte()!==255){--_.read;break}++P}else if(V===2)for(P=0;_.length()>1;){if(_.getByte()===0){--_.read;break}++P}var q=_.getByte();if(q!==0||P!==K-3-_.length())throw new Error("Encryption block is invalid.");return _.getBytes()}function S(l,s,w){typeof s=="function"&&(w=s,s={}),s=s||{};var N={algorithm:{name:s.algorithm||"PRIMEINC",options:{workers:s.workers||2,workLoad:s.workLoad||100,workerScript:s.workerScript}}};"prng"in s&&(N.prng=s.prng),K();function K(){_(l.pBits,function(V,P){if(V)return w(V);if(l.p=P,l.q!==null)return D(V,l.q);_(l.qBits,D)})}function _(V,P){t.prime.generateProbablePrime(V,N,P)}function D(V,P){if(V)return w(V);if(l.q=P,l.p.compareTo(l.q)<0){var M=l.p;l.p=l.q,l.q=M}if(l.p.subtract(e.ONE).gcd(l.e).compareTo(e.ONE)!==0){l.p=null,K();return}if(l.q.subtract(e.ONE).gcd(l.e).compareTo(e.ONE)!==0){l.q=null,_(l.qBits,D);return}if(l.p1=l.p.subtract(e.ONE),l.q1=l.q.subtract(e.ONE),l.phi=l.p1.multiply(l.q1),l.phi.gcd(l.e).compareTo(e.ONE)!==0){l.p=l.q=null,K();return}if(l.n=l.p.multiply(l.q),l.n.bitLength()!==l.bits){l.q=null,_(l.qBits,D);return}var q=l.e.modInverse(l.phi);l.keys={privateKey:o.rsa.setPrivateKey(l.n,l.e,q,l.p,l.q,q.mod(l.p1),q.mod(l.q1),l.q.modInverse(l.p)),publicKey:o.rsa.setPublicKey(l.n,l.e)},w(null,l.keys)}}function c(l){var s=l.toString(16);s[0]>="8"&&(s="00"+s);var w=t.util.hexToBytes(s);return w.length>1&&(w.charCodeAt(0)===0&&(w.charCodeAt(1)&128)===0||w.charCodeAt(0)===255&&(w.charCodeAt(1)&128)===128)?w.substr(1):w}function g(l){return l<=100?27:l<=150?18:l<=200?15:l<=250?12:l<=300?9:l<=350?8:l<=400?7:l<=500?6:l<=600?5:l<=800?4:l<=1250?3:2}function E(l){return t.util.isNodejs&&typeof r[l]=="function"}function A(l){return typeof f.globalScope<"u"&&typeof f.globalScope.crypto=="object"&&typeof f.globalScope.crypto.subtle=="object"&&typeof f.globalScope.crypto.subtle[l]=="function"}function I(l){return typeof f.globalScope<"u"&&typeof f.globalScope.msCrypto=="object"&&typeof f.globalScope.msCrypto.subtle=="object"&&typeof f.globalScope.msCrypto.subtle[l]=="function"}function x(l){for(var s=t.util.hexToBytes(l.toString(16)),w=new Uint8Array(s.length),N=0;N<s.length;++N)w[N]=s.charCodeAt(N);return w}return aa}var ia,zi;function Io(){if(zi)return ia;zi=1;var t=ge();if(dr(),Dt(),bn(),$t(),pr(),Qa(),Cr(),wt(),wo(),Bn(),Ee(),typeof e>"u")var e=t.jsbn.BigInteger;var r=t.asn1,a=t.pki=t.pki||{};ia=a.pbe=t.pbe=t.pbe||{};var f=a.oids,o={name:"EncryptedPrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},i={name:"PBES2Algorithms",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},n={name:"pkcs-12PbeParams",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"iterations"}]};a.encryptPrivateKeyInfo=function(v,d,p){p=p||{},p.saltSize=p.saltSize||8,p.count=p.count||2048,p.algorithm=p.algorithm||"aes128",p.prfAlgorithm=p.prfAlgorithm||"sha1";var b=t.random.getBytesSync(p.saltSize),S=p.count,c=r.integerToDer(S),g,E,A;if(p.algorithm.indexOf("aes")===0||p.algorithm==="des"){var I,x,l;switch(p.algorithm){case"aes128":g=16,I=16,x=f["aes128-CBC"],l=t.aes.createEncryptionCipher;break;case"aes192":g=24,I=16,x=f["aes192-CBC"],l=t.aes.createEncryptionCipher;break;case"aes256":g=32,I=16,x=f["aes256-CBC"],l=t.aes.createEncryptionCipher;break;case"des":g=8,I=8,x=f.desCBC,l=t.des.createEncryptionCipher;break;default:var s=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=p.algorithm,s}var w="hmacWith"+p.prfAlgorithm.toUpperCase(),N=m(w),K=t.pkcs5.pbkdf2(d,b,S,g,N),_=t.random.getBytesSync(I),D=l(K);D.start(_),D.update(r.toDer(v)),D.finish(),A=D.output.getBytes();var V=B(b,c,g,w);E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(f.pkcs5PBES2).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(f.pkcs5PBKDF2).getBytes()),V]),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(x).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,_)])])])}else if(p.algorithm==="3des"){g=24;var P=new t.util.ByteBuffer(b),K=a.pbe.generatePkcs12Key(d,P,1,S,g),_=a.pbe.generatePkcs12Key(d,P,2,S,g),D=t.des.createEncryptionCipher(K);D.start(_),D.update(r.toDer(v)),D.finish(),A=D.output.getBytes(),E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(f["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,b),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,c.getBytes())])])}else{var s=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw s.algorithm=p.algorithm,s}var M=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[E,r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,A)]);return M},a.decryptPrivateKeyInfo=function(v,d){var p=null,b={},S=[];if(!r.validate(v,o,b,S)){var c=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=S,c}var g=r.derToOid(b.encryptionOid),E=a.pbe.getCipher(g,b.encryptionParams,d),A=t.util.createBuffer(b.encryptedData);return E.update(A),E.finish()&&(p=r.fromDer(E.output)),p},a.encryptedPrivateKeyToPem=function(v,d){var p={type:"ENCRYPTED PRIVATE KEY",body:r.toDer(v).getBytes()};return t.pem.encode(p,{maxline:d})},a.encryptedPrivateKeyFromPem=function(v){var d=t.pem.decode(v)[0];if(d.type!=="ENCRYPTED PRIVATE KEY"){var p=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw p.headerType=d.type,p}if(d.procType&&d.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return r.fromDer(d.body)},a.encryptRsaPrivateKey=function(v,d,p){if(p=p||{},!p.legacy){var b=a.wrapRsaPrivateKey(a.privateKeyToAsn1(v));return b=a.encryptPrivateKeyInfo(b,d,p),a.encryptedPrivateKeyToPem(b)}var S,c,g,E;switch(p.algorithm){case"aes128":S="AES-128-CBC",g=16,c=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes192":S="AES-192-CBC",g=24,c=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"aes256":S="AES-256-CBC",g=32,c=t.random.getBytesSync(16),E=t.aes.createEncryptionCipher;break;case"3des":S="DES-EDE3-CBC",g=24,c=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;case"des":S="DES-CBC",g=8,c=t.random.getBytesSync(8),E=t.des.createEncryptionCipher;break;default:var A=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+p.algorithm+'".');throw A.algorithm=p.algorithm,A}var I=t.pbe.opensslDeriveBytes(d,c.substr(0,8),g),x=E(I);x.start(c),x.update(r.toDer(a.privateKeyToAsn1(v))),x.finish();var l={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:S,parameters:t.util.bytesToHex(c).toUpperCase()},body:x.output.getBytes()};return t.pem.encode(l)},a.decryptRsaPrivateKey=function(v,d){var p=null,b=t.pem.decode(v)[0];if(b.type!=="ENCRYPTED PRIVATE KEY"&&b.type!=="PRIVATE KEY"&&b.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw S.headerType=S,S}if(b.procType&&b.procType.type==="ENCRYPTED"){var c,g;switch(b.dekInfo.algorithm){case"DES-CBC":c=8,g=t.des.createDecryptionCipher;break;case"DES-EDE3-CBC":c=24,g=t.des.createDecryptionCipher;break;case"AES-128-CBC":c=16,g=t.aes.createDecryptionCipher;break;case"AES-192-CBC":c=24,g=t.aes.createDecryptionCipher;break;case"AES-256-CBC":c=32,g=t.aes.createDecryptionCipher;break;case"RC2-40-CBC":c=5,g=function(l){return t.rc2.createDecryptionCipher(l,40)};break;case"RC2-64-CBC":c=8,g=function(l){return t.rc2.createDecryptionCipher(l,64)};break;case"RC2-128-CBC":c=16,g=function(l){return t.rc2.createDecryptionCipher(l,128)};break;default:var S=new Error('Could not decrypt private key; unsupported encryption algorithm "'+b.dekInfo.algorithm+'".');throw S.algorithm=b.dekInfo.algorithm,S}var E=t.util.hexToBytes(b.dekInfo.parameters),A=t.pbe.opensslDeriveBytes(d,E.substr(0,8),c),I=g(A);if(I.start(E),I.update(t.util.createBuffer(b.body)),I.finish())p=I.output.getBytes();else return p}else p=b.body;return b.type==="ENCRYPTED PRIVATE KEY"?p=a.decryptPrivateKeyInfo(r.fromDer(p),d):p=r.fromDer(p),p!==null&&(p=a.privateKeyFromAsn1(p)),p},a.pbe.generatePkcs12Key=function(v,d,p,b,S,c){var g,E;if(typeof c>"u"||c===null){if(!("sha1"in t.md))throw new Error('"sha1" hash algorithm unavailable.');c=t.md.sha1.create()}var A=c.digestLength,I=c.blockLength,x=new t.util.ByteBuffer,l=new t.util.ByteBuffer;if(v!=null){for(E=0;E<v.length;E++)l.putInt16(v.charCodeAt(E));l.putInt16(0)}var s=l.length(),w=d.length(),N=new t.util.ByteBuffer;N.fillWithByte(p,I);var K=I*Math.ceil(w/I),_=new t.util.ByteBuffer;for(E=0;E<K;E++)_.putByte(d.at(E%w));var D=I*Math.ceil(s/I),V=new t.util.ByteBuffer;for(E=0;E<D;E++)V.putByte(l.at(E%s));var P=_;P.putBuffer(V);for(var M=Math.ceil(S/A),q=1;q<=M;q++){var z=new t.util.ByteBuffer;z.putBytes(N.bytes()),z.putBytes(P.bytes());for(var G=0;G<b;G++)c.start(),c.update(z.getBytes()),z=c.digest();var Y=new t.util.ByteBuffer;for(E=0;E<I;E++)Y.putByte(z.at(E%A));var j=Math.ceil(w/I)+Math.ceil(s/I),te=new t.util.ByteBuffer;for(g=0;g<j;g++){var ue=new t.util.ByteBuffer(P.getBytes(I)),X=511;for(E=Y.length()-1;E>=0;E--)X=X>>8,X+=Y.at(E)+ue.at(E),ue.setAt(E,X&255);te.putBuffer(ue)}P=te,x.putBuffer(z)}return x.truncate(x.length()-S),x},a.pbe.getCipher=function(v,d,p){switch(v){case a.oids.pkcs5PBES2:return a.pbe.getCipherForPBES2(v,d,p);case a.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case a.oids["pbewithSHAAnd40BitRC2-CBC"]:return a.pbe.getCipherForPKCS12PBE(v,d,p);default:var b=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw b.oid=v,b.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],b}},a.pbe.getCipherForPBES2=function(v,d,p){var b={},S=[];if(!r.validate(d,i,b,S)){var c=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=S,c}if(v=r.derToOid(b.kdfOid),v!==a.oids.pkcs5PBKDF2){var c=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw c.oid=v,c.supportedOids=["pkcs5PBKDF2"],c}if(v=r.derToOid(b.encOid),v!==a.oids["aes128-CBC"]&&v!==a.oids["aes192-CBC"]&&v!==a.oids["aes256-CBC"]&&v!==a.oids["des-EDE3-CBC"]&&v!==a.oids.desCBC){var c=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw c.oid=v,c.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],c}var g=b.kdfSalt,E=t.util.createBuffer(b.kdfIterationCount);E=E.getInt(E.length()<<3);var A,I;switch(a.oids[v]){case"aes128-CBC":A=16,I=t.aes.createDecryptionCipher;break;case"aes192-CBC":A=24,I=t.aes.createDecryptionCipher;break;case"aes256-CBC":A=32,I=t.aes.createDecryptionCipher;break;case"des-EDE3-CBC":A=24,I=t.des.createDecryptionCipher;break;case"desCBC":A=8,I=t.des.createDecryptionCipher;break}var x=h(b.prfOid),l=t.pkcs5.pbkdf2(p,g,E,A,x),s=b.encIv,w=I(l);return w.start(s),w},a.pbe.getCipherForPKCS12PBE=function(v,d,p){var b={},S=[];if(!r.validate(d,n,b,S)){var c=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=S,c}var g=t.util.createBuffer(b.salt),E=t.util.createBuffer(b.iterations);E=E.getInt(E.length()<<3);var A,I,x;switch(v){case a.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:A=24,I=8,x=t.des.startDecrypting;break;case a.oids["pbewithSHAAnd40BitRC2-CBC"]:A=5,I=8,x=function(K,_){var D=t.rc2.createDecryptionCipher(K,40);return D.start(_,null),D};break;default:var c=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw c.oid=v,c}var l=h(b.prfOid),s=a.pbe.generatePkcs12Key(p,g,1,E,A,l);l.start();var w=a.pbe.generatePkcs12Key(p,g,2,E,I,l);return x(s,w)},a.pbe.opensslDeriveBytes=function(v,d,p,b){if(typeof b>"u"||b===null){if(!("md5"in t.md))throw new Error('"md5" hash algorithm unavailable.');b=t.md.md5.create()}d===null&&(d="");for(var S=[u(b,v+d)],c=16,g=1;c<p;++g,c+=16)S.push(u(b,S[g-1]+v+d));return S.join("").substr(0,p)};function u(v,d){return v.start().update(d).digest().getBytes()}function h(v){var d;if(!v)d="hmacWithSHA1";else if(d=a.oids[r.derToOid(v)],!d){var p=new Error("Unsupported PRF OID.");throw p.oid=v,p.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],p}return m(d)}function m(v){var d=t.md;switch(v){case"hmacWithSHA224":d=t.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":v=v.substr(8).toLowerCase();break;default:var p=new Error("Unsupported PRF algorithm.");throw p.algorithm=v,p.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],p}if(!d||!(v in d))throw new Error("Unknown hash algorithm: "+v);return d[v].create()}function B(v,d,p,b){var S=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,v),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,d.getBytes())]);return b!=="hmacWithSHA1"&&S.value.push(r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,t.util.hexToBytes(p.toString(16))),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(a.oids[b]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.NULL,!1,"")])),S}return ia}var sa={exports:{}},oa={exports:{}},Yi;function _o(){if(Yi)return oa.exports;Yi=1;var t=ge();Dt(),Ee();var e=t.asn1,r=oa.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=r;var a={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=a;var f={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(f)},r.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(f)};var o={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return r.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},a,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[o]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},oa.exports}var fa={exports:{}},ca={exports:{}},Qi;function Ro(){if(Qi)return ca.exports;Qi=1;var t=ge();Ee(),t.mgf=t.mgf||{};var e=ca.exports=t.mgf.mgf1=t.mgf1=t.mgf1||{};return e.create=function(r){var a={generate:function(f,o){for(var i=new t.util.ByteBuffer,n=Math.ceil(o/r.digestLength),u=0;u<n;u++){var h=new t.util.ByteBuffer;h.putInt32(u),r.start(),r.update(f+h.getBytes()),i.putBuffer(r.digest())}return i.truncate(i.length()-o),i.getBytes()}};return a},ca.exports}var ua,Xi;function Ru(){if(Xi)return ua;Xi=1;var t=ge();return Ro(),ua=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1,ua}var la={exports:{}},ji;function Xa(){if(ji)return la.exports;ji=1;var t=ge();wt(),Ee();var e=la.exports=t.pss=t.pss||{};return e.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var a=r.md,f=r.mgf,o=a.digestLength,i=r.salt||null;typeof i=="string"&&(i=t.util.createBuffer(i));var n;if("saltLength"in r)n=r.saltLength;else if(i!==null)n=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==n)throw new Error("Given salt length does not match length of given salt.");var u=r.prng||t.random,h={};return h.encode=function(m,B){var v,d=B-1,p=Math.ceil(d/8),b=m.digest().getBytes();if(p<o+n+2)throw new Error("Message is too long to encrypt.");var S;i===null?S=u.getBytesSync(n):S=i.bytes();var c=new t.util.ByteBuffer;c.fillWithByte(0,8),c.putBytes(b),c.putBytes(S),a.start(),a.update(c.getBytes());var g=a.digest().getBytes(),E=new t.util.ByteBuffer;E.fillWithByte(0,p-n-o-2),E.putByte(1),E.putBytes(S);var A=E.getBytes(),I=p-o-1,x=f.generate(g,I),l="";for(v=0;v<I;v++)l+=String.fromCharCode(A.charCodeAt(v)^x.charCodeAt(v));var s=65280>>8*p-d&255;return l=String.fromCharCode(l.charCodeAt(0)&~s)+l.substr(1),l+g+""},h.verify=function(m,B,v){var d,p=v-1,b=Math.ceil(p/8);if(B=B.substr(-b),b<o+n+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(B.charCodeAt(b-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var S=b-o-1,c=B.substr(0,S),g=B.substr(S,o),E=65280>>8*b-p&255;if((c.charCodeAt(0)&E)!==0)throw new Error("Bits beyond keysize not zero as expected.");var A=f.generate(g,S),I="";for(d=0;d<S;d++)I+=String.fromCharCode(c.charCodeAt(d)^A.charCodeAt(d));I=String.fromCharCode(I.charCodeAt(0)&~E)+I.substr(1);var x=b-o-n-2;for(d=0;d<x;d++)if(I.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(I.charCodeAt(x)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var l=I.substr(-n),s=new t.util.ByteBuffer;s.fillWithByte(0,8),s.putBytes(m),s.putBytes(l),a.start(),a.update(s.getBytes());var w=a.digest().getBytes();return g===w},h},la.exports}var Zi;function ja(){if(Zi)return fa.exports;Zi=1;var t=ge();dr(),Dt(),bn(),$t(),Ru(),pr(),Cr(),Xa(),Bn(),Ee();var e=t.asn1,r=fa.exports=t.pki=t.pki||{},a=r.oids,f={};f.CN=a.commonName,f.commonName="CN",f.C=a.countryName,f.countryName="C",f.L=a.localityName,f.localityName="L",f.ST=a.stateOrProvinceName,f.stateOrProvinceName="ST",f.O=a.organizationName,f.organizationName="O",f.OU=a.organizationalUnitName,f.organizationalUnitName="OU",f.E=a.emailAddress,f.emailAddress="E";var o=t.pki.rsa.publicKeyValidator,i={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},o,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},n={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},u={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},o,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},h={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[u,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};r.RDNAttributesAsArray=function(x,l){for(var s=[],w,N,K,_=0;_<x.value.length;++_){w=x.value[_];for(var D=0;D<w.value.length;++D)K={},N=w.value[D],K.type=e.derToOid(N.value[0].value),K.value=N.value[1].value,K.valueTagClass=N.value[1].type,K.type in a&&(K.name=a[K.type],K.name in f&&(K.shortName=f[K.name])),l&&(l.update(K.type),l.update(K.value)),s.push(K)}return s},r.CRIAttributesAsArray=function(x){for(var l=[],s=0;s<x.length;++s)for(var w=x[s],N=e.derToOid(w.value[0].value),K=w.value[1].value,_=0;_<K.length;++_){var D={};if(D.type=N,D.value=K[_].value,D.valueTagClass=K[_].type,D.type in a&&(D.name=a[D.type],D.name in f&&(D.shortName=f[D.name])),D.type===a.extensionRequest){D.extensions=[];for(var V=0;V<D.value.length;++V)D.extensions.push(r.certificateExtensionFromAsn1(D.value[V]))}l.push(D)}return l};function m(x,l){typeof l=="string"&&(l={shortName:l});for(var s=null,w,N=0;s===null&&N<x.attributes.length;++N)w=x.attributes[N],(l.type&&l.type===w.type||l.name&&l.name===w.name||l.shortName&&l.shortName===w.shortName)&&(s=w);return s}var B=function(x,l,s){var w={};if(x!==a["RSASSA-PSS"])return w;s&&(w={hash:{algorithmOid:a.sha1},mgf:{algorithmOid:a.mgf1,hash:{algorithmOid:a.sha1}},saltLength:20});var N={},K=[];if(!e.validate(l,n,N,K)){var _=new Error("Cannot read RSASSA-PSS parameter block.");throw _.errors=K,_}return N.hashOid!==void 0&&(w.hash=w.hash||{},w.hash.algorithmOid=e.derToOid(N.hashOid)),N.maskGenOid!==void 0&&(w.mgf=w.mgf||{},w.mgf.algorithmOid=e.derToOid(N.maskGenOid),w.mgf.hash=w.mgf.hash||{},w.mgf.hash.algorithmOid=e.derToOid(N.maskGenHashOid)),N.saltLength!==void 0&&(w.saltLength=N.saltLength.charCodeAt(0)),w},v=function(x){switch(a[x.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return t.md.sha1.create();case"md5WithRSAEncryption":return t.md.md5.create();case"sha256WithRSAEncryption":return t.md.sha256.create();case"sha384WithRSAEncryption":return t.md.sha384.create();case"sha512WithRSAEncryption":return t.md.sha512.create();case"RSASSA-PSS":return t.md.sha256.create();default:var l=new Error("Could not compute "+x.type+" digest. Unknown signature OID.");throw l.signatureOid=x.signatureOid,l}},d=function(x){var l=x.certificate,s;switch(l.signatureOid){case a.sha1WithRSAEncryption:case a.sha1WithRSASignature:break;case a["RSASSA-PSS"]:var w,N;if(w=a[l.signatureParameters.mgf.hash.algorithmOid],w===void 0||t.md[w]===void 0){var K=new Error("Unsupported MGF hash function.");throw K.oid=l.signatureParameters.mgf.hash.algorithmOid,K.name=w,K}if(N=a[l.signatureParameters.mgf.algorithmOid],N===void 0||t.mgf[N]===void 0){var K=new Error("Unsupported MGF function.");throw K.oid=l.signatureParameters.mgf.algorithmOid,K.name=N,K}if(N=t.mgf[N].create(t.md[w].create()),w=a[l.signatureParameters.hash.algorithmOid],w===void 0||t.md[w]===void 0){var K=new Error("Unsupported RSASSA-PSS hash function.");throw K.oid=l.signatureParameters.hash.algorithmOid,K.name=w,K}s=t.pss.create(t.md[w].create(),N,l.signatureParameters.saltLength);break}return l.publicKey.verify(x.md.digest().getBytes(),x.signature,s)};r.certificateFromPem=function(x,l,s){var w=t.pem.decode(x)[0];if(w.type!=="CERTIFICATE"&&w.type!=="X509 CERTIFICATE"&&w.type!=="TRUSTED CERTIFICATE"){var N=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw N.headerType=w.type,N}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var K=e.fromDer(w.body,s);return r.certificateFromAsn1(K,l)},r.certificateToPem=function(x,l){var s={type:"CERTIFICATE",body:e.toDer(r.certificateToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:l})},r.publicKeyFromPem=function(x){var l=t.pem.decode(x)[0];if(l.type!=="PUBLIC KEY"&&l.type!=="RSA PUBLIC KEY"){var s=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw s.headerType=l.type,s}if(l.procType&&l.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var w=e.fromDer(l.body);return r.publicKeyFromAsn1(w)},r.publicKeyToPem=function(x,l){var s={type:"PUBLIC KEY",body:e.toDer(r.publicKeyToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:l})},r.publicKeyToRSAPublicKeyPem=function(x,l){var s={type:"RSA PUBLIC KEY",body:e.toDer(r.publicKeyToRSAPublicKey(x)).getBytes()};return t.pem.encode(s,{maxline:l})},r.getPublicKeyFingerprint=function(x,l){l=l||{};var s=l.md||t.md.sha1.create(),w=l.type||"RSAPublicKey",N;switch(w){case"RSAPublicKey":N=e.toDer(r.publicKeyToRSAPublicKey(x)).getBytes();break;case"SubjectPublicKeyInfo":N=e.toDer(r.publicKeyToAsn1(x)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+l.type+'".')}s.start(),s.update(N);var K=s.digest();if(l.encoding==="hex"){var _=K.toHex();return l.delimiter?_.match(/.{2}/g).join(l.delimiter):_}else{if(l.encoding==="binary")return K.getBytes();if(l.encoding)throw new Error('Unknown encoding "'+l.encoding+'".')}return K},r.certificationRequestFromPem=function(x,l,s){var w=t.pem.decode(x)[0];if(w.type!=="CERTIFICATE REQUEST"){var N=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw N.headerType=w.type,N}if(w.procType&&w.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var K=e.fromDer(w.body,s);return r.certificationRequestFromAsn1(K,l)},r.certificationRequestToPem=function(x,l){var s={type:"CERTIFICATE REQUEST",body:e.toDer(r.certificationRequestToAsn1(x)).getBytes()};return t.pem.encode(s,{maxline:l})},r.createCertificate=function(){var x={};return x.version=2,x.serialNumber="00",x.signatureOid=null,x.signature=null,x.siginfo={},x.siginfo.algorithmOid=null,x.validity={},x.validity.notBefore=new Date,x.validity.notAfter=new Date,x.issuer={},x.issuer.getField=function(l){return m(x.issuer,l)},x.issuer.addField=function(l){b([l]),x.issuer.attributes.push(l)},x.issuer.attributes=[],x.issuer.hash=null,x.subject={},x.subject.getField=function(l){return m(x.subject,l)},x.subject.addField=function(l){b([l]),x.subject.attributes.push(l)},x.subject.attributes=[],x.subject.hash=null,x.extensions=[],x.publicKey=null,x.md=null,x.setSubject=function(l,s){b(l),x.subject.attributes=l,delete x.subject.uniqueId,s&&(x.subject.uniqueId=s),x.subject.hash=null},x.setIssuer=function(l,s){b(l),x.issuer.attributes=l,delete x.issuer.uniqueId,s&&(x.issuer.uniqueId=s),x.issuer.hash=null},x.setExtensions=function(l){for(var s=0;s<l.length;++s)S(l[s],{cert:x});x.extensions=l},x.getExtension=function(l){typeof l=="string"&&(l={name:l});for(var s=null,w,N=0;s===null&&N<x.extensions.length;++N)w=x.extensions[N],(l.id&&w.id===l.id||l.name&&w.name===l.name)&&(s=w);return s},x.sign=function(l,s){x.md=s||t.md.sha1.create();var w=a[x.md.algorithm+"WithRSAEncryption"];if(!w){var N=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw N.algorithm=x.md.algorithm,N}x.signatureOid=x.siginfo.algorithmOid=w,x.tbsCertificate=r.getTBSCertificate(x);var K=e.toDer(x.tbsCertificate);x.md.update(K.getBytes()),x.signature=l.sign(x.md)},x.verify=function(l){var s=!1;if(!x.issued(l)){var w=l.issuer,N=x.subject,K=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw K.expectedIssuer=N.attributes,K.actualIssuer=w.attributes,K}var _=l.md;if(_===null){_=v({signatureOid:l.signatureOid,type:"certificate"});var D=l.tbsCertificate||r.getTBSCertificate(l),V=e.toDer(D);_.update(V.getBytes())}return _!==null&&(s=d({certificate:x,md:_,signature:l.signature})),s},x.isIssuer=function(l){var s=!1,w=x.issuer,N=l.subject;if(w.hash&&N.hash)s=w.hash===N.hash;else if(w.attributes.length===N.attributes.length){s=!0;for(var K,_,D=0;s&&D<w.attributes.length;++D)K=w.attributes[D],_=N.attributes[D],(K.type!==_.type||K.value!==_.value)&&(s=!1)}return s},x.issued=function(l){return l.isIssuer(x)},x.generateSubjectKeyIdentifier=function(){return r.getPublicKeyFingerprint(x.publicKey,{type:"RSAPublicKey"})},x.verifySubjectKeyIdentifier=function(){for(var l=a.subjectKeyIdentifier,s=0;s<x.extensions.length;++s){var w=x.extensions[s];if(w.id===l){var N=x.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(w.subjectKeyIdentifier)===N}}return!1},x},r.certificateFromAsn1=function(x,l){var s={},w=[];if(!e.validate(x,i,s,w)){var N=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw N.errors=w,N}var K=e.derToOid(s.publicKeyOid);if(K!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var _=r.createCertificate();_.version=s.certVersion?s.certVersion.charCodeAt(0):0;var D=t.util.createBuffer(s.certSerialNumber);_.serialNumber=D.toHex(),_.signatureOid=t.asn1.derToOid(s.certSignatureOid),_.signatureParameters=B(_.signatureOid,s.certSignatureParams,!0),_.siginfo.algorithmOid=t.asn1.derToOid(s.certinfoSignatureOid),_.siginfo.parameters=B(_.siginfo.algorithmOid,s.certinfoSignatureParams,!1),_.signature=s.certSignature;var V=[];if(s.certValidity1UTCTime!==void 0&&V.push(e.utcTimeToDate(s.certValidity1UTCTime)),s.certValidity2GeneralizedTime!==void 0&&V.push(e.generalizedTimeToDate(s.certValidity2GeneralizedTime)),s.certValidity3UTCTime!==void 0&&V.push(e.utcTimeToDate(s.certValidity3UTCTime)),s.certValidity4GeneralizedTime!==void 0&&V.push(e.generalizedTimeToDate(s.certValidity4GeneralizedTime)),V.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(V.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(_.validity.notBefore=V[0],_.validity.notAfter=V[1],_.tbsCertificate=s.tbsCertificate,l){_.md=v({signatureOid:_.signatureOid,type:"certificate"});var P=e.toDer(_.tbsCertificate);_.md.update(P.getBytes())}var M=t.md.sha1.create(),q=e.toDer(s.certIssuer);M.update(q.getBytes()),_.issuer.getField=function(Y){return m(_.issuer,Y)},_.issuer.addField=function(Y){b([Y]),_.issuer.attributes.push(Y)},_.issuer.attributes=r.RDNAttributesAsArray(s.certIssuer),s.certIssuerUniqueId&&(_.issuer.uniqueId=s.certIssuerUniqueId),_.issuer.hash=M.digest().toHex();var z=t.md.sha1.create(),G=e.toDer(s.certSubject);return z.update(G.getBytes()),_.subject.getField=function(Y){return m(_.subject,Y)},_.subject.addField=function(Y){b([Y]),_.subject.attributes.push(Y)},_.subject.attributes=r.RDNAttributesAsArray(s.certSubject),s.certSubjectUniqueId&&(_.subject.uniqueId=s.certSubjectUniqueId),_.subject.hash=z.digest().toHex(),s.certExtensions?_.extensions=r.certificateExtensionsFromAsn1(s.certExtensions):_.extensions=[],_.publicKey=r.publicKeyFromAsn1(s.subjectPublicKeyInfo),_},r.certificateExtensionsFromAsn1=function(x){for(var l=[],s=0;s<x.value.length;++s)for(var w=x.value[s],N=0;N<w.value.length;++N)l.push(r.certificateExtensionFromAsn1(w.value[N]));return l},r.certificateExtensionFromAsn1=function(x){var l={};if(l.id=e.derToOid(x.value[0].value),l.critical=!1,x.value[1].type===e.Type.BOOLEAN?(l.critical=x.value[1].value.charCodeAt(0)!==0,l.value=x.value[2].value):l.value=x.value[1].value,l.id in a){if(l.name=a[l.id],l.name==="keyUsage"){var s=e.fromDer(l.value),w=0,N=0;s.value.length>1&&(w=s.value.charCodeAt(1),N=s.value.length>2?s.value.charCodeAt(2):0),l.digitalSignature=(w&128)===128,l.nonRepudiation=(w&64)===64,l.keyEncipherment=(w&32)===32,l.dataEncipherment=(w&16)===16,l.keyAgreement=(w&8)===8,l.keyCertSign=(w&4)===4,l.cRLSign=(w&2)===2,l.encipherOnly=(w&1)===1,l.decipherOnly=(N&128)===128}else if(l.name==="basicConstraints"){var s=e.fromDer(l.value);s.value.length>0&&s.value[0].type===e.Type.BOOLEAN?l.cA=s.value[0].value.charCodeAt(0)!==0:l.cA=!1;var K=null;s.value.length>0&&s.value[0].type===e.Type.INTEGER?K=s.value[0].value:s.value.length>1&&(K=s.value[1].value),K!==null&&(l.pathLenConstraint=e.derToInteger(K))}else if(l.name==="extKeyUsage")for(var s=e.fromDer(l.value),_=0;_<s.value.length;++_){var D=e.derToOid(s.value[_].value);D in a?l[a[D]]=!0:l[D]=!0}else if(l.name==="nsCertType"){var s=e.fromDer(l.value),w=0;s.value.length>1&&(w=s.value.charCodeAt(1)),l.client=(w&128)===128,l.server=(w&64)===64,l.email=(w&32)===32,l.objsign=(w&16)===16,l.reserved=(w&8)===8,l.sslCA=(w&4)===4,l.emailCA=(w&2)===2,l.objCA=(w&1)===1}else if(l.name==="subjectAltName"||l.name==="issuerAltName"){l.altNames=[];for(var V,s=e.fromDer(l.value),P=0;P<s.value.length;++P){V=s.value[P];var M={type:V.type,value:V.value};switch(l.altNames.push(M),V.type){case 1:case 2:case 6:break;case 7:M.ip=t.util.bytesToIP(V.value);break;case 8:M.oid=e.derToOid(V.value);break}}}else if(l.name==="subjectKeyIdentifier"){var s=e.fromDer(l.value);l.subjectKeyIdentifier=t.util.bytesToHex(s.value)}}return l},r.certificationRequestFromAsn1=function(x,l){var s={},w=[];if(!e.validate(x,h,s,w)){var N=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw N.errors=w,N}var K=e.derToOid(s.publicKeyOid);if(K!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var _=r.createCertificationRequest();if(_.version=s.csrVersion?s.csrVersion.charCodeAt(0):0,_.signatureOid=t.asn1.derToOid(s.csrSignatureOid),_.signatureParameters=B(_.signatureOid,s.csrSignatureParams,!0),_.siginfo.algorithmOid=t.asn1.derToOid(s.csrSignatureOid),_.siginfo.parameters=B(_.siginfo.algorithmOid,s.csrSignatureParams,!1),_.signature=s.csrSignature,_.certificationRequestInfo=s.certificationRequestInfo,l){_.md=v({signatureOid:_.signatureOid,type:"certification request"});var D=e.toDer(_.certificationRequestInfo);_.md.update(D.getBytes())}var V=t.md.sha1.create();return _.subject.getField=function(P){return m(_.subject,P)},_.subject.addField=function(P){b([P]),_.subject.attributes.push(P)},_.subject.attributes=r.RDNAttributesAsArray(s.certificationRequestInfoSubject,V),_.subject.hash=V.digest().toHex(),_.publicKey=r.publicKeyFromAsn1(s.subjectPublicKeyInfo),_.getAttribute=function(P){return m(_,P)},_.addAttribute=function(P){b([P]),_.attributes.push(P)},_.attributes=r.CRIAttributesAsArray(s.certificationRequestInfoAttributes||[]),_},r.createCertificationRequest=function(){var x={};return x.version=0,x.signatureOid=null,x.signature=null,x.siginfo={},x.siginfo.algorithmOid=null,x.subject={},x.subject.getField=function(l){return m(x.subject,l)},x.subject.addField=function(l){b([l]),x.subject.attributes.push(l)},x.subject.attributes=[],x.subject.hash=null,x.publicKey=null,x.attributes=[],x.getAttribute=function(l){return m(x,l)},x.addAttribute=function(l){b([l]),x.attributes.push(l)},x.md=null,x.setSubject=function(l){b(l),x.subject.attributes=l,x.subject.hash=null},x.setAttributes=function(l){b(l),x.attributes=l},x.sign=function(l,s){x.md=s||t.md.sha1.create();var w=a[x.md.algorithm+"WithRSAEncryption"];if(!w){var N=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw N.algorithm=x.md.algorithm,N}x.signatureOid=x.siginfo.algorithmOid=w,x.certificationRequestInfo=r.getCertificationRequestInfo(x);var K=e.toDer(x.certificationRequestInfo);x.md.update(K.getBytes()),x.signature=l.sign(x.md)},x.verify=function(){var l=!1,s=x.md;if(s===null){s=v({signatureOid:x.signatureOid,type:"certification request"});var w=x.certificationRequestInfo||r.getCertificationRequestInfo(x),N=e.toDer(w);s.update(N.getBytes())}return s!==null&&(l=d({certificate:x,md:s,signature:x.signature})),l},x};function p(x){for(var l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),s,w,N=x.attributes,K=0;K<N.length;++K){s=N[K];var _=s.value,D=e.Type.PRINTABLESTRING;"valueTagClass"in s&&(D=s.valueTagClass,D===e.Type.UTF8&&(_=t.util.encodeUtf8(_))),w=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(s.type).getBytes()),e.create(e.Class.UNIVERSAL,D,!1,_)])]),l.value.push(w)}return l}function b(x){for(var l,s=0;s<x.length;++s){if(l=x[s],typeof l.name>"u"&&(l.type&&l.type in r.oids?l.name=r.oids[l.type]:l.shortName&&l.shortName in f&&(l.name=r.oids[f[l.shortName]])),typeof l.type>"u")if(l.name&&l.name in r.oids)l.type=r.oids[l.name];else{var w=new Error("Attribute type not specified.");throw w.attribute=l,w}if(typeof l.shortName>"u"&&l.name&&l.name in f&&(l.shortName=f[l.name]),l.type===a.extensionRequest&&(l.valueConstructed=!0,l.valueTagClass=e.Type.SEQUENCE,!l.value&&l.extensions)){l.value=[];for(var N=0;N<l.extensions.length;++N)l.value.push(r.certificateExtensionToAsn1(S(l.extensions[N])))}if(typeof l.value>"u"){var w=new Error("Attribute value not specified.");throw w.attribute=l,w}}}function S(x,l){if(l=l||{},typeof x.name>"u"&&x.id&&x.id in r.oids&&(x.name=r.oids[x.id]),typeof x.id>"u")if(x.name&&x.name in r.oids)x.id=r.oids[x.name];else{var s=new Error("Extension ID not specified.");throw s.extension=x,s}if(typeof x.value<"u")return x;if(x.name==="keyUsage"){var w=0,N=0,K=0;x.digitalSignature&&(N|=128,w=7),x.nonRepudiation&&(N|=64,w=6),x.keyEncipherment&&(N|=32,w=5),x.dataEncipherment&&(N|=16,w=4),x.keyAgreement&&(N|=8,w=3),x.keyCertSign&&(N|=4,w=2),x.cRLSign&&(N|=2,w=1),x.encipherOnly&&(N|=1,w=0),x.decipherOnly&&(K|=128,w=7);var _=String.fromCharCode(w);K!==0?_+=String.fromCharCode(N)+String.fromCharCode(K):N!==0&&(_+=String.fromCharCode(N)),x.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,_)}else if(x.name==="basicConstraints")x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),x.cA&&x.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"")),"pathLenConstraint"in x&&x.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.pathLenConstraint).getBytes()));else if(x.name==="extKeyUsage"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var D=x.value.value;for(var V in x)x[V]===!0&&(V in a?D.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a[V]).getBytes())):V.indexOf(".")!==-1&&D.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(V).getBytes())))}else if(x.name==="nsCertType"){var w=0,N=0;x.client&&(N|=128,w=7),x.server&&(N|=64,w=6),x.email&&(N|=32,w=5),x.objsign&&(N|=16,w=4),x.reserved&&(N|=8,w=3),x.sslCA&&(N|=4,w=2),x.emailCA&&(N|=2,w=1),x.objCA&&(N|=1,w=0);var _=String.fromCharCode(w);N!==0&&(_+=String.fromCharCode(N)),x.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,_)}else if(x.name==="subjectAltName"||x.name==="issuerAltName"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var P,M=0;M<x.altNames.length;++M){P=x.altNames[M];var _=P.value;if(P.type===7&&P.ip){if(_=t.util.bytesFromIP(P.ip),_===null){var s=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw s.extension=x,s}}else P.type===8&&(P.oid?_=e.oidToDer(e.oidToDer(P.oid)):_=e.oidToDer(_));x.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,P.type,!1,_))}}else if(x.name==="nsComment"&&l.cert){if(!/^[\x00-\x7F]*$/.test(x.comment)||x.comment.length<1||x.comment.length>128)throw new Error('Invalid "nsComment" content.');x.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,x.comment)}else if(x.name==="subjectKeyIdentifier"&&l.cert){var q=l.cert.generateSubjectKeyIdentifier();x.subjectKeyIdentifier=q.toHex(),x.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,q.getBytes())}else if(x.name==="authorityKeyIdentifier"&&l.cert){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var D=x.value.value;if(x.keyIdentifier){var z=x.keyIdentifier===!0?l.cert.generateSubjectKeyIdentifier().getBytes():x.keyIdentifier;D.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,z))}if(x.authorityCertIssuer){var G=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[p(x.authorityCertIssuer===!0?l.cert.issuer:x.authorityCertIssuer)])];D.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,G))}if(x.serialNumber){var Y=t.util.hexToBytes(x.serialNumber===!0?l.cert.serialNumber:x.serialNumber);D.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,Y))}}else if(x.name==="cRLDistributionPoints"){x.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var D=x.value.value,j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),te=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),P,M=0;M<x.altNames.length;++M){P=x.altNames[M];var _=P.value;if(P.type===7&&P.ip){if(_=t.util.bytesFromIP(P.ip),_===null){var s=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw s.extension=x,s}}else P.type===8&&(P.oid?_=e.oidToDer(e.oidToDer(P.oid)):_=e.oidToDer(_));te.value.push(e.create(e.Class.CONTEXT_SPECIFIC,P.type,!1,_))}j.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[te])),D.push(j)}if(typeof x.value>"u"){var s=new Error("Extension value not specified.");throw s.extension=x,s}return x}function c(x,l){switch(x){case a["RSASSA-PSS"]:var s=[];return l.hash.algorithmOid!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(l.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),l.mgf.algorithmOid!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(l.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(l.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),l.saltLength!==void 0&&s.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(l.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,s);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function g(x){var l=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(x.attributes.length===0)return l;for(var s=x.attributes,w=0;w<s.length;++w){var N=s[w],K=N.value,_=e.Type.UTF8;"valueTagClass"in N&&(_=N.valueTagClass),_===e.Type.UTF8&&(K=t.util.encodeUtf8(K));var D=!1;"valueConstructed"in N&&(D=N.valueConstructed);var V=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(N.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,_,D,K)])]);l.value.push(V)}return l}var E=new Date("1950-01-01T00:00:00Z"),A=new Date("2050-01-01T00:00:00Z");function I(x){return x>=E&&x<A?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(x)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(x))}return r.getTBSCertificate=function(x){var l=I(x.validity.notBefore),s=I(x.validity.notAfter),w=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(x.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.siginfo.algorithmOid).getBytes()),c(x.siginfo.algorithmOid,x.siginfo.parameters)]),p(x.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[l,s]),p(x.subject),r.publicKeyToAsn1(x.publicKey)]);return x.issuer.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.issuer.uniqueId)])),x.subject.uniqueId&&w.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.subject.uniqueId)])),x.extensions.length>0&&w.value.push(r.certificateExtensionsToAsn1(x.extensions)),w},r.getCertificationRequestInfo=function(x){var l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(x.version).getBytes()),p(x.subject),r.publicKeyToAsn1(x.publicKey),g(x)]);return l},r.distinguishedNameToAsn1=function(x){return p(x)},r.certificateToAsn1=function(x){var l=x.tbsCertificate||r.getTBSCertificate(x);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[l,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.signatureOid).getBytes()),c(x.signatureOid,x.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.signature)])},r.certificateExtensionsToAsn1=function(x){var l=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),s=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);l.value.push(s);for(var w=0;w<x.length;++w)s.value.push(r.certificateExtensionToAsn1(x[w]));return l},r.certificateExtensionToAsn1=function(x){var l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);l.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.id).getBytes())),x.critical&&l.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,""));var s=x.value;return typeof x.value!="string"&&(s=e.toDer(s).getBytes()),l.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s)),l},r.certificationRequestToAsn1=function(x){var l=x.certificationRequestInfo||r.getCertificationRequestInfo(x);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[l,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(x.signatureOid).getBytes()),c(x.signatureOid,x.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+x.signature)])},r.createCaStore=function(x){var l={certs:{}};l.getIssuer=function(_){var D=s(_.issuer);return D},l.addCertificate=function(_){if(typeof _=="string"&&(_=t.pki.certificateFromPem(_)),w(_.subject),!l.hasCertificate(_))if(_.subject.hash in l.certs){var D=l.certs[_.subject.hash];t.util.isArray(D)||(D=[D]),D.push(_),l.certs[_.subject.hash]=D}else l.certs[_.subject.hash]=_},l.hasCertificate=function(_){typeof _=="string"&&(_=t.pki.certificateFromPem(_));var D=s(_.subject);if(!D)return!1;t.util.isArray(D)||(D=[D]);for(var V=e.toDer(r.certificateToAsn1(_)).getBytes(),P=0;P<D.length;++P){var M=e.toDer(r.certificateToAsn1(D[P])).getBytes();if(V===M)return!0}return!1},l.listAllCertificates=function(){var _=[];for(var D in l.certs)if(l.certs.hasOwnProperty(D)){var V=l.certs[D];if(!t.util.isArray(V))_.push(V);else for(var P=0;P<V.length;++P)_.push(V[P])}return _},l.removeCertificate=function(_){var D;if(typeof _=="string"&&(_=t.pki.certificateFromPem(_)),w(_.subject),!l.hasCertificate(_))return null;var V=s(_.subject);if(!t.util.isArray(V))return D=l.certs[_.subject.hash],delete l.certs[_.subject.hash],D;for(var P=e.toDer(r.certificateToAsn1(_)).getBytes(),M=0;M<V.length;++M){var q=e.toDer(r.certificateToAsn1(V[M])).getBytes();P===q&&(D=V[M],V.splice(M,1))}return V.length===0&&delete l.certs[_.subject.hash],D};function s(_){return w(_),l.certs[_.hash]||null}function w(_){if(!_.hash){var D=t.md.sha1.create();_.attributes=r.RDNAttributesAsArray(p(_),D),_.hash=D.digest().toHex()}}if(x)for(var N=0;N<x.length;++N){var K=x[N];l.addCertificate(K)}return l},r.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},r.verifyCertificateChain=function(x,l,s){typeof s=="function"&&(s={verify:s}),s=s||{},l=l.slice(0);var w=l.slice(0),N=s.validityCheckDate;typeof N>"u"&&(N=new Date);var K=!0,_=null,D=0;do{var V=l.shift(),P=null,M=!1;if(N&&(N<V.validity.notBefore||N>V.validity.notAfter)&&(_={message:"Certificate is not valid yet or has expired.",error:r.certificateError.certificate_expired,notBefore:V.validity.notBefore,notAfter:V.validity.notAfter,now:N}),_===null){if(P=l[0]||x.getIssuer(V),P===null&&V.isIssuer(V)&&(M=!0,P=V),P){var q=P;t.util.isArray(q)||(q=[q]);for(var z=!1;!z&&q.length>0;){P=q.shift();try{z=P.verify(V)}catch{}}z||(_={message:"Certificate signature is invalid.",error:r.certificateError.bad_certificate})}_===null&&(!P||M)&&!x.hasCertificate(V)&&(_={message:"Certificate is not trusted.",error:r.certificateError.unknown_ca})}if(_===null&&P&&!V.isIssuer(P)&&(_={message:"Certificate issuer is invalid.",error:r.certificateError.bad_certificate}),_===null)for(var G={keyUsage:!0,basicConstraints:!0},Y=0;_===null&&Y<V.extensions.length;++Y){var j=V.extensions[Y];j.critical&&!(j.name in G)&&(_={message:"Certificate has an unsupported critical extension.",error:r.certificateError.unsupported_certificate})}if(_===null&&(!K||l.length===0&&(!P||M))){var te=V.getExtension("basicConstraints"),ue=V.getExtension("keyUsage");if(ue!==null&&(!ue.keyCertSign||te===null)&&(_={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:r.certificateError.bad_certificate}),_===null&&te!==null&&!te.cA&&(_={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:r.certificateError.bad_certificate}),_===null&&ue!==null&&"pathLenConstraint"in te){var X=D-1;X>te.pathLenConstraint&&(_={message:"Certificate basicConstraints pathLenConstraint violated.",error:r.certificateError.bad_certificate})}}var re=_===null?!0:_.error,W=s.verify?s.verify(re,D,w):re;if(W===!0)_=null;else throw re===!0&&(_={message:"The application rejected the certificate.",error:r.certificateError.bad_certificate}),(W||W===0)&&(typeof W=="object"&&!t.util.isArray(W)?(W.message&&(_.message=W.message),W.error&&(_.error=W.error)):typeof W=="string"&&(_.error=W)),_;K=!1,++D}while(l.length>0);return!0},fa.exports}var Wi;function No(){if(Wi)return sa.exports;Wi=1;var t=ge();Dt(),Hr(),pr(),_o(),Io(),wt(),Bn(),qr(),Ee(),ja();var e=t.asn1,r=t.pki,a=sa.exports=t.pkcs12=t.pkcs12||{},f={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},o={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},f,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},i={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},n={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},u={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function h(b,S,c,g){for(var E=[],A=0;A<b.length;A++)for(var I=0;I<b[A].safeBags.length;I++){var x=b[A].safeBags[I];if(!(g!==void 0&&x.type!==g)){if(S===null){E.push(x);continue}x.attributes[S]!==void 0&&x.attributes[S].indexOf(c)>=0&&E.push(x)}}return E}a.pkcs12FromAsn1=function(b,S,c){typeof S=="string"?(c=S,S=!0):S===void 0&&(S=!0);var g={},E=[];if(!e.validate(b,o,g,E)){var A=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw A.errors=A,A}var I={version:g.version.charCodeAt(0),safeContents:[],getBags:function(P){var M={},q;return"localKeyId"in P?q=P.localKeyId:"localKeyIdHex"in P&&(q=t.util.hexToBytes(P.localKeyIdHex)),q===void 0&&!("friendlyName"in P)&&"bagType"in P&&(M[P.bagType]=h(I.safeContents,null,null,P.bagType)),q!==void 0&&(M.localKeyId=h(I.safeContents,"localKeyId",q,P.bagType)),"friendlyName"in P&&(M.friendlyName=h(I.safeContents,"friendlyName",P.friendlyName,P.bagType)),M},getBagsByFriendlyName:function(P,M){return h(I.safeContents,"friendlyName",P,M)},getBagsByLocalKeyId:function(P,M){return h(I.safeContents,"localKeyId",P,M)}};if(g.version.charCodeAt(0)!==3){var A=new Error("PKCS#12 PFX of version other than 3 not supported.");throw A.version=g.version.charCodeAt(0),A}if(e.derToOid(g.contentType)!==r.oids.data){var A=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw A.oid=e.derToOid(g.contentType),A}var x=g.content.value[0];if(x.tagClass!==e.Class.UNIVERSAL||x.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(x=m(x),g.mac){var l=null,s=0,w=e.derToOid(g.macAlgorithm);switch(w){case r.oids.sha1:l=t.md.sha1.create(),s=20;break;case r.oids.sha256:l=t.md.sha256.create(),s=32;break;case r.oids.sha384:l=t.md.sha384.create(),s=48;break;case r.oids.sha512:l=t.md.sha512.create(),s=64;break;case r.oids.md5:l=t.md.md5.create(),s=16;break}if(l===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+w);var N=new t.util.ByteBuffer(g.macSalt),K="macIterations"in g?parseInt(t.util.bytesToHex(g.macIterations),16):1,_=a.generateKey(c,N,3,K,s,l),D=t.hmac.create();D.start(l,_),D.update(x.value);var V=D.getMac();if(V.getBytes()!==g.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return B(I,x.value,S,c),I};function m(b){if(b.composed||b.constructed){for(var S=t.util.createBuffer(),c=0;c<b.value.length;++c)S.putBytes(b.value[c].value);b.composed=b.constructed=!1,b.value=S.getBytes()}return b}function B(b,S,c,g){if(S=e.fromDer(S,c),S.tagClass!==e.Class.UNIVERSAL||S.type!==e.Type.SEQUENCE||S.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var E=0;E<S.value.length;E++){var A=S.value[E],I={},x=[];if(!e.validate(A,f,I,x)){var l=new Error("Cannot read ContentInfo.");throw l.errors=x,l}var s={encrypted:!1},w=null,N=I.content.value[0];switch(e.derToOid(I.contentType)){case r.oids.data:if(N.tagClass!==e.Class.UNIVERSAL||N.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");w=m(N).value;break;case r.oids.encryptedData:w=v(N,g),s.encrypted=!0;break;default:var l=new Error("Unsupported PKCS#12 contentType.");throw l.contentType=e.derToOid(I.contentType),l}s.safeBags=d(w,c,g),b.safeContents.push(s)}}function v(b,S){var c={},g=[];if(!e.validate(b,t.pkcs7.asn1.encryptedDataValidator,c,g)){var E=new Error("Cannot read EncryptedContentInfo.");throw E.errors=g,E}var A=e.derToOid(c.contentType);if(A!==r.oids.data){var E=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw E.oid=A,E}A=e.derToOid(c.encAlgorithm);var I=r.pbe.getCipher(A,c.encParameter,S),x=m(c.encryptedContentAsn1),l=t.util.createBuffer(x.value);if(I.update(l),!I.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return I.output.getBytes()}function d(b,S,c){if(!S&&b.length===0)return[];if(b=e.fromDer(b,S),b.tagClass!==e.Class.UNIVERSAL||b.type!==e.Type.SEQUENCE||b.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var g=[],E=0;E<b.value.length;E++){var A=b.value[E],I={},x=[];if(!e.validate(A,i,I,x)){var l=new Error("Cannot read SafeBag.");throw l.errors=x,l}var s={type:e.derToOid(I.bagId),attributes:p(I.bagAttributes)};g.push(s);var w,N,K=I.bagValue.value[0];switch(s.type){case r.oids.pkcs8ShroudedKeyBag:if(K=r.decryptPrivateKeyInfo(K,c),K===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case r.oids.keyBag:try{s.key=r.privateKeyFromAsn1(K)}catch{s.key=null,s.asn1=K}continue;case r.oids.certBag:w=u,N=function(){if(e.derToOid(I.certId)!==r.oids.x509Certificate){var D=new Error("Unsupported certificate type, only X.509 supported.");throw D.oid=e.derToOid(I.certId),D}var V=e.fromDer(I.cert,S);try{s.cert=r.certificateFromAsn1(V,!0)}catch{s.cert=null,s.asn1=V}};break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=s.type,l}if(w!==void 0&&!e.validate(K,w,I,x)){var l=new Error("Cannot read PKCS#12 "+w.name);throw l.errors=x,l}N()}return g}function p(b){var S={};if(b!==void 0)for(var c=0;c<b.length;++c){var g={},E=[];if(!e.validate(b[c],n,g,E)){var A=new Error("Cannot read PKCS#12 BagAttribute.");throw A.errors=E,A}var I=e.derToOid(g.oid);if(r.oids[I]!==void 0){S[r.oids[I]]=[];for(var x=0;x<g.values.length;++x)S[r.oids[I]].push(g.values[x].value)}}return S}return a.toPkcs12Asn1=function(b,S,c,g){g=g||{},g.saltSize=g.saltSize||8,g.count=g.count||2048,g.algorithm=g.algorithm||g.encAlgorithm||"aes128","useMac"in g||(g.useMac=!0),"localKeyId"in g||(g.localKeyId=null),"generateLocalKeyId"in g||(g.generateLocalKeyId=!0);var E=g.localKeyId,A;if(E!==null)E=t.util.hexToBytes(E);else if(g.generateLocalKeyId)if(S){var I=t.util.isArray(S)?S[0]:S;typeof I=="string"&&(I=r.certificateFromPem(I));var x=t.md.sha1.create();x.update(e.toDer(r.certificateToAsn1(I)).getBytes()),E=x.digest().getBytes()}else E=t.random.getBytes(20);var l=[];E!==null&&l.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,E)])])),"friendlyName"in g&&l.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,g.friendlyName)])])),l.length>0&&(A=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,l));var s=[],w=[];S!==null&&(t.util.isArray(S)?w=S:w=[S]);for(var N=[],K=0;K<w.length;++K){S=w[K],typeof S=="string"&&(S=r.certificateFromPem(S));var _=K===0?A:void 0,D=r.certificateToAsn1(S),V=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(D).getBytes())])])]),_]);N.push(V)}if(N.length>0){var P=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,N),M=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(P).getBytes())])]);s.push(M)}var q=null;if(b!==null){var z=r.wrapRsaPrivateKey(r.privateKeyToAsn1(b));c===null?q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[z]),A]):q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[r.encryptPrivateKeyInfo(z,c,g)]),A]);var G=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[q]),Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(G).getBytes())])]);s.push(Y)}var j=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,s),te;if(g.useMac){var x=t.md.sha1.create(),ue=new t.util.ByteBuffer(t.random.getBytes(g.saltSize)),X=g.count,b=a.generateKey(c,ue,3,X,20),re=t.hmac.create();re.start(x,b),re.update(e.toDer(j).getBytes());var W=re.getMac();te=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,W.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ue.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(X).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(j).getBytes())])]),te])},a.generateKey=t.pbe.generatePkcs12Key,sa.exports}var Ji;function ko(){if(Ji)return Xn.exports;Ji=1;var t=ge();Dt(),pr(),Io(),Cr(),Qa(),No(),Xa(),Bn(),Ee(),ja();var e=t.asn1,r=Xn.exports=t.pki=t.pki||{};return r.pemToDer=function(a){var f=t.pem.decode(a)[0];if(f.procType&&f.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(f.body)},r.privateKeyFromPem=function(a){var f=t.pem.decode(a)[0];if(f.type!=="PRIVATE KEY"&&f.type!=="RSA PRIVATE KEY"){var o=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw o.headerType=f.type,o}if(f.procType&&f.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var i=e.fromDer(f.body);return r.privateKeyFromAsn1(i)},r.privateKeyToPem=function(a,f){var o={type:"RSA PRIVATE KEY",body:e.toDer(r.privateKeyToAsn1(a)).getBytes()};return t.pem.encode(o,{maxline:f})},r.privateKeyInfoToPem=function(a,f){var o={type:"PRIVATE KEY",body:e.toDer(a).getBytes()};return t.pem.encode(o,{maxline:f})},Xn.exports}var ha,es;function Lo(){if(es)return ha;es=1;var t=ge();Dt(),Hr(),za(),Cr(),ko(),wt(),qr(),Ee();var e=function(C,U,L,y){var R=t.util.createBuffer(),H=C.length>>1,F=H+(C.length&1),J=C.substr(0,F),ie=C.substr(H,F),ce=t.util.createBuffer(),Q=t.hmac.create();L=U+L;var se=Math.ceil(y/16),he=Math.ceil(y/20);Q.start("MD5",J);var ve=t.util.createBuffer();ce.putBytes(L);for(var ye=0;ye<se;++ye)Q.start(null,null),Q.update(ce.getBytes()),ce.putBuffer(Q.digest()),Q.start(null,null),Q.update(ce.bytes()+L),ve.putBuffer(Q.digest());Q.start("SHA1",ie);var we=t.util.createBuffer();ce.clear(),ce.putBytes(L);for(var ye=0;ye<he;++ye)Q.start(null,null),Q.update(ce.getBytes()),ce.putBuffer(Q.digest()),Q.start(null,null),Q.update(ce.bytes()+L),we.putBuffer(Q.digest());return R.putBytes(t.util.xorBytes(ve.getBytes(),we.getBytes(),y)),R},r=function(C,U,L){var y=t.hmac.create();y.start("SHA1",C);var R=t.util.createBuffer();return R.putInt32(U[0]),R.putInt32(U[1]),R.putByte(L.type),R.putByte(L.version.major),R.putByte(L.version.minor),R.putInt16(L.length),R.putBytes(L.fragment.bytes()),y.update(R.getBytes()),y.digest().getBytes()},a=function(C,U,L){var y=!1;try{var R=C.deflate(U.fragment.getBytes());U.fragment=t.util.createBuffer(R),U.length=R.length,y=!0}catch{}return y},f=function(C,U,L){var y=!1;try{var R=C.inflate(U.fragment.getBytes());U.fragment=t.util.createBuffer(R),U.length=R.length,y=!0}catch{}return y},o=function(C,U){var L=0;switch(U){case 1:L=C.getByte();break;case 2:L=C.getInt16();break;case 3:L=C.getInt24();break;case 4:L=C.getInt32();break}return t.util.createBuffer(C.getBytes(L))},i=function(C,U,L){C.putInt(L.length(),U<<3),C.putBuffer(L)},n={};n.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},n.SupportedVersions=[n.Versions.TLS_1_1,n.Versions.TLS_1_0],n.Version=n.SupportedVersions[0],n.MaxFragment=15360,n.ConnectionEnd={server:0,client:1},n.PRFAlgorithm={tls_prf_sha256:0},n.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},n.CipherType={stream:0,block:1,aead:2},n.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},n.CompressionMethod={none:0,deflate:1},n.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},n.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},n.Alert={},n.Alert.Level={warning:1,fatal:2},n.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},n.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},n.CipherSuites={},n.getCipherSuite=function(C){var U=null;for(var L in n.CipherSuites){var y=n.CipherSuites[L];if(y.id[0]===C.charCodeAt(0)&&y.id[1]===C.charCodeAt(1)){U=y;break}}return U},n.handleUnexpected=function(C,U){var L=!C.open&&C.entity===n.ConnectionEnd.client;L||C.error(C,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unexpected_message}})},n.handleHelloRequest=function(C,U,L){!C.handshaking&&C.handshakes>0&&(n.queue(C,n.createAlert(C,{level:n.Alert.Level.warning,description:n.Alert.Description.no_renegotiation})),n.flush(C)),C.process()},n.parseHelloMessage=function(C,U,L){var y=null,R=C.entity===n.ConnectionEnd.client;if(L<38)C.error(C,{message:R?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});else{var H=U.fragment,F=H.length();if(y={version:{major:H.getByte(),minor:H.getByte()},random:t.util.createBuffer(H.getBytes(32)),session_id:o(H,1),extensions:[]},R?(y.cipher_suite=H.getBytes(2),y.compression_method=H.getByte()):(y.cipher_suites=o(H,2),y.compression_methods=o(H,1)),F=L-(F-H.length()),F>0){for(var J=o(H,2);J.length()>0;)y.extensions.push({type:[J.getByte(),J.getByte()],data:o(J,2)});if(!R)for(var ie=0;ie<y.extensions.length;++ie){var ce=y.extensions[ie];if(ce.type[0]===0&&ce.type[1]===0)for(var Q=o(ce.data,2);Q.length()>0;){var se=Q.getByte();if(se!==0)break;C.session.extensions.server_name.serverNameList.push(o(Q,2).getBytes())}}}if(C.session.version&&(y.version.major!==C.session.version.major||y.version.minor!==C.session.version.minor))return C.error(C,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}});if(R)C.session.cipherSuite=n.getCipherSuite(y.cipher_suite);else for(var he=t.util.createBuffer(y.cipher_suites.bytes());he.length()>0&&(C.session.cipherSuite=n.getCipherSuite(he.getBytes(2)),C.session.cipherSuite===null););if(C.session.cipherSuite===null)return C.error(C,{message:"No cipher suites in common.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.handshake_failure},cipherSuite:t.util.bytesToHex(y.cipher_suite)});R?C.session.compressionMethod=y.compression_method:C.session.compressionMethod=n.CompressionMethod.none}return y},n.createSecurityParameters=function(C,U){var L=C.entity===n.ConnectionEnd.client,y=U.random.bytes(),R=L?C.session.sp.client_random:y,H=L?y:n.createRandom().getBytes();C.session.sp={entity:C.entity,prf_algorithm:n.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:C.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:R,server_random:H}},n.handleServerHello=function(C,U,L){var y=n.parseHelloMessage(C,U,L);if(!C.fail){if(y.version.minor<=C.version.minor)C.version.minor=y.version.minor;else return C.error(C,{message:"Incompatible TLS version.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}});C.session.version=C.version;var R=y.session_id.bytes();R.length>0&&R===C.session.id?(C.expect=d,C.session.resuming=!0,C.session.sp.server_random=y.random.bytes()):(C.expect=h,C.session.resuming=!1,n.createSecurityParameters(C,y)),C.session.id=R,C.process()}},n.handleClientHello=function(C,U,L){var y=n.parseHelloMessage(C,U,L);if(!C.fail){var R=y.session_id.bytes(),H=null;if(C.sessionCache&&(H=C.sessionCache.getSession(R),H===null?R="":(H.version.major!==y.version.major||H.version.minor>y.version.minor)&&(H=null,R="")),R.length===0&&(R=t.random.getBytes(32)),C.session.id=R,C.session.clientHelloVersion=y.version,C.session.sp={},H)C.version=C.session.version=H.version,C.session.sp=H.sp;else{for(var F,J=1;J<n.SupportedVersions.length&&(F=n.SupportedVersions[J],!(F.minor<=y.version.minor));++J);C.version={major:F.major,minor:F.minor},C.session.version=C.version}H!==null?(C.expect=I,C.session.resuming=!0,C.session.sp.client_random=y.random.bytes()):(C.expect=C.verifyClient!==!1?g:E,C.session.resuming=!1,n.createSecurityParameters(C,y)),C.open=!0,n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createServerHello(C)})),C.session.resuming?(n.queue(C,n.createRecord(C,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),C.state.pending=n.createConnectionState(C),C.state.current.write=C.state.pending.write,n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createFinished(C)}))):(n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createCertificate(C)})),C.fail||(n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createServerKeyExchange(C)})),C.verifyClient!==!1&&n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createCertificateRequest(C)})),n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createServerHelloDone(C)})))),n.flush(C),C.process()}},n.handleCertificate=function(C,U,L){if(L<3)return C.error(C,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var y=U.fragment,R={certificate_list:o(y,3)},H,F,J=[];try{for(;R.certificate_list.length()>0;)H=o(R.certificate_list,3),F=t.asn1.fromDer(H),H=t.pki.certificateFromAsn1(F,!0),J.push(H)}catch(ce){return C.error(C,{message:"Could not parse certificate list.",cause:ce,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate}})}var ie=C.entity===n.ConnectionEnd.client;(ie||C.verifyClient===!0)&&J.length===0?C.error(C,{message:ie?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}}):J.length===0?C.expect=ie?m:E:(ie?C.session.serverCertificate=J[0]:C.session.clientCertificate=J[0],n.verifyCertificateChain(C,J)&&(C.expect=ie?m:E)),C.process()},n.handleServerKeyExchange=function(C,U,L){if(L>0)return C.error(C,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unsupported_certificate}});C.expect=B,C.process()},n.handleClientKeyExchange=function(C,U,L){if(L<48)return C.error(C,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unsupported_certificate}});var y=U.fragment,R={enc_pre_master_secret:o(y,2).getBytes()},H=null;if(C.getPrivateKey)try{H=C.getPrivateKey(C,C.session.serverCertificate),H=t.pki.privateKeyFromPem(H)}catch(ie){C.error(C,{message:"Could not get private key.",cause:ie,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}})}if(H===null)return C.error(C,{message:"No private key set.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}});try{var F=C.session.sp;F.pre_master_secret=H.decrypt(R.enc_pre_master_secret);var J=C.session.clientHelloVersion;if(J.major!==F.pre_master_secret.charCodeAt(0)||J.minor!==F.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{F.pre_master_secret=t.random.getBytes(48)}C.expect=I,C.session.clientCertificate!==null&&(C.expect=A),C.process()},n.handleCertificateRequest=function(C,U,L){if(L<3)return C.error(C,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var y=U.fragment,R={certificate_types:o(y,1),certificate_authorities:o(y,2)};C.session.certificateRequest=R,C.expect=v,C.process()},n.handleCertificateVerify=function(C,U,L){if(L<2)return C.error(C,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var y=U.fragment;y.read-=4;var R=y.bytes();y.read+=4;var H={signature:o(y,2).getBytes()},F=t.util.createBuffer();F.putBuffer(C.session.md5.digest()),F.putBuffer(C.session.sha1.digest()),F=F.getBytes();try{var J=C.session.clientCertificate;if(!J.publicKey.verify(F,H.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");C.session.md5.update(R),C.session.sha1.update(R)}catch{return C.error(C,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.handshake_failure}})}C.expect=I,C.process()},n.handleServerHelloDone=function(C,U,L){if(L>0)return C.error(C,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.record_overflow}});if(C.serverCertificate===null){var y={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.insufficient_security}},R=0,H=C.verify(C,y.alert.description,R,[]);if(H!==!0)return(H||H===0)&&(typeof H=="object"&&!t.util.isArray(H)?(H.message&&(y.message=H.message),H.alert&&(y.alert.description=H.alert)):typeof H=="number"&&(y.alert.description=H)),C.error(C,y)}C.session.certificateRequest!==null&&(U=n.createRecord(C,{type:n.ContentType.handshake,data:n.createCertificate(C)}),n.queue(C,U)),U=n.createRecord(C,{type:n.ContentType.handshake,data:n.createClientKeyExchange(C)}),n.queue(C,U),C.expect=S;var F=function(J,ie){J.session.certificateRequest!==null&&J.session.clientCertificate!==null&&n.queue(J,n.createRecord(J,{type:n.ContentType.handshake,data:n.createCertificateVerify(J,ie)})),n.queue(J,n.createRecord(J,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),J.state.pending=n.createConnectionState(J),J.state.current.write=J.state.pending.write,n.queue(J,n.createRecord(J,{type:n.ContentType.handshake,data:n.createFinished(J)})),J.expect=d,n.flush(J),J.process()};if(C.session.certificateRequest===null||C.session.clientCertificate===null)return F(C,null);n.getClientSignature(C,F)},n.handleChangeCipherSpec=function(C,U){if(U.fragment.getByte()!==1)return C.error(C,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.illegal_parameter}});var L=C.entity===n.ConnectionEnd.client;(C.session.resuming&&L||!C.session.resuming&&!L)&&(C.state.pending=n.createConnectionState(C)),C.state.current.read=C.state.pending.read,(!C.session.resuming&&L||C.session.resuming&&!L)&&(C.state.pending=null),C.expect=L?p:x,C.process()},n.handleFinished=function(C,U,L){var y=U.fragment;y.read-=4;var R=y.bytes();y.read+=4;var H=U.fragment.getBytes();y=t.util.createBuffer(),y.putBuffer(C.session.md5.digest()),y.putBuffer(C.session.sha1.digest());var F=C.entity===n.ConnectionEnd.client,J=F?"server finished":"client finished",ie=C.session.sp,ce=12,Q=e;if(y=Q(ie.master_secret,J,y.getBytes(),ce),y.getBytes()!==H)return C.error(C,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.decrypt_error}});C.session.md5.update(R),C.session.sha1.update(R),(C.session.resuming&&F||!C.session.resuming&&!F)&&(n.queue(C,n.createRecord(C,{type:n.ContentType.change_cipher_spec,data:n.createChangeCipherSpec()})),C.state.current.write=C.state.pending.write,C.state.pending=null,n.queue(C,n.createRecord(C,{type:n.ContentType.handshake,data:n.createFinished(C)}))),C.expect=F?b:l,C.handshaking=!1,++C.handshakes,C.peerCertificate=F?C.session.serverCertificate:C.session.clientCertificate,n.flush(C),C.isConnected=!0,C.connected(C),C.process()},n.handleAlert=function(C,U){var L=U.fragment,y={level:L.getByte(),description:L.getByte()},R;switch(y.description){case n.Alert.Description.close_notify:R="Connection closed.";break;case n.Alert.Description.unexpected_message:R="Unexpected message.";break;case n.Alert.Description.bad_record_mac:R="Bad record MAC.";break;case n.Alert.Description.decryption_failed:R="Decryption failed.";break;case n.Alert.Description.record_overflow:R="Record overflow.";break;case n.Alert.Description.decompression_failure:R="Decompression failed.";break;case n.Alert.Description.handshake_failure:R="Handshake failure.";break;case n.Alert.Description.bad_certificate:R="Bad certificate.";break;case n.Alert.Description.unsupported_certificate:R="Unsupported certificate.";break;case n.Alert.Description.certificate_revoked:R="Certificate revoked.";break;case n.Alert.Description.certificate_expired:R="Certificate expired.";break;case n.Alert.Description.certificate_unknown:R="Certificate unknown.";break;case n.Alert.Description.illegal_parameter:R="Illegal parameter.";break;case n.Alert.Description.unknown_ca:R="Unknown certificate authority.";break;case n.Alert.Description.access_denied:R="Access denied.";break;case n.Alert.Description.decode_error:R="Decode error.";break;case n.Alert.Description.decrypt_error:R="Decrypt error.";break;case n.Alert.Description.export_restriction:R="Export restriction.";break;case n.Alert.Description.protocol_version:R="Unsupported protocol version.";break;case n.Alert.Description.insufficient_security:R="Insufficient security.";break;case n.Alert.Description.internal_error:R="Internal error.";break;case n.Alert.Description.user_canceled:R="User canceled.";break;case n.Alert.Description.no_renegotiation:R="Renegotiation not supported.";break;default:R="Unknown error.";break}if(y.description===n.Alert.Description.close_notify)return C.close();C.error(C,{message:R,send:!1,origin:C.entity===n.ConnectionEnd.client?"server":"client",alert:y}),C.process()},n.handleHandshake=function(C,U){var L=U.fragment,y=L.getByte(),R=L.getInt24();if(R>L.length())return C.fragmented=U,U.fragment=t.util.createBuffer(),L.read-=4,C.process();C.fragmented=null,L.read-=4;var H=L.bytes(R+4);L.read+=4,y in te[C.entity][C.expect]?(C.entity===n.ConnectionEnd.server&&!C.open&&!C.fail&&(C.handshaking=!0,C.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:t.md.md5.create(),sha1:t.md.sha1.create()}),y!==n.HandshakeType.hello_request&&y!==n.HandshakeType.certificate_verify&&y!==n.HandshakeType.finished&&(C.session.md5.update(H),C.session.sha1.update(H)),te[C.entity][C.expect][y](C,U,R)):n.handleUnexpected(C,U)},n.handleApplicationData=function(C,U){C.data.putBuffer(U.fragment),C.dataReady(C),C.process()},n.handleHeartbeat=function(C,U){var L=U.fragment,y=L.getByte(),R=L.getInt16(),H=L.getBytes(R);if(y===n.HeartbeatMessageType.heartbeat_request){if(C.handshaking||R>H.length)return C.process();n.queue(C,n.createRecord(C,{type:n.ContentType.heartbeat,data:n.createHeartbeat(n.HeartbeatMessageType.heartbeat_response,H)})),n.flush(C)}else if(y===n.HeartbeatMessageType.heartbeat_response){if(H!==C.expectedHeartbeatPayload)return C.process();C.heartbeatReceived&&C.heartbeatReceived(C,t.util.createBuffer(H))}C.process()};var u=0,h=1,m=2,B=3,v=4,d=5,p=6,b=7,S=8,c=0,g=1,E=2,A=3,I=4,x=5,l=6,s=n.handleUnexpected,w=n.handleChangeCipherSpec,N=n.handleAlert,K=n.handleHandshake,_=n.handleApplicationData,D=n.handleHeartbeat,V=[];V[n.ConnectionEnd.client]=[[s,N,K,s,D],[s,N,K,s,D],[s,N,K,s,D],[s,N,K,s,D],[s,N,K,s,D],[w,N,s,s,D],[s,N,K,s,D],[s,N,K,_,D],[s,N,K,s,D]],V[n.ConnectionEnd.server]=[[s,N,K,s,D],[s,N,K,s,D],[s,N,K,s,D],[s,N,K,s,D],[w,N,s,s,D],[s,N,K,s,D],[s,N,K,_,D],[s,N,K,s,D]];var P=n.handleHelloRequest,M=n.handleServerHello,q=n.handleCertificate,z=n.handleServerKeyExchange,G=n.handleCertificateRequest,Y=n.handleServerHelloDone,j=n.handleFinished,te=[];te[n.ConnectionEnd.client]=[[s,s,M,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,q,z,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,z,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,G,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,Y,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,j],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[P,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s]];var ue=n.handleClientHello,X=n.handleClientKeyExchange,re=n.handleCertificateVerify;te[n.ConnectionEnd.server]=[[s,ue,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,q,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,X,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,re,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,j],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s]],n.generateKeys=function(C,U){var L=e,y=U.client_random+U.server_random;C.session.resuming||(U.master_secret=L(U.pre_master_secret,"master secret",y,48).bytes(),U.pre_master_secret=null),y=U.server_random+U.client_random;var R=2*U.mac_key_length+2*U.enc_key_length,H=C.version.major===n.Versions.TLS_1_0.major&&C.version.minor===n.Versions.TLS_1_0.minor;H&&(R+=2*U.fixed_iv_length);var F=L(U.master_secret,"key expansion",y,R),J={client_write_MAC_key:F.getBytes(U.mac_key_length),server_write_MAC_key:F.getBytes(U.mac_key_length),client_write_key:F.getBytes(U.enc_key_length),server_write_key:F.getBytes(U.enc_key_length)};return H&&(J.client_write_IV=F.getBytes(U.fixed_iv_length),J.server_write_IV=F.getBytes(U.fixed_iv_length)),J},n.createConnectionState=function(C){var U=C.entity===n.ConnectionEnd.client,L=function(){var H={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(F){return!0},compressionState:null,compressFunction:function(F){return!0},updateSequenceNumber:function(){H.sequenceNumber[1]===4294967295?(H.sequenceNumber[1]=0,++H.sequenceNumber[0]):++H.sequenceNumber[1]}};return H},y={read:L(),write:L()};if(y.read.update=function(H,F){return y.read.cipherFunction(F,y.read)?y.read.compressFunction(H,F,y.read)||H.error(H,{message:"Could not decompress record.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.decompression_failure}}):H.error(H,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_record_mac}}),!H.fail},y.write.update=function(H,F){return y.write.compressFunction(H,F,y.write)?y.write.cipherFunction(F,y.write)||H.error(H,{message:"Could not encrypt record.",send:!1,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}):H.error(H,{message:"Could not compress record.",send:!1,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}),!H.fail},C.session){var R=C.session.sp;switch(C.session.cipherSuite.initSecurityParameters(R),R.keys=n.generateKeys(C,R),y.read.macKey=U?R.keys.server_write_MAC_key:R.keys.client_write_MAC_key,y.write.macKey=U?R.keys.client_write_MAC_key:R.keys.server_write_MAC_key,C.session.cipherSuite.initConnectionState(y,C,R),R.compression_algorithm){case n.CompressionMethod.none:break;case n.CompressionMethod.deflate:y.read.compressFunction=f,y.write.compressFunction=a;break;default:throw new Error("Unsupported compression algorithm.")}}return y},n.createRandom=function(){var C=new Date,U=+C+C.getTimezoneOffset()*6e4,L=t.util.createBuffer();return L.putInt32(U),L.putBytes(t.random.getBytes(28)),L},n.createRecord=function(C,U){if(!U.data)return null;var L={type:U.type,version:{major:C.version.major,minor:C.version.minor},length:U.data.length(),fragment:U.data};return L},n.createAlert=function(C,U){var L=t.util.createBuffer();return L.putByte(U.level),L.putByte(U.description),n.createRecord(C,{type:n.ContentType.alert,data:L})},n.createClientHello=function(C){C.session.clientHelloVersion={major:C.version.major,minor:C.version.minor};for(var U=t.util.createBuffer(),L=0;L<C.cipherSuites.length;++L){var y=C.cipherSuites[L];U.putByte(y.id[0]),U.putByte(y.id[1])}var R=U.length(),H=t.util.createBuffer();H.putByte(n.CompressionMethod.none);var F=H.length(),J=t.util.createBuffer();if(C.virtualHost){var ie=t.util.createBuffer();ie.putByte(0),ie.putByte(0);var ce=t.util.createBuffer();ce.putByte(0),i(ce,2,t.util.createBuffer(C.virtualHost));var Q=t.util.createBuffer();i(Q,2,ce),i(ie,2,Q),J.putBuffer(ie)}var se=J.length();se>0&&(se+=2);var he=C.session.id,ve=he.length+1+2+4+28+2+R+1+F+se,ye=t.util.createBuffer();return ye.putByte(n.HandshakeType.client_hello),ye.putInt24(ve),ye.putByte(C.version.major),ye.putByte(C.version.minor),ye.putBytes(C.session.sp.client_random),i(ye,1,t.util.createBuffer(he)),i(ye,2,U),i(ye,1,H),se>0&&i(ye,2,J),ye},n.createServerHello=function(C){var U=C.session.id,L=U.length+1+2+4+28+2+1,y=t.util.createBuffer();return y.putByte(n.HandshakeType.server_hello),y.putInt24(L),y.putByte(C.version.major),y.putByte(C.version.minor),y.putBytes(C.session.sp.server_random),i(y,1,t.util.createBuffer(U)),y.putByte(C.session.cipherSuite.id[0]),y.putByte(C.session.cipherSuite.id[1]),y.putByte(C.session.compressionMethod),y},n.createCertificate=function(C){var U=C.entity===n.ConnectionEnd.client,L=null;if(C.getCertificate){var y;U?y=C.session.certificateRequest:y=C.session.extensions.server_name.serverNameList,L=C.getCertificate(C,y)}var R=t.util.createBuffer();if(L!==null)try{t.util.isArray(L)||(L=[L]);for(var H=null,F=0;F<L.length;++F){var J=t.pem.decode(L[F])[0];if(J.type!=="CERTIFICATE"&&J.type!=="X509 CERTIFICATE"&&J.type!=="TRUSTED CERTIFICATE"){var ie=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ie.headerType=J.type,ie}if(J.procType&&J.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ce=t.util.createBuffer(J.body);H===null&&(H=t.asn1.fromDer(ce.bytes(),!1));var Q=t.util.createBuffer();i(Q,3,ce),R.putBuffer(Q)}L=t.pki.certificateFromAsn1(H),U?C.session.clientCertificate=L:C.session.serverCertificate=L}catch(ve){return C.error(C,{message:"Could not send certificate list.",cause:ve,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate}})}var se=3+R.length(),he=t.util.createBuffer();return he.putByte(n.HandshakeType.certificate),he.putInt24(se),i(he,3,R),he},n.createClientKeyExchange=function(C){var U=t.util.createBuffer();U.putByte(C.session.clientHelloVersion.major),U.putByte(C.session.clientHelloVersion.minor),U.putBytes(t.random.getBytes(46));var L=C.session.sp;L.pre_master_secret=U.getBytes();var y=C.session.serverCertificate.publicKey;U=y.encrypt(L.pre_master_secret);var R=U.length+2,H=t.util.createBuffer();return H.putByte(n.HandshakeType.client_key_exchange),H.putInt24(R),H.putInt16(U.length),H.putBytes(U),H},n.createServerKeyExchange=function(C){var U=t.util.createBuffer();return U},n.getClientSignature=function(C,U){var L=t.util.createBuffer();L.putBuffer(C.session.md5.digest()),L.putBuffer(C.session.sha1.digest()),L=L.getBytes(),C.getSignature=C.getSignature||function(y,R,H){var F=null;if(y.getPrivateKey)try{F=y.getPrivateKey(y,y.session.clientCertificate),F=t.pki.privateKeyFromPem(F)}catch(J){y.error(y,{message:"Could not get private key.",cause:J,send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}})}F===null?y.error(y,{message:"No private key set.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.internal_error}}):R=F.sign(R,null),H(y,R)},C.getSignature(C,L,U)},n.createCertificateVerify=function(C,U){var L=U.length+2,y=t.util.createBuffer();return y.putByte(n.HandshakeType.certificate_verify),y.putInt24(L),y.putInt16(U.length),y.putBytes(U),y},n.createCertificateRequest=function(C){var U=t.util.createBuffer();U.putByte(1);var L=t.util.createBuffer();for(var y in C.caStore.certs){var R=C.caStore.certs[y],H=t.pki.distinguishedNameToAsn1(R.subject),F=t.asn1.toDer(H);L.putInt16(F.length()),L.putBuffer(F)}var J=1+U.length()+2+L.length(),ie=t.util.createBuffer();return ie.putByte(n.HandshakeType.certificate_request),ie.putInt24(J),i(ie,1,U),i(ie,2,L),ie},n.createServerHelloDone=function(C){var U=t.util.createBuffer();return U.putByte(n.HandshakeType.server_hello_done),U.putInt24(0),U},n.createChangeCipherSpec=function(){var C=t.util.createBuffer();return C.putByte(1),C},n.createFinished=function(C){var U=t.util.createBuffer();U.putBuffer(C.session.md5.digest()),U.putBuffer(C.session.sha1.digest());var L=C.entity===n.ConnectionEnd.client,y=C.session.sp,R=12,H=e,F=L?"client finished":"server finished";U=H(y.master_secret,F,U.getBytes(),R);var J=t.util.createBuffer();return J.putByte(n.HandshakeType.finished),J.putInt24(U.length()),J.putBuffer(U),J},n.createHeartbeat=function(C,U,L){typeof L>"u"&&(L=U.length);var y=t.util.createBuffer();y.putByte(C),y.putInt16(L),y.putBytes(U);var R=y.length(),H=Math.max(16,R-L-3);return y.putBytes(t.random.getBytes(H)),y},n.queue=function(C,U){if(U&&!(U.fragment.length()===0&&(U.type===n.ContentType.handshake||U.type===n.ContentType.alert||U.type===n.ContentType.change_cipher_spec))){if(U.type===n.ContentType.handshake){var L=U.fragment.bytes();C.session.md5.update(L),C.session.sha1.update(L),L=null}var y;if(U.fragment.length()<=n.MaxFragment)y=[U];else{y=[];for(var R=U.fragment.bytes();R.length>n.MaxFragment;)y.push(n.createRecord(C,{type:U.type,data:t.util.createBuffer(R.slice(0,n.MaxFragment))})),R=R.slice(n.MaxFragment);R.length>0&&y.push(n.createRecord(C,{type:U.type,data:t.util.createBuffer(R)}))}for(var H=0;H<y.length&&!C.fail;++H){var F=y[H],J=C.state.current.write;J.update(C,F)&&C.records.push(F)}}},n.flush=function(C){for(var U=0;U<C.records.length;++U){var L=C.records[U];C.tlsData.putByte(L.type),C.tlsData.putByte(L.version.major),C.tlsData.putByte(L.version.minor),C.tlsData.putInt16(L.fragment.length()),C.tlsData.putBuffer(C.records[U].fragment)}return C.records=[],C.tlsDataReady(C)};var W=function(C){switch(C){case!0:return!0;case t.pki.certificateError.bad_certificate:return n.Alert.Description.bad_certificate;case t.pki.certificateError.unsupported_certificate:return n.Alert.Description.unsupported_certificate;case t.pki.certificateError.certificate_revoked:return n.Alert.Description.certificate_revoked;case t.pki.certificateError.certificate_expired:return n.Alert.Description.certificate_expired;case t.pki.certificateError.certificate_unknown:return n.Alert.Description.certificate_unknown;case t.pki.certificateError.unknown_ca:return n.Alert.Description.unknown_ca;default:return n.Alert.Description.bad_certificate}},pe=function(C){switch(C){case!0:return!0;case n.Alert.Description.bad_certificate:return t.pki.certificateError.bad_certificate;case n.Alert.Description.unsupported_certificate:return t.pki.certificateError.unsupported_certificate;case n.Alert.Description.certificate_revoked:return t.pki.certificateError.certificate_revoked;case n.Alert.Description.certificate_expired:return t.pki.certificateError.certificate_expired;case n.Alert.Description.certificate_unknown:return t.pki.certificateError.certificate_unknown;case n.Alert.Description.unknown_ca:return t.pki.certificateError.unknown_ca;default:return t.pki.certificateError.bad_certificate}};n.verifyCertificateChain=function(C,U){try{var L={};for(var y in C.verifyOptions)L[y]=C.verifyOptions[y];L.verify=function(H,F,J){var ie=W(H),ce=C.verify(C,H,F,J);if(ce!==!0){if(typeof ce=="object"&&!t.util.isArray(ce)){var Q=new Error("The application rejected the certificate.");throw Q.send=!0,Q.alert={level:n.Alert.Level.fatal,description:n.Alert.Description.bad_certificate},ce.message&&(Q.message=ce.message),ce.alert&&(Q.alert.description=ce.alert),Q}ce!==H&&(ce=pe(ce))}return ce},t.pki.verifyCertificateChain(C.caStore,U,L)}catch(H){var R=H;(typeof R!="object"||t.util.isArray(R))&&(R={send:!0,alert:{level:n.Alert.Level.fatal,description:W(H)}}),"send"in R||(R.send=!0),"alert"in R||(R.alert={level:n.Alert.Level.fatal,description:W(R.error)}),C.error(C,R)}return!C.fail},n.createSessionCache=function(C,U){var L=null;if(C&&C.getSession&&C.setSession&&C.order)L=C;else{L={},L.cache=C||{},L.capacity=Math.max(U||100,1),L.order=[];for(var y in C)L.order.length<=U?L.order.push(y):delete C[y];L.getSession=function(R){var H=null,F=null;if(R?F=t.util.bytesToHex(R):L.order.length>0&&(F=L.order[0]),F!==null&&F in L.cache){H=L.cache[F],delete L.cache[F];for(var J in L.order)if(L.order[J]===F){L.order.splice(J,1);break}}return H},L.setSession=function(R,H){if(L.order.length===L.capacity){var F=L.order.shift();delete L.cache[F]}var F=t.util.bytesToHex(R);L.order.push(F),L.cache[F]=H}}return L},n.createConnection=function(C){var U=null;C.caStore?t.util.isArray(C.caStore)?U=t.pki.createCaStore(C.caStore):U=C.caStore:U=t.pki.createCaStore();var L=C.cipherSuites||null;if(L===null){L=[];for(var y in n.CipherSuites)L.push(n.CipherSuites[y])}var R=C.server?n.ConnectionEnd.server:n.ConnectionEnd.client,H=C.sessionCache?n.createSessionCache(C.sessionCache):null,F={version:{major:n.Version.major,minor:n.Version.minor},entity:R,sessionId:C.sessionId,caStore:U,sessionCache:H,cipherSuites:L,connected:C.connected,virtualHost:C.virtualHost||null,verifyClient:C.verifyClient||!1,verify:C.verify||function(Q,se,he,ve){return se},verifyOptions:C.verifyOptions||{},getCertificate:C.getCertificate||null,getPrivateKey:C.getPrivateKey||null,getSignature:C.getSignature||null,input:t.util.createBuffer(),tlsData:t.util.createBuffer(),data:t.util.createBuffer(),tlsDataReady:C.tlsDataReady,dataReady:C.dataReady,heartbeatReceived:C.heartbeatReceived,closed:C.closed,error:function(Q,se){se.origin=se.origin||(Q.entity===n.ConnectionEnd.client?"client":"server"),se.send&&(n.queue(Q,n.createAlert(Q,se.alert)),n.flush(Q));var he=se.fatal!==!1;he&&(Q.fail=!0),C.error(Q,se),he&&Q.close(!1)},deflate:C.deflate||null,inflate:C.inflate||null};F.reset=function(Q){F.version={major:n.Version.major,minor:n.Version.minor},F.record=null,F.session=null,F.peerCertificate=null,F.state={pending:null,current:null},F.expect=F.entity===n.ConnectionEnd.client?u:c,F.fragmented=null,F.records=[],F.open=!1,F.handshakes=0,F.handshaking=!1,F.isConnected=!1,F.fail=!(Q||typeof Q>"u"),F.input.clear(),F.tlsData.clear(),F.data.clear(),F.state.current=n.createConnectionState(F)},F.reset();var J=function(Q,se){var he=se.type-n.ContentType.change_cipher_spec,ve=V[Q.entity][Q.expect];he in ve?ve[he](Q,se):n.handleUnexpected(Q,se)},ie=function(Q){var se=0,he=Q.input,ve=he.length();if(ve<5)se=5-ve;else{Q.record={type:he.getByte(),version:{major:he.getByte(),minor:he.getByte()},length:he.getInt16(),fragment:t.util.createBuffer(),ready:!1};var ye=Q.record.version.major===Q.version.major;ye&&Q.session&&Q.session.version&&(ye=Q.record.version.minor===Q.version.minor),ye||Q.error(Q,{message:"Incompatible TLS version.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.protocol_version}})}return se},ce=function(Q){var se=0,he=Q.input,ve=he.length();if(ve<Q.record.length)se=Q.record.length-ve;else{Q.record.fragment.putBytes(he.getBytes(Q.record.length)),he.compact();var ye=Q.state.current.read;ye.update(Q,Q.record)&&(Q.fragmented!==null&&(Q.fragmented.type===Q.record.type?(Q.fragmented.fragment.putBuffer(Q.record.fragment),Q.record=Q.fragmented):Q.error(Q,{message:"Invalid fragmented record.",send:!0,alert:{level:n.Alert.Level.fatal,description:n.Alert.Description.unexpected_message}})),Q.record.ready=!0)}return se};return F.handshake=function(Q){if(F.entity!==n.ConnectionEnd.client)F.error(F,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(F.handshaking)F.error(F,{message:"Handshake already in progress.",fatal:!1});else{F.fail&&!F.open&&F.handshakes===0&&(F.fail=!1),F.handshaking=!0,Q=Q||"";var se=null;Q.length>0&&(F.sessionCache&&(se=F.sessionCache.getSession(Q)),se===null&&(Q="")),Q.length===0&&F.sessionCache&&(se=F.sessionCache.getSession(),se!==null&&(Q=se.id)),F.session={id:Q,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:t.md.md5.create(),sha1:t.md.sha1.create()},se&&(F.version=se.version,F.session.sp=se.sp),F.session.sp.client_random=n.createRandom().getBytes(),F.open=!0,n.queue(F,n.createRecord(F,{type:n.ContentType.handshake,data:n.createClientHello(F)})),n.flush(F)}},F.process=function(Q){var se=0;return Q&&F.input.putBytes(Q),F.fail||(F.record!==null&&F.record.ready&&F.record.fragment.isEmpty()&&(F.record=null),F.record===null&&(se=ie(F)),!F.fail&&F.record!==null&&!F.record.ready&&(se=ce(F)),!F.fail&&F.record!==null&&F.record.ready&&J(F,F.record)),se},F.prepare=function(Q){return n.queue(F,n.createRecord(F,{type:n.ContentType.application_data,data:t.util.createBuffer(Q)})),n.flush(F)},F.prepareHeartbeatRequest=function(Q,se){return Q instanceof t.util.ByteBuffer&&(Q=Q.bytes()),typeof se>"u"&&(se=Q.length),F.expectedHeartbeatPayload=Q,n.queue(F,n.createRecord(F,{type:n.ContentType.heartbeat,data:n.createHeartbeat(n.HeartbeatMessageType.heartbeat_request,Q,se)})),n.flush(F)},F.close=function(Q){if(!F.fail&&F.sessionCache&&F.session){var se={id:F.session.id,version:F.session.version,sp:F.session.sp};se.sp.keys=null,F.sessionCache.setSession(se.id,se)}F.open&&(F.open=!1,F.input.clear(),(F.isConnected||F.handshaking)&&(F.isConnected=F.handshaking=!1,n.queue(F,n.createAlert(F,{level:n.Alert.Level.warning,description:n.Alert.Description.close_notify})),n.flush(F)),F.closed(F)),F.reset(Q)},F},ha=t.tls=t.tls||{};for(var le in n)typeof n[le]!="function"&&(t.tls[le]=n[le]);return t.tls.prf_tls1=e,t.tls.hmac_sha1=r,t.tls.createSessionCache=n.createSessionCache,t.tls.createConnection=n.createConnection,ha}var ts;function Nu(){if(ts)return Hn.exports;ts=1;var t=ge();dr(),Lo();var e=Hn.exports=t.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(u){u.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,u.cipher_type=e.CipherType.block,u.enc_key_length=16,u.block_length=16,u.fixed_iv_length=16,u.record_iv_length=16,u.mac_algorithm=e.MACAlgorithm.hmac_sha1,u.mac_length=20,u.mac_key_length=20},initConnectionState:r},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(u){u.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,u.cipher_type=e.CipherType.block,u.enc_key_length=32,u.block_length=16,u.fixed_iv_length=16,u.record_iv_length=16,u.mac_algorithm=e.MACAlgorithm.hmac_sha1,u.mac_length=20,u.mac_key_length=20},initConnectionState:r};function r(u,h,m){var B=h.entity===t.tls.ConnectionEnd.client;u.read.cipherState={init:!1,cipher:t.cipher.createDecipher("AES-CBC",B?m.keys.server_write_key:m.keys.client_write_key),iv:B?m.keys.server_write_IV:m.keys.client_write_IV},u.write.cipherState={init:!1,cipher:t.cipher.createCipher("AES-CBC",B?m.keys.client_write_key:m.keys.server_write_key),iv:B?m.keys.client_write_IV:m.keys.server_write_IV},u.read.cipherFunction=i,u.write.cipherFunction=a,u.read.macLength=u.write.macLength=m.mac_length,u.read.macFunction=u.write.macFunction=e.hmac_sha1}function a(u,h){var m=!1,B=h.macFunction(h.macKey,h.sequenceNumber,u);u.fragment.putBytes(B),h.updateSequenceNumber();var v;u.version.minor===e.Versions.TLS_1_0.minor?v=h.cipherState.init?null:h.cipherState.iv:v=t.random.getBytesSync(16),h.cipherState.init=!0;var d=h.cipherState.cipher;return d.start({iv:v}),u.version.minor>=e.Versions.TLS_1_1.minor&&d.output.putBytes(v),d.update(u.fragment),d.finish(f)&&(u.fragment=d.output,u.length=u.fragment.length(),m=!0),m}function f(u,h,m){if(!m){var B=u-h.length()%u;h.fillWithByte(B-1,B)}return!0}function o(u,h,m){var B=!0;if(m){for(var v=h.length(),d=h.last(),p=v-1-d;p<v-1;++p)B=B&&h.at(p)==d;B&&h.truncate(d+1)}return B}function i(u,h){var m=!1,B;u.version.minor===e.Versions.TLS_1_0.minor?B=h.cipherState.init?null:h.cipherState.iv:B=u.fragment.getBytes(16),h.cipherState.init=!0;var v=h.cipherState.cipher;v.start({iv:B}),v.update(u.fragment),m=v.finish(o);var d=h.macLength,p=t.random.getBytesSync(d),b=v.output.length();b>=d?(u.fragment=v.output.getBytes(b-d),p=v.output.getBytes(d)):u.fragment=v.output.getBytes(),u.fragment=t.util.createBuffer(u.fragment),u.length=u.fragment.length();var S=h.macFunction(h.macKey,h.sequenceNumber,u);return h.updateSequenceNumber(),m=n(h.macKey,p,S)&&m,m}function n(u,h,m){var B=t.hmac.create();return B.start("SHA1",u),B.update(h),h=B.digest().getBytes(),B.start(null,null),B.update(m),m=B.digest().getBytes(),h===m}return Hn.exports}var da={exports:{}},rs;function Uo(){if(rs)return da.exports;rs=1;var t=ge();$t(),Ee();var e=da.exports=t.sha512=t.sha512||{};t.md.sha512=t.md.algorithms.sha512=e;var r=t.sha384=t.sha512.sha384=t.sha512.sha384||{};r.create=function(){return e.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=r,t.sha512.sha256=t.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,e.create=function(h){if(f||n(),typeof h>"u"&&(h="SHA-512"),!(h in i))throw new Error("Invalid SHA-512 algorithm: "+h);for(var m=i[h],B=null,v=t.util.createBuffer(),d=new Array(80),p=0;p<80;++p)d[p]=new Array(2);var b=64;switch(h){case"SHA-384":b=48;break;case"SHA-512/256":b=32;break;case"SHA-512/224":b=28;break}var S={algorithm:h.replace("-","").toLowerCase(),blockLength:128,digestLength:b,messageLength:0,fullMessageLength:null,messageLengthSize:16};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength128=[];for(var c=S.messageLengthSize/4,g=0;g<c;++g)S.fullMessageLength.push(0);v=t.util.createBuffer(),B=new Array(m.length);for(var g=0;g<m.length;++g)B[g]=m[g].slice(0);return S},S.start(),S.update=function(c,g){g==="utf8"&&(c=t.util.encodeUtf8(c));var E=c.length;S.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var A=S.fullMessageLength.length-1;A>=0;--A)S.fullMessageLength[A]+=E[1],E[1]=E[0]+(S.fullMessageLength[A]/4294967296>>>0),S.fullMessageLength[A]=S.fullMessageLength[A]>>>0,E[0]=E[1]/4294967296>>>0;return v.putBytes(c),u(B,d,v),(v.read>2048||v.length()===0)&&v.compact(),S},S.digest=function(){var c=t.util.createBuffer();c.putBytes(v.bytes());var g=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,E=g&S.blockLength-1;c.putBytes(a.substr(0,S.blockLength-E));for(var A,I,x=S.fullMessageLength[0]*8,l=0;l<S.fullMessageLength.length-1;++l)A=S.fullMessageLength[l+1]*8,I=A/4294967296>>>0,x+=I,c.putInt32(x>>>0),x=A>>>0;c.putInt32(x);for(var s=new Array(B.length),l=0;l<B.length;++l)s[l]=B[l].slice(0);u(s,d,c);var w=t.util.createBuffer(),N;h==="SHA-512"?N=s.length:h==="SHA-384"?N=s.length-2:N=s.length-4;for(var l=0;l<N;++l)w.putInt32(s[l][0]),(l!==N-1||h!=="SHA-512/224")&&w.putInt32(s[l][1]);return w},S};var a=null,f=!1,o=null,i=null;function n(){a="",a+=t.util.fillString("\0",128),o=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],i={},i["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],i["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],i["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],i["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],f=!0}function u(h,m,B){for(var v,d,p,b,S,c,g,E,A,I,x,l,s,w,N,K,_,D,V,P,M,q,z,G,Y,j,te,ue,X,re,W,pe,le,C,U,L=B.length();L>=128;){for(X=0;X<16;++X)m[X][0]=B.getInt32()>>>0,m[X][1]=B.getInt32()>>>0;for(;X<80;++X)pe=m[X-2],re=pe[0],W=pe[1],v=((re>>>19|W<<13)^(W>>>29|re<<3)^re>>>6)>>>0,d=((re<<13|W>>>19)^(W<<3|re>>>29)^(re<<26|W>>>6))>>>0,C=m[X-15],re=C[0],W=C[1],p=((re>>>1|W<<31)^(re>>>8|W<<24)^re>>>7)>>>0,b=((re<<31|W>>>1)^(re<<24|W>>>8)^(re<<25|W>>>7))>>>0,le=m[X-7],U=m[X-16],W=d+le[1]+b+U[1],m[X][0]=v+le[0]+p+U[0]+(W/4294967296>>>0)>>>0,m[X][1]=W>>>0;for(s=h[0][0],w=h[0][1],N=h[1][0],K=h[1][1],_=h[2][0],D=h[2][1],V=h[3][0],P=h[3][1],M=h[4][0],q=h[4][1],z=h[5][0],G=h[5][1],Y=h[6][0],j=h[6][1],te=h[7][0],ue=h[7][1],X=0;X<80;++X)g=((M>>>14|q<<18)^(M>>>18|q<<14)^(q>>>9|M<<23))>>>0,E=((M<<18|q>>>14)^(M<<14|q>>>18)^(q<<23|M>>>9))>>>0,A=(Y^M&(z^Y))>>>0,I=(j^q&(G^j))>>>0,S=((s>>>28|w<<4)^(w>>>2|s<<30)^(w>>>7|s<<25))>>>0,c=((s<<4|w>>>28)^(w<<30|s>>>2)^(w<<25|s>>>7))>>>0,x=(s&N|_&(s^N))>>>0,l=(w&K|D&(w^K))>>>0,W=ue+E+I+o[X][1]+m[X][1],v=te+g+A+o[X][0]+m[X][0]+(W/4294967296>>>0)>>>0,d=W>>>0,W=c+l,p=S+x+(W/4294967296>>>0)>>>0,b=W>>>0,te=Y,ue=j,Y=z,j=G,z=M,G=q,W=P+d,M=V+v+(W/4294967296>>>0)>>>0,q=W>>>0,V=_,P=D,_=N,D=K,N=s,K=w,W=d+b,s=v+p+(W/4294967296>>>0)>>>0,w=W>>>0;W=h[0][1]+w,h[0][0]=h[0][0]+s+(W/4294967296>>>0)>>>0,h[0][1]=W>>>0,W=h[1][1]+K,h[1][0]=h[1][0]+N+(W/4294967296>>>0)>>>0,h[1][1]=W>>>0,W=h[2][1]+D,h[2][0]=h[2][0]+_+(W/4294967296>>>0)>>>0,h[2][1]=W>>>0,W=h[3][1]+P,h[3][0]=h[3][0]+V+(W/4294967296>>>0)>>>0,h[3][1]=W>>>0,W=h[4][1]+q,h[4][0]=h[4][0]+M+(W/4294967296>>>0)>>>0,h[4][1]=W>>>0,W=h[5][1]+G,h[5][0]=h[5][0]+z+(W/4294967296>>>0)>>>0,h[5][1]=W>>>0,W=h[6][1]+j,h[6][0]=h[6][0]+Y+(W/4294967296>>>0)>>>0,h[6][1]=W>>>0,W=h[7][1]+ue,h[7][0]=h[7][0]+te+(W/4294967296>>>0)>>>0,h[7][1]=W>>>0,L-=128}}return da.exports}var Wr={},ns;function ku(){if(ns)return Wr;ns=1;var t=ge();Dt();var e=t.asn1;return Wr.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Wr.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},Wr}var pa,as;function Lu(){if(as)return pa;as=1;var t=ge();Cn(),wt(),Uo(),Ee();var e=ku(),r=e.publicKeyValidator,a=e.privateKeyValidator;if(typeof f>"u")var f=t.jsbn.BigInteger;var o=t.util.ByteBuffer,i=typeof Buffer>"u"?Uint8Array:Buffer;t.pki=t.pki||{},pa=t.pki.ed25519=t.ed25519=t.ed25519||{};var n=t.ed25519;n.constants={},n.constants.PUBLIC_KEY_BYTE_LENGTH=32,n.constants.PRIVATE_KEY_BYTE_LENGTH=64,n.constants.SEED_BYTE_LENGTH=32,n.constants.SIGN_BYTE_LENGTH=64,n.constants.HASH_BYTE_LENGTH=64,n.generateKeyPair=function(C){C=C||{};var U=C.seed;if(U===void 0)U=t.random.getBytesSync(n.constants.SEED_BYTE_LENGTH);else if(typeof U=="string"){if(U.length!==n.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+n.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(U instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');U=u({message:U,encoding:"binary"});for(var L=new i(n.constants.PUBLIC_KEY_BYTE_LENGTH),y=new i(n.constants.PRIVATE_KEY_BYTE_LENGTH),R=0;R<32;++R)y[R]=U[R];return g(L,y),{publicKey:L,privateKey:y}},n.privateKeyFromAsn1=function(C){var U={},L=[],y=t.asn1.validate(C,a,U,L);if(!y){var R=new Error("Invalid Key.");throw R.errors=L,R}var H=t.asn1.derToOid(U.privateKeyOid),F=t.oids.EdDSA25519;if(H!==F)throw new Error('Invalid OID "'+H+'"; OID must be "'+F+'".');var J=U.privateKey,ie=u({message:t.asn1.fromDer(J).value,encoding:"binary"});return{privateKeyBytes:ie}},n.publicKeyFromAsn1=function(C){var U={},L=[],y=t.asn1.validate(C,r,U,L);if(!y){var R=new Error("Invalid Key.");throw R.errors=L,R}var H=t.asn1.derToOid(U.publicKeyOid),F=t.oids.EdDSA25519;if(H!==F)throw new Error('Invalid OID "'+H+'"; OID must be "'+F+'".');var J=U.ed25519PublicKey;if(J.length!==n.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return u({message:J,encoding:"binary"})},n.publicKeyFromPrivateKey=function(C){C=C||{};var U=u({message:C.privateKey,encoding:"binary"});if(U.length!==n.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+n.constants.PRIVATE_KEY_BYTE_LENGTH);for(var L=new i(n.constants.PUBLIC_KEY_BYTE_LENGTH),y=0;y<L.length;++y)L[y]=U[32+y];return L},n.sign=function(C){C=C||{};var U=u(C),L=u({message:C.privateKey,encoding:"binary"});if(L.length===n.constants.SEED_BYTE_LENGTH){var y=n.generateKeyPair({seed:L});L=y.privateKey}else if(L.length!==n.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+n.constants.SEED_BYTE_LENGTH+" or "+n.constants.PRIVATE_KEY_BYTE_LENGTH);var R=new i(n.constants.SIGN_BYTE_LENGTH+U.length);E(R,U,U.length,L);for(var H=new i(n.constants.SIGN_BYTE_LENGTH),F=0;F<H.length;++F)H[F]=R[F];return H},n.verify=function(C){C=C||{};var U=u(C);if(C.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var L=u({message:C.signature,encoding:"binary"});if(L.length!==n.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+n.constants.SIGN_BYTE_LENGTH);var y=u({message:C.publicKey,encoding:"binary"});if(y.length!==n.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+n.constants.PUBLIC_KEY_BYTE_LENGTH);var R=new i(n.constants.SIGN_BYTE_LENGTH+U.length),H=new i(n.constants.SIGN_BYTE_LENGTH+U.length),F;for(F=0;F<n.constants.SIGN_BYTE_LENGTH;++F)R[F]=L[F];for(F=0;F<U.length;++F)R[F+n.constants.SIGN_BYTE_LENGTH]=U[F];return A(H,R,R.length,y)>=0};function u(C){var U=C.message;if(U instanceof Uint8Array||U instanceof i)return U;var L=C.encoding;if(U===void 0)if(C.md)U=C.md.digest().getBytes(),L="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof U=="string"&&!L)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof U=="string"){if(typeof Buffer<"u")return Buffer.from(U,L);U=new o(U,L)}else if(!(U instanceof o))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var y=new i(U.length()),R=0;R<y.length;++R)y[R]=U.at(R);return y}var h=X(),m=X([1]),B=X([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=X([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=X([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),p=X([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),S=X([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function c(C,U){var L=t.md.sha512.create(),y=new o(C);L.update(y.getBytes(U),"binary");var R=L.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(R,"binary");for(var H=new i(n.constants.HASH_BYTE_LENGTH),F=0;F<64;++F)H[F]=R.charCodeAt(F);return H}function g(C,U){var L=[X(),X(),X(),X()],y,R=c(U,32);for(R[0]&=248,R[31]&=127,R[31]|=64,G(L,R),w(C,L),y=0;y<32;++y)U[y+32]=C[y];return 0}function E(C,U,L,y){var R,H,F=new Float64Array(64),J=[X(),X(),X(),X()],ie=c(y,32);ie[0]&=248,ie[31]&=127,ie[31]|=64;var ce=L+64;for(R=0;R<L;++R)C[64+R]=U[R];for(R=0;R<32;++R)C[32+R]=ie[32+R];var Q=c(C.subarray(32),L+32);for(x(Q),G(J,Q),w(C,J),R=32;R<64;++R)C[R]=y[R];var se=c(C,L+64);for(x(se),R=32;R<64;++R)F[R]=0;for(R=0;R<32;++R)F[R]=Q[R];for(R=0;R<32;++R)for(H=0;H<32;H++)F[R+H]+=se[R]*ie[H];return I(C.subarray(32),F),ce}function A(C,U,L,y){var R,H,F=new i(32),J=[X(),X(),X(),X()],ie=[X(),X(),X(),X()];if(H=-1,L<64||K(ie,y))return-1;for(R=0;R<L;++R)C[R]=U[R];for(R=0;R<32;++R)C[R+32]=y[R];var ce=c(C,L);if(x(ce),z(J,ie,ce),G(ie,U.subarray(32)),l(J,ie),w(F,J),L-=64,P(U,0,F,0)){for(R=0;R<L;++R)C[R]=0;return-1}for(R=0;R<L;++R)C[R]=U[R+64];return H=L,H}function I(C,U){var L,y,R,H;for(y=63;y>=32;--y){for(L=0,R=y-32,H=y-12;R<H;++R)U[R]+=L-16*U[y]*b[R-(y-32)],L=U[R]+128>>8,U[R]-=L*256;U[R]+=L,U[y]=0}for(L=0,R=0;R<32;++R)U[R]+=L-(U[31]>>4)*b[R],L=U[R]>>8,U[R]&=255;for(R=0;R<32;++R)U[R]-=L*b[R];for(y=0;y<32;++y)U[y+1]+=U[y]>>8,C[y]=U[y]&255}function x(C){for(var U=new Float64Array(64),L=0;L<64;++L)U[L]=C[L],C[L]=0;I(C,U)}function l(C,U){var L=X(),y=X(),R=X(),H=X(),F=X(),J=X(),ie=X(),ce=X(),Q=X();W(L,C[1],C[0]),W(Q,U[1],U[0]),le(L,L,Q),re(y,C[0],C[1]),re(Q,U[0],U[1]),le(y,y,Q),le(R,C[3],U[3]),le(R,R,v),le(H,C[2],U[2]),re(H,H,H),W(F,y,L),W(J,H,R),re(ie,H,R),re(ce,y,L),le(C[0],F,J),le(C[1],ce,ie),le(C[2],ie,J),le(C[3],F,ce)}function s(C,U,L){for(var y=0;y<4;++y)ue(C[y],U[y],L)}function w(C,U){var L=X(),y=X(),R=X();j(R,U[2]),le(L,U[0],R),le(y,U[1],R),N(C,y),C[31]^=q(L)<<7}function N(C,U){var L,y,R,H=X(),F=X();for(L=0;L<16;++L)F[L]=U[L];for(te(F),te(F),te(F),y=0;y<2;++y){for(H[0]=F[0]-65517,L=1;L<15;++L)H[L]=F[L]-65535-(H[L-1]>>16&1),H[L-1]&=65535;H[15]=F[15]-32767-(H[14]>>16&1),R=H[15]>>16&1,H[14]&=65535,ue(F,H,1-R)}for(L=0;L<16;L++)C[2*L]=F[L]&255,C[2*L+1]=F[L]>>8}function K(C,U){var L=X(),y=X(),R=X(),H=X(),F=X(),J=X(),ie=X();return Y(C[2],m),_(C[1],U),pe(R,C[1]),le(H,R,B),W(R,R,C[2]),re(H,C[2],H),pe(F,H),pe(J,F),le(ie,J,F),le(L,ie,R),le(L,L,H),D(L,L),le(L,L,R),le(L,L,H),le(L,L,H),le(C[0],L,H),pe(y,C[0]),le(y,y,H),V(y,R)&&le(C[0],C[0],S),pe(y,C[0]),le(y,y,H),V(y,R)?-1:(q(C[0])===U[31]>>7&&W(C[0],h,C[0]),le(C[3],C[0],C[1]),0)}function _(C,U){var L;for(L=0;L<16;++L)C[L]=U[2*L]+(U[2*L+1]<<8);C[15]&=32767}function D(C,U){var L=X(),y;for(y=0;y<16;++y)L[y]=U[y];for(y=250;y>=0;--y)pe(L,L),y!==1&&le(L,L,U);for(y=0;y<16;++y)C[y]=L[y]}function V(C,U){var L=new i(32),y=new i(32);return N(L,C),N(y,U),P(L,0,y,0)}function P(C,U,L,y){return M(C,U,L,y,32)}function M(C,U,L,y,R){var H,F=0;for(H=0;H<R;++H)F|=C[U+H]^L[y+H];return(1&F-1>>>8)-1}function q(C){var U=new i(32);return N(U,C),U[0]&1}function z(C,U,L){var y,R;for(Y(C[0],h),Y(C[1],m),Y(C[2],m),Y(C[3],h),R=255;R>=0;--R)y=L[R/8|0]>>(R&7)&1,s(C,U,y),l(U,C),l(C,C),s(C,U,y)}function G(C,U){var L=[X(),X(),X(),X()];Y(L[0],d),Y(L[1],p),Y(L[2],m),le(L[3],d,p),z(C,L,U)}function Y(C,U){var L;for(L=0;L<16;L++)C[L]=U[L]|0}function j(C,U){var L=X(),y;for(y=0;y<16;++y)L[y]=U[y];for(y=253;y>=0;--y)pe(L,L),y!==2&&y!==4&&le(L,L,U);for(y=0;y<16;++y)C[y]=L[y]}function te(C){var U,L,y=1;for(U=0;U<16;++U)L=C[U]+y+65535,y=Math.floor(L/65536),C[U]=L-y*65536;C[0]+=y-1+37*(y-1)}function ue(C,U,L){for(var y,R=~(L-1),H=0;H<16;++H)y=R&(C[H]^U[H]),C[H]^=y,U[H]^=y}function X(C){var U,L=new Float64Array(16);if(C)for(U=0;U<C.length;++U)L[U]=C[U];return L}function re(C,U,L){for(var y=0;y<16;++y)C[y]=U[y]+L[y]}function W(C,U,L){for(var y=0;y<16;++y)C[y]=U[y]-L[y]}function pe(C,U){le(C,U,U)}function le(C,U,L){var y,R,H=0,F=0,J=0,ie=0,ce=0,Q=0,se=0,he=0,ve=0,ye=0,we=0,Re=0,_e=0,Ae=0,Ce=0,Be=0,Ne=0,je=0,Ze=0,nt=0,at=0,lt=0,pt=0,vt=0,At=0,Pt=0,zt=0,sr=0,gr=0,Br=0,Gr=0,Ue=L[0],De=L[1],Pe=L[2],Ke=L[3],Oe=L[4],Ve=L[5],Fe=L[6],Me=L[7],He=L[8],qe=L[9],Ge=L[10],$e=L[11],Te=L[12],ke=L[13],ze=L[14],Ye=L[15];y=U[0],H+=y*Ue,F+=y*De,J+=y*Pe,ie+=y*Ke,ce+=y*Oe,Q+=y*Ve,se+=y*Fe,he+=y*Me,ve+=y*He,ye+=y*qe,we+=y*Ge,Re+=y*$e,_e+=y*Te,Ae+=y*ke,Ce+=y*ze,Be+=y*Ye,y=U[1],F+=y*Ue,J+=y*De,ie+=y*Pe,ce+=y*Ke,Q+=y*Oe,se+=y*Ve,he+=y*Fe,ve+=y*Me,ye+=y*He,we+=y*qe,Re+=y*Ge,_e+=y*$e,Ae+=y*Te,Ce+=y*ke,Be+=y*ze,Ne+=y*Ye,y=U[2],J+=y*Ue,ie+=y*De,ce+=y*Pe,Q+=y*Ke,se+=y*Oe,he+=y*Ve,ve+=y*Fe,ye+=y*Me,we+=y*He,Re+=y*qe,_e+=y*Ge,Ae+=y*$e,Ce+=y*Te,Be+=y*ke,Ne+=y*ze,je+=y*Ye,y=U[3],ie+=y*Ue,ce+=y*De,Q+=y*Pe,se+=y*Ke,he+=y*Oe,ve+=y*Ve,ye+=y*Fe,we+=y*Me,Re+=y*He,_e+=y*qe,Ae+=y*Ge,Ce+=y*$e,Be+=y*Te,Ne+=y*ke,je+=y*ze,Ze+=y*Ye,y=U[4],ce+=y*Ue,Q+=y*De,se+=y*Pe,he+=y*Ke,ve+=y*Oe,ye+=y*Ve,we+=y*Fe,Re+=y*Me,_e+=y*He,Ae+=y*qe,Ce+=y*Ge,Be+=y*$e,Ne+=y*Te,je+=y*ke,Ze+=y*ze,nt+=y*Ye,y=U[5],Q+=y*Ue,se+=y*De,he+=y*Pe,ve+=y*Ke,ye+=y*Oe,we+=y*Ve,Re+=y*Fe,_e+=y*Me,Ae+=y*He,Ce+=y*qe,Be+=y*Ge,Ne+=y*$e,je+=y*Te,Ze+=y*ke,nt+=y*ze,at+=y*Ye,y=U[6],se+=y*Ue,he+=y*De,ve+=y*Pe,ye+=y*Ke,we+=y*Oe,Re+=y*Ve,_e+=y*Fe,Ae+=y*Me,Ce+=y*He,Be+=y*qe,Ne+=y*Ge,je+=y*$e,Ze+=y*Te,nt+=y*ke,at+=y*ze,lt+=y*Ye,y=U[7],he+=y*Ue,ve+=y*De,ye+=y*Pe,we+=y*Ke,Re+=y*Oe,_e+=y*Ve,Ae+=y*Fe,Ce+=y*Me,Be+=y*He,Ne+=y*qe,je+=y*Ge,Ze+=y*$e,nt+=y*Te,at+=y*ke,lt+=y*ze,pt+=y*Ye,y=U[8],ve+=y*Ue,ye+=y*De,we+=y*Pe,Re+=y*Ke,_e+=y*Oe,Ae+=y*Ve,Ce+=y*Fe,Be+=y*Me,Ne+=y*He,je+=y*qe,Ze+=y*Ge,nt+=y*$e,at+=y*Te,lt+=y*ke,pt+=y*ze,vt+=y*Ye,y=U[9],ye+=y*Ue,we+=y*De,Re+=y*Pe,_e+=y*Ke,Ae+=y*Oe,Ce+=y*Ve,Be+=y*Fe,Ne+=y*Me,je+=y*He,Ze+=y*qe,nt+=y*Ge,at+=y*$e,lt+=y*Te,pt+=y*ke,vt+=y*ze,At+=y*Ye,y=U[10],we+=y*Ue,Re+=y*De,_e+=y*Pe,Ae+=y*Ke,Ce+=y*Oe,Be+=y*Ve,Ne+=y*Fe,je+=y*Me,Ze+=y*He,nt+=y*qe,at+=y*Ge,lt+=y*$e,pt+=y*Te,vt+=y*ke,At+=y*ze,Pt+=y*Ye,y=U[11],Re+=y*Ue,_e+=y*De,Ae+=y*Pe,Ce+=y*Ke,Be+=y*Oe,Ne+=y*Ve,je+=y*Fe,Ze+=y*Me,nt+=y*He,at+=y*qe,lt+=y*Ge,pt+=y*$e,vt+=y*Te,At+=y*ke,Pt+=y*ze,zt+=y*Ye,y=U[12],_e+=y*Ue,Ae+=y*De,Ce+=y*Pe,Be+=y*Ke,Ne+=y*Oe,je+=y*Ve,Ze+=y*Fe,nt+=y*Me,at+=y*He,lt+=y*qe,pt+=y*Ge,vt+=y*$e,At+=y*Te,Pt+=y*ke,zt+=y*ze,sr+=y*Ye,y=U[13],Ae+=y*Ue,Ce+=y*De,Be+=y*Pe,Ne+=y*Ke,je+=y*Oe,Ze+=y*Ve,nt+=y*Fe,at+=y*Me,lt+=y*He,pt+=y*qe,vt+=y*Ge,At+=y*$e,Pt+=y*Te,zt+=y*ke,sr+=y*ze,gr+=y*Ye,y=U[14],Ce+=y*Ue,Be+=y*De,Ne+=y*Pe,je+=y*Ke,Ze+=y*Oe,nt+=y*Ve,at+=y*Fe,lt+=y*Me,pt+=y*He,vt+=y*qe,At+=y*Ge,Pt+=y*$e,zt+=y*Te,sr+=y*ke,gr+=y*ze,Br+=y*Ye,y=U[15],Be+=y*Ue,Ne+=y*De,je+=y*Pe,Ze+=y*Ke,nt+=y*Oe,at+=y*Ve,lt+=y*Fe,pt+=y*Me,vt+=y*He,At+=y*qe,Pt+=y*Ge,zt+=y*$e,sr+=y*Te,gr+=y*ke,Br+=y*ze,Gr+=y*Ye,H+=38*Ne,F+=38*je,J+=38*Ze,ie+=38*nt,ce+=38*at,Q+=38*lt,se+=38*pt,he+=38*vt,ve+=38*At,ye+=38*Pt,we+=38*zt,Re+=38*sr,_e+=38*gr,Ae+=38*Br,Ce+=38*Gr,R=1,y=H+R+65535,R=Math.floor(y/65536),H=y-R*65536,y=F+R+65535,R=Math.floor(y/65536),F=y-R*65536,y=J+R+65535,R=Math.floor(y/65536),J=y-R*65536,y=ie+R+65535,R=Math.floor(y/65536),ie=y-R*65536,y=ce+R+65535,R=Math.floor(y/65536),ce=y-R*65536,y=Q+R+65535,R=Math.floor(y/65536),Q=y-R*65536,y=se+R+65535,R=Math.floor(y/65536),se=y-R*65536,y=he+R+65535,R=Math.floor(y/65536),he=y-R*65536,y=ve+R+65535,R=Math.floor(y/65536),ve=y-R*65536,y=ye+R+65535,R=Math.floor(y/65536),ye=y-R*65536,y=we+R+65535,R=Math.floor(y/65536),we=y-R*65536,y=Re+R+65535,R=Math.floor(y/65536),Re=y-R*65536,y=_e+R+65535,R=Math.floor(y/65536),_e=y-R*65536,y=Ae+R+65535,R=Math.floor(y/65536),Ae=y-R*65536,y=Ce+R+65535,R=Math.floor(y/65536),Ce=y-R*65536,y=Be+R+65535,R=Math.floor(y/65536),Be=y-R*65536,H+=R-1+37*(R-1),R=1,y=H+R+65535,R=Math.floor(y/65536),H=y-R*65536,y=F+R+65535,R=Math.floor(y/65536),F=y-R*65536,y=J+R+65535,R=Math.floor(y/65536),J=y-R*65536,y=ie+R+65535,R=Math.floor(y/65536),ie=y-R*65536,y=ce+R+65535,R=Math.floor(y/65536),ce=y-R*65536,y=Q+R+65535,R=Math.floor(y/65536),Q=y-R*65536,y=se+R+65535,R=Math.floor(y/65536),se=y-R*65536,y=he+R+65535,R=Math.floor(y/65536),he=y-R*65536,y=ve+R+65535,R=Math.floor(y/65536),ve=y-R*65536,y=ye+R+65535,R=Math.floor(y/65536),ye=y-R*65536,y=we+R+65535,R=Math.floor(y/65536),we=y-R*65536,y=Re+R+65535,R=Math.floor(y/65536),Re=y-R*65536,y=_e+R+65535,R=Math.floor(y/65536),_e=y-R*65536,y=Ae+R+65535,R=Math.floor(y/65536),Ae=y-R*65536,y=Ce+R+65535,R=Math.floor(y/65536),Ce=y-R*65536,y=Be+R+65535,R=Math.floor(y/65536),Be=y-R*65536,H+=R-1+37*(R-1),C[0]=H,C[1]=F,C[2]=J,C[3]=ie,C[4]=ce,C[5]=Q,C[6]=se,C[7]=he,C[8]=ve,C[9]=ye,C[10]=we,C[11]=Re,C[12]=_e,C[13]=Ae,C[14]=Ce,C[15]=Be}return pa}var ya,is;function Uu(){if(is)return ya;is=1;var t=ge();Ee(),wt(),Cn(),ya=t.kem=t.kem||{};var e=t.jsbn.BigInteger;t.kem.rsa={},t.kem.rsa.create=function(a,f){f=f||{};var o=f.prng||t.random,i={};return i.encrypt=function(n,u){var h=Math.ceil(n.n.bitLength()/8),m;do m=new e(t.util.bytesToHex(o.getBytesSync(h)),16).mod(n.n);while(m.compareTo(e.ONE)<=0);m=t.util.hexToBytes(m.toString(16));var B=h-m.length;B>0&&(m=t.util.fillString("\0",B)+m);var v=n.encrypt(m,"NONE"),d=a.generate(m,u);return{encapsulation:v,key:d}},i.decrypt=function(n,u,h){var m=n.decrypt(u,"NONE");return a.generate(m,h)},i},t.kem.kdf1=function(a,f){r(this,a,0,f||a.digestLength)},t.kem.kdf2=function(a,f){r(this,a,1,f||a.digestLength)};function r(a,f,o,i){a.generate=function(n,u){for(var h=new t.util.ByteBuffer,m=Math.ceil(u/i)+o,B=new t.util.ByteBuffer,v=o;v<m;++v){B.putInt32(v),f.start(),f.update(n+B.getBytes());var d=f.digest();h.putBytes(d.getBytes(i))}return h.truncate(h.length()-u),h.getBytes()}}return ya}var ga,ss;function Du(){if(ss)return ga;ss=1;var t=ge();Ee(),ga=t.log=t.log||{},t.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},r=[],a=null;t.log.LEVEL_LOCKED=2,t.log.NO_LEVEL_CHECK=4,t.log.INTERPOLATE=8;for(var f=0;f<t.log.levels.length;++f){var o=t.log.levels[f];e[o]={index:f,name:o.toUpperCase()}}t.log.logMessage=function(v){for(var d=e[v.level].index,p=0;p<r.length;++p){var b=r[p];if(b.flags&t.log.NO_LEVEL_CHECK)b.f(v);else{var S=e[b.level].index;d<=S&&b.f(b,v)}}},t.log.prepareStandard=function(v){"standard"in v||(v.standard=e[v.level].name+" ["+v.category+"] "+v.message)},t.log.prepareFull=function(v){if(!("full"in v)){var d=[v.message];d=d.concat([]),v.full=t.util.format.apply(this,d)}},t.log.prepareStandardFull=function(v){"standardFull"in v||(t.log.prepareStandard(v),v.standardFull=v.standard)};for(var i=["error","warning","info","debug","verbose"],f=0;f<i.length;++f)(function(d){t.log[d]=function(p,b){var S=Array.prototype.slice.call(arguments).slice(2),c={timestamp:new Date,level:d,category:p,message:b,arguments:S};t.log.logMessage(c)}})(i[f]);if(t.log.makeLogger=function(v){var d={flags:0,f:v};return t.log.setLevel(d,"none"),d},t.log.setLevel=function(v,d){var p=!1;if(v&&!(v.flags&t.log.LEVEL_LOCKED))for(var b=0;b<t.log.levels.length;++b){var S=t.log.levels[b];if(d==S){v.level=d,p=!0;break}}return p},t.log.lock=function(v,d){typeof d>"u"||d?v.flags|=t.log.LEVEL_LOCKED:v.flags&=~t.log.LEVEL_LOCKED},t.log.addLogger=function(v){r.push(v)},typeof console<"u"&&"log"in console){var n;if(console.error&&console.warn&&console.info&&console.debug){var u={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},h=function(v,d){t.log.prepareStandard(d);var p=u[d.level],b=[d.standard];b=b.concat(d.arguments.slice()),p.apply(console,b)};n=t.log.makeLogger(h)}else{var h=function(d,p){t.log.prepareStandardFull(p),console.log(p.standardFull)};n=t.log.makeLogger(h)}t.log.setLevel(n,"debug"),t.log.addLogger(n),a=n}else console={log:function(){}};if(a!==null&&typeof window<"u"&&window.location){var m=new URL(window.location.href).searchParams;if(m.has("console.level")&&t.log.setLevel(a,m.get("console.level").slice(-1)[0]),m.has("console.lock")){var B=m.get("console.lock").slice(-1)[0];B=="true"&&t.log.lock(a)}}return t.log.consoleLogger=a,ga}var va,os;function Pu(){return os||(os=1,va=$t(),za(),qr(),Co(),Uo()),va}var ma={exports:{}},fs;function Ku(){if(fs)return ma.exports;fs=1;var t=ge();dr(),Dt(),bn(),pr(),Cr(),_o(),wt(),Ee(),ja();var e=t.asn1,r=ma.exports=t.pkcs7=t.pkcs7||{};r.messageFromPem=function(d){var p=t.pem.decode(d)[0];if(p.type!=="PKCS7"){var b=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw b.headerType=p.type,b}if(p.procType&&p.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var S=e.fromDer(p.body);return r.messageFromAsn1(S)},r.messageToPem=function(d,p){var b={type:"PKCS7",body:e.toDer(d.toAsn1()).getBytes()};return t.pem.encode(b,{maxline:p})},r.messageFromAsn1=function(d){var p={},b=[];if(!e.validate(d,r.asn1.contentInfoValidator,p,b)){var S=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw S.errors=b,S}var c=e.derToOid(p.contentType),g;switch(c){case t.pki.oids.envelopedData:g=r.createEnvelopedData();break;case t.pki.oids.encryptedData:g=r.createEncryptedData();break;case t.pki.oids.signedData:g=r.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return g.fromAsn1(p.content.value[0]),g},r.createSignedData=function(){var d=null;return d={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(S){if(B(d,S,r.asn1.signedDataValidator),d.certificates=[],d.crls=[],d.digestAlgorithmIdentifiers=[],d.contentInfo=null,d.signerInfos=[],d.rawCapture.certificates)for(var c=d.rawCapture.certificates.value,g=0;g<c.length;++g)d.certificates.push(t.pki.certificateFromAsn1(c[g]))},toAsn1:function(){d.contentInfo||d.sign();for(var S=[],c=0;c<d.certificates.length;++c)S.push(t.pki.certificateToAsn1(d.certificates[c]));var g=[],E=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d.digestAlgorithmIdentifiers),d.contentInfo])]);return S.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,S)),g.length>0&&E.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,g)),E.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,d.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),E])},addSigner:function(S){var c=S.issuer,g=S.serialNumber;if(S.certificate){var E=S.certificate;typeof E=="string"&&(E=t.pki.certificateFromPem(E)),c=E.issuer.attributes,g=E.serialNumber}var A=S.key;if(!A)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof A=="string"&&(A=t.pki.privateKeyFromPem(A));var I=S.digestAlgorithm||t.pki.oids.sha1;switch(I){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+I)}var x=S.authenticatedAttributes||[];if(x.length>0){for(var l=!1,s=!1,w=0;w<x.length;++w){var N=x[w];if(!l&&N.type===t.pki.oids.contentType){if(l=!0,s)break;continue}if(!s&&N.type===t.pki.oids.messageDigest){if(s=!0,l)break;continue}}if(!l||!s)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}d.signers.push({key:A,version:1,issuer:c,serialNumber:g,digestAlgorithm:I,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:x,unauthenticatedAttributes:[]})},sign:function(S){if(S=S||{},(typeof d.content!="object"||d.contentInfo===null)&&(d.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes())]),"content"in d)){var c;d.content instanceof t.util.ByteBuffer?c=d.content.bytes():typeof d.content=="string"&&(c=t.util.encodeUtf8(d.content)),S.detached?d.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,c):d.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,c)]))}if(d.signers.length!==0){var g=p();b(g)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(S){typeof S=="string"&&(S=t.pki.certificateFromPem(S)),d.certificates.push(S)},addCertificateRevokationList:function(S){throw new Error("PKCS#7 CRL support not yet implemented.")}},d;function p(){for(var S={},c=0;c<d.signers.length;++c){var g=d.signers[c],E=g.digestAlgorithm;E in S||(S[E]=t.md[t.pki.oids[E]].create()),g.authenticatedAttributes.length===0?g.md=S[E]:g.md=t.md[t.pki.oids[E]].create()}d.digestAlgorithmIdentifiers=[];for(var E in S)d.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(E).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return S}function b(S){var c;if(d.detachedContent?c=d.detachedContent:(c=d.contentInfo.value[1],c=c.value[0]),!c)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var g=e.derToOid(d.contentInfo.value[0].value),E=e.toDer(c);E.getByte(),e.getBerValueLength(E),E=E.getBytes();for(var A in S)S[A].start().update(E);for(var I=new Date,x=0;x<d.signers.length;++x){var l=d.signers[x];if(l.authenticatedAttributes.length===0){if(g!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var s=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),w=0;w<l.authenticatedAttributes.length;++w){var N=l.authenticatedAttributes[w];N.type===t.pki.oids.messageDigest?N.value=S[l.digestAlgorithm].digest():N.type===t.pki.oids.signingTime&&(N.value||(N.value=I)),s.value.push(h(N)),l.authenticatedAttributesAsn1.value.push(h(N))}E=e.toDer(s).getBytes(),l.md.start().update(E)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}d.signerInfos=u(d.signers)}},r.createEncryptedData=function(){var d=null;return d={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(p){B(d,p,r.asn1.encryptedDataValidator)},decrypt:function(p){p!==void 0&&(d.encryptedContent.key=p),v(d)}},d},r.createEnvelopedData=function(){var d=null;return d={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(p){var b=B(d,p,r.asn1.envelopedDataValidator);d.recipients=o(b.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,i(d.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,m(d.encryptedContent))])])])},findRecipient:function(p){for(var b=p.issuer.attributes,S=0;S<d.recipients.length;++S){var c=d.recipients[S],g=c.issuer;if(c.serialNumber===p.serialNumber&&g.length===b.length){for(var E=!0,A=0;A<b.length;++A)if(g[A].type!==b[A].type||g[A].value!==b[A].value){E=!1;break}if(E)return c}}return null},decrypt:function(p,b){if(d.encryptedContent.key===void 0&&p!==void 0&&b!==void 0)switch(p.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var S=b.decrypt(p.encryptedContent.content);d.encryptedContent.key=t.util.createBuffer(S);break;default:throw new Error("Unsupported asymmetric cipher, OID "+p.encryptedContent.algorithm)}v(d)},addRecipient:function(p){d.recipients.push({version:0,issuer:p.issuer.attributes,serialNumber:p.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:p.publicKey}})},encrypt:function(p,b){if(d.encryptedContent.content===void 0){b=b||d.encryptedContent.algorithm,p=p||d.encryptedContent.key;var S,c,g;switch(b){case t.pki.oids["aes128-CBC"]:S=16,c=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:S=24,c=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:S=32,c=16,g=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:S=24,c=8,g=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+b)}if(p===void 0)p=t.util.createBuffer(t.random.getBytes(S));else if(p.length()!=S)throw new Error("Symmetric key has wrong length; got "+p.length()+" bytes, expected "+S+".");d.encryptedContent.algorithm=b,d.encryptedContent.key=p,d.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(c));var E=g(p);if(E.start(d.encryptedContent.parameter.copy()),E.update(d.content),!E.finish())throw new Error("Symmetric encryption failed.");d.encryptedContent.content=E.output}for(var A=0;A<d.recipients.length;++A){var I=d.recipients[A];if(I.encryptedContent.content===void 0)switch(I.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:I.encryptedContent.content=I.encryptedContent.key.encrypt(d.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+I.encryptedContent.algorithm)}}}},d};function a(d){var p={},b=[];if(!e.validate(d,r.asn1.recipientInfoValidator,p,b)){var S=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw S.errors=b,S}return{version:p.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(p.issuer),serialNumber:t.util.createBuffer(p.serial).toHex(),encryptedContent:{algorithm:e.derToOid(p.encAlgorithm),parameter:p.encParameter?p.encParameter.value:void 0,content:p.encKey}}}function f(d){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:d.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(d.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.encryptedContent.content)])}function o(d){for(var p=[],b=0;b<d.length;++b)p.push(a(d[b]));return p}function i(d){for(var p=[],b=0;b<d.length;++b)p.push(f(d[b]));return p}function n(d){var p=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(d.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:d.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,t.util.hexToBytes(d.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(d.authenticatedAttributesAsn1&&p.value.push(d.authenticatedAttributesAsn1),p.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),p.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.signature)),d.unauthenticatedAttributes.length>0){for(var b=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),S=0;S<d.unauthenticatedAttributes.length;++S){var c=d.unauthenticatedAttributes[S];b.values.push(h(c))}p.value.push(b)}return p}function u(d){for(var p=[],b=0;b<d.length;++b)p.push(n(d[b]));return p}function h(d){var p;if(d.type===t.pki.oids.contentType)p=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.value).getBytes());else if(d.type===t.pki.oids.messageDigest)p=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.value.bytes());else if(d.type===t.pki.oids.signingTime){var b=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z"),c=d.value;if(typeof c=="string"){var g=Date.parse(c);isNaN(g)?c.length===13?c=e.utcTimeToDate(c):c=e.generalizedTimeToDate(c):c=new Date(g)}c>=b&&c<S?p=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(c)):p=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(c))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[p])])}function m(d){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(t.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d.algorithm).getBytes()),d.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,d.content.getBytes())])]}function B(d,p,b){var S={},c=[];if(!e.validate(p,b,S,c)){var g=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw g.errors=g,g}var E=e.derToOid(S.contentType);if(E!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(S.encryptedContent){var A="";if(t.util.isArray(S.encryptedContent))for(var I=0;I<S.encryptedContent.length;++I){if(S.encryptedContent[I].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");A+=S.encryptedContent[I].value}else A=S.encryptedContent;d.encryptedContent={algorithm:e.derToOid(S.encAlgorithm),parameter:t.util.createBuffer(S.encParameter.value),content:t.util.createBuffer(A)}}if(S.content){var A="";if(t.util.isArray(S.content))for(var I=0;I<S.content.length;++I){if(S.content[I].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");A+=S.content[I].value}else A=S.content;d.content=t.util.createBuffer(A)}return d.version=S.version.charCodeAt(0),d.rawCapture=S,S}function v(d){if(d.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(d.content===void 0){var p;switch(d.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:p=t.aes.createDecryptionCipher(d.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:p=t.des.createDecryptionCipher(d.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+d.encryptedContent.algorithm)}if(p.start(d.encryptedContent.parameter),p.update(d.encryptedContent.content),!p.finish())throw new Error("Symmetric decryption failed.");d.content=p.output}}return ma.exports}var Ea={exports:{}},cs;function Ou(){if(cs)return Ea.exports;cs=1;var t=ge();dr(),Hr(),za(),qr(),Ee();var e=Ea.exports=t.ssh=t.ssh||{};e.privateKeyToPutty=function(o,i,n){n=n||"",i=i||"";var u="ssh-rsa",h=i===""?"none":"aes256-cbc",m="PuTTY-User-Key-File-2: "+u+`\r
`;m+="Encryption: "+h+`\r
`,m+="Comment: "+n+`\r
`;var B=t.util.createBuffer();a(B,u),r(B,o.e),r(B,o.n);var v=t.util.encode64(B.bytes(),64),d=Math.floor(v.length/66)+1;m+="Public-Lines: "+d+`\r
`,m+=v;var p=t.util.createBuffer();r(p,o.d),r(p,o.p),r(p,o.q),r(p,o.qInv);var b;if(!i)b=t.util.encode64(p.bytes(),64);else{var S=p.length()+16-1;S-=S%16;var c=f(p.bytes());c.truncate(c.length()-S+p.length()),p.putBuffer(c);var g=t.util.createBuffer();g.putBuffer(f("\0\0\0\0",i)),g.putBuffer(f("\0\0\0",i));var E=t.aes.createEncryptionCipher(g.truncate(8),"CBC");E.start(t.util.createBuffer().fillWithByte(0,16)),E.update(p.copy()),E.finish();var A=E.output;A.truncate(16),b=t.util.encode64(A.bytes(),64)}d=Math.floor(b.length/66)+1,m+=`\r
Private-Lines: `+d+`\r
`,m+=b;var I=f("putty-private-key-file-mac-key",i),x=t.util.createBuffer();a(x,u),a(x,h),a(x,n),x.putInt32(B.length()),x.putBuffer(B),x.putInt32(p.length()),x.putBuffer(p);var l=t.hmac.create();return l.start("sha1",I),l.update(x.bytes()),m+=`\r
Private-MAC: `+l.digest().toHex()+`\r
`,m},e.publicKeyToOpenSSH=function(o,i){var n="ssh-rsa";i=i||"";var u=t.util.createBuffer();return a(u,n),r(u,o.e),r(u,o.n),n+" "+t.util.encode64(u.bytes())+" "+i},e.privateKeyToOpenSSH=function(o,i){return i?t.pki.encryptRsaPrivateKey(o,i,{legacy:!0,algorithm:"aes128"}):t.pki.privateKeyToPem(o)},e.getPublicKeyFingerprint=function(o,i){i=i||{};var n=i.md||t.md.md5.create(),u="ssh-rsa",h=t.util.createBuffer();a(h,u),r(h,o.e),r(h,o.n),n.start(),n.update(h.getBytes());var m=n.digest();if(i.encoding==="hex"){var B=m.toHex();return i.delimiter?B.match(/.{2}/g).join(i.delimiter):B}else{if(i.encoding==="binary")return m.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".')}return m};function r(o,i){var n=i.toString(16);n[0]>="8"&&(n="00"+n);var u=t.util.hexToBytes(n);o.putInt32(u.length),o.putBytes(u)}function a(o,i){o.putInt32(i.length),o.putString(i)}function f(){for(var o=t.md.sha1.create(),i=arguments.length,n=0;n<i;++n)o.update(arguments[n]);return o.digest()}return Ea.exports}var xa,us;function Vu(){return us||(us=1,xa=ge(),dr(),Nu(),Dt(),$a(),bn(),Lu(),Hr(),Uu(),Du(),Pu(),Ro(),Qa(),Cr(),Ao(),No(),Ku(),ko(),To(),Bo(),Xa(),wt(),wo(),Ou(),Lo(),Ee()),xa}var Fu=Vu();const st=Au(Fu),Rr=2048,ls=4096;function Za(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}function Mu(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function Do(t){let e="";for(let r=0;r<t.length;r++){const a=t.charCodeAt(r);e+=a.toString(16).padStart(2,"0")}return e}function Po(t){const e=t.replace(/\s+/g,"");if(e.length%2!==0)throw new Error("Invalid hex string: length must be even");let r="";for(let a=0;a<e.length;a+=2){const f=Number.parseInt(e.substring(a,a+2),16);if(Number.isNaN(f))throw new Error(`Invalid hex string: invalid character at position ${a}`);r+=String.fromCharCode(f)}return r}function Hu(t=Rr){if(t!==Rr&&t!==ls)throw new Error(`Invalid key size: expected ${Rr} or ${ls}, got ${t}`);const e=st.pki.rsa.generateKeyPair(t);return{publicKey:st.pki.publicKeyToPem(e.publicKey),privateKey:st.pki.privateKeyToPem(e.privateKey)}}function qu(t,e){try{const r=st.pki.publicKeyFromPem(e),a=Za(t),f=r.encrypt(a,"RSA-OAEP");return{ciphertext:Do(f)}}catch(r){throw new Error(`RSA encryption failed: ${r instanceof Error?r.message:String(r)}`)}}function Gu(t,e){try{const r=st.pki.privateKeyFromPem(e),a=Po(t),f=r.decrypt(a,"RSA-OAEP");return Mu(f)}catch(r){throw new Error(`RSA decryption failed: ${r instanceof Error?r.message:String(r)}`)}}function $u(t,e,r="SHA-256"){try{const a=st.pki.privateKeyFromPem(e),f=Za(t),o=r.toLowerCase().replace("-","");let i;if(o==="sha256")i=st.md.sha256.create();else if(o==="sha384")i=st.md.sha384.create();else if(o==="sha512")i=st.md.sha512.create();else if(o==="sha1")i=st.md.sha1.create();else throw new Error(`Unsupported hash algorithm: ${r}`);i.update(f,"raw");const n=a.sign(i);return{signature:Do(n)}}catch(a){throw new Error(`RSA signing failed: ${a instanceof Error?a.message:String(a)}`)}}function zu(t,e,r,a="SHA-256"){try{const f=st.pki.publicKeyFromPem(r),o=Za(t),i=a.toLowerCase().replace("-","");let n;if(i==="sha256")n=st.md.sha256.create();else if(i==="sha384")n=st.md.sha384.create();else if(i==="sha512")n=st.md.sha512.create();else if(i==="sha1")n=st.md.sha1.create();else throw new Error(`Unsupported hash algorithm: ${a}`);n.update(o,"raw");const u=Po(e);return f.verify(n.digest().bytes(),u)}catch(f){if(f instanceof Error&&(f.message.includes("Encryption block is invalid")||f.message.includes("Encrypted message is invalid")))return!1;throw new Error(`RSA verification failed: ${f instanceof Error?f.message:String(f)}`)}}function Yu(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ra(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Sa(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Ie(t,e,r=""){const a=Yu(t),f=t?.length,o=e!==void 0;if(!a||o&&f!==e){const i=r&&`"${r}" `,n=o?` of length ${e}`:"",u=a?`length=${f}`:`type=${typeof t}`;throw new Error(i+"expected Uint8Array"+n+", got "+u)}return t}function xr(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Wa(t,e){Ie(t,void 0,"output");const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Qu(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function et(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ot(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function wn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const Xu=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ju(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Ko(t,e){if(t.length!==e.length)return!1;let r=0;for(let a=0;a<t.length;a++)r|=t[a]^e[a];return r===0}const Oo=(t,e)=>{function r(a,...f){if(Ie(a,void 0,"key"),!Xu)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const m=f[0];Ie(m,t.varSizeNonce?void 0:t.nonceLength,"nonce")}const o=t.tagLength;o&&f[1]!==void 0&&Ie(f[1],void 0,"AAD");const i=e(a,...f),n=(m,B)=>{if(B!==void 0){if(m!==2)throw new Error("cipher output not supported");Ie(B,void 0,"output")}};let u=!1;return{encrypt(m,B){if(u)throw new Error("cannot encrypt() twice with same key + nonce");return u=!0,Ie(m),n(i.encrypt.length,B),i.encrypt(m,B)},decrypt(m,B){if(Ie(m),o&&m.length<o)throw new Error('"ciphertext" expected length bigger than tagLength='+o);return n(i.decrypt.length,B),i.decrypt(m,B)}}}return Object.assign(r,t),r};function Na(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error('"output" expected Uint8Array of length '+t+", got: "+e.length);if(r&&!ln(e))throw new Error("invalid output, must be aligned");return e}function Vo(t,e,r){Ra(r);const a=new Uint8Array(16),f=wn(a);return f.setBigUint64(0,BigInt(e),r),f.setBigUint64(8,BigInt(t),r),a}function ln(t){return t.byteOffset%4===0}function Bt(t){return Uint8Array.from(t)}function yr(t=32){const e=typeof globalThis=="object"?globalThis.crypto:null;if(typeof e?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return e.getRandomValues(new Uint8Array(t))}const Ht=16,Ja=new Uint8Array(16),_t=et(Ja),Zu=225,Wu=(t,e,r,a)=>{const f=a&1;return{s3:r<<31|a>>>1,s2:e<<31|r>>>1,s1:t<<31|e>>>1,s0:t>>>1^Zu<<24&-(f&1)}},gt=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255|0;function Ju(t){t.reverse();const e=t[15]&1;let r=0;for(let a=0;a<t.length;a++){const f=t[a];t[a]=f>>>1|r,r=(f&1)<<7}return t[0]^=-e&225,t}const e0=t=>t>64*1024?8:t>1024?4:2;class Fo{blockLen=Ht;outputLen=Ht;s0=0;s1=0;s2=0;s3=0;finished=!1;t;W;windowSize;constructor(e,r){Ie(e,16,"key"),e=Bt(e);const a=wn(e);let f=a.getUint32(0,!1),o=a.getUint32(4,!1),i=a.getUint32(8,!1),n=a.getUint32(12,!1);const u=[];for(let p=0;p<128;p++)u.push({s0:gt(f),s1:gt(o),s2:gt(i),s3:gt(n)}),{s0:f,s1:o,s2:i,s3:n}=Wu(f,o,i,n);const h=e0(r||1024);if(![1,2,4,8].includes(h))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=h;const B=128/h,v=this.windowSize=2**h,d=[];for(let p=0;p<B;p++)for(let b=0;b<v;b++){let S=0,c=0,g=0,E=0;for(let A=0;A<h;A++){if(!(b>>>h-A-1&1))continue;const{s0:x,s1:l,s2:s,s3:w}=u[h*p+A];S^=x,c^=l,g^=s,E^=w}d.push({s0:S,s1:c,s2:g,s3:E})}this.t=d}_updateBlock(e,r,a,f){e^=this.s0,r^=this.s1,a^=this.s2,f^=this.s3;const{W:o,t:i,windowSize:n}=this;let u=0,h=0,m=0,B=0;const v=(1<<o)-1;let d=0;for(const p of[e,r,a,f])for(let b=0;b<4;b++){const S=p>>>8*b&255;for(let c=8/o-1;c>=0;c--){const g=S>>>o*c&v,{s0:E,s1:A,s2:I,s3:x}=i[d*n+g];u^=E,h^=A,m^=I,B^=x,d+=1}}this.s0=u,this.s1=h,this.s2=m,this.s3=B}update(e){xr(this),Ie(e),e=Bt(e);const r=et(e),a=Math.floor(e.length/Ht),f=e.length%Ht;for(let o=0;o<a;o++)this._updateBlock(r[o*4+0],r[o*4+1],r[o*4+2],r[o*4+3]);return f&&(Ja.set(e.subarray(a*Ht)),this._updateBlock(_t[0],_t[1],_t[2],_t[3]),ot(_t)),this}destroy(){const{t:e}=this;for(const r of e)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(e){xr(this),Wa(e,this),this.finished=!0;const{s0:r,s1:a,s2:f,s3:o}=this,i=et(e);return i[0]=r,i[1]=a,i[2]=f,i[3]=o,e}digest(){const e=new Uint8Array(Ht);return this.digestInto(e),this.destroy(),e}}class t0 extends Fo{constructor(e,r){Ie(e);const a=Ju(Bt(e));super(a,r),ot(a)}update(e){xr(this),Ie(e),e=Bt(e);const r=et(e),a=e.length%Ht,f=Math.floor(e.length/Ht);for(let o=0;o<f;o++)this._updateBlock(gt(r[o*4+3]),gt(r[o*4+2]),gt(r[o*4+1]),gt(r[o*4+0]));return a&&(Ja.set(e.subarray(f*Ht)),this._updateBlock(gt(_t[3]),gt(_t[2]),gt(_t[1]),gt(_t[0])),ot(_t)),this}digestInto(e){xr(this),Wa(e,this),this.finished=!0;const{s0:r,s1:a,s2:f,s3:o}=this,i=et(e);return i[0]=r,i[1]=a,i[2]=f,i[3]=o,e.reverse()}}function Mo(t){const e=(a,f)=>t(f,a.length).update(a).digest(),r=t(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(a,f)=>t(a,f),e}const hs=Mo((t,e)=>new Fo(t,e));Mo((t,e)=>new t0(t,e));const ka=16,r0=4,Jr=new Uint8Array(ka),n0=283;function a0(t){if(![16,24,32].includes(t.length))throw new Error('"aes key" expected Uint8Array of length 16/24/32, got length='+t.length)}function ei(t){return t<<1^n0&-(t>>7)}function ds(t,e){let r=0;for(;e>0;e>>=1)r^=t&-(e&1),t=ei(t);return r}const i0=(()=>{const t=new Uint8Array(256);for(let r=0,a=1;r<256;r++,a^=ei(a))t[r]=a;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let a=t[255-r];a|=a<<8,e[t[r]]=(a^a>>4^a>>5^a>>6^a>>7^99)&255}return ot(t),e})(),s0=t=>t<<24|t>>>8,ba=t=>t<<8|t>>>24;function o0(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const r=new Uint32Array(256).map((h,m)=>e(t[m])),a=r.map(ba),f=a.map(ba),o=f.map(ba),i=new Uint32Array(256*256),n=new Uint32Array(256*256),u=new Uint16Array(256*256);for(let h=0;h<256;h++)for(let m=0;m<256;m++){const B=h*256+m;i[B]=r[h]^a[m],n[B]=f[h]^o[m],u[B]=t[h]<<8|t[m]}return{sbox:t,sbox2:u,T0:r,T1:a,T2:f,T3:o,T01:i,T23:n}}const Ho=o0(i0,t=>ds(t,3)<<24|t<<16|t<<8|ds(t,2)),f0=(()=>{const t=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=ei(r))t[e]=r;return t})();function c0(t){Ie(t);const e=t.length;a0(t);const{sbox2:r}=Ho,a=[];ln(t)||a.push(t=Bt(t));const f=et(t),o=f.length,i=u=>Ir(r,u,u,u,u),n=new Uint32Array(e+28);n.set(f);for(let u=o;u<n.length;u++){let h=n[u-1];u%o===0?h=i(s0(h))^f0[u/o-1]:o>6&&u%o===4&&(h=i(h)),n[u]=n[u-o]^h}return ot(...a),n}function en(t,e,r,a,f,o){return t[r<<8&65280|a>>>8&255]^e[f>>>8&65280|o>>>24&255]}function Ir(t,e,r,a,f){return t[e&255|r&65280]|t[a>>>16&255|f>>>16&65280]<<16}function ps(t,e,r,a,f){const{sbox2:o,T01:i,T23:n}=Ho;let u=0;e^=t[u++],r^=t[u++],a^=t[u++],f^=t[u++];const h=t.length/4-2;for(let p=0;p<h;p++){const b=t[u++]^en(i,n,e,r,a,f),S=t[u++]^en(i,n,r,a,f,e),c=t[u++]^en(i,n,a,f,e,r),g=t[u++]^en(i,n,f,e,r,a);e=b,r=S,a=c,f=g}const m=t[u++]^Ir(o,e,r,a,f),B=t[u++]^Ir(o,r,a,f,e),v=t[u++]^Ir(o,a,f,e,r),d=t[u++]^Ir(o,f,e,r,a);return{s0:m,s1:B,s2:v,s3:d}}function tn(t,e,r,a,f){Ie(r,ka,"nonce"),Ie(a),f=Na(a.length,f);const o=r,i=et(o),n=wn(o),u=et(a),h=et(f),m=e?0:12,B=a.length;let v=n.getUint32(m,e),{s0:d,s1:p,s2:b,s3:S}=ps(t,i[0],i[1],i[2],i[3]);for(let g=0;g+4<=u.length;g+=4)h[g+0]=u[g+0]^d,h[g+1]=u[g+1]^p,h[g+2]=u[g+2]^b,h[g+3]=u[g+3]^S,v=v+1>>>0,n.setUint32(m,v,e),{s0:d,s1:p,s2:b,s3:S}=ps(t,i[0],i[1],i[2],i[3]);const c=ka*Math.floor(u.length/r0);if(c<B){const g=new Uint32Array([d,p,b,S]),E=Qu(g);for(let A=c,I=0;A<B;A++,I++)f[A]=a[A]^E[I];ot(g)}return f}function u0(t,e,r,a,f){const o=f?f.length:0,i=t.create(r,a.length+o);f&&i.update(f);const n=Vo(8*a.length,8*o,e);i.update(a),i.update(n);const u=i.digest();return ot(n),u}const qo=Oo({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,r,a){if(r.length<8)throw new Error("aes/gcm: invalid nonce length");const f=16;function o(n,u,h){const m=u0(hs,!1,n,h,a);for(let B=0;B<u.length;B++)m[B]^=u[B];return m}function i(){const n=c0(e),u=Jr.slice(),h=Jr.slice();if(tn(n,!1,h,h,u),r.length===12)h.set(r);else{const B=Jr.slice();wn(B).setBigUint64(8,BigInt(r.length*8),!1);const d=hs.create(u).update(r).update(B);d.digestInto(h),d.destroy()}const m=tn(n,!1,h,Jr);return{xk:n,authKey:u,counter:h,tagMask:m}}return{encrypt(n){const{xk:u,authKey:h,counter:m,tagMask:B}=i(),v=new Uint8Array(n.length+f),d=[u,h,m,B];ln(n)||d.push(n=Bt(n)),tn(u,!1,m,n,v.subarray(0,n.length));const p=o(h,B,v.subarray(0,v.length-f));return d.push(p),v.set(p,n.length),ot(...d),v},decrypt(n){const{xk:u,authKey:h,counter:m,tagMask:B}=i(),v=[u,h,B,m];ln(n)||v.push(n=Bt(n));const d=n.subarray(0,-f),p=n.subarray(-f),b=o(h,B,d);if(v.push(b),!Ko(b,p))throw new Error("aes/gcm: invalid ghash tag");const S=tn(u,!1,m,d);return ot(...v),S}}}),Sr=256,Nr=12,hn=16;function Go(t,e,r){if(e.length!==Sr/8)throw new Error(`Invalid key length: expected ${Sr/8} bytes, got ${e.length}`);const a=r??yr(Nr);if(a.length!==Nr)throw new Error(`Invalid IV length: expected ${Nr} bytes, got ${a.length}`);const o=qo(e,a).encrypt(t),i=o.subarray(0,o.length-hn),n=o.subarray(o.length-hn);return{ciphertext:i,authTag:n,iv:a}}function $o(t,e,r,a){if(e.length!==Sr/8)throw new Error(`Invalid key length: expected ${Sr/8} bytes, got ${e.length}`);if(r.length!==Nr)throw new Error(`Invalid IV length: expected ${Nr} bytes, got ${r.length}`);if(a.length!==hn)throw new Error(`Invalid auth tag length: expected ${hn} bytes, got ${a.length}`);const f=qo(e,r),o=new Uint8Array(t.length+a.length);o.set(t),o.set(a,t.length);try{return f.decrypt(o)}catch{throw new Error("Authentication failed: data may have been tampered with")}}function zo(){return yr(Sr/8)}const Yo=t=>Uint8Array.from(t.split(""),e=>e.charCodeAt(0)),l0=Yo("expand 16-byte k"),h0=Yo("expand 32-byte k"),d0=et(l0),p0=et(h0);function fe(t,e){return t<<e|t>>>32-e}function La(t){return t.byteOffset%4===0}const rn=64,y0=16,Qo=2**32-1,ys=Uint32Array.of();function g0(t,e,r,a,f,o,i,n){const u=f.length,h=new Uint8Array(rn),m=et(h),B=La(f)&&La(o),v=B?et(f):ys,d=B?et(o):ys;for(let p=0;p<u;i++){if(t(e,r,a,m,i,n),i>=Qo)throw new Error("arx: counter overflow");const b=Math.min(rn,u-p);if(B&&b===rn){const S=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let c=0,g;c<y0;c++)g=S+c,d[g]=v[g]^m[c];p+=rn;continue}for(let S=0,c;S<b;S++)c=p+S,o[c]=f[c]^h[S];p+=b}}function v0(t,e){const{allowShortKeys:r,extendNonceFn:a,counterLength:f,counterRight:o,rounds:i}=ju({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Sa(f),Sa(i),Ra(o),Ra(r),(n,u,h,m,B=0)=>{Ie(n,void 0,"key"),Ie(u,void 0,"nonce"),Ie(h,void 0,"data");const v=h.length;if(m===void 0&&(m=new Uint8Array(v)),Ie(m,void 0,"output"),Sa(B),B<0||B>=Qo)throw new Error("arx: counter overflow");if(m.length<v)throw new Error(`arx: output (${m.length}) is shorter than data (${v})`);const d=[];let p=n.length,b,S;if(p===32)d.push(b=Bt(n)),S=p0;else if(p===16&&r)b=new Uint8Array(32),b.set(n),b.set(n,16),S=d0,d.push(b);else throw Ie(n,32,"arx key"),new Error("invalid key size");La(u)||d.push(u=Bt(u));const c=et(b);if(a){if(u.length!==24)throw new Error("arx: extended nonce must be 24 bytes");a(S,c,et(u.subarray(0,16)),c),u=u.subarray(16)}const g=16-f;if(g!==u.length)throw new Error(`arx: nonce must be ${g} or 16 bytes`);if(g!==12){const A=new Uint8Array(12);A.set(u,o?0:12-u.length),u=A,d.push(u)}const E=et(u);return g0(t,S,c,E,h,m,B,i),ot(...d),m}}function We(t,e){return t[e++]&255|(t[e++]&255)<<8}class m0{blockLen=16;outputLen=16;buffer=new Uint8Array(16);r=new Uint16Array(10);h=new Uint16Array(10);pad=new Uint16Array(8);pos=0;finished=!1;constructor(e){e=Bt(Ie(e,32,"key"));const r=We(e,0),a=We(e,2),f=We(e,4),o=We(e,6),i=We(e,8),n=We(e,10),u=We(e,12),h=We(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|a<<3)&8191,this.r[2]=(a>>>10|f<<6)&7939,this.r[3]=(f>>>7|o<<9)&8191,this.r[4]=(o>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|n<<2)&8191,this.r[7]=(n>>>11|u<<5)&8065,this.r[8]=(u>>>8|h<<8)&8191,this.r[9]=h>>>5&127;for(let m=0;m<8;m++)this.pad[m]=We(e,16+2*m)}process(e,r,a=!1){const f=a?0:2048,{h:o,r:i}=this,n=i[0],u=i[1],h=i[2],m=i[3],B=i[4],v=i[5],d=i[6],p=i[7],b=i[8],S=i[9],c=We(e,r+0),g=We(e,r+2),E=We(e,r+4),A=We(e,r+6),I=We(e,r+8),x=We(e,r+10),l=We(e,r+12),s=We(e,r+14);let w=o[0]+(c&8191),N=o[1]+((c>>>13|g<<3)&8191),K=o[2]+((g>>>10|E<<6)&8191),_=o[3]+((E>>>7|A<<9)&8191),D=o[4]+((A>>>4|I<<12)&8191),V=o[5]+(I>>>1&8191),P=o[6]+((I>>>14|x<<2)&8191),M=o[7]+((x>>>11|l<<5)&8191),q=o[8]+((l>>>8|s<<8)&8191),z=o[9]+(s>>>5|f),G=0,Y=G+w*n+N*(5*S)+K*(5*b)+_*(5*p)+D*(5*d);G=Y>>>13,Y&=8191,Y+=V*(5*v)+P*(5*B)+M*(5*m)+q*(5*h)+z*(5*u),G+=Y>>>13,Y&=8191;let j=G+w*u+N*n+K*(5*S)+_*(5*b)+D*(5*p);G=j>>>13,j&=8191,j+=V*(5*d)+P*(5*v)+M*(5*B)+q*(5*m)+z*(5*h),G+=j>>>13,j&=8191;let te=G+w*h+N*u+K*n+_*(5*S)+D*(5*b);G=te>>>13,te&=8191,te+=V*(5*p)+P*(5*d)+M*(5*v)+q*(5*B)+z*(5*m),G+=te>>>13,te&=8191;let ue=G+w*m+N*h+K*u+_*n+D*(5*S);G=ue>>>13,ue&=8191,ue+=V*(5*b)+P*(5*p)+M*(5*d)+q*(5*v)+z*(5*B),G+=ue>>>13,ue&=8191;let X=G+w*B+N*m+K*h+_*u+D*n;G=X>>>13,X&=8191,X+=V*(5*S)+P*(5*b)+M*(5*p)+q*(5*d)+z*(5*v),G+=X>>>13,X&=8191;let re=G+w*v+N*B+K*m+_*h+D*u;G=re>>>13,re&=8191,re+=V*n+P*(5*S)+M*(5*b)+q*(5*p)+z*(5*d),G+=re>>>13,re&=8191;let W=G+w*d+N*v+K*B+_*m+D*h;G=W>>>13,W&=8191,W+=V*u+P*n+M*(5*S)+q*(5*b)+z*(5*p),G+=W>>>13,W&=8191;let pe=G+w*p+N*d+K*v+_*B+D*m;G=pe>>>13,pe&=8191,pe+=V*h+P*u+M*n+q*(5*S)+z*(5*b),G+=pe>>>13,pe&=8191;let le=G+w*b+N*p+K*d+_*v+D*B;G=le>>>13,le&=8191,le+=V*m+P*h+M*u+q*n+z*(5*S),G+=le>>>13,le&=8191;let C=G+w*S+N*b+K*p+_*d+D*v;G=C>>>13,C&=8191,C+=V*B+P*m+M*h+q*u+z*n,G+=C>>>13,C&=8191,G=(G<<2)+G|0,G=G+Y|0,Y=G&8191,G=G>>>13,j+=G,o[0]=Y,o[1]=j,o[2]=te,o[3]=ue,o[4]=X,o[5]=re,o[6]=W,o[7]=pe,o[8]=le,o[9]=C}finalize(){const{h:e,pad:r}=this,a=new Uint16Array(10);let f=e[1]>>>13;e[1]&=8191;for(let n=2;n<10;n++)e[n]+=f,f=e[n]>>>13,e[n]&=8191;e[0]+=f*5,f=e[0]>>>13,e[0]&=8191,e[1]+=f,f=e[1]>>>13,e[1]&=8191,e[2]+=f,a[0]=e[0]+5,f=a[0]>>>13,a[0]&=8191;for(let n=1;n<10;n++)a[n]=e[n]+f,f=a[n]>>>13,a[n]&=8191;a[9]-=8192;let o=(f^1)-1;for(let n=0;n<10;n++)a[n]&=o;o=~o;for(let n=0;n<10;n++)e[n]=e[n]&o|a[n];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let i=e[0]+r[0];e[0]=i&65535;for(let n=1;n<8;n++)i=(e[n]+r[n]|0)+(i>>>16)|0,e[n]=i&65535;ot(a)}update(e){xr(this),Ie(e),e=Bt(e);const{buffer:r,blockLen:a}=this,f=e.length;for(let o=0;o<f;){const i=Math.min(a-this.pos,f-o);if(i===a){for(;a<=f-o;o+=a)this.process(e,o);continue}r.set(e.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===a&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){ot(this.h,this.r,this.buffer,this.pad)}digestInto(e){xr(this),Wa(e,this),this.finished=!0;const{buffer:r,h:a}=this;let{pos:f}=this;if(f){for(r[f++]=1;f<16;f++)r[f]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let i=0;i<8;i++)e[o++]=a[i]>>>0,e[o++]=a[i]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}}function E0(t){const e=(a,f)=>t(f).update(a).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=a=>t(a),e}const Xo=E0(t=>new m0(t));function x0(t,e,r,a,f,o=20){let i=t[0],n=t[1],u=t[2],h=t[3],m=e[0],B=e[1],v=e[2],d=e[3],p=e[4],b=e[5],S=e[6],c=e[7],g=f,E=r[0],A=r[1],I=r[2],x=i,l=n,s=u,w=h,N=m,K=B,_=v,D=d,V=p,P=b,M=S,q=c,z=g,G=E,Y=A,j=I;for(let ue=0;ue<o;ue+=2)x=x+N|0,z=fe(z^x,16),V=V+z|0,N=fe(N^V,12),x=x+N|0,z=fe(z^x,8),V=V+z|0,N=fe(N^V,7),l=l+K|0,G=fe(G^l,16),P=P+G|0,K=fe(K^P,12),l=l+K|0,G=fe(G^l,8),P=P+G|0,K=fe(K^P,7),s=s+_|0,Y=fe(Y^s,16),M=M+Y|0,_=fe(_^M,12),s=s+_|0,Y=fe(Y^s,8),M=M+Y|0,_=fe(_^M,7),w=w+D|0,j=fe(j^w,16),q=q+j|0,D=fe(D^q,12),w=w+D|0,j=fe(j^w,8),q=q+j|0,D=fe(D^q,7),x=x+K|0,j=fe(j^x,16),M=M+j|0,K=fe(K^M,12),x=x+K|0,j=fe(j^x,8),M=M+j|0,K=fe(K^M,7),l=l+_|0,z=fe(z^l,16),q=q+z|0,_=fe(_^q,12),l=l+_|0,z=fe(z^l,8),q=q+z|0,_=fe(_^q,7),s=s+D|0,G=fe(G^s,16),V=V+G|0,D=fe(D^V,12),s=s+D|0,G=fe(G^s,8),V=V+G|0,D=fe(D^V,7),w=w+N|0,Y=fe(Y^w,16),P=P+Y|0,N=fe(N^P,12),w=w+N|0,Y=fe(Y^w,8),P=P+Y|0,N=fe(N^P,7);let te=0;a[te++]=i+x|0,a[te++]=n+l|0,a[te++]=u+s|0,a[te++]=h+w|0,a[te++]=m+N|0,a[te++]=B+K|0,a[te++]=v+_|0,a[te++]=d+D|0,a[te++]=p+V|0,a[te++]=b+P|0,a[te++]=S+M|0,a[te++]=c+q|0,a[te++]=g+z|0,a[te++]=E+G|0,a[te++]=A+Y|0,a[te++]=I+j|0}function S0(t,e,r,a){let f=t[0],o=t[1],i=t[2],n=t[3],u=e[0],h=e[1],m=e[2],B=e[3],v=e[4],d=e[5],p=e[6],b=e[7],S=r[0],c=r[1],g=r[2],E=r[3];for(let I=0;I<20;I+=2)f=f+u|0,S=fe(S^f,16),v=v+S|0,u=fe(u^v,12),f=f+u|0,S=fe(S^f,8),v=v+S|0,u=fe(u^v,7),o=o+h|0,c=fe(c^o,16),d=d+c|0,h=fe(h^d,12),o=o+h|0,c=fe(c^o,8),d=d+c|0,h=fe(h^d,7),i=i+m|0,g=fe(g^i,16),p=p+g|0,m=fe(m^p,12),i=i+m|0,g=fe(g^i,8),p=p+g|0,m=fe(m^p,7),n=n+B|0,E=fe(E^n,16),b=b+E|0,B=fe(B^b,12),n=n+B|0,E=fe(E^n,8),b=b+E|0,B=fe(B^b,7),f=f+h|0,E=fe(E^f,16),p=p+E|0,h=fe(h^p,12),f=f+h|0,E=fe(E^f,8),p=p+E|0,h=fe(h^p,7),o=o+m|0,S=fe(S^o,16),b=b+S|0,m=fe(m^b,12),o=o+m|0,S=fe(S^o,8),b=b+S|0,m=fe(m^b,7),i=i+B|0,c=fe(c^i,16),v=v+c|0,B=fe(B^v,12),i=i+B|0,c=fe(c^i,8),v=v+c|0,B=fe(B^v,7),n=n+u|0,g=fe(g^n,16),d=d+g|0,u=fe(u^d,12),n=n+u|0,g=fe(g^n,8),d=d+g|0,u=fe(u^d,7);let A=0;a[A++]=f,a[A++]=o,a[A++]=i,a[A++]=n,a[A++]=S,a[A++]=c,a[A++]=g,a[A++]=E}const b0=v0(x0,{counterRight:!1,counterLength:8,extendNonceFn:S0,allowShortKeys:!1}),C0=new Uint8Array(16),gs=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(C0.subarray(r))},B0=new Uint8Array(32);function vs(t,e,r,a,f){f!==void 0&&Ie(f,void 0,"AAD");const o=t(e,r,B0),i=Vo(a.length,f?f.length:0,!0),n=Xo.create(o);f&&gs(n,f),gs(n,a),n.update(i);const u=n.digest();return ot(o,i),u}const w0=t=>(e,r,a)=>({encrypt(o,i){const n=o.length;i=Na(n+16,i,!1),i.set(o);const u=i.subarray(0,-16);t(e,r,u,u,1);const h=vs(t,e,r,u,a);return i.set(h,n),ot(h),i},decrypt(o,i){i=Na(o.length-16,i,!1);const n=o.subarray(0,-16),u=o.subarray(-16),h=vs(t,e,r,n,a);if(!Ko(u,h))throw new Error("invalid tag");return i.set(o.subarray(0,-16)),t(e,r,i,i,1),ot(h),i}}),jo=Oo({blockSize:64,nonceLength:24,tagLength:16},w0(b0)),Pr=256,kr=24,dn=16;function A0(t,e,r){if(e.length!==Pr/8)throw new Error(`Invalid key length: expected ${Pr/8} bytes, got ${e.length}`);const a=yr(kr);if(a.length!==kr)throw new Error(`Invalid nonce length: expected ${kr} bytes, got ${a.length}`);const o=jo(e,a).encrypt(t),i=o.subarray(0,o.length-dn),n=o.subarray(o.length-dn);return{ciphertext:i,authTag:n,nonce:a}}function T0(t,e,r,a){if(e.length!==Pr/8)throw new Error(`Invalid key length: expected ${Pr/8} bytes, got ${e.length}`);if(r.length!==kr)throw new Error(`Invalid nonce length: expected ${kr} bytes, got ${r.length}`);if(a.length!==dn)throw new Error(`Invalid auth tag length: expected ${dn} bytes, got ${a.length}`);const f=jo(e,r),o=new Uint8Array(t.length+a.length);o.set(t),o.set(a,t.length);try{return f.decrypt(o)}catch{throw new Error("Authentication failed: data may have been tampered with")}}function I0(){return yr(Pr/8)}const Kr=32,ms=16;function Zo(t,e){if(e.length!==Kr)throw new Error(`Invalid key length: expected ${Kr} bytes, got ${e.length}`);const r=Xo.create(e);return r.update(t),r.digest()}function _0(t,e,r){if(e.length!==Kr)throw new Error(`Invalid key length: expected ${Kr} bytes, got ${e.length}`);if(r.length!==ms)throw new Error(`Invalid tag length: expected ${ms} bytes, got ${r.length}`);const a=Zo(t,e);return R0(a,r)}function R0(t,e){if(t.length!==e.length)return!1;let r=0;for(let a=0;a<t.length;a++)r|=t[a]^e[a];return r===0}function N0(){return yr(Kr)}async function Ua(t){const e=await crypto.subtle.digest("SHA-256",t);return new Uint8Array(e)}async function Es(t){const e=await crypto.subtle.digest("SHA-512",t);return new Uint8Array(e)}async function xs(t){return Promise.resolve(jf(t))}const k0=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);function Wt(t,e,r,a,f){return t=t+e+f|0,a=ft(a^t,16),r=r+a|0,e=ft(e^r,12),{a:t,b:e,c:r,d:a}}function Jt(t,e,r,a,f){return t=t+e+f|0,a=ft(a^t,8),r=r+a|0,e=ft(e^r,7),{a:t,b:e,c:r,d:a}}const Le=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ae=new Uint32Array(32);function er(t,e,r,a,f,o){const i=f[o],n=f[o+1];let u=ae[2*t],h=ae[2*t+1],m=ae[2*e],B=ae[2*e+1],v=ae[2*r],d=ae[2*r+1],p=ae[2*a],b=ae[2*a+1],S=Pa(u,m,i);h=Ka(S,h,B,n),u=S|0,{Dh:b,Dl:p}={Dh:b^h,Dl:p^u},{Dh:b,Dl:p}={Dh:If(b,p),Dl:_f(b)},{h:d,l:v}=St(d,v,b,p),{Bh:B,Bl:m}={Bh:B^d,Bl:m^v},{Bh:B,Bl:m}={Bh:rr(B,m,24),Bl:nr(B,m,24)},ae[2*t]=u,ae[2*t+1]=h,ae[2*e]=m,ae[2*e+1]=B,ae[2*r]=v,ae[2*r+1]=d,ae[2*a]=p,ae[2*a+1]=b}function tr(t,e,r,a,f,o){const i=f[o],n=f[o+1];let u=ae[2*t],h=ae[2*t+1],m=ae[2*e],B=ae[2*e+1],v=ae[2*r],d=ae[2*r+1],p=ae[2*a],b=ae[2*a+1],S=Pa(u,m,i);h=Ka(S,h,B,n),u=S|0,{Dh:b,Dl:p}={Dh:b^h,Dl:p^u},{Dh:b,Dl:p}={Dh:rr(b,p,16),Dl:nr(b,p,16)},{h:d,l:v}=St(d,v,b,p),{Bh:B,Bl:m}={Bh:B^d,Bl:m^v},{Bh:B,Bl:m}={Bh:Ar(B,m,63),Bl:Tr(B,m,63)},ae[2*t]=u,ae[2*t+1]=h,ae[2*e]=m,ae[2*e+1]=B,ae[2*r]=v,ae[2*r+1]=d,ae[2*a]=p,ae[2*a+1]=b}function L0(t,e={},r,a,f){if(dt(r),t<0||t>r)throw new Error("outputLen bigger than keyLen");const{key:o,salt:i,personalization:n}=e;if(o!==void 0&&(o.length<1||o.length>r))throw new Error('"key" expected to be undefined or of length=1..'+r);i!==void 0&&de(i,a,"salt"),n!==void 0&&de(n,f,"personalization")}class Wo{buffer;buffer32;finished=!1;destroyed=!1;length=0;pos=0;blockLen;outputLen;constructor(e,r){dt(e),dt(r),this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=ur(this.buffer)}update(e){Gt(this),de(e);const{blockLen:r,buffer:a,buffer32:f}=this,o=e.length,i=e.byteOffset,n=e.buffer;for(let u=0;u<o;){this.pos===r&&(it(f),this.compress(f,0,!1),it(f),this.pos=0);const h=Math.min(r-this.pos,o-u),m=i+u;if(h===r&&!(m%4)&&u+h<o){const B=new Uint32Array(n,m,Math.floor((o-u)/4));it(B);for(let v=0;u+r<o;v+=f.length,u+=r)this.length+=r,this.compress(B,v,!1);it(B);continue}a.set(e.subarray(u,u+h),this.pos),this.pos+=h,this.length+=h,u+=h}return this}digestInto(e){Gt(this),yn(e,this);const{pos:r,buffer32:a}=this;this.finished=!0,ut(this.buffer.subarray(r)),it(a),this.compress(a,0,!0),it(a);const f=ur(e);this.get().forEach((o,i)=>f[i]=Ft(o))}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const a=e.slice(0,r);return this.destroy(),a}_cloneInto(e){const{buffer:r,length:a,finished:f,destroyed:o,outputLen:i,pos:n}=this;return e||=new this.constructor({dkLen:i}),e.set(...this.get()),e.buffer.set(r),e.destroyed=o,e.finished=f,e.length=a,e.pos=n,e.outputLen=i,e}clone(){return this._cloneInto()}}class U0 extends Wo{v0l=Le[0]|0;v0h=Le[1]|0;v1l=Le[2]|0;v1h=Le[3]|0;v2l=Le[4]|0;v2h=Le[5]|0;v3l=Le[6]|0;v3h=Le[7]|0;v4l=Le[8]|0;v4h=Le[9]|0;v5l=Le[10]|0;v5h=Le[11]|0;v6l=Le[12]|0;v6h=Le[13]|0;v7l=Le[14]|0;v7h=Le[15]|0;constructor(e={}){const r=e.dkLen===void 0?64:e.dkLen;super(128,r),L0(r,e,64,16,16);let{key:a,personalization:f,salt:o}=e,i=0;if(a!==void 0&&(de(a,void 0,"key"),i=a.length),this.v0l^=this.outputLen|i<<8|65536|1<<24,o!==void 0){de(o,void 0,"salt");const n=ur(o);this.v4l^=Ft(n[0]),this.v4h^=Ft(n[1]),this.v5l^=Ft(n[2]),this.v5h^=Ft(n[3])}if(f!==void 0){de(f,void 0,"personalization");const n=ur(f);this.v6l^=Ft(n[0]),this.v6h^=Ft(n[1]),this.v7l^=Ft(n[2]),this.v7h^=Ft(n[3])}if(a!==void 0){const n=new Uint8Array(this.blockLen);n.set(a),this.update(n)}}get(){let{v0l:e,v0h:r,v1l:a,v1h:f,v2l:o,v2h:i,v3l:n,v3h:u,v4l:h,v4h:m,v5l:B,v5h:v,v6l:d,v6h:p,v7l:b,v7h:S}=this;return[e,r,a,f,o,i,n,u,h,m,B,v,d,p,b,S]}set(e,r,a,f,o,i,n,u,h,m,B,v,d,p,b,S){this.v0l=e|0,this.v0h=r|0,this.v1l=a|0,this.v1h=f|0,this.v2l=o|0,this.v2h=i|0,this.v3l=n|0,this.v3h=u|0,this.v4l=h|0,this.v4h=m|0,this.v5l=B|0,this.v5h=v|0,this.v6l=d|0,this.v6h=p|0,this.v7l=b|0,this.v7h=S|0}compress(e,r,a){this.get().forEach((u,h)=>ae[h]=u),ae.set(Le,16);let{h:f,l:o}=fn(BigInt(this.length));ae[24]=Le[8]^o,ae[25]=Le[9]^f,a&&(ae[28]=~ae[28],ae[29]=~ae[29]);let i=0;const n=k0;for(let u=0;u<12;u++)er(0,4,8,12,e,r+2*n[i++]),tr(0,4,8,12,e,r+2*n[i++]),er(1,5,9,13,e,r+2*n[i++]),tr(1,5,9,13,e,r+2*n[i++]),er(2,6,10,14,e,r+2*n[i++]),tr(2,6,10,14,e,r+2*n[i++]),er(3,7,11,15,e,r+2*n[i++]),tr(3,7,11,15,e,r+2*n[i++]),er(0,5,10,15,e,r+2*n[i++]),tr(0,5,10,15,e,r+2*n[i++]),er(1,6,11,12,e,r+2*n[i++]),tr(1,6,11,12,e,r+2*n[i++]),er(2,7,8,13,e,r+2*n[i++]),tr(2,7,8,13,e,r+2*n[i++]),er(3,4,9,14,e,r+2*n[i++]),tr(3,4,9,14,e,r+2*n[i++]);this.v0l^=ae[0]^ae[16],this.v0h^=ae[1]^ae[17],this.v1l^=ae[2]^ae[18],this.v1h^=ae[3]^ae[19],this.v2l^=ae[4]^ae[20],this.v2h^=ae[5]^ae[21],this.v3l^=ae[6]^ae[22],this.v3h^=ae[7]^ae[23],this.v4l^=ae[8]^ae[24],this.v4h^=ae[9]^ae[25],this.v5l^=ae[10]^ae[26],this.v5h^=ae[11]^ae[27],this.v6l^=ae[12]^ae[28],this.v6h^=ae[13]^ae[29],this.v7l^=ae[14]^ae[30],this.v7h^=ae[15]^ae[31],ut(ae)}destroy(){this.destroyed=!0,ut(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const D0=ir(t=>new U0(t));function Ss(t,e,r,a,f,o,i,n,u,h,m,B,v,d,p,b,S,c,g,E){let A=0;for(let I=0;I<a;I++)({a:f,b:u,c:v,d:S}=Wt(f,u,v,S,r[e+t[A++]])),{a:f,b:u,c:v,d:S}=Jt(f,u,v,S,r[e+t[A++]]),{a:o,b:h,c:d,d:c}=Wt(o,h,d,c,r[e+t[A++]]),{a:o,b:h,c:d,d:c}=Jt(o,h,d,c,r[e+t[A++]]),{a:i,b:m,c:p,d:g}=Wt(i,m,p,g,r[e+t[A++]]),{a:i,b:m,c:p,d:g}=Jt(i,m,p,g,r[e+t[A++]]),{a:n,b:B,c:b,d:E}=Wt(n,B,b,E,r[e+t[A++]]),{a:n,b:B,c:b,d:E}=Jt(n,B,b,E,r[e+t[A++]]),{a:f,b:h,c:p,d:E}=Wt(f,h,p,E,r[e+t[A++]]),{a:f,b:h,c:p,d:E}=Jt(f,h,p,E,r[e+t[A++]]),{a:o,b:m,c:b,d:S}=Wt(o,m,b,S,r[e+t[A++]]),{a:o,b:m,c:b,d:S}=Jt(o,m,b,S,r[e+t[A++]]),{a:i,b:B,c:v,d:c}=Wt(i,B,v,c,r[e+t[A++]]),{a:i,b:B,c:v,d:c}=Jt(i,B,v,c,r[e+t[A++]]),{a:n,b:u,c:d,d:g}=Wt(n,u,d,g,r[e+t[A++]]),{a:n,b:u,c:d,d:g}=Jt(n,u,d,g,r[e+t[A++]]);return{v0:f,v1:o,v2:i,v3:n,v4:u,v5:h,v6:m,v7:B,v8:v,v9:d,v10:p,v11:b,v12:S,v13:c,v14:g,v15:E}}async function bs(t){return Promise.resolve(D0(t))}const Tt={CHUNK_START:1,CHUNK_END:2,PARENT:4,ROOT:8,KEYED_HASH:16,DERIVE_KEY_CONTEXT:32,DERIVE_KEY_MATERIAL:64},Vt=Mt.slice(),Cs=(()=>{const t=Array.from({length:16},(a,f)=>f),e=a=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(f=>a[f]),r=[];for(let a=0,f=t;a<7;a++,f=e(f))r.push(...f);return Uint8Array.from(r)})();class ti extends Wo{chunkPos=0;chunksDone=0;flags=0;IV;state;stack=[];posOut=0;bufferOut32=new Uint32Array(16);bufferOut;chunkOut=0;enableXOF=!0;constructor(e={},r=0){super(64,e.dkLen===void 0?32:e.dkLen);const{key:a,context:f}=e,o=f!==void 0;if(a!==void 0){if(o)throw new Error('Only "key" or "context" can be specified at same time');de(a,32,"key");const i=a.slice();this.IV=ur(i),it(this.IV),this.flags=r|Tt.KEYED_HASH}else if(o){de(f,void 0,"context");const i=f,n=new ti({dkLen:32},Tt.DERIVE_KEY_CONTEXT).update(i).digest();this.IV=ur(n),it(this.IV),this.flags=r|Tt.DERIVE_KEY_MATERIAL}else this.IV=Vt.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=Of(this.bufferOut32)}get(){return[]}set(){}b2Compress(e,r,a,f=0){const{state:o,pos:i}=this,{h:n,l:u}=fn(BigInt(e),!0),{v0:h,v1:m,v2:B,v3:v,v4:d,v5:p,v6:b,v7:S,v8:c,v9:g,v10:E,v11:A,v12:I,v13:x,v14:l,v15:s}=Ss(Cs,f,a,7,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],Vt[0],Vt[1],Vt[2],Vt[3],n,u,i,r);o[0]=h^c,o[1]=m^g,o[2]=B^E,o[3]=v^A,o[4]=d^I,o[5]=p^x,o[6]=b^l,o[7]=S^s}compress(e,r=0,a=!1){let f=this.flags;if(this.chunkPos||(f|=Tt.CHUNK_START),(this.chunkPos===15||a)&&(f|=Tt.CHUNK_END),a||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,f,e,r),this.chunkPos+=1,this.chunkPos===16||a){let o=this.state;this.state=this.IV.slice();for(let i,n=this.chunksDone+1;(a||!(n&1))&&(i=this.stack.pop());n>>=1)this.buffer32.set(i,0),this.buffer32.set(o,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|Tt.PARENT,this.buffer32,0),o=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(o)}this.pos=0}_cloneInto(e){e=super._cloneInto(e);const{IV:r,flags:a,state:f,chunkPos:o,posOut:i,chunkOut:n,stack:u,chunksDone:h}=this;return e.state.set(f.slice()),e.stack=u.map(m=>Uint32Array.from(m)),e.IV.set(r),e.flags=a,e.chunkPos=o,e.chunksDone=h,e.posOut=i,e.chunkOut=n,e.enableXOF=this.enableXOF,e.bufferOut32.set(this.bufferOut32),e}destroy(){this.destroyed=!0,ut(this.state,this.buffer32,this.IV,this.bufferOut32),ut(...this.stack)}b2CompressOut(){const{state:e,pos:r,flags:a,buffer32:f,bufferOut32:o}=this,{h:i,l:n}=fn(BigInt(this.chunkOut++));it(f);const{v0:u,v1:h,v2:m,v3:B,v4:v,v5:d,v6:p,v7:b,v8:S,v9:c,v10:g,v11:E,v12:A,v13:I,v14:x,v15:l}=Ss(Cs,0,f,7,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],Vt[0],Vt[1],Vt[2],Vt[3],n,i,r,a);o[0]=u^S,o[1]=h^c,o[2]=m^g,o[3]=B^E,o[4]=v^A,o[5]=d^I,o[6]=p^x,o[7]=b^l,o[8]=e[0]^S,o[9]=e[1]^c,o[10]=e[2]^g,o[11]=e[3]^E,o[12]=e[4]^A,o[13]=e[5]^I,o[14]=e[6]^x,o[15]=e[7]^l,it(f),it(o),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,ut(this.buffer.subarray(this.pos));let e=this.flags|Tt.ROOT;this.stack.length?(e|=Tt.PARENT,it(this.buffer32),this.compress(this.buffer32,0,!0),it(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):e|=(this.chunkPos?0:Tt.CHUNK_START)|Tt.CHUNK_END,this.flags=e,this.b2CompressOut()}writeInto(e){Gt(this,!1),de(e),this.finish();const{blockLen:r,bufferOut:a}=this;for(let f=0,o=e.length;f<o;){this.posOut>=r&&this.b2CompressOut();const i=Math.min(r-this.posOut,o-f);e.set(a.subarray(this.posOut,this.posOut+i),f),this.posOut+=i,f+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(e)}xof(e){return dt(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(yn(e,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}}const P0=ir((t={})=>new ti(t));async function Bs(t){return Promise.resolve(P0(t))}var Ca={exports:{}},Ba,ws;function K0(){if(ws)return Ba;ws=1;var t=(function(){function e(v,d){var p=v.l+d.l,b={h:v.h+d.h+(p/2>>>31)>>>0,l:p>>>0};v.h=b.h,v.l=b.l}function r(v,d){v.h^=d.h,v.h>>>=0,v.l^=d.l,v.l>>>=0}function a(v,d){var p={h:v.h<<d|v.l>>>32-d,l:v.l<<d|v.h>>>32-d};v.h=p.h,v.l=p.l}function f(v){var d=v.l;v.l=v.h,v.h=d}function o(v,d,p,b){e(v,d),e(p,b),a(d,13),a(b,16),r(d,v),r(b,p),f(v),e(p,d),e(v,b),a(d,17),a(b,21),r(d,p),r(b,v),f(p)}function i(v,d){return v[d+3]<<24|v[d+2]<<16|v[d+1]<<8|v[d]}function n(v,d){typeof d=="string"&&(d=m(d));var p={h:v[1]>>>0,l:v[0]>>>0},b={h:v[3]>>>0,l:v[2]>>>0},S={h:p.h,l:p.l},c=p,g={h:b.h,l:b.l},E=b,A=d.length,I=A-7,x=new Uint8Array(new ArrayBuffer(8));r(S,{h:1936682341,l:1886610805}),r(g,{h:1685025377,l:1852075885}),r(c,{h:1819895653,l:1852142177}),r(E,{h:1952801890,l:2037671283});for(var l=0;l<I;){var s={h:i(d,l+4),l:i(d,l)};r(E,s),o(S,g,c,E),o(S,g,c,E),r(S,s),l+=8}x[7]=A;for(var w=0;l<A;)x[w++]=d[l++];for(;w<7;)x[w++]=0;var N={h:x[7]<<24|x[6]<<16|x[5]<<8|x[4],l:x[3]<<24|x[2]<<16|x[1]<<8|x[0]};r(E,N),o(S,g,c,E),o(S,g,c,E),r(S,N),r(c,{h:0,l:255}),o(S,g,c,E),o(S,g,c,E),o(S,g,c,E),o(S,g,c,E);var K=S;return r(K,g),r(K,c),r(K,E),K}function u(v,d){var p=n(v,d);return("0000000"+p.h.toString(16)).substr(-8)+("0000000"+p.l.toString(16)).substr(-8)}function h(v,d){var p=n(v,d);return(p.h&2097151)*4294967296+p.l}function m(v){if(typeof TextEncoder=="function")return new TextEncoder().encode(v);v=unescape(encodeURIComponent(v));for(var d=new Uint8Array(v.length),p=0,b=v.length;p<b;p++)d[p]=v.charCodeAt(p);return d}function B(v){var d=m(v);if(d.length!==16)throw Error("Key length must be 16 bytes");var p=new Uint32Array(4);return p[0]=i(d,0),p[1]=i(d,4),p[2]=i(d,8),p[3]=i(d,12),p}return{hash:n,hash_hex:u,hash_uint:h,string16_to_key:B,string_to_u8:m}})();return Ba=t,Ba}var As;function O0(){return As||(As=1,(function(t,e){t.exports=K0()})(Ca)),Ca.exports}var V0=O0();const Da=128;async function Ts(t,e){if(e.length!==Da/8)throw new Error(`Invalid key length: expected ${Da/8} bytes, got ${e.length}`);const r=new Uint32Array(4),a=new DataView(e.buffer,e.byteOffset,e.byteLength);for(let n=0;n<4;n++)r[n]=a.getUint32(n*4,!0);const f=V0.hash(r,t),o=new Uint8Array(8),i=new DataView(o.buffer);return i.setUint32(0,f.l,!0),i.setUint32(4,f.h,!0),Promise.resolve(o)}function F0(){return yr(Da/8)}let nn=null,Nt=null,Is=!1;async function An(){if(!(Is&&nn))try{const t=(await xe(async()=>{const{default:r}=await import("./kyber_wasm-DMbO7f7O.js");return{default:r}},[],import.meta.url)).default;let e;if(typeof process<"u"&&process.versions?.node){const{readFileSync:r}=await xe(async()=>{const{readFileSync:h}=await Promise.resolve().then(()=>Rt);return{readFileSync:h}},void 0,import.meta.url),{fileURLToPath:a}=await xe(async()=>{const{fileURLToPath:h}=await Promise.resolve().then(()=>Rt);return{fileURLToPath:h}},void 0,import.meta.url),{dirname:f,join:o}=await xe(async()=>{const{dirname:h,join:m}=await Promise.resolve().then(()=>Rt);return{dirname:h,join:m}},void 0,import.meta.url),i=f(a(import.meta.url)),n=o(i,"../../wasm-src/kyber-wasm/pkg/kyber_wasm_bg.wasm"),u=r(n);nn=await t(u)}else e=new URL(""+new URL("kyber_wasm_bg-9RDN9wMl.wasm",import.meta.url).href,import.meta.url).href,nn=await t({module:e});nn.init(),Nt=await xe(()=>import("./kyber_wasm-DMbO7f7O.js"),[],import.meta.url),Is=!0}catch(t){throw new Error(`Failed to initialize Kyber WebAssembly module: ${t}`)}}async function M0(){if(await An(),!Nt||!Nt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=Nt.generate_keypair();if(!t)throw new Error("Failed to generate Kyber key pair: null result");return H0(t)}function H0(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function q0(t){if(await An(),!Nt||!Nt.encapsulate)throw new Error("encapsulate function not found in wasm exports");const e=Nt.encapsulate(t);if(!e)throw new Error("Failed to encapsulate");try{return{ciphertext:new Uint8Array(e.ciphertext),sharedSecret:new Uint8Array(e.shared_secret)}}finally{typeof e.free=="function"&&e.free()}}async function G0(t,e,r){if(await An(),!Nt||!Nt.decapsulate)throw new Error("decapsulate function not found in wasm exports");const a=Nt.decapsulate(t,e,r);if(!a)throw new Error("Failed to decapsulate");return new Uint8Array(a)}let an=null,kt=null,_s=!1;async function Tn(){if(!(_s&&an))try{const t=(await xe(async()=>{const{default:e}=await import("./dilithium_wasm-C55ki1z2.js");return{default:e}},[],import.meta.url)).default;if(typeof process<"u"&&process.versions?.node){const{readFileSync:e}=await xe(async()=>{const{readFileSync:u}=await Promise.resolve().then(()=>Rt);return{readFileSync:u}},void 0,import.meta.url),{fileURLToPath:r}=await xe(async()=>{const{fileURLToPath:u}=await Promise.resolve().then(()=>Rt);return{fileURLToPath:u}},void 0,import.meta.url),{dirname:a,join:f}=await xe(async()=>{const{dirname:u,join:h}=await Promise.resolve().then(()=>Rt);return{dirname:u,join:h}},void 0,import.meta.url),o=a(r(import.meta.url)),i=f(o,"../../wasm-src/dilithium-wasm/pkg/dilithium_wasm_bg.wasm"),n=e(i);an=await t(n)}else{const e=new URL(""+new URL("dilithium_wasm_bg-CuMJEY0E.wasm",import.meta.url).href,import.meta.url).href;an=await t({module:e})}an.init(),kt=await xe(()=>import("./dilithium_wasm-C55ki1z2.js"),[],import.meta.url),_s=!0}catch(t){throw new Error(`Failed to initialize Dilithium WebAssembly module: ${t}`)}}async function $0(){if(await Tn(),!kt||!kt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=kt.generate_keypair();if(!t)throw new Error("Failed to generate Dilithium key pair: null result");return z0(t)}function z0(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function Y0(t,e){if(await Tn(),!kt||!kt.sign)throw new Error("sign function not found in wasm exports");const r=kt.sign(t,e);if(!r)throw new Error("Failed to sign");return new Uint8Array(r)}async function Q0(t,e,r){if(await Tn(),!kt||!kt.verify)throw new Error("verify function not found in wasm exports");return kt.verify(t,e,r)}let sn=null,Lt=null,Rs=!1;async function In(){if(!(Rs&&sn))try{const t=(await xe(async()=>{const{default:e}=await import("./falcon_rust_wasm-WhH7d1pS.js");return{default:e}},[],import.meta.url)).default;if(typeof process<"u"&&process.versions?.node){const{readFileSync:e}=await xe(async()=>{const{readFileSync:u}=await Promise.resolve().then(()=>Rt);return{readFileSync:u}},void 0,import.meta.url),{fileURLToPath:r}=await xe(async()=>{const{fileURLToPath:u}=await Promise.resolve().then(()=>Rt);return{fileURLToPath:u}},void 0,import.meta.url),{dirname:a,join:f}=await xe(async()=>{const{dirname:u,join:h}=await Promise.resolve().then(()=>Rt);return{dirname:u,join:h}},void 0,import.meta.url),o=a(r(import.meta.url)),i=f(o,"../../wasm-src/falcon-rust-wasm/pkg/falcon_rust_wasm_bg.wasm"),n=e(i);sn=await t(n)}else{const e=new URL(""+new URL("falcon_rust_wasm_bg-B2h8gh_x.wasm",import.meta.url).href,import.meta.url).href;sn=await t({module:e})}sn.init(),Lt=await xe(()=>import("./falcon_rust_wasm-WhH7d1pS.js"),[],import.meta.url),Rs=!0}catch(t){throw new Error(`Failed to initialize FALCON WebAssembly module: ${t}`)}}async function X0(){if(await In(),!Lt||!Lt.generate_keypair)throw new Error("generate_keypair function not found in wasm exports");const t=Lt.generate_keypair();if(!t)throw new Error("Failed to generate FALCON key pair: null result");return j0(t)}function j0(t){try{const e=t.public_key,r=t.private_key;if(!e||e.length===0)throw new Error(`Failed to get public key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);if(!r||r.length===0)throw new Error(`Failed to get private key data. keypair type: ${typeof t}, publicKey: ${e}, privateKey: ${r}`);return{publicKey:e instanceof Uint8Array?e:new Uint8Array(e),privateKey:r instanceof Uint8Array?r:new Uint8Array(r)}}finally{typeof t.free=="function"&&t.free()}}async function Z0(t,e){if(await In(),!Lt||!Lt.sign_message)throw new Error("sign_message function not found in wasm exports");const r=Lt.sign_message(t,e);if(!r)throw new Error("Failed to sign");return new Uint8Array(r)}async function W0(t,e,r){if(await In(),!Lt||!Lt.verify_signature)throw new Error("verify_signature function not found in wasm exports");return Lt.verify_signature(t,e,r)}const br=Sr/8,Ns=32;async function J0(t,e){const r=await crypto.subtle.importKey("raw",t,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),a=await crypto.subtle.sign("HMAC",r,e);return new Uint8Array(a)}async function Jo(t,e){const r=new TextEncoder().encode(e);return J0(t,r)}async function ef(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),Ua(r)}function el(){return zo()}async function tl(t,e,r,a){if(t.length!==br)throw new Error(`Invalid master key length: expected ${br} bytes, got ${t.length}`);const f=await ef(t,e),o=Go(r,f),i=await Promise.all(a.map(n=>Jo(t,n)));return{ciphertext:o.ciphertext,authTag:o.authTag,iv:o.iv,keywordTags:i}}async function rl(t,e,r){if(t.length!==br)throw new Error(`Invalid master key length: expected ${br} bytes, got ${t.length}`);const a=await ef(t,e);return $o(r.ciphertext,a,r.iv,r.authTag)}async function nl(t,e){if(t.length!==br)throw new Error(`Invalid master key length: expected ${br} bytes, got ${t.length}`);return Jo(t,e)}function al(t,e){if(t.length!==Ns)throw new Error(`Invalid search tag length: expected ${Ns} bytes, got ${t.length}`);return{documents:e.filter(a=>a.keywordTags.some(f=>{if(f.length!==t.length)return!1;for(let o=0;o<f.length;o++)if(f[o]!==t[o])return!1;return!0})),searchTag:t}}function il(t=16){return yr(t)}function sl(){const t=globalThis;return!t||!t.location||!t.location.search?"":new URLSearchParams(t.location.search).get("crypto")||""}function ol(){return{selectedCrypto:sl(),aesState:{key:null,plaintext:"",plaintextBytes:null,ciphertext:null,iv:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},chacha20State:{key:null,plaintext:"",plaintextBytes:null,ciphertext:null,nonce:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},poly1305State:{key:null,message:"",messageBytes:null,tag:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,mac:!0,verification:!0}},rsaState:{keyPair:null,keySize:Rr,mode:"encryption",plaintext:"",plaintextBytes:null,ciphertext:"",decrypted:"",decryptedBytes:null,signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0,signing:!0,verification:!0}},eccState:{keyPair:null,curve:"secp256k1",mode:"signature",signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,ecdhPrivateKey:"",ecdhPublicKey:"",sharedSecret:"",error:"",showDetails:{keyGeneration:!0,signing:!0,verification:!0,ecdh:!0}},ibeState:{initialized:!1,masterKey:null,publicParams:null,identity:"",privateKey:null,plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},abeState:{initialized:!1,masterKey:null,publicParams:null,attributes:[],attributeInput:"",privateKey:null,policy:"",plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,decryptionSucceeded:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},kpabeState:{initialized:!1,masterKey:null,publicParams:null,policy:"",privateKey:null,attributes:[],attributeInput:"",plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,decryptionSucceeded:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},hashState:{selectedAlgorithm:"sha256",inputText:"",inputBytes:null,hash:null,processingTime:0,error:"",siphashKey:null,showDetails:{input:!0,processing:!0,output:!0},comparisonMode:!1,comparisonResults:{}},kyberState:{initialized:!1,publicKey:null,privateKey:null,ciphertext:null,sharedSecret:null,decapsulatedSecret:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,encapsulation:!0,decapsulation:!0}},dilithiumState:{initialized:!1,publicKey:null,privateKey:null,message:"",messageBytes:null,signature:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,signing:!0,verification:!0}},falconState:{initialized:!1,publicKey:null,privateKey:null,message:"",messageBytes:null,signature:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,signing:!0,verification:!0}},sseState:{masterKey:null,documents:[],documentId:null,plaintext:"",plaintextBytes:null,keywords:[],keywordInput:"",encryptedDocument:null,searchKeyword:"",searchTag:null,searchResults:[],selectedDocumentId:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,search:!0,decryption:!0}},resetState(){this.aesState={key:null,plaintext:"",plaintextBytes:null,ciphertext:null,iv:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},this.chacha20State={key:null,plaintext:"",plaintextBytes:null,ciphertext:null,nonce:null,authTag:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0}},this.poly1305State={key:null,message:"",messageBytes:null,tag:null,verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,mac:!0,verification:!0}},this.rsaState={keyPair:null,keySize:Rr,mode:"encryption",plaintext:"",plaintextBytes:null,ciphertext:"",decrypted:"",decryptedBytes:null,signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,decryption:!0,signing:!0,verification:!0}},this.eccState={keyPair:null,curve:"secp256k1",mode:"signature",signatureMessage:"",signatureMessageBytes:null,signature:"",verificationMessage:"",verificationMessageBytes:null,verified:null,ecdhPrivateKey:"",ecdhPublicKey:"",sharedSecret:"",error:"",showDetails:{keyGeneration:!0,signing:!0,verification:!0,ecdh:!0}},this.ibeState={initialized:!1,masterKey:null,publicParams:null,identity:"",privateKey:null,plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},this.abeState={initialized:!1,masterKey:null,publicParams:null,attributes:[],attributeInput:"",privateKey:null,policy:"",plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,decryptionSucceeded:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}},this.kpabeState={initialized:!1,masterKey:null,publicParams:null,policy:"",privateKey:null,attributes:[],attributeInput:"",plaintext:"",plaintextBytes:null,ciphertext:null,decrypted:"",decryptedBytes:null,decryptionSucceeded:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,keyExtraction:!0,encryption:!0,decryption:!0}};let t="sha256",e=!1;this.selectedCrypto==="hash-sha256"?t="sha256":this.selectedCrypto==="hash-sha512"?t="sha512":this.selectedCrypto==="hash-sha3-256"?t="sha3-256":this.selectedCrypto==="hash-blake2b"?t="blake2b":this.selectedCrypto==="hash-blake3"?t="blake3":this.selectedCrypto==="hash-compare"?e=!0:this.selectedCrypto==="siphash"&&(t="siphash"),this.hashState={selectedAlgorithm:t,inputText:"",inputBytes:null,hash:null,processingTime:0,error:"",siphashKey:null,showDetails:{input:!0,processing:!0,output:!0},comparisonMode:e,comparisonResults:{}},this.kyberState={initialized:!1,publicKey:null,privateKey:null,ciphertext:null,sharedSecret:null,decapsulatedSecret:null,error:"",showDetails:{initialization:!0,keyGeneration:!0,encapsulation:!0,decapsulation:!0}},this.sseState={masterKey:null,documents:[],documentId:null,plaintext:"",plaintextBytes:null,keywords:[],keywordInput:"",encryptedDocument:null,searchKeyword:"",searchTag:null,searchResults:[],selectedDocumentId:null,decrypted:"",decryptedBytes:null,error:"",showDetails:{keyGeneration:!0,encryption:!0,search:!0,decryption:!0}}},formatBytes(t){return t?It(t):""},formatBytesReadable(t){if(!t)return"";const e=It(t);return e.match(/.{1,2}/g)?.join(" ")||e},formatBytesAsASCII(t){return t?Array.from(t).map(e=>e>=32&&e<=126?String.fromCharCode(e):".").join(""):""},getBytesInfo(t){return t?{hex:It(t),hexFormatted:this.formatBytesReadable(t),decimal:Array.from(t).join(", "),ascii:this.formatBytesAsASCII(t),length:t.length}:{hex:"",hexFormatted:"",decimal:"",ascii:"",length:0}},stringToBytes(t){return new TextEncoder().encode(t)},bytesToString(t){return new TextDecoder().decode(t)},hexToBytes(t){const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=Number.parseInt(t.substr(r,2),16);return e},generateAESKey(){try{this.aesState.key=zo(),this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptAES(){if(!(!this.aesState.key||!this.aesState.plaintext))try{const t=this.stringToBytes(this.aesState.plaintext);this.aesState.plaintextBytes=t;const e=Go(t,this.aesState.key);this.aesState.ciphertext=e.ciphertext,this.aesState.iv=e.iv,this.aesState.authTag=e.authTag,this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptAES(){if(!(!this.aesState.ciphertext||!this.aesState.key||!this.aesState.iv||!this.aesState.authTag))try{const t=$o(this.aesState.ciphertext,this.aesState.key,this.aesState.iv,this.aesState.authTag);this.aesState.decryptedBytes=t,this.aesState.decrypted=this.bytesToString(t),this.aesState.error=""}catch(t){this.aesState.error=`: ${t instanceof Error?t.message:String(t)}`,this.aesState.decrypted="",this.aesState.decryptedBytes=null}},generateChaCha20Key(){try{this.chacha20State.key=I0(),this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptChaCha20(){if(!(!this.chacha20State.key||!this.chacha20State.plaintext))try{const t=this.stringToBytes(this.chacha20State.plaintext);this.chacha20State.plaintextBytes=t;const e=A0(t,this.chacha20State.key);this.chacha20State.ciphertext=e.ciphertext,this.chacha20State.nonce=e.nonce,this.chacha20State.authTag=e.authTag,this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptChaCha20(){if(!(!this.chacha20State.ciphertext||!this.chacha20State.key||!this.chacha20State.nonce||!this.chacha20State.authTag))try{const t=T0(this.chacha20State.ciphertext,this.chacha20State.key,this.chacha20State.nonce,this.chacha20State.authTag);this.chacha20State.decryptedBytes=t,this.chacha20State.decrypted=this.bytesToString(t),this.chacha20State.error=""}catch(t){this.chacha20State.error=`: ${t instanceof Error?t.message:String(t)}`,this.chacha20State.decrypted="",this.chacha20State.decryptedBytes=null}},generatePoly1305Key(){try{this.poly1305State.key=N0(),this.poly1305State.error=""}catch(t){this.poly1305State.error=`: ${t instanceof Error?t.message:String(t)}`}},computePoly1305MAC(){if(!(!this.poly1305State.key||!this.poly1305State.message))try{const t=this.stringToBytes(this.poly1305State.message);this.poly1305State.messageBytes=t,this.poly1305State.tag=Zo(t,this.poly1305State.key),this.poly1305State.error=""}catch(t){this.poly1305State.error=`MAC: ${t instanceof Error?t.message:String(t)}`}},verifyPoly1305MAC(){if(!(!this.poly1305State.key||!this.poly1305State.tag||!this.poly1305State.verificationMessage))try{const t=this.stringToBytes(this.poly1305State.verificationMessage);this.poly1305State.verificationMessageBytes=t,this.poly1305State.verified=_0(t,this.poly1305State.key,this.poly1305State.tag),this.poly1305State.error=""}catch(t){this.poly1305State.error=`MAC: ${t instanceof Error?t.message:String(t)}`,this.poly1305State.verified=!1}},generateRsaKeyPair(){try{const t=Number(this.rsaState.keySize);this.rsaState.keyPair=Hu(t),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},encryptRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.plaintext))try{const t=this.stringToBytes(this.rsaState.plaintext);this.rsaState.plaintextBytes=t;const e=qu(t,this.rsaState.keyPair.publicKey);this.rsaState.ciphertext=e.ciphertext,this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},decryptRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.ciphertext))try{const t=Gu(this.rsaState.ciphertext,this.rsaState.keyPair.privateKey);this.rsaState.decryptedBytes=t,this.rsaState.decrypted=this.bytesToString(t),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`,this.rsaState.decrypted="",this.rsaState.decryptedBytes=null}},signRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.signatureMessage))try{const t=this.stringToBytes(this.rsaState.signatureMessage);this.rsaState.signatureMessageBytes=t;const e=$u(t,this.rsaState.keyPair.privateKey);this.rsaState.signature=e.signature,this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`}},verifyRSA(){if(!(!this.rsaState.keyPair||!this.rsaState.signature||!this.rsaState.verificationMessage))try{const t=this.stringToBytes(this.rsaState.verificationMessage);this.rsaState.verificationMessageBytes=t,this.rsaState.verified=zu(t,this.rsaState.signature,this.rsaState.keyPair.publicKey),this.rsaState.error=""}catch(t){this.rsaState.error=`: ${t instanceof Error?t.message:String(t)}`,this.rsaState.verified=!1}},generateEccKeyPair(){try{this.eccState.keyPair=vu(this.eccState.curve),this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`}},signECC(){if(!(!this.eccState.keyPair||!this.eccState.signatureMessage))try{const t=this.stringToBytes(this.eccState.signatureMessage);this.eccState.signatureMessageBytes=t;const e=this.eccState.keyPair.curve,r=e==="ed25519"||e==="ed448"?Eu(t,this.eccState.keyPair.privateKey,e):xo(t,this.eccState.keyPair.privateKey,e);this.eccState.signature=r.signature,this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`}},verifyECC(){if(!(!this.eccState.keyPair||!this.eccState.signature||!this.eccState.verificationMessage))try{const t=this.stringToBytes(this.eccState.verificationMessage);this.eccState.verificationMessageBytes=t;const e=this.eccState.keyPair.curve;this.eccState.verified=e==="ed25519"||e==="ed448"?xu(t,this.eccState.signature,this.eccState.keyPair.publicKey,e):So(t,this.eccState.signature,this.eccState.keyPair.publicKey,e),this.eccState.error=""}catch(t){this.eccState.error=`: ${t instanceof Error?t.message:String(t)}`,this.eccState.verified=!1}},async initializeIBE(){try{this.ibeState.error="",await Mr(),this.ibeState.initialized=!0}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.initialized=!1}},async generateIBEKeyPair(){this.ibeState.initialized||await this.initializeIBE();try{const t=await Su();this.ibeState.masterKey=t.masterKey,this.ibeState.publicParams=t.publicParams,this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`}},async extractIBEKey(){if(!this.ibeState.masterKey||!this.ibeState.identity){this.ibeState.error="";return}try{this.ibeState.privateKey=await bu(this.ibeState.masterKey,this.ibeState.identity),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.privateKey=null}},async encryptIBE(){if(!(!this.ibeState.publicParams||!this.ibeState.identity||!this.ibeState.plaintext))try{const t=this.stringToBytes(this.ibeState.plaintext);this.ibeState.plaintextBytes=t,this.ibeState.ciphertext=await Cu(this.ibeState.publicParams,this.ibeState.identity,t),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.ciphertext=null}},async decryptIBE(){if(!(!this.ibeState.privateKey||!this.ibeState.ciphertext))try{const t=await Bu(this.ibeState.privateKey,this.ibeState.ciphertext);this.ibeState.decryptedBytes=t,this.ibeState.decrypted=this.bytesToString(t),this.ibeState.error=""}catch(t){this.ibeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.ibeState.decrypted="",this.ibeState.decryptedBytes=null}},async initializeABE(){if(!this.abeState.initialized)try{this.abeState.error="",await Ut(),this.abeState.initialized=!0}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.initialized=!1}},async generateABEKeyPair(){this.abeState.initialized||await this.initializeABE();try{const t=await xf();this.abeState.masterKey=t.masterKey,this.abeState.publicParams=t.publicParams,this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`}},async extractABEKey(){if(!this.abeState.masterKey||!this.abeState.attributes.length){this.abeState.error="";return}try{this.abeState.privateKey=await Sf(this.abeState.masterKey,this.abeState.attributes),this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.privateKey=null}},addAttribute(){const t=this.abeState.attributeInput.trim();if(!t)return;const e=t.split(",").map(r=>r.trim()).filter(r=>r.length>0);for(const r of e)this.abeState.attributes.includes(r)||this.abeState.attributes.push(r);this.abeState.attributeInput=""},removeAttribute(t){this.abeState.attributes.splice(t,1)},async encryptABE(){if(!(!this.abeState.publicParams||!this.abeState.policy||!this.abeState.plaintext))try{const t=this.stringToBytes(this.abeState.plaintext);this.abeState.plaintextBytes=t,this.abeState.ciphertext=await bf(this.abeState.publicParams,this.abeState.policy,t),this.abeState.error=""}catch(t){this.abeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.abeState.ciphertext=null}},async decryptABE(){if(!(!this.abeState.privateKey||!this.abeState.ciphertext))try{const t=await Cf(this.abeState.privateKey,this.abeState.ciphertext);this.abeState.decryptedBytes=t,this.abeState.decrypted=this.bytesToString(t),this.abeState.decryptionSucceeded=!0,this.abeState.error=""}catch(t){const e=t instanceof Error?t.message:String(t);e.includes("Attribute mismatch")||e.includes("")?(this.abeState.decryptionSucceeded=!1,this.abeState.error=""):(this.abeState.error=`: ${e}`,this.abeState.decryptionSucceeded=null),this.abeState.decrypted="",this.abeState.decryptedBytes=null}},async initializeKPABE(){if(!this.kpabeState.initialized)try{this.kpabeState.error="",await Ut(),this.kpabeState.initialized=!0}catch(t){this.kpabeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.kpabeState.initialized=!1}},async generateKPABEKeyPair(){this.kpabeState.initialized||await this.initializeKPABE();try{this.kpabeState.error="";const t=await Bf();if(!t||!t.masterKey||!t.publicParams)throw new Error("Invalid key pair result");this.kpabeState.masterKey=t.masterKey,this.kpabeState.publicParams=t.publicParams,this.kpabeState.error=""}catch(t){const e=t instanceof Error?t.message:String(t);this.kpabeState.error=`: ${e}`,console.error("KP-ABE key pair generation error:",t),this.kpabeState.masterKey=null,this.kpabeState.publicParams=null}},async extractKPABEKey(){if(!this.kpabeState.masterKey||!this.kpabeState.policy){this.kpabeState.error="";return}try{this.kpabeState.privateKey=await wf(this.kpabeState.masterKey,this.kpabeState.policy),this.kpabeState.error=""}catch(t){this.kpabeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.kpabeState.privateKey=null}},addKPABEAttribute(){const t=this.kpabeState.attributeInput.trim();if(!t)return;const e=t.split(",").map(r=>r.trim()).filter(r=>r.length>0);for(const r of e)this.kpabeState.attributes.includes(r)||this.kpabeState.attributes.push(r);this.kpabeState.attributeInput=""},removeKPABEAttribute(t){this.kpabeState.attributes.splice(t,1)},async encryptKPABE(){if(!(!this.kpabeState.publicParams||!this.kpabeState.attributes.length||!this.kpabeState.plaintext))try{const t=this.stringToBytes(this.kpabeState.plaintext);this.kpabeState.plaintextBytes=t,this.kpabeState.ciphertext=await Af(this.kpabeState.publicParams,this.kpabeState.attributes,t),this.kpabeState.error=""}catch(t){this.kpabeState.error=`: ${t instanceof Error?t.message:String(t)}`,this.kpabeState.ciphertext=null}},async decryptKPABE(){if(!(!this.kpabeState.privateKey||!this.kpabeState.ciphertext))try{const t=await Tf(this.kpabeState.privateKey,this.kpabeState.ciphertext);this.kpabeState.decryptedBytes=t,this.kpabeState.decrypted=this.bytesToString(t),this.kpabeState.decryptionSucceeded=!0,this.kpabeState.error=""}catch(t){const e=t instanceof Error?t.message:String(t);e.includes("Attribute mismatch")||e.includes("")?(this.kpabeState.decryptionSucceeded=!1,this.kpabeState.error=""):(this.kpabeState.error=`: ${e}`,this.kpabeState.decryptionSucceeded=null),this.kpabeState.decrypted="",this.kpabeState.decryptedBytes=null}},computeECDH(){if(!(!this.eccState.ecdhPrivateKey||!this.eccState.ecdhPublicKey))try{const t=this.eccState.curve;if(t==="ed25519"||t==="ed448"){this.eccState.error=`ECDH${t}`;return}const e=mu(this.eccState.ecdhPrivateKey,this.eccState.ecdhPublicKey,t);this.eccState.sharedSecret=e.sharedSecret,this.eccState.error=""}catch(t){this.eccState.error=`ECDH: ${t instanceof Error?t.message:String(t)}`}},generateSipHashKey(){try{this.hashState.siphashKey=F0(),this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async computeHash(){if(!this.hashState.inputText){this.hashState.error="";return}try{const t=performance.now(),e=new TextEncoder().encode(this.hashState.inputText);this.hashState.inputBytes=e;let r;switch(this.hashState.selectedAlgorithm){case"sha256":r=await Ua(e);break;case"sha512":r=await Es(e);break;case"sha3-256":r=await xs(e);break;case"blake2b":r=await bs(e);break;case"blake3":r=await Bs(e);break;case"siphash":if(!this.hashState.siphashKey){this.hashState.error="SipHash";return}r=await Ts(e,this.hashState.siphashKey);break;default:this.hashState.error="";return}this.hashState.hash=r,this.hashState.processingTime=performance.now()-t,this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async compareAllHashes(){if(!this.hashState.inputText){this.hashState.error="";return}try{const t=new TextEncoder().encode(this.hashState.inputText);this.hashState.inputBytes=t,this.hashState.comparisonResults={};const e=[{name:"SHA-256",fn:Ua},{name:"SHA-512",fn:Es},{name:"SHA-3-256",fn:xs},{name:"BLAKE2b",fn:bs},{name:"BLAKE3",fn:Bs}];for(const r of e){const a=performance.now(),f=await r.fn(t),o=performance.now()-a;this.hashState.comparisonResults[r.name]={hash:It(f),time:o}}if(this.hashState.siphashKey){const r=performance.now(),a=await Ts(t,this.hashState.siphashKey),f=performance.now()-r;this.hashState.comparisonResults["SipHash-2-4"]={hash:It(a),time:f}}this.hashState.error=""}catch(t){this.hashState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initKyber(){try{this.kyberState.error="",await An(),this.kyberState.initialized=!0}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`,this.kyberState.initialized=!1}},async generateKyberKeyPair(){this.kyberState.initialized||await this.initKyber();try{this.kyberState.error="";const t=await M0();this.kyberState.publicKey=t.publicKey,this.kyberState.privateKey=t.privateKey}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async encapsulateKyber(){if(!this.kyberState.publicKey){this.kyberState.error="";return}try{this.kyberState.error="";const t=await q0(this.kyberState.publicKey);this.kyberState.ciphertext=t.ciphertext,this.kyberState.sharedSecret=t.sharedSecret}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async decapsulateKyber(){if(!this.kyberState.ciphertext||!this.kyberState.privateKey||!this.kyberState.publicKey){this.kyberState.error="";return}try{this.kyberState.error="";const t=await G0(this.kyberState.ciphertext,this.kyberState.privateKey,this.kyberState.publicKey);this.kyberState.decapsulatedSecret=t}catch(t){this.kyberState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initDilithium(){try{this.dilithiumState.error="",await Tn(),this.dilithiumState.initialized=!0}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`,this.dilithiumState.initialized=!1}},async generateDilithiumKeyPair(){this.dilithiumState.initialized||await this.initDilithium();try{this.dilithiumState.error="";const t=await $0();this.dilithiumState.publicKey=t.publicKey,this.dilithiumState.privateKey=t.privateKey}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async signDilithium(){if(!this.dilithiumState.privateKey){this.dilithiumState.error="";return}if(!this.dilithiumState.message){this.dilithiumState.error="";return}try{this.dilithiumState.error="";const t=new TextEncoder().encode(this.dilithiumState.message);this.dilithiumState.messageBytes=t;const e=await Y0(t,this.dilithiumState.privateKey);this.dilithiumState.signature=e}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async verifyDilithium(){if(!this.dilithiumState.signature||!this.dilithiumState.publicKey){this.dilithiumState.error="";return}if(!this.dilithiumState.verificationMessage){this.dilithiumState.error="";return}try{this.dilithiumState.error="";const t=new TextEncoder().encode(this.dilithiumState.verificationMessage);this.dilithiumState.verificationMessageBytes=t;const e=await Q0(t,this.dilithiumState.signature,this.dilithiumState.publicKey);this.dilithiumState.verified=e}catch(t){this.dilithiumState.error=`: ${t instanceof Error?t.message:String(t)}`}},async initFalcon(){try{this.falconState.error="",await In(),this.falconState.initialized=!0}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`,this.falconState.initialized=!1}},async generateFalconKeyPair(){this.falconState.initialized||await this.initFalcon();try{this.falconState.error="";const t=await X0();this.falconState.publicKey=t.publicKey,this.falconState.privateKey=t.privateKey}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}},async signFalcon(){if(!this.falconState.privateKey){this.falconState.error="";return}if(!this.falconState.message){this.falconState.error="";return}try{this.falconState.error="";const t=new TextEncoder().encode(this.falconState.message);this.falconState.messageBytes=t;const e=await Z0(t,this.falconState.privateKey);this.falconState.signature=e}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}},async verifyFalcon(){if(!this.falconState.signature||!this.falconState.publicKey){this.falconState.error="";return}if(!this.falconState.verificationMessage){this.falconState.error="";return}try{this.falconState.error="";const t=new TextEncoder().encode(this.falconState.verificationMessage);this.falconState.verificationMessageBytes=t;const e=await W0(t,this.falconState.signature,this.falconState.publicKey);this.falconState.verified=e}catch(t){this.falconState.error=`: ${t instanceof Error?t.message:String(t)}`}},generateSSEKey(){try{this.sseState.masterKey=el(),this.sseState.error=""}catch(t){this.sseState.error=`: ${t instanceof Error?t.message:String(t)}`}},addKeyword(){if(!this.sseState.keywordInput.trim())return;const t=this.sseState.keywordInput.trim();this.sseState.keywords.includes(t)||this.sseState.keywords.push(t),this.sseState.keywordInput=""},removeKeyword(t){this.sseState.keywords.splice(t,1)},async encryptSSE(){if(!this.sseState.masterKey){this.sseState.error="";return}if(!this.sseState.plaintext){this.sseState.error="";return}if(this.sseState.keywords.length===0){this.sseState.error="1";return}try{this.sseState.error="";const t=this.stringToBytes(this.sseState.plaintext);this.sseState.plaintextBytes=t;const e=il();this.sseState.documentId=e;const r=await tl(this.sseState.masterKey,e,t,this.sseState.keywords);this.sseState.encryptedDocument=r,this.sseState.documents.push({id:e,document:r}),this.sseState.plaintext="",this.sseState.plaintextBytes=null,this.sseState.keywords=[],this.sseState.keywordInput=""}catch(t){this.sseState.error=`: ${t instanceof Error?t.message:String(t)}`}},async searchSSE(){if(!this.sseState.masterKey){this.sseState.error="";return}if(!this.sseState.searchKeyword.trim()){this.sseState.error="";return}if(this.sseState.documents.length===0){this.sseState.error="";return}try{this.sseState.error="";const t=await nl(this.sseState.masterKey,this.sseState.searchKeyword.trim());this.sseState.searchTag=t;const e=this.sseState.documents.map(a=>a.document),r=al(t,e);this.sseState.searchResults=this.sseState.documents.filter(a=>r.documents.includes(a.document)),this.sseState.searchResults.length===1?this.sseState.selectedDocumentId=this.sseState.searchResults[0].id:this.sseState.selectedDocumentId=null}catch(t){this.sseState.error=`: ${t instanceof Error?t.message:String(t)}`}},async decryptSSE(){if(!this.sseState.masterKey){this.sseState.error="";return}if(!this.sseState.selectedDocumentId){this.sseState.error="";return}const t=this.sseState.documents.find(e=>{if(e.id.length!==this.sseState.selectedDocumentId.length)return!1;for(let r=0;r<e.id.length;r++)if(e.id[r]!==this.sseState.selectedDocumentId[r])return!1;return!0});if(!t){this.sseState.error="";return}try{this.sseState.error="";const e=await rl(this.sseState.masterKey,t.id,t.document);this.sseState.decryptedBytes=e,this.sseState.decrypted=this.bytesToString(e)}catch(e){this.sseState.error=`: ${e instanceof Error?e.message:String(e)}`}},selectDocument(t){this.sseState.selectedDocumentId=t,this.sseState.error=""}}}typeof window<"u"&&(window.cryptoApp=ol);
